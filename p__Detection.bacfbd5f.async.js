(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{72285:function(w){w.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},80212:function(w,U,l){"use strict";l.r(U),l.d(U,{default:function(){return ln}});var vn=l(57663),G=l(71577),gn=l(34669),K=l(54458),Z=l(2824),O=l(67294),W=l(72285),C=l.n(W),z=l(8088),S=l(61541),J=l(44434),V=l(5041),Q=l(57436),q=l(14836),o=l(85893),_=function(r){return(0,o.jsx)(S.Z,{active:r.active,imgSrc:r.imgSrc||"./pics/buttons/rectangle.png",onClick:r.onClick,children:r.children})},nn=_,tn=l(91220),B=l(11849),R=l(65031);function on(n){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:null}function H(n,r){if(!(!n||!r))return{color:n,points:r}}function en(n,r,h,y,c,m,d){if(!n||!n.lines||!n.lines[0])return[(0,o.jsx)(o.Fragment,{})];var i=n.lines[0].points,u=n.lines[0].color,v=on(u);if(!v)return[(0,o.jsx)(o.Fragment,{})];var j=(d==null?void 0:d.annotationId)==n.annotationId,x=j?.5:.1,g=void 0,M=[];return i.forEach(function(A,I){if(!g){g=A;return}M.push((0,o.jsx)(R.Cd,{onMouseDown:function(){c=="mover"&&m(n)},draggable:c=="mover",onDragMove:function(p){console.log("Circle onDrageMove");var N=p.evt.offsetX/y,P=p.evt.offsetY/y;i[I-1]=N,i[I]=P;var L=(0,B.Z)((0,B.Z)({},n),{},{lines:[{color:u,points:i}]});r(L)},onMouseOver:function(){console.log("Circle onMouseOver"),c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:g,y:A,radius:5,fill:u})),console.log(I,i),i.length>4&&i.splice(I+1,2),g=void 0}),[(0,o.jsxs)(R.ZA,{children:[(0,o.jsx)(R.UL,{onMouseOver:function(){c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){c=="mover"&&m(n)},stroke:u,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",x:i[0],y:i[1],width:i[2]-i[0],height:i[3]-i[1],closed:!0,fill:"rgba(".concat(v.r,", ").concat(v.g,", ").concat(v.b,", ").concat(x,")")}),M]},n.annotationId)]}function rn(n){var r=0,h=(0,tn.Z)(n),y;try{for(h.s();!(y=h.n()).done;){var c=y.value;!c||c.annotationId>r&&(r=c.annotationId)}}catch(m){h.e(m)}finally{h.f()}return r}function an(n){var r=function(d,i){var u,v=d.evt.offsetX/i,j=d.evt.offsetY/i,x=H((u=n.currentLabel)===null||u===void 0?void 0:u.color,[v,j]);!x||n.onAnnotationAdd({tool:"polygon",annotationId:rn(n.annotations)+1,label:n.currentLabel,lines:[x]})},h=function(d,i){var u,v;if(!!n.currentAnnotation){var j=d.evt.offsetX/i,x=d.evt.offsetY/i,g=n.currentAnnotation.lines||[],M=H((u=n.currentLabel)===null||u===void 0?void 0:u.color,(v=g[0])===null||v===void 0?void 0:v.points.concat([j,x]));if(!!M){var A={tool:"polygon",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:[M]};n.onAnnotationModify(A)}}},y=function(d,i){n.currentTool=="polygon"&&(n.currentAnnotation?h(d,i):r(d,i))},c=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:y,onMouseMove:function(){},onMouseUp:c,createElementsFunc:en}}var D=40,sn=function(){var r,h=(0,O.useState)(void 0),y=(0,Z.Z)(h,2),c=y[0],m=y[1],d=(0,O.useState)({color:"",name:""}),i=(0,Z.Z)(d,2),u=i[0],v=i[1],j=(0,O.useState)(),x=(0,Z.Z)(j,2),g=x[0],M=x[1],A=(0,O.useState)([]),I=(0,Z.Z)(A,2),f=I[0],p=I[1],N=(0,O.useState)(1),P=(0,Z.Z)(N,2),L=P[0],k=P[1],Y=function(t){t||k(1),t<.1||t>3?k(1):k(t)},b=function(t){M(t),t!=null&&t.label&&v(t.label)};(0,O.useEffect)(function(){localStorage.removeItem("history"),T([])},[]);function T(a,t){var e=localStorage.getItem("history"),s=e?JSON.parse(e):{index:-1,items:[]},$={currentAnnotation:t,annotations:a};if(JSON.stringify(s.items[s.index])!=JSON.stringify($)){var dn=s.index>D?s.index-D:0,fn=s.items.splice(dn,s.index==0?1:s.index+1);s.items=fn.concat([$]),s.index<=D?s.index++:s.index=D+1,localStorage.setItem("history",JSON.stringify(s))}}var cn=function(){var t=localStorage.getItem("history");if(!!t){var e=JSON.parse(t);if(!!e&&!(e.index>=e.items.length-1)){e.index++,localStorage.setItem("history",JSON.stringify(e));var s=e.items[e.index];M(s.currentAnnotation),p(s.annotations)}}},un=function(){var t=localStorage.getItem("history");if(!!t){var e=JSON.parse(t);if(!(!e||!e.index)&&!(e.index<=0)){e.index--,localStorage.setItem("history",JSON.stringify(e));var s=e.items[e.index];M(s.currentAnnotation),p(s.annotations)}}},F=function(t){for(var e=[],s=0;s<f.length;s++)f[s].annotationId==t.annotationId?e.push(t):e.push(f[s]);b(t),p(e)},X=an({currentLabel:u,currentTool:c,annotations:f,currentAnnotation:g,onAnnotationAdd:function(t){var e=f.concat([t]);p(e),g||b(t)},onAnnotationModify:F,onMouseUp:function(){T(f,g)}}),E=X;return(0,o.jsxs)(z.Z,{className:C().det,children:[(0,o.jsxs)(J.Z,{children:[(0,o.jsx)(nn,{active:c=="polygon",onClick:function(){m("polygon"),b(void 0)},children:"Rectangle"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){Y(L+.1)},children:"Zoom in"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){Y(L-.1)},children:"Zoom out"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){m("mover")},children:"Move"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){un()},children:"Undo"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){cn()},children:"Redo"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{id:"dr",className:C().mainStage,children:[(0,o.jsx)("div",{className:C().draw,children:(0,o.jsx)(Q.Z,{width:(r=document.getElementById("dr"))===null||r===void 0?void 0:r.clientWidth,scale:L,annotations:f,currentTool:c,currentAnnotation:g,setCurrentAnnotation:b,onAnnotationModify:F,onAnnotationModifyComplete:function(){T(f,g)},onMouseDown:E.onMouseDown,onMouseMove:E.onMouseMove,onMouseUp:E.onMouseUp,createPolygonFunc:X.createElementsFunc})}),(0,o.jsx)("div",{className:C().pblock,children:(0,o.jsx)("div",{className:C().progress,children:(0,o.jsx)(K.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(J.Z,{disLoc:"right",children:[(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(S.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"})]}),(0,o.jsxs)("div",{className:C().rightSideBar,children:[(0,o.jsx)("div",{className:C().determinOutline,children:(0,o.jsx)(G.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){b(void 0)},children:"Determine Outline"})}),(0,o.jsx)(V.Z,{selectedLabel:u,onLabelSelect:function(t){v(t),b(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(q.Z,{selectedAnnotation:g,annotations:f,onAnnotationSelect:function(t){t!=null&&t.delete||b(t)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(t){p(f.filter(function(e){return e.annotationId!=t.annotationId})),b(void 0)}})]})]})},ln=sn}}]);
