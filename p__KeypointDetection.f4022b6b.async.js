(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{85024:function(S){S.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(S){S.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},71212:function(S){S.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},14836:function(S,B,t){"use strict";t.d(B,{Z:function(){return l}});var U=t(54421),D=t(38272),C=t(57663),A=t(71577),u=t(67294),_=t(56159),L=t.n(_),x=t(49111),p=t(19650),n=t(2824),v=t(11849),y=t(85024),g=t.n(y),I=t(63097),a=t(85893),h=function(d){var s=(0,v.Z)({},d.annotation),E=(0,u.useState)(s.invisible),P=(0,n.Z)(E,2),M=P[0],b=P[1],W=(0,u.useState)(0),K=(0,n.Z)(W,2),Y=K[0],H=K[1];(0,u.useEffect)(function(){b(d.annotation.invisible)},[d.annotation.invisible]);var k=(0,a.jsxs)(D.ZP.Item,{className:"".concat(g().listItem," ").concat(d.active?g().listItemActive:""),unselectable:"on",onClick:function(){d.onClick(s)},children:[(0,a.jsxs)(p.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:g().eye,style:{backgroundImage:M?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(Z){Z.stopPropagation(),b(!M),d.onAnnotationModify(s)}})," ",(0,a.jsx)("span",{className:g().annotationId,children:s.frontendId}),(0,a.jsx)("span",{className:g().labelName,children:s.label.name}),(0,a.jsx)(I.Z,{color:s.label.color})]}),(0,a.jsx)("a",{className:g().delete,onClick:function(Z){Z.stopPropagation();var F=new Date().getTime();F-Y<300||(H(F),d.onAnnotationDelete(s))}})]});return k},i=h,o=t(48971),m=function(d){var s=(0,o.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),E=(0,o.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(D.ZP,{className:L().labelList,size:"large",header:(0,a.jsx)("div",{className:L().listHeader,children:s}),bordered:!0,dataSource:d.annotations,renderItem:function(M){var b;return(0,a.jsx)(i,{onClick:d.onAnnotationSelect,annotation:M,active:M.frontendId==((b=d.currAnnotation)===null||b===void 0?void 0:b.frontendId),onAnnotationDelete:d.onAnnotationDelete,onAnnotationModify:d.onAnnotationModify})},footer:(0,a.jsx)("div",{children:(0,a.jsx)(A.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){d.onAnnotationAdd()},block:!0,children:E})})})})},l=m},29919:function(S,B,t){"use strict";var U=t(67294),D=t(61541),C=t(85893),A=function(_){return(0,C.jsx)(D.Z,{active:_.active,imgSrc:_.imgSrc||"./pics/buttons/polygon.png",onClick:_.onClick,children:_.children})};B.Z=A},50242:function(S,B,t){"use strict";t.d(B,{Z:function(){return p}});var U=t(91220),D=t(11849),C=t(65031),A=t(33522),u=t(85893);function _(n,v){if(!(!n||!v))return{color:n,points:v}}function L(n){if(!n.annotation||!n.annotation.points||!n.annotation.points[0])return[(0,u.jsx)(u.Fragment,{})];var v=n.annotation.points[0].points,y=n.annotation.points[0].color,g=(0,A.o)(y);if(!g)return[(0,u.jsx)(u.Fragment,{})];var I=.3,a=void 0,h=[];return v.forEach(function(i,o){if(!a){a=i;return}h.push((0,u.jsx)(C.Cd,{onMouseDown:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},draggable:n.currentTool=="editor",onDragMove:function(l){var O;l.cancelBubble=!0;var d=(O=n.stageRef)===null||O===void 0?void 0:O.current,s=d.findOne(".baseImage"),E=!1,P=l.target.x();P>s.width()/2&&(P=s.width()/2,E=!0),P<-s.width()/2&&(P=-s.width()/2,E=!0);var M=l.target.y();M>s.height()/2&&(M=s.height()/2,E=!0),M<-s.height()/2&&(M=-s.height()/2,E=!0),E&&l.target.setPosition({x:P,y:M}),v[o-1]=P,v[o]=M;var b=(0,D.Z)((0,D.Z)({},n.annotation),{},{points:[{color:y,points:v}]});n.onDrag(b)},onMouseOver:function(){var l;n.currentTool=="editor"&&(l=n.stageRef)!==null&&l!==void 0&&l.current&&(n.stageRef.current.container().style.cursor="cell")},onMouseOut:function(){var l;n.currentTool=="editor"&&(l=n.stageRef)!==null&&l!==void 0&&l.current&&(n.stageRef.current.container().style.cursor="default")},x:a,y:i,radius:5/n.scale,fill:y})),a=void 0}),[(0,u.jsxs)(C.ZA,{children:[(0,u.jsx)(C.x1,{onMouseOver:function(){n.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},stroke:y,strokeWidth:2/n.scale,globalCompositeOperation:"source-over",lineCap:"round",points:v,tension:0,closed:!0,fill:"rgba(".concat(g.r,", ").concat(g.g,", ").concat(g.b,", ").concat(I,")")}),h]},n.annotation.frontendId)]}function x(n){var v=0,y=(0,U.Z)(n),g;try{for(y.s();!(g=y.n()).done;){var I=g.value;!I||!I.frontendId||I.frontendId>v&&(v=I.frontendId)}}catch(a){y.e(a)}finally{y.f()}return v}function p(n){var v=function(h,i,o,m){var l,O=(h.evt.offsetX+i)/m,d=(h.evt.offsetY+o)/m,s=_((l=n.currentLabel)===null||l===void 0?void 0:l.color,[O,d]);!s||n.onAnnotationAdd({type:"polygon",frontendId:x(n.annotations)+1,label:n.currentLabel,points:[s]})},y=function(h,i,o,m){var l,O;if(!!n.currentAnnotation){var d=(h.evt.offsetX+i)/m,s=(h.evt.offsetY+o)/m,E=n.currentAnnotation.points||[],P=_((l=n.currentLabel)===null||l===void 0?void 0:l.color,(O=E[0])===null||O===void 0?void 0:O.points.concat([d,s]));if(!!P){var M={type:"polygon",frontendId:n.currentAnnotation.frontendId,label:n.currentAnnotation.label,points:[P]};n.onAnnotationModify(M)}}},g=function(h,i,o,m){n.currentTool=="polygon"&&(n.currentAnnotation?y(h,i,o,m):v(h,i,o,m))},I=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:g,onMouseMove:function(){},onMouseUp:I,createElementsFunc:L}}},33522:function(S,B,t){"use strict";t.d(B,{o:function(){return D}});function U(C){var A=0,u=_createForOfIteratorHelper(C),_;try{for(u.s();!(_=u.n()).done;){var L=_.value;!L||!L.frontendId||L.frontendId>A&&(A=L.frontendId)}}catch(x){u.e(x)}finally{u.f()}return A}function D(C){var A=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(C);return A?{r:parseInt(A[1],16),g:parseInt(A[2],16),b:parseInt(A[3],16)}:null}},82881:function(S,B,t){"use strict";t.r(B);var U=t(57663),D=t(71577),C=t(34669),A=t(54458),u=t(2824),_=t(67294),L=t(71212),x=t.n(L),p=t(8088),n=t(61541),v=t(44434),y=t(5041),g=t(57436),I=t(14836),a=t(29919),h=t(50242),i=t(48971),o=t(85893),m=40,l=function(){var d,s=(0,_.useState)(void 0),E=(0,u.Z)(s,2),P=E[0],M=E[1],b=(0,_.useState)({color:"",name:""}),W=(0,u.Z)(b,2),K=W[0],Y=W[1],H=(0,_.useState)(),k=(0,u.Z)(H,2),j=k[0],Z=k[1],F=(0,_.useState)([]),w=(0,u.Z)(F,2),T=w[0],N=w[1],tn=(0,_.useState)(1),Q=(0,u.Z)(tn,2),z=Q[0],J=Q[1],G=function(e){e||J(1),e<.1||e>3?J(1):J(e)},R=function(e){Z(e),e!=null&&e.label&&Y(e.label)};(0,_.useEffect)(function(){localStorage.removeItem("history"),$([])},[]);function $(c,e){var r=localStorage.getItem("history"),f=r?JSON.parse(r):{index:-1,items:[]},nn={currentAnnotation:e,annotations:c};if(JSON.stringify(f.items[f.index])!=JSON.stringify(nn)){var Pn=f.index>m?f.index-m:0,Mn=f.items.splice(Pn,f.index==0?1:f.index+1);f.items=Mn.concat([nn]),f.index<=m?f.index++:f.index=m+1,localStorage.setItem("history",JSON.stringify(f))}}var on=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!!r&&!(r.index>=r.items.length-1)){r.index++,localStorage.setItem("history",JSON.stringify(r));var f=r.items[r.index];Z(f.currentAnnotation),N(f.annotations)}}},en=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!(!r||!r.index)&&!(r.index<=0)){r.index--,localStorage.setItem("history",JSON.stringify(r));var f=r.items[r.index];Z(f.currentAnnotation),N(f.annotations)}}},V=function(e){for(var r=[],f=0;f<T.length;f++)T[f].annotationId==e.annotationId?r.push(e):r.push(T[f]);R(e),N(r)},q=(0,h.Z)({currentLabel:K,currentTool:P,annotations:T,currentAnnotation:j,onAnnotationAdd:function(e){var r=T.concat([e]);N(r),j||R(e)},onAnnotationModify:V,onMouseUp:function(){$(T,j)}}),X=q,an=(0,i.YB)().formatMessage({id:"pages.toolBar.polygon"}),rn=(0,i.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),sn=(0,i.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),ln=(0,i.YB)().formatMessage({id:"pages.toolBar.move"}),dn=(0,i.YB)().formatMessage({id:"pages.toolBar.unDo"}),cn=(0,i.YB)().formatMessage({id:"pages.toolBar.reDo"}),un=(0,i.YB)().formatMessage({id:"pages.toolBar.save"}),fn=(0,i.YB)().formatMessage({id:"pages.toolBar.edit"}),_n=(0,i.YB)().formatMessage({id:"pages.toolBar.clearMark"}),vn=(0,i.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),mn=(0,i.YB)().formatMessage({id:"pages.toolBar.divideData"}),gn=(0,i.YB)().formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(p.Z,{className:x().key,children:[(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(a.Z,{active:P=="polygon",onClick:function(){M("polygon"),R(void 0)},children:an}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/edit.png",children:fn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){G(z+.1)},children:rn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){G(z-.1)},children:sn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:un}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){M("mover")},children:ln}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){en()},children:dn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){on()},children:cn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:_n})]}),(0,o.jsxs)("div",{id:"dr",className:x().mainStage,children:[(0,o.jsx)("div",{className:x().draw,children:(0,o.jsx)(g.Z,{width:(d=document.getElementById("dr"))===null||d===void 0?void 0:d.clientWidth,scale:z,annotations:T,currentTool:P,currentAnnotation:j,setCurrentAnnotation:R,onAnnotationModify:V,onAnnotationModifyComplete:function(){$(T,j)},onMouseDown:X.onMouseDown,onMouseMove:X.onMouseMove,onMouseUp:X.onMouseUp,createPolygonFunc:q.createElementsFunc})}),(0,o.jsx)("div",{className:x().pblock,children:(0,o.jsx)("div",{className:x().progress,children:(0,o.jsx)(A.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(v.Z,{disLoc:"right",children:[(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:mn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:gn})]}),(0,o.jsxs)("div",{className:x().rightSideBar,children:[(0,o.jsx)("div",{className:x().finished,children:(0,o.jsx)(D.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){R(void 0)},children:vn})}),(0,o.jsx)(y.Z,{selectedLabel:K,onLabelSelect:function(e){Y(e),R(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(I.Z,{selectedAnnotation:j,annotations:T,onAnnotationSelect:function(e){e!=null&&e.delete||R(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){N(T.filter(function(r){return r.annotationId!=e.annotationId})),R(void 0)}})]})]})};B.default=l}}]);
