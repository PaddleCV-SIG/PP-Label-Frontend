(self.webpackChunkpp_labeling_frontend=self.webpackChunkpp_labeling_frontend||[]).push([[267],{71212:function(B){B.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},13931:function(B,p,r){"use strict";r.d(p,{Z:function(){return K}});var J=r(91220),I=r(11849),T=r(65031),P=r(85893);function D(n){var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16)}:null}function m(n,s){if(!(!n||!s))return{color:n,points:s}}function R(n,s,M,y,_,d,u){if(!n||!n.lines||!n.lines[0])return[(0,P.jsx)(P.Fragment,{})];var o=n.lines[0].points,l=n.lines[0].color,c=D(l);if(!c)return[(0,P.jsx)(P.Fragment,{})];var S=(u==null?void 0:u.annotationId)==n.annotationId,A=S?.5:.1,E=void 0,O=[];return o.forEach(function(f,j){if(!E){E=f;return}O.push((0,P.jsx)(T.Cd,{onMouseDown:function(){_=="mover"&&d(n)},draggable:_=="mover",onDragMove:function(L){console.log("Circle onDrageMove");var U=L.evt.offsetX/y,W=L.evt.offsetY/y;o[j-1]=U,o[j]=W;var Z=(0,I.Z)((0,I.Z)({},n),{},{lines:[{color:l,points:o}]});s(Z)},onMouseOver:function(){console.log("Circle onMouseOver"),_=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:E,y:f,radius:5,fill:l})),E=void 0}),[(0,P.jsxs)(T.ZA,{children:[(0,P.jsx)(T.x1,{onMouseOver:function(){_=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){_=="mover"&&d(n)},stroke:l,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:o,tension:0,closed:!0,fill:"rgba(".concat(c.r,", ").concat(c.g,", ").concat(c.b,", ").concat(A,")")}),O]},n.annotationId)]}function g(n){var s=0,M=(0,J.Z)(n),y;try{for(M.s();!(y=M.n()).done;){var _=y.value;!_||_.annotationId>s&&(s=_.annotationId)}}catch(d){M.e(d)}finally{M.f()}return s}function K(n){var s=function(u,o){var l,c=u.evt.offsetX/o,S=u.evt.offsetY/o,A=m((l=n.currentLabel)===null||l===void 0?void 0:l.color,[c,S]);!A||n.onAnnotationAdd({tool:"polygon",annotationId:g(n.annotations)+1,label:n.currentLabel,lines:[A]})},M=function(u,o){var l,c;if(!!n.currentAnnotation){var S=u.evt.offsetX/o,A=u.evt.offsetY/o,E=n.currentAnnotation.lines||[],O=m((l=n.currentLabel)===null||l===void 0?void 0:l.color,(c=E[0])===null||c===void 0?void 0:c.points.concat([S,A]));if(!!O){var f={tool:"polygon",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:[O]};n.onAnnotationModify(f)}}},y=function(u,o){n.currentTool=="polygon"&&(n.currentAnnotation?M(u,o):s(u,o))},_=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:y,onMouseMove:function(){},onMouseUp:_,createElementsFunc:R}}},82881:function(B,p,r){"use strict";r.r(p);var J=r(57663),I=r(71577),T=r(34669),P=r(54458),D=r(2824),m=r(67294),R=r(71212),g=r.n(R),K=r(8088),n=r(61541),s=r(44434),M=r(5041),y=r(57436),_=r(14836),d=r(29919),u=r(13931),o=r(85893),l=40,c=function(){var A=(0,m.useState)(void 0),E=(0,D.Z)(A,2),O=E[0],f=E[1],j=(0,m.useState)({color:"",name:""}),x=(0,D.Z)(j,2),L=x[0],U=x[1],W=(0,m.useState)(),Z=(0,D.Z)(W,2),h=Z[0],k=Z[1],V=(0,m.useState)([]),Y=(0,D.Z)(V,2),v=Y[0],C=Y[1],q=(0,m.useState)(1),X=(0,D.Z)(q,2),N=X[0],F=X[1],$=function(e){e||F(1),e<.1||e>3?F(1):F(e)},b=function(e){k(e),e!=null&&e.label&&U(e.label)};(0,m.useEffect)(function(){localStorage.removeItem("history"),w([])},[]);function w(i,e){var t=localStorage.getItem("history"),a=t?JSON.parse(t):{index:-1,items:[]},G={currentAnnotation:e,annotations:i};if(JSON.stringify(a.items[a.index])!=JSON.stringify(G)){var en=a.index>l?a.index-l:0,tn=a.items.splice(en,a.index==0?1:a.index+1);a.items=tn.concat([G]),a.index<=l?a.index++:a.index=l+1,localStorage.setItem("history",JSON.stringify(a))}}var nn=function(){var e=localStorage.getItem("history");if(!!e){var t=JSON.parse(e);if(!!t&&!(t.index>=t.items.length-1)){t.index++,localStorage.setItem("history",JSON.stringify(t));var a=t.items[t.index];k(a.currentAnnotation),C(a.annotations)}}},on=function(){var e=localStorage.getItem("history");if(!!e){var t=JSON.parse(e);if(!(!t||!t.index)&&!(t.index<=0)){t.index--,localStorage.setItem("history",JSON.stringify(t));var a=t.items[t.index];k(a.currentAnnotation),C(a.annotations)}}},z=function(e){for(var t=[],a=0;a<v.length;a++)v[a].annotationId==e.annotationId?t.push(e):t.push(v[a]);b(e),C(t)},Q=(0,u.Z)({currentLabel:L,currentTool:O,annotations:v,currentAnnotation:h,onAnnotationAdd:function(e){var t=v.concat([e]);C(t),h||b(e)},onAnnotationModify:z,onMouseUp:function(){w(v,h)}}),H=Q;return(0,o.jsxs)(K.Z,{className:g().key,children:[(0,o.jsxs)(s.Z,{children:[(0,o.jsx)(d.Z,{active:O=="polygon",onClick:function(){f("polygon"),b(void 0)},children:"Polygon"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){$(N+.1)},children:"Zoom in"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){$(N-.1)},children:"Zoom out"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){f("mover")},children:"Move"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){on()},children:"Undo"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){nn()},children:"Redo"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{className:g().mainStage,children:[(0,o.jsx)("div",{className:g().draw,children:(0,o.jsx)(y.Z,{scale:N,annotations:v,currentTool:O,currentAnnotation:h,setCurrentAnnotation:b,onAnnotationModify:z,onAnnotationModifyComplete:function(){w(v,h)},onMouseDown:H.onMouseDown,onMouseMove:H.onMouseMove,onMouseUp:H.onMouseUp,createPolygonFunc:Q.createElementsFunc})}),(0,o.jsx)("div",{className:g().pblock,children:(0,o.jsx)("div",{className:g().progress,children:(0,o.jsx)(P.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)("div",{className:g().rightSideBar,children:[(0,o.jsx)("div",{className:g().finished,children:(0,o.jsx)(I.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){b(void 0)},children:"Determine Outline"})}),(0,o.jsx)(M.Z,{selectedLabel:L,onLabelSelect:function(e){U(e),b(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(_.Z,{selectedAnnotation:h,annotations:v,onAnnotationSelect:function(e){e!=null&&e.delete||b(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){C(v.filter(function(t){return t.annotationId!=e.annotationId})),b(void 0)}})]})]})};p.default=c}}]);
