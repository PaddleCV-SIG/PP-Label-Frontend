(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(I,F,e){"use strict";e.d(F,{Z:function(){return _}});var H=e(94663),T=e(80112);function p(j){return Function.toString.call(j).indexOf("[native code]")!==-1}var Z=e(18597);function i(j,n,A){return(0,Z.Z)()?i=Reflect.construct:i=function(y,R,t){var K=[null];K.push.apply(K,R);var f=Function.bind.apply(y,K),W=new f;return t&&(0,T.Z)(W,t.prototype),W},i.apply(null,arguments)}function _(j){var n=typeof Map=="function"?new Map:void 0;return _=function(h){if(h===null||!p(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n!="undefined"){if(n.has(h))return n.get(h);n.set(h,y)}function y(){return i(h,arguments,(0,H.Z)(this).constructor)}return y.prototype=Object.create(h.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),(0,T.Z)(y,h)},_(j)}},52822:function(I){I.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(I){I.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(I){I.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(I){I.exports={container:"container___G0FNe"}},83930:function(I){I.exports={stage:"stage___3H5QL"}},80961:function(I){I.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(I){I.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(I){I.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(I,F,e){"use strict";var H=e(20136),T=e(55241),p=e(2824),Z=e(67294),i=e(52822),_=e.n(i),j=e(63144),n=e(85893),A=function(y){var R=(0,Z.useState)(y.color||"#FFF"),t=(0,p.Z)(R,2),K=t[0],f=t[1];return(0,Z.useEffect)(function(){f(y.color||"#FFF")},[y]),y.changeable?(0,n.jsx)(T.Z,{getPopupContainer:function(x){return x.parentElement||document.body},overlayClassName:_().popover,openClassName:_().popoverOpenClassName,placement:"bottom",content:(0,n.jsx)(j.xS,{disableAlpha:!0,color:K,onChange:function(x){f(x.hex)},onChangeComplete:y.onChange}),trigger:"click",children:(0,n.jsx)("div",{className:_().roundBall,style:{backgroundColor:K}})}):(0,n.jsx)("div",{className:_().roundBall,style:{backgroundColor:K}})};F.Z=A},5041:function(I,F,e){"use strict";e.d(F,{Z:function(){return g}});var H=e(54421),T=e(38272),p=e(57663),Z=e(71577),i=e(2824),_=e(67294),j=e(56131),n=e.n(j),A=e(49111),h=e(19650),y=e(11849),R=e(5882),t=e.n(R),K=e(63097),f=e(85893),W=function(l){var u=(0,y.Z)({},l.label),P=(0,_.useState)(u.invisible),L=(0,i.Z)(P,2),o=L[0],E=L[1],d=(0,f.jsx)(T.ZP.Item,{className:"".concat(t().listItem," ").concat(u.active?t().listItemActive:""),unselectable:"on",onClick:function(){l.onClick(u)},children:(0,f.jsxs)(h.Z,{align:"center",size:5,children:[(0,f.jsx)("a",{className:t().eye,style:{backgroundImage:o?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){E(!o),l.onLabelModify(u)}})," ",u.name,(0,f.jsx)(K.Z,{color:u.color,changeable:!0,onChange:function(C){u.color=C.hex,l.onLabelModify(u)}}),(0,f.jsx)("a",{className:t().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){l.onLabelDelete(u)}})]})});return d},x=W,O=e(71194),V=e(50146),w=e(47673),G=e(24044),k=e(9715),N=e(93766),U=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],M=function(l){var u,P,L=(0,_.useState)(((u=l.defaultLabel)===null||u===void 0?void 0:u.color)||U[l.order||0]),o=(0,i.Z)(L,2),E=o[0],d=o[1];(0,_.useEffect)(function(){var v;d(((v=l.defaultLabel)===null||v===void 0?void 0:v.color)||U[l.order||0])},[l]);var r=N.Z.useForm(),C=(0,i.Z)(r,1),c=C[0];return(0,f.jsx)(V.Z,{title:"Add Label",visible:l.visible,onCancel:l.onCancel,footer:null,children:(0,f.jsxs)(N.Z,{form:c,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(P=l.defaultLabel)===null||P===void 0?void 0:P.name},onFinish:function(m){var a={name:m.labelname,color:E};l.onLabelAdd(a),c.resetFields()},autoComplete:"off",children:[(0,f.jsx)(N.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,f.jsx)(G.Z,{})}),(0,f.jsx)(N.Z.Item,{label:"Select Color",name:"color",children:(0,f.jsx)(K.Z,{color:E,onChange:function(m){d(m.hex)}})}),(0,f.jsx)(N.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,f.jsxs)(h.Z,{children:[(0,f.jsx)(Z.Z,{onClick:function(){var m;(m=l.onCancel)===null||m===void 0||m.call(0),c.resetFields()},children:"\u53D6\u6D88"}),(0,f.jsx)(Z.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},D=M,B=function(l){var u;console.log("render pplabellist");var P=(0,_.useState)(!1),L=(0,i.Z)(P,2),o=L[0],E=L[1];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(T.ZP,{className:n().labelList,size:"large",header:(0,f.jsx)("div",{className:n().listHeader,children:"Label List"}),footer:(0,f.jsx)("div",{children:(0,f.jsx)(Z.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){E(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:l.labels,renderItem:function(r){return(0,f.jsx)(x,{onClick:l.onLabelSelect,label:r,onLabelDelete:l.onLabelDelete,onLabelModify:l.onLabelModify})}}),(0,f.jsx)(D,{order:(u=l.labels)===null||u===void 0?void 0:u.length,visible:o,onLabelAdd:function(r){l.onLabelAdd(r),E(!1)},onCancel:function(){E(!1)}})]})},g=B},8088:function(I,F,e){"use strict";var H=e(67294),T=e(78677),p=e.n(T),Z=e(85893),i=function(j){return(0,Z.jsx)("div",{className:"".concat(p().container," ").concat(j.className),children:j.children})};F.Z=i},57436:function(I,F,e){"use strict";var H=e(91220),T=e(2824),p=e(67294),Z=e(65031),i=e(84420),_=e.n(i),j=e(83930),n=e.n(j),A=e(85893),h="./pics/basketball.jpg",y=function(t){var K=_()(t.imgSrc||""),f=(0,T.Z)(K,1),W=f[0],x=(W==null?void 0:W.width)||0,O=(W==null?void 0:W.height)||0,V=(0,p.useState)(),w=(0,T.Z)(V,2),G=w[0],k=w[1],N=(0,p.useState)(),U=(0,T.Z)(N,2),M=U[0],D=U[1],B=(0,p.useState)({x:0,y:0}),g=(0,T.Z)(B,2),S=g[0],l=g[1];function u(){var r=document.getElementById("dr");r&&(k(r.clientWidth),D(r.clientHeight))}(0,p.useEffect)(function(){window.removeEventListener("resize",u),window.addEventListener("resize",u);var r=document.getElementById("dr");r&&(k(r.clientWidth),D(r.clientHeight),l({x:r.clientWidth/2,y:r.clientHeight/2}))},[]);var P=[];if(t.annotations){var L=(0,H.Z)(t.annotations),o;try{for(L.s();!(o=L.n()).done;){var E=o.value;if(!!E){var d=E.tool=="polygon"?t.createPolygonFunc:t.createBrushFunc;d&&P.push(d(E,t.onAnnotationModify,t.onAnnotationModifyComplete,t.scale,t.currentTool,t.setCurrentAnnotation,t.currentAnnotation))}}}catch(r){L.e(r)}finally{L.f()}}return(0,A.jsx)(Z.Hf,{width:G,height:M,className:n().stage,children:(0,A.jsx)(Z.mh,{onMouseDown:function(C){t.onMouseDown&&t.onMouseDown(C,t.scale)},onMouseMove:function(C){t.onMouseMove&&t.onMouseMove(C,t.scale)},onMouseUp:function(C){t.onMouseUp&&t.onMouseUp(C,t.scale)},onContextMenu:function(C){C.evt.preventDefault()},draggable:!1,children:(0,A.jsxs)(Z.ZA,{draggable:t.currentTool=="mover",onDragEnd:function(C){},children:[(0,A.jsx)(Z.Ee,{draggable:!1,image:W,x:S.x,y:S.y,offsetX:x/2,offsetY:O/2,scaleX:t.scale,scaleY:t.scale}),P]})})})};F.Z=y},44434:function(I,F,e){"use strict";var H=e(67294),T=e(80961),p=e.n(T),Z=e(85893),i=function(j){var n=p().leftToolbar;return j.disLoc=="right"&&(n=p().rightToolbar),(0,Z.jsx)("div",{className:n,children:j.children})};F.Z=i},61541:function(I,F,e){"use strict";var H=e(49111),T=e(19650),p=e(67294),Z=e(82499),i=e.n(Z),_=e(85893),j=function(A){return(0,_.jsx)("div",{unselectable:"on",className:"".concat(i().toolBarButtonContainerWrapper," ").concat(A.active&&i().toolBarButtonContainerWrapperActive),onClick:A.onClick,children:(0,_.jsx)(T.Z,{align:"center",className:i().toolBarButtonContainer,size:0,children:(0,_.jsxs)(T.Z,{align:"center",direction:"vertical",className:i().toolBarButton,size:0,children:[(0,_.jsx)("img",{src:A.imgSrc}),(0,_.jsx)("div",{className:i().buttonText,children:A.children})]})})})};F.Z=j},29214:function(I,F,e){"use strict";e.r(F);var H=e(20228),T=e(11382),p=e(34669),Z=e(54458),i=e(34792),_=e(48086),j=e(2824),n=e(67294),A=e(73199),h=e.n(A),y=e(8088),R=e(61541),t=e(44434),K=e(5041),f=e(57436),W=e(37071),x=e(64322),O=e(85893),V=localStorage.getItem("basePath"),w=function k(N){console.log("selectlabel",k)},G=function(){var N,U=(0,n.useState)("mover"),M=(0,j.Z)(U,2),D=M[0],B=M[1],g=(0,n.useState)(!1),S=(0,j.Z)(g,2),l=S[0],u=S[1],P=(0,x._D)(n.useState),L=(0,x.Gd)(n.useState),o=(0,x.jL)(n.useState,{pageOnSelect:w}),E=(0,x.iA)(n.useState),d=(0,x.A5)(n.useState),r=(0,x.CV)(n.useState),C=W.Z.getQueryVariable("projectId");return console.log("projectId",C),(0,n.useEffect)(function(){u(!0),L.getCurr(C).then(function(c){o.getAll(c.projectId),E.getAll(c.projectId,0)}),u(!1)},[C]),(0,n.useEffect)(function(){!E.curr||d.getAll(E.curr.taskId,0)},[E.curr]),(0,O.jsxs)(y.Z,{className:h().classes,children:[(0,O.jsxs)(t.Z,{children:[(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){P.change(.1)},children:"Zoom in"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){P.change(-.1)},children:"Zoom out"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){_.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){B("mover"),_.default.info("You can move the image now.")},children:"Move"})]}),(0,O.jsx)("div",{id:"dr",className:h().mainStage,children:(0,O.jsxs)(T.Z,{tip:"loading",spinning:l,children:[(0,O.jsx)("div",{className:h().draw,children:(0,O.jsx)(f.Z,{scale:P.curr,currentTool:D,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat(V,"/datas/").concat((N=d.curr)===null||N===void 0?void 0:N.dataId,"/image")})}),(0,O.jsx)("div",{className:h().pblock,children:(0,O.jsx)("div",{className:h().progress,children:(0,O.jsx)(Z.Z,{percent:50,status:"active"})})}),(0,O.jsx)("div",{className:h().prevTask,onClick:function(){return E.turnTo(E.currIdx-1)}}),(0,O.jsx)("div",{className:h().nextTask,onClick:function(){return E.turnTo(E.currIdx+1)}})]})}),(0,O.jsxs)(t.Z,{disLoc:"right",children:[(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,O.jsx)("div",{className:h().rightSideBar,children:(0,O.jsx)(K.Z,{labels:o.all,selectedLabel:o.curr,onLabelSelect:o.onSelect,onLabelAdd:o.onAdd,onLabelDelete:o.onDelete,onLabelModify:function(){}})})]})};F.default=G},64322:function(I,F,e){"use strict";e.d(F,{gu:function(){return f},_D:function(){return O},Gd:function(){return V},jL:function(){return w},iA:function(){return G},CV:function(){return k},A5:function(){return N}});var H=e(86582),T=e(91220),p=e(3182),Z=e(34792),i=e(48086),_=e(2824),j=e(94043),n=e.n(j),A=e(37071),h=e(81139),y=localStorage.getItem("basePath"),R=new h.VK(y?{basePath:y}:void 0),t=new h.U(R),K=new h.sD(R),f=function(M){return JSON.parse(JSON.stringify(M))};function W(U){return U&&(U.toLowerCase().replace(/([-_][a-z])/g,function(M){return M.toUpperCase().replace("-","").replace("_","")}),U)}var x=function(M,D,B){if(!!B){for(var g=0;g<D.length;g++)if(M[B]==D[g][B])return g}},O=function(M){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],B=M(1),g=(0,_.Z)(B,2),S=g[0],l=g[1],u=function(L){var o=S;o+=L,o<D[0]&&(o=D[0],i.default.error("Smallest scale is "+D[0])),o>D[1]&&(o=D[1],i.default.error("Largest scale is "+D[1])),l(o)};return{change:u,get scale(){return S}}},V=function(M){var D=M([]),B=(0,_.Z)(D,2),g=B[0],S=B[1],l=M(),u=(0,_.Z)(l,2),P=u[0],L=u[1],o=function(){var c=(0,p.Z)(n().mark(function v(){var m;return n().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,t.getAll();case 3:return m=b.sent,S(m),b.abrupt("return",m);case 8:b.prev=8,b.t0=b.catch(0),console.log("project getAll err",b.t0),A.Z.parseError(b.t0,i.default);case 12:case"end":return b.stop()}},v,null,[[0,8]])}));return function(){return c.apply(this,arguments)}}(),E=function(){var c=(0,p.Z)(n().mark(function v(m){var a;return n().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(m!=null){s.next=2;break}return s.abrupt("return",void 0);case 2:if(!(g.length>1)){s.next=5;break}return i.default.error("Currently have multiple projects stored, use turnTo instead"),s.abrupt("return");case 5:return s.prev=5,s.next=8,t.get(m);case 8:return a=s.sent,S([a]),L(0),s.abrupt("return",a);case 14:s.prev=14,s.t0=s.catch(5),console.log("prject getcurr err",s.t0),A.Z.parseError(s.t0,i.default);case 18:case"end":return s.stop()}},v,null,[[5,14]])}));return function(m){return c.apply(this,arguments)}}(),d=function(){var c=(0,p.Z)(n().mark(function v(m){return n().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:typeof m=="number"?t.remove(m):t.remove(m.projectId),o();case 2:case"end":return b.stop()}},v)}));return function(m){return c.apply(this,arguments)}}(),r=function(){var c=(0,p.Z)(n().mark(function v(m){var a;return n().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.create(m);case 3:return a=s.sent,console.log(a),s.abrupt("return",a);case 8:s.prev=8,s.t0=s.catch(0),console.log("project create err",s.t0),A.Z.parseError(s.t0,i.default);case 12:case"end":return s.stop()}},v,null,[[0,8]])}));return function(m){return c.apply(this,arguments)}}(),C=function(){var c=(0,p.Z)(n().mark(function v(m,a){return n().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t.update(m,a).then(function(z){console.log("project update res",z)}).catch(function(z){console.log("project update err ",z),A.Z.parseError(z,i.default)});case 1:case"end":return s.stop()}},v)}));return function(m,a){return c.apply(this,arguments)}}();return{all:g,getAll:o,getCurr:E,remove:d,create:r,update:C,get curr(){if(P!=null)return g[P]}}},w=function(M,D){var B=D.pageOnSelect,g=M([]),S=(0,_.Z)(g,2),l=S[0],u=S[1],P=M(),L=(0,_.Z)(P,2),o=L[0],E=L[1],d=function(){var m=(0,p.Z)(n().mark(function a(b){var s,z,J,X;return n().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.prev=0,$.next=3,t.getLabels(b);case 3:s=$.sent,z=(0,T.Z)(s);try{for(z.s();!(J=z.n()).done;)X=J.value,X.active=!1}catch(Y){z.e(Y)}finally{z.f()}return u(s),$.abrupt("return",s);case 10:$.prev=10,$.t0=$.catch(0),console.log("label getall err ",$.t0),A.Z.parseError($.t0,i.default);case 14:case"end":return $.stop()}},a,null,[[0,10]])}));return function(b){return m.apply(this,arguments)}}(),r=function(a){E(idx,x(lable,l,"labelId"));var b=l.filter(function(s){return s.labelId==a.labelId})[0];b.active=!b.active,B(b),u((0,H.Z)(l))},C=function(){},c=function(){},v=function(){};return{all:l,getAll:d,onSelect:r,onAdd:C,onDelete:c,onModify:v,get curr(){if(o!=null)return l[o]}}},G=function(M){var D=M([]),B=(0,_.Z)(D,2),g=B[0],S=B[1],l=M(0),u=(0,_.Z)(l,2),P=u[0],L=u[1],o=function(r){if(console.log("turnto",g,r),g.length!=0){if(r==-1){i.default.error("This is the first image. No previous image.");return}if(r==g.length){i.default.error("This is the final image. No next image.");return}L(r)}},E=function(){var d=(0,p.Z)(n().mark(function r(C,c){var v;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.getTasks(C);case 3:return v=a.sent,S(v),c!=null&&o(c),a.abrupt("return",v);case 9:a.prev=9,a.t0=a.catch(0),console.log("task getall err ",a.t0),A.Z.parseError(a.t0,i.default);case 13:case"end":return a.stop()}},r,null,[[0,9]])}));return function(C,c){return d.apply(this,arguments)}}();return{currIdx:P,all:g,turnTo:o,getAll:E,get curr(){if(P!=null)return g[P]}}},k=function(M){var D=M([]),B=(0,_.Z)(D,2),g=B[0],S=B[1],l=function(){var u=(0,p.Z)(n().mark(function P(L){var o;return n().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,o=dataApi.getAnnotations(L),S(o),d.abrupt("return",o);case 6:d.prev=6,d.t0=d.catch(0),console.log("ann getAll err",d.t0),A.Z.parseError(d.t0,i.default);case 10:case"end":return d.stop()}},P,null,[[0,6]])}));return function(L){return u.apply(this,arguments)}}();return{all:g,getAll:l}},N=function(M){var D=M(),B=(0,_.Z)(D,2),g=B[0],S=B[1],l=M([]),u=(0,_.Z)(l,2),P=u[0],L=u[1],o=function(){var d=(0,p.Z)(n().mark(function r(C){return n().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:S(C);case 1:case"end":return v.stop()}},r)}));return function(C){return d.apply(this,arguments)}}(),E=function(){var d=(0,p.Z)(n().mark(function r(C,c){var v;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,K.getDatas(C);case 3:return v=a.sent,c!=null&&o(c),L(v),a.abrupt("return",v);case 9:a.prev=9,a.t0=a.catch(0),console.log("data getall err ",a.t0),A.Z.parseError(a.t0,i.default);case 13:case"end":return a.stop()}},r,null,[[0,9]])}));return function(C,c){return d.apply(this,arguments)}}();return{all:P,getAll:E,turnTo:o,get curr(){if(P.length!=0)return P[g]}}}}}]);
