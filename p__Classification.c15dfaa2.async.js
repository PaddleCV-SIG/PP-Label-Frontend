(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(d,L,e){"use strict";e.d(L,{Z:function(){return _}});var F=e(94663),P=e(80112);function g(m){return Function.toString.call(m).indexOf("[native code]")!==-1}var f=e(18597);function s(m,v,h){return(0,f.Z)()?s=Reflect.construct:s=function(E,R,t){var i=[null];i.push.apply(i,R);var n=Function.bind.apply(E,i),u=new n;return t&&(0,P.Z)(u,t.prototype),u},s.apply(null,arguments)}function _(m){var v=typeof Map=="function"?new Map:void 0;return _=function(C){if(C===null||!g(C))return C;if(typeof C!="function")throw new TypeError("Super expression must either be null or a function");if(typeof v!="undefined"){if(v.has(C))return v.get(C);v.set(C,E)}function E(){return s(C,arguments,(0,F.Z)(this).constructor)}return E.prototype=Object.create(C.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),(0,P.Z)(E,C)},_(m)}},52822:function(d){d.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(d){d.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",delete:"delete___WHPf2",listItemActive:"listItemActive___3FRb7"}},56131:function(d){d.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(d){d.exports={container:"container___G0FNe"}},83930:function(d){d.exports={stage:"stage___3H5QL"}},80961:function(d){d.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(d){d.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(d){d.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(d,L,e){"use strict";var F=e(20136),P=e(55241),g=e(2824),f=e(67294),s=e(52822),_=e.n(s),m=e(63144),v=e(85893),h=function(E){var R=(0,f.useState)(E.color||"#FFF"),t=(0,g.Z)(R,2),i=t[0],n=t[1];return(0,f.useEffect)(function(){n(E.color||"#FFF")},[E]),E.changeable?(0,v.jsx)(P.Z,{getPopupContainer:function(W){return W.parentElement||document.body},overlayClassName:_().popover,openClassName:_().popoverOpenClassName,placement:"bottom",content:(0,v.jsx)(m.xS,{disableAlpha:!0,color:i,onChange:function(W){n(W.hex)},onChangeComplete:E.onChange}),trigger:"click",children:(0,v.jsx)("div",{className:_().roundBall,style:{backgroundColor:i}})}):(0,v.jsx)("div",{className:_().roundBall,style:{backgroundColor:i}})};L.Z=h},5041:function(d,L,e){"use strict";e.d(L,{Z:function(){return K}});var F=e(54421),P=e(38272),g=e(57663),f=e(71577),s=e(2824),_=e(67294),m=e(56131),v=e.n(m),h=e(49111),C=e(19650),E=e(11849),R=e(5882),t=e.n(R),i=e(63097),n=e(85893),u=function(o){var c=(0,E.Z)({},o.label),x=(0,_.useState)(c.invisible),b=(0,s.Z)(x,2),I=b[0],D=b[1],O=o.hideEye?" ":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{className:t().eye,style:{backgroundImage:I?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){D(!I),o.onLabelModify(c)}})," "]}),r=o.hideColorPicker?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(i.Z,{color:c.color,changeable:!0,onChange:function(y){c.color=y.hex,o.onLabelModify(c)}}),B=(0,n.jsx)(P.ZP.Item,{className:"".concat(t().listItem," ").concat(c.active?t().listItemActive:""),unselectable:"on",onClick:function(){o.onClick(c)},children:(0,n.jsxs)(C.Z,{align:"center",size:5,children:[O,c.name,r,(0,n.jsx)("a",{className:t().delete,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(y){y.stopPropagation(),o.onLabelDelete(c)}})]})});return B},W=u,Z=e(71194),H=e(50146),z=e(47673),V=e(24044),X=e(9715),M=e(93766),l=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],Y=function(o){var c,x,b=(0,_.useState)(((c=o.defaultLabel)===null||c===void 0?void 0:c.color)||l[o.order||0]),I=(0,s.Z)(b,2),D=I[0],O=I[1];(0,_.useEffect)(function(){var j;O(((j=o.defaultLabel)===null||j===void 0?void 0:j.color)||l[o.order||0])},[o]);var r=o.hideColorPicker?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(M.Z.Item,{label:"Select Color",name:"color",children:(0,n.jsx)(i.Z,{color:D,onChange:function(a){O(a.hex)}})}),B=M.Z.useForm(),S=(0,s.Z)(B,1),y=S[0];return(0,n.jsx)(H.Z,{title:"Add Label",visible:o.visible,onCancel:o.onCancel,footer:null,children:(0,n.jsxs)(M.Z,{form:y,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(x=o.defaultLabel)===null||x===void 0?void 0:x.name},onFinish:function(a){var k={name:a.labelname,color:D};o.onLabelAdd(k),y.resetFields()},autoComplete:"off",children:[(0,n.jsx)(M.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,n.jsx)(V.Z,{})}),r,(0,n.jsx)(M.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,n.jsxs)(C.Z,{children:[(0,n.jsx)(f.Z,{onClick:function(){var a;(a=o.onCancel)===null||a===void 0||a.call(0),y.resetFields()},children:"\u53D6\u6D88"}),(0,n.jsx)(f.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},$=Y,w=function(o){var c;console.log("render pplabellist");var x=(0,_.useState)(!1),b=(0,s.Z)(x,2),I=b[0],D=b[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.ZP,{className:v().labelList,size:"large",header:(0,n.jsx)("div",{className:v().listHeader,children:"Label List"}),footer:(0,n.jsx)("div",{children:(0,n.jsx)(f.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){D(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:o.labels,renderItem:function(r){return(0,n.jsx)(W,{hideColorPicker:o.hideColorPicker,hideEye:o.hideEye,onClick:o.onLabelSelect,label:r,onLabelDelete:o.onLabelDelete,onLabelModify:o.onLabelModify})}}),(0,n.jsx)($,{hideColorPicker:o.hideColorPicker,order:(c=o.labels)===null||c===void 0?void 0:c.length,visible:I,onLabelAdd:function(r){o.onLabelAdd(r),D(!1)},onCancel:function(){D(!1)}})]})},K=w},8088:function(d,L,e){"use strict";var F=e(67294),P=e(78677),g=e.n(P),f=e(85893),s=function(m){return(0,f.jsx)("div",{className:"".concat(g().container," ").concat(m.className),children:m.children})};L.Z=s},57436:function(d,L,e){"use strict";var F=e(91220),P=e(2824),g=e(67294),f=e(65031),s=e(84420),_=e.n(s),m=e(83930),v=e.n(m),h=e(85893),C="./pics/basketball.jpg",E=function(t){var i=_()(t.imgSrc||""),n=(0,P.Z)(i,1),u=n[0],W=(u==null?void 0:u.width)||0,Z=(u==null?void 0:u.height)||0,H=(0,g.useState)(),z=(0,P.Z)(H,2),V=z[0],X=z[1],M=(0,g.useState)(),l=(0,P.Z)(M,2),Y=l[0],$=l[1],w=(0,g.useState)({x:0,y:0}),K=(0,P.Z)(w,2),U=K[0],o=K[1];function c(){var r=document.getElementById("dr");r&&(X(r.clientWidth),$(r.clientHeight))}(0,g.useEffect)(function(){window.removeEventListener("resize",c),window.addEventListener("resize",c);var r=document.getElementById("dr");r&&(X(r.clientWidth),$(r.clientHeight),o({x:r.clientWidth/2,y:r.clientHeight/2}))},[]);var x=[];if(t.annotations){var b=(0,F.Z)(t.annotations),I;try{for(b.s();!(I=b.n()).done;){var D=I.value;if(!!D){var O=D.tool=="polygon"?t.createPolygonFunc:t.createBrushFunc;O&&x.push(O(D,t.onAnnotationModify,t.onAnnotationModifyComplete,t.scale,t.currentTool,t.setCurrentAnnotation,t.currentAnnotation))}}}catch(r){b.e(r)}finally{b.f()}}return(0,h.jsx)(f.Hf,{width:V,height:Y,className:v().stage,children:(0,h.jsx)(f.mh,{onMouseDown:function(B){t.onMouseDown&&t.onMouseDown(B,t.scale)},onMouseMove:function(B){t.onMouseMove&&t.onMouseMove(B,t.scale)},onMouseUp:function(B){t.onMouseUp&&t.onMouseUp(B,t.scale)},onContextMenu:function(B){B.evt.preventDefault()},draggable:!1,children:(0,h.jsxs)(f.ZA,{draggable:t.currentTool=="mover",onDragEnd:function(B){},children:[(0,h.jsx)(f.Ee,{draggable:!1,image:u,x:U.x,y:U.y,offsetX:W/2,offsetY:Z/2,scaleX:t.scale,scaleY:t.scale}),x]})})})};L.Z=E},44434:function(d,L,e){"use strict";var F=e(67294),P=e(80961),g=e.n(P),f=e(85893),s=function(m){var v=g().leftToolbar;return m.disLoc=="right"&&(v=g().rightToolbar),(0,f.jsx)("div",{className:v,children:m.children})};L.Z=s},61541:function(d,L,e){"use strict";var F=e(49111),P=e(19650),g=e(67294),f=e(82499),s=e.n(f),_=e(85893),m=function(h){return(0,_.jsx)("div",{unselectable:"on",className:"".concat(s().toolBarButtonContainerWrapper," ").concat(h.active&&s().toolBarButtonContainerWrapperActive),onClick:h.onClick,children:(0,_.jsx)(P.Z,{align:"center",className:s().toolBarButtonContainer,size:0,children:(0,_.jsxs)(P.Z,{align:"center",direction:"vertical",className:s().toolBarButton,size:0,children:[(0,_.jsx)("img",{src:h.imgSrc}),(0,_.jsx)("div",{className:s().buttonText,children:h.children})]})})})};L.Z=m},29214:function(d,L,e){"use strict";e.r(L);var F=e(11849),P=e(20228),g=e(11382),f=e(34669),s=e(54458),_=e(34792),m=e(48086),v=e(86582),h=e(91220),C=e(3182),E=e(2824),R=e(94043),t=e.n(R),i=e(67294),n=e(73199),u=e.n(n),W=e(8088),Z=e(61541),H=e(44434),z=e(5041),V=e(57436),X=e(37071),M=e(64322),l=e(85893),Y=localStorage.getItem("basePath"),$=function(){var K,U,o,c=(0,i.useState)("mover"),x=(0,E.Z)(c,2),b=x[0],I=x[1],D=(0,i.useState)(!1),O=(0,E.Z)(D,2),r=O[0],B=O[1],S=X.Z.getQueryVariable("projectId"),y=(0,M._D)(i.useState),j=(0,M.CV)(i.useState),a=(0,M.iA)(i.useState),k=(0,M.A5)(i.useState),te=(0,M.Gd)(i.useState),de=function(p){if(console.log("selectLabel",a.curr,k.curr,j.all),p.active)j.create({taskId:a.curr.taskId,labelId:p.labelId,dataId:k.curr.dataId});else{var G=j.all.filter(function(q){return q.labelId==p.labelId})[0];console.log("filter ann ",G),j.remove(G.annotationId)}console.log("selectlabel",p)},T=(0,M.jL)(i.useState,{oneHot:!1,pageOnSelect:de});return(0,i.useEffect)(function(){te.getCurr(S),T.getAll(S),a.getAll(S),a.getProgress(S)},[]),(0,i.useEffect)(function(){a.all&&a.all.length!=0&&a.turnTo(0)},[a.all]),(0,i.useEffect)(function(){if(a.currIdx!=null){var A=function(){var p=(0,C.Z)(t().mark(function G(){var q,ne,ue,oe,ae,Q,le,re,J,se,_e;return t().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return console.log("onTaskChange",a.curr,T.all,a.progress),a.getProgress(a.curr.projectId),N.next=4,k.getAll(a.curr.taskId,0);case 4:return q=N.sent,ne=(0,E.Z)(q,2),ue=ne[0],oe=ne[1],N.next=10,j.getAll(oe.dataId);case 10:ae=N.sent,Q=(0,h.Z)(T.all);try{for(Q.s();!(le=Q.n()).done;)re=le.value,re.active=!1}catch(ee){Q.e(ee)}finally{Q.f()}J=(0,h.Z)(T.all);try{for(_e=function(){var ie=se.value,ce=ae.filter(function(me){return me.label.labelId==ie.labelId});ce.length!=0&&(ie.active=!0)},J.s();!(se=J.n()).done;)_e()}catch(ee){J.e(ee)}finally{J.f()}console.log("label.all toggled",T.all),T.setAll((0,v.Z)(T.all)),B(!1);case 18:case"end":return N.stop()}},G)}));return function(){return p.apply(this,arguments)}}();A()}},[a.currIdx]),(0,l.jsxs)(W.Z,{className:u().classes,children:[(0,l.jsxs)(H.Z,{children:[(0,l.jsx)(Z.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){y.change(.1)},children:"Zoom in"}),(0,l.jsx)(Z.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){y.change(-.1)},children:"Zoom out"}),(0,l.jsx)(Z.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){m.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,l.jsx)(Z.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){I("mover"),m.default.info("You can move the image now.")},children:"Move"})]}),(0,l.jsx)("div",{id:"dr",className:u().mainStage,children:(0,l.jsxs)(g.Z,{tip:"loading",spinning:r,children:[(0,l.jsx)("div",{className:u().draw,children:(0,l.jsx)(V.Z,{scale:y.curr,currentTool:b,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat(Y,"/datas/").concat((K=k.curr)===null||K===void 0?void 0:K.dataId,"/image")})}),(0,l.jsx)("div",{className:u().pblock,children:(0,l.jsxs)("div",{className:u().progress,children:[(0,l.jsx)(s.Z,{percent:a.progress,status:"active"})," ",a.currIdx," ",(U=a.all)===null||U===void 0?void 0:U.length," ",Math.floor(((o=a.all)===null||o===void 0?void 0:o.length)*a.progress/100)]})}),(0,l.jsx)("div",{className:u().prevTask,onClick:function(){return a.turnTo(a.currIdx-1)}}),(0,l.jsx)("div",{className:u().nextTask,onClick:function(){return a.turnTo(a.currIdx+1)}})]})}),(0,l.jsxs)(H.Z,{disLoc:"right",children:[(0,l.jsx)(Z.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,l.jsx)(Z.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,l.jsx)("div",{className:u().rightSideBar,children:(0,l.jsx)(z.Z,{labels:T.all,selectedLabel:T.curr,onLabelSelect:T.onSelect,onLabelAdd:function(p){return T.create((0,F.Z)((0,F.Z)({},p),{},{projectId:te.curr.projectId}))},onLabelDelete:T.remove,onLabelModify:function(){},hideColorPicker:!0,hideEye:!0})})]})};L.default=$}}]);
