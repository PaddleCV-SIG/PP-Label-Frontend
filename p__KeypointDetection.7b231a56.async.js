(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{85024:function(L){L.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(L){L.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},71212:function(L){L.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},14836:function(L,C,t){"use strict";t.d(C,{Z:function(){return d}});var p=t(54421),O=t(38272),b=t(57663),D=t(71577),i=t(67294),f=t(56159),T=t.n(f),A=t(49111),Z=t(19650),n=t(2824),v=t(11849),y=t(85024),g=t.n(y),x=t(63097),a=t(85893),h=function(u){var l=(0,v.Z)({},u.annotation),E=(0,i.useState)(l.invisible),P=(0,n.Z)(E,2),M=P[0],S=P[1],N=(0,i.useState)(0),K=(0,n.Z)(N,2),Y=K[0],H=K[1];(0,i.useEffect)(function(){S(u.annotation.invisible)},[u.annotation.invisible]);var k=(0,a.jsxs)(O.ZP.Item,{className:"".concat(g().listItem," ").concat(u.active?g().listItemActive:""),unselectable:"on",onClick:function(){u.onClick(l)},children:[(0,a.jsxs)(Z.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:g().eye,style:{backgroundImage:M?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(U){U.stopPropagation(),S(!M),u.onAnnotationModify(l)}})," ",(0,a.jsx)("span",{className:g().annotationId,children:l.frontendId}),(0,a.jsx)("span",{className:g().labelName,children:l.label.name}),(0,a.jsx)(x.Z,{color:l.label.color})]}),(0,a.jsx)("a",{className:g().delete,onClick:function(U){U.stopPropagation();var F=new Date().getTime();F-Y<300||(H(F),u.onAnnotationDelete(l))}})]});return k},r=h,e=t(48971),m=function(u){var l=(0,e.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),E=(0,e.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(O.ZP,{className:T().labelList,size:"large",header:(0,a.jsx)("div",{className:T().listHeader,children:l}),bordered:!0,dataSource:u.annotations,renderItem:function(M){var S;return(0,a.jsx)(r,{onClick:u.onAnnotationSelect,annotation:M,active:M.frontendId==((S=u.currAnnotation)===null||S===void 0?void 0:S.frontendId),onAnnotationDelete:u.onAnnotationDelete,onAnnotationModify:u.onAnnotationModify})},footer:(0,a.jsx)("div",{children:(0,a.jsx)(D.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){u.onAnnotationAdd()},block:!0,children:E})})})})},d=m},29919:function(L,C,t){"use strict";var p=t(67294),O=t(61541),b=t(85893),D=function(f){return(0,b.jsx)(O.Z,{active:f.active,imgSrc:f.imgSrc||"./pics/buttons/polygon.png",onClick:f.onClick,children:f.children})};C.Z=D},50242:function(L,C,t){"use strict";t.d(C,{Z:function(){return Z}});var p=t(91220),O=t(11849),b=t(65031),D=t(33522),i=t(85893);function f(n,v){if(!(!n||!v))return{color:n,points:v}}function T(n){if(!n.annotation||!n.annotation.points||!n.annotation.points[0])return[(0,i.jsx)(i.Fragment,{})];var v=n.annotation.points[0].points,y=n.annotation.points[0].color,g=(0,D.o)(y);if(!g)return[(0,i.jsx)(i.Fragment,{})];var x=.3,a=void 0,h=[];return v.forEach(function(r,e){if(!a){a=r;return}h.push((0,i.jsx)(b.Cd,{onMouseDown:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},draggable:n.currentTool=="editor",onDragMove:function(d){var I;d.cancelBubble=!0;var u=(I=n.stageRef)===null||I===void 0?void 0:I.current,l=u.findOne(".baseImage"),E=!1,P=d.target.x();P>l.width()/2&&(P=l.width()/2,E=!0),P<-l.width()/2&&(P=-l.width()/2,E=!0);var M=d.target.y();M>l.height()/2&&(M=l.height()/2,E=!0),M<-l.height()/2&&(M=-l.height()/2,E=!0),E&&d.target.setPosition({x:P,y:M}),v[e-1]=P,v[e]=M;var S=(0,O.Z)((0,O.Z)({},n.annotation),{},{points:[{color:y,points:v}]});n.onDrag(S)},onMouseOver:function(){var d;n.currentTool=="editor"&&(d=n.stageRef)!==null&&d!==void 0&&d.current&&(n.stageRef.current.container().style.cursor="cell")},onMouseOut:function(){var d;n.currentTool=="editor"&&(d=n.stageRef)!==null&&d!==void 0&&d.current&&(n.stageRef.current.container().style.cursor="default")},x:a,y:r,radius:5/n.scale,fill:y})),a=void 0}),[(0,i.jsxs)(b.ZA,{children:[(0,i.jsx)(b.x1,{onMouseOver:function(){n.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},stroke:y,strokeWidth:2/n.scale,globalCompositeOperation:"source-over",lineCap:"round",points:v,tension:0,closed:!0,fill:"rgba(".concat(g.r,", ").concat(g.g,", ").concat(g.b,", ").concat(x,")")}),h]},n.annotation.frontendId)]}function A(n){var v=0,y=(0,p.Z)(n),g;try{for(y.s();!(g=y.n()).done;){var x=g.value;!x||!x.frontendId||x.frontendId>v&&(v=x.frontendId)}}catch(a){y.e(a)}finally{y.f()}return v}function Z(n){var v=function(h,r,e,m){var d,I=(h.evt.offsetX+r)/m,u=(h.evt.offsetY+e)/m,l=f((d=n.currentLabel)===null||d===void 0?void 0:d.color,[I,u]);!l||n.onAnnotationAdd({type:"polygon",frontendId:A(n.annotations)+1,label:n.currentLabel,points:[l]})},y=function(h,r,e,m){var d,I;if(!!n.currentAnnotation){var u=(h.evt.offsetX+r)/m,l=(h.evt.offsetY+e)/m,E=n.currentAnnotation.points||[],P=f((d=n.currentLabel)===null||d===void 0?void 0:d.color,(I=E[0])===null||I===void 0?void 0:I.points.concat([u,l]));if(!!P){var M={type:"polygon",frontendId:n.currentAnnotation.frontendId,label:n.currentAnnotation.label,points:[P]};n.onAnnotationModify(M)}}},g=function(h,r,e,m){n.currentTool=="polygon"&&(n.currentAnnotation?y(h,r,e,m):v(h,r,e,m))},x=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:g,onMouseMove:function(){},onMouseUp:x,createElementsFunc:T}}},33522:function(L,C,t){"use strict";t.d(C,{p:function(){return O},o:function(){return b}});var p=t(91220);function O(D){var i=0,f=(0,p.Z)(D),T;try{for(f.s();!(T=f.n()).done;){var A=T.value;!A||!A.frontendId||A.frontendId>i&&(i=A.frontendId)}}catch(Z){f.e(Z)}finally{f.f()}return i}function b(D){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(D);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}},82881:function(L,C,t){"use strict";t.r(C);var p=t(57663),O=t(71577),b=t(34669),D=t(54458),i=t(2824),f=t(67294),T=t(71212),A=t.n(T),Z=t(8088),n=t(61541),v=t(44434),y=t(5041),g=t(57436),x=t(14836),a=t(29919),h=t(50242),r=t(48971),e=t(85893),m=40,d=function(){var u,l=(0,f.useState)(void 0),E=(0,i.Z)(l,2),P=E[0],M=E[1],S=(0,f.useState)({color:"",name:""}),N=(0,i.Z)(S,2),K=N[0],Y=N[1],H=(0,f.useState)(),k=(0,i.Z)(H,2),j=k[0],U=k[1],F=(0,f.useState)([]),w=(0,i.Z)(F,2),B=w[0],W=w[1],tn=(0,f.useState)(1),Q=(0,i.Z)(tn,2),z=Q[0],J=Q[1],G=function(o){o||J(1),o<.1||o>3?J(1):J(o)},R=function(o){U(o),o!=null&&o.label&&Y(o.label)};(0,f.useEffect)(function(){localStorage.removeItem("history"),$([])},[]);function $(c,o){var s=localStorage.getItem("history"),_=s?JSON.parse(s):{index:-1,items:[]},nn={currentAnnotation:o,annotations:c};if(JSON.stringify(_.items[_.index])!=JSON.stringify(nn)){var Pn=_.index>m?_.index-m:0,Mn=_.items.splice(Pn,_.index==0?1:_.index+1);_.items=Mn.concat([nn]),_.index<=m?_.index++:_.index=m+1,localStorage.setItem("history",JSON.stringify(_))}}var en=function(){var o=localStorage.getItem("history");if(!!o){var s=JSON.parse(o);if(!!s&&!(s.index>=s.items.length-1)){s.index++,localStorage.setItem("history",JSON.stringify(s));var _=s.items[s.index];U(_.currentAnnotation),W(_.annotations)}}},on=function(){var o=localStorage.getItem("history");if(!!o){var s=JSON.parse(o);if(!(!s||!s.index)&&!(s.index<=0)){s.index--,localStorage.setItem("history",JSON.stringify(s));var _=s.items[s.index];U(_.currentAnnotation),W(_.annotations)}}},V=function(o){for(var s=[],_=0;_<B.length;_++)B[_].annotationId==o.annotationId?s.push(o):s.push(B[_]);R(o),W(s)},q=(0,h.Z)({currentLabel:K,currentTool:P,annotations:B,currentAnnotation:j,onAnnotationAdd:function(o){var s=B.concat([o]);W(s),j||R(o)},onAnnotationModify:V,onMouseUp:function(){$(B,j)}}),X=q,an=(0,r.YB)().formatMessage({id:"pages.toolBar.polygon"}),rn=(0,r.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),sn=(0,r.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),ln=(0,r.YB)().formatMessage({id:"pages.toolBar.move"}),dn=(0,r.YB)().formatMessage({id:"pages.toolBar.unDo"}),un=(0,r.YB)().formatMessage({id:"pages.toolBar.reDo"}),cn=(0,r.YB)().formatMessage({id:"pages.toolBar.save"}),_n=(0,r.YB)().formatMessage({id:"pages.toolBar.edit"}),fn=(0,r.YB)().formatMessage({id:"pages.toolBar.clearMark"}),vn=(0,r.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),mn=(0,r.YB)().formatMessage({id:"pages.toolBar.divideData"}),gn=(0,r.YB)().formatMessage({id:"pages.toolBar.export"});return(0,e.jsxs)(Z.Z,{className:A().key,children:[(0,e.jsxs)(v.Z,{children:[(0,e.jsx)(a.Z,{active:P=="polygon",onClick:function(){M("polygon"),R(void 0)},children:an}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/edit.png",children:_n}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){G(z+.1)},children:rn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){G(z-.1)},children:sn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:cn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){M("mover")},children:ln}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){on()},children:dn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){en()},children:un}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:fn})]}),(0,e.jsxs)("div",{id:"dr",className:A().mainStage,children:[(0,e.jsx)("div",{className:A().draw,children:(0,e.jsx)(g.Z,{width:(u=document.getElementById("dr"))===null||u===void 0?void 0:u.clientWidth,scale:z,annotations:B,currentTool:P,currentAnnotation:j,setCurrentAnnotation:R,onAnnotationModify:V,onAnnotationModifyComplete:function(){$(B,j)},onMouseDown:X.onMouseDown,onMouseMove:X.onMouseMove,onMouseUp:X.onMouseUp,createPolygonFunc:q.createElementsFunc})}),(0,e.jsx)("div",{className:A().pblock,children:(0,e.jsx)("div",{className:A().progress,children:(0,e.jsx)(D.Z,{percent:50,status:"active"})})})]}),(0,e.jsxs)(v.Z,{disLoc:"right",children:[(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:mn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:gn})]}),(0,e.jsxs)("div",{className:A().rightSideBar,children:[(0,e.jsx)("div",{className:A().finished,children:(0,e.jsx)(O.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){R(void 0)},children:vn})}),(0,e.jsx)(y.Z,{selectedLabel:K,onLabelSelect:function(o){Y(o),R(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,e.jsx)(x.Z,{selectedAnnotation:j,annotations:B,onAnnotationSelect:function(o){o!=null&&o.delete||R(o)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(o){W(B.filter(function(s){return s.annotationId!=o.annotationId})),R(void 0)}})]})]})};C.default=d}}]);
