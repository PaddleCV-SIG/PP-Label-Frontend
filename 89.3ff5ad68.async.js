(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[89],{57560:function(I){I.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(I){I.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},54777:function(I){I.exports={segment:"segment___1YMcl",mainStage:"mainStage___2otee",draw:"draw___equn4",pblock:"pblock___2bT7z",progress:"progress___1porz",rightSideBar:"rightSideBar___2X7jK",determinOutline:"determinOutline___2ls57"}},43801:function(I,B,e){"use strict";e.d(B,{Z:function(){return E}});var Z=e(11849),T=e(2824),R=e(91220),A=e(67294),L=e(65031),O=e(85893);function U(n,d,s,M){if(!(!n||!d||!s||!M))return{width:n,color:d,points:s,tool:M}}function D(n,d,s,M,l,g,c){if(!n||!n.lines)return(0,O.jsx)(O.Fragment,{});var i=(c==null?void 0:c.annotationId)==n.annotationId,t=i&&l=="mover",f=[],m=(0,R.Z)(n.lines),C;try{for(m.s();!(C=m.n()).done;){var u=C.value;!u.width||!u.color||!u.points||!u.tool||f.push((0,O.jsx)(L.x1,{stroke:u.color,strokeWidth:u.width,globalCompositeOperation:u.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:u.points,tension:.01,onDragMove:function(){},onDragEnd:function(){s()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:t?1:0}))}}catch(b){m.e(b)}finally{m.f()}return(0,O.jsx)(L.ZA,{draggable:t,children:f})}function W(n,d){return n=="rubber"||d==2?"rubber":"brush"}function o(n){var d=0,s=(0,R.Z)(n),M;try{for(s.s();!(M=s.n()).done;){var l=M.value;!l||l.annotationId>d&&(d=l.annotationId)}}catch(g){s.e(g)}finally{s.f()}return d}function E(n){var d=(0,A.useState)(),s=(0,T.Z)(d,2),M=s[0],l=s[1],g=function(f,m){var C;if(!(n.currentTool!="brush"&&n.currentTool!="rubber")){var u=f.evt.offsetX/m,b=f.evt.offsetY/m,_=W(n.currentTool,f.evt.button),r=U(n.brushSize||10,(C=n.currentLabel)===null||C===void 0?void 0:C.color,[u,b,u,b],_);if(!!r)if(l(_),n.currentAnnotation){var S,K={tool:"brush",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:(S=n.currentAnnotation.lines)===null||S===void 0?void 0:S.concat([r])};n.onAnnotationModify(K)}else{if(_=="rubber")return;n.onAnnotationAdd({tool:"brush",annotationId:o(n.annotations)+1,label:n.currentLabel,lines:[r]})}}},c=function(f,m){var C;if(!(!M||!n.currentAnnotation)){var u=f.evt.offsetX/m,b=f.evt.offsetY/m,_=[u,b],r=[];(C=n.currentAnnotation)!==null&&C!==void 0&&C.lines&&(_=n.currentAnnotation.lines[n.currentAnnotation.lines.length-1].points.concat(_),r=n.currentAnnotation.lines);var S=U(n.brushSize||10,n.currentLabel.color,_,M);!S||(r.pop(),r.push(S),n.onAnnotationModify((0,Z.Z)((0,Z.Z)({},n.currentAnnotation),{},{lines:r})))}},i=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||(l(void 0),n.onMouseUp())};return{onMouseDown:g,onMouseMove:c,onMouseUp:i,createElementsFunc:D}}},58967:function(I,B,e){"use strict";var Z=e(20136),T=e(55241),R=e(77883),A=e(70507),L=e(57663),O=e(71577),U=e(2824),D=e(67294),W=e(61541),o=e(57560),E=e.n(o),n=e(85893),d=1,s=50,M=10;function l(c){return c?c<=d?d:c>=s?s:c:M}var g=function(i){var t=(0,D.useState)(l(i.size)),f=(0,U.Z)(t,2),m=f[0],C=f[1],u=function(_){C(l(_))};return(0,D.useEffect)(function(){u(i.size)},[i.size]),(0,n.jsxs)(T.Z,{overlayClassName:E().popover,placement:"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(O.Z,{type:"text",onClick:function(){var _,r=l(m-1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"-"}),(0,n.jsx)(A.Z,{min:d,max:s,value:m,onChange:function(_){var r;(r=i.onChange)===null||r===void 0||r.call(0,_)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(O.Z,{type:"text",onClick:function(){var _,r=l(m+1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"+"})]}),trigger:i.active?"hover":"click",children:[" ",(0,n.jsx)(W.Z,{active:i.active,imgSrc:i.imgSrc||"./pics/buttons/brush.png",onClick:i.onClick,children:i.children||"Brush"})]})};B.Z=g},27992:function(I,B,e){"use strict";var Z=e(20136),T=e(55241),R=e(77883),A=e(70507),L=e(57663),O=e(71577),U=e(2824),D=e(67294),W=e(61541),o=e(26647),E=e.n(o),n=e(85893),d=1,s=100,M=10;function l(c){return c?c<=d?d:c>=s?s:c:M}var g=function(i){var t=(0,D.useState)(l(i.size)),f=(0,U.Z)(t,2),m=f[0],C=f[1],u=function(_){C(l(_))};return(0,D.useEffect)(function(){u(i.size)},[i.size]),(0,n.jsxs)(T.Z,{overlayClassName:"".concat(E().popover," ").concat(i.disLoc=="left"?E().popoverLeft:""),placement:i.disLoc||"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(O.Z,{type:"text",onClick:function(){var _,r=l(m-1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"-"}),(0,n.jsx)(A.Z,{min:d,max:s,value:m,onChange:function(_){var r;(r=i.onChange)===null||r===void 0||r.call(0,_)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(O.Z,{type:"text",onClick:function(){var _,r=l(m+1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"+"})]}),trigger:"hover",children:[" ",(0,n.jsx)(W.Z,{imgSrc:i.imgSrc,onClick:i.onClick,children:i.children})]})};B.Z=g},13931:function(I,B,e){"use strict";e.d(B,{Z:function(){return W}});var Z=e(91220),T=e(11849),R=e(65031),A=e(85893);function L(o){var E=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return E?{r:parseInt(E[1],16),g:parseInt(E[2],16),b:parseInt(E[3],16)}:null}function O(o,E){if(!(!o||!E))return{color:o,points:E}}function U(o,E,n,d,s,M,l){if(!o||!o.lines||!o.lines[0])return[(0,A.jsx)(A.Fragment,{})];var g=o.lines[0].points,c=o.lines[0].color,i=L(c);if(!i)return[(0,A.jsx)(A.Fragment,{})];var t=(l==null?void 0:l.annotationId)==o.annotationId,f=t?.5:.1,m=void 0,C=[];return g.forEach(function(u,b){if(!m){m=u;return}C.push((0,A.jsx)(R.Cd,{onMouseDown:function(){s=="mover"&&M(o)},draggable:s=="mover",onDragMove:function(r){console.log("Circle onDrageMove");var S=r.evt.offsetX/d,K=r.evt.offsetY/d;g[b-1]=S,g[b]=K;var z=(0,T.Z)((0,T.Z)({},o),{},{lines:[{color:c,points:g}]});E(z)},onMouseOver:function(){console.log("Circle onMouseOver"),s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:m,y:u,radius:5,fill:c})),m=void 0}),[(0,A.jsxs)(R.ZA,{children:[(0,A.jsx)(R.x1,{onMouseOver:function(){s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){s=="mover"&&M(o)},stroke:c,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:g,tension:0,closed:!0,fill:"rgba(".concat(i.r,", ").concat(i.g,", ").concat(i.b,", ").concat(f,")")}),C]},o.annotationId)]}function D(o){var E=0,n=(0,Z.Z)(o),d;try{for(n.s();!(d=n.n()).done;){var s=d.value;!s||s.annotationId>E&&(E=s.annotationId)}}catch(M){n.e(M)}finally{n.f()}return E}function W(o){var E=function(l,g){var c,i=l.evt.offsetX/g,t=l.evt.offsetY/g,f=O((c=o.currentLabel)===null||c===void 0?void 0:c.color,[i,t]);!f||o.onAnnotationAdd({tool:"polygon",annotationId:D(o.annotations)+1,label:o.currentLabel,lines:[f]})},n=function(l,g){var c,i;if(!!o.currentAnnotation){var t=l.evt.offsetX/g,f=l.evt.offsetY/g,m=o.currentAnnotation.lines||[],C=O((c=o.currentLabel)===null||c===void 0?void 0:c.color,(i=m[0])===null||i===void 0?void 0:i.points.concat([t,f]));if(!!C){var u={tool:"polygon",annotationId:o.currentAnnotation.annotationId,label:o.currentAnnotation.label,lines:[C]};o.onAnnotationModify(u)}}},d=function(l,g){o.currentTool=="polygon"&&(o.currentAnnotation?n(l,g):E(l,g))},s=function(){o.currentTool=="polygon"&&o.onMouseUp()};return{onMouseDown:d,onMouseMove:function(){},onMouseUp:s,createElementsFunc:U}}},86089:function(I,B,e){"use strict";e.r(B),e.d(B,{MOST_HISTORY_STEPS:function(){return f}});var Z=e(57663),T=e(71577),R=e(34669),A=e(54458),L=e(2824),O=e(67294),U=e(54777),D=e.n(U),W=e(8088),o=e(61541),E=e(44434),n=e(58967),d=e(27992),s=e(5041),M=e(57436),l=e(14836),g=e(29919),c=e(43801),i=e(13931),t=e(85893),f=40,m=function(){var u,b=(0,O.useState)(void 0),_=(0,L.Z)(b,2),r=_[0],S=_[1],K=(0,O.useState)({color:"",name:""}),z=(0,L.Z)(K,2),X=z[0],w=z[1],an=(0,O.useState)(),V=(0,L.Z)(an,2),j=V[0],Y=V[1],_n=(0,O.useState)([]),G=(0,L.Z)(_n,2),x=G[0],p=G[1],sn=(0,O.useState)(10),Q=(0,L.Z)(sn,2),F=Q[0],q=Q[1],ln=(0,O.useState)(1),nn=(0,L.Z)(ln,2),$=nn[0],H=nn[1],en=function(a){a||H(1),a<.1||a>3?H(1):H(a)},y=function(a){Y(a),a!=null&&a.label&&w(a.label)};(0,O.useEffect)(function(){localStorage.removeItem("history"),N([])},[]);function N(v,a){var P=localStorage.getItem("history"),h=P?JSON.parse(P):{index:-1,items:[]},rn={currentAnnotation:a,annotations:v};if(JSON.stringify(h.items[h.index])!=JSON.stringify(rn)){var dn=h.index>f?h.index-f:0,vn=h.items.splice(dn,h.index==0?1:h.index+1);h.items=vn.concat([rn]),h.index<=f?h.index++:h.index=f+1,localStorage.setItem("history",JSON.stringify(h))}}var un=function(){var a=localStorage.getItem("history");if(!!a){var P=JSON.parse(a);if(!!P&&!(P.index>=P.items.length-1)){P.index++,localStorage.setItem("history",JSON.stringify(P));var h=P.items[P.index];Y(h.currentAnnotation),p(h.annotations)}}},cn=function(){var a=localStorage.getItem("history");if(!!a){var P=JSON.parse(a);if(!(!P||!P.index)&&!(P.index<=0)){P.index--,localStorage.setItem("history",JSON.stringify(P));var h=P.items[P.index];Y(h.currentAnnotation),p(h.annotations)}}},k=function(a){for(var P=[],h=0;h<x.length;h++)x[h].annotationId==a.annotationId?P.push(a):P.push(x[h]);y(a),p(P)},on=(0,c.Z)({currentLabel:X,brushSize:F,currentTool:r,annotations:x,currentAnnotation:j,onAnnotationAdd:function(a){var P=x.concat([a]);p(P),j||y(a)},onAnnotationModify:k,onMouseUp:function(){N(x,j)}}),tn=(0,i.Z)({currentLabel:X,brushSize:F,currentTool:r,annotations:x,currentAnnotation:j,onAnnotationAdd:function(a){var P=x.concat([a]);p(P),j||y(a)},onAnnotationModify:k,onMouseUp:function(){N(x,j)}}),J=r=="polygon"?tn:on;return(0,t.jsxs)(W.Z,{className:D().segment,children:[(0,t.jsxs)(E.Z,{children:[(0,t.jsx)(g.Z,{active:r=="polygon",onClick:function(){S("polygon"),y(void 0)},children:"Polygon"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,t.jsx)(n.Z,{size:F,active:r=="brush",onClick:function(){r!="rubber"&&r!="brush"&&y(void 0),S("brush")},onChange:function(a){q(a)},children:"Brush"}),(0,t.jsx)(n.Z,{size:F,active:r=="rubber",onClick:function(){r!="rubber"&&r!="brush"&&y(void 0),S("rubber")},onChange:function(a){q(a)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){en($+.1)},children:"Zoom in"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){en($-.1)},children:"Zoom out"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){S("mover")},children:"Move"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){cn()},children:"Undo"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){un()},children:"Redo"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,t.jsxs)("div",{id:"dr",className:D().mainStage,children:[(0,t.jsx)("div",{className:D().draw,children:(0,t.jsx)(M.Z,{width:(u=document.getElementById("dr"))===null||u===void 0?void 0:u.clientWidth,scale:$,annotations:x,currentTool:r,currentAnnotation:j,setCurrentAnnotation:y,onAnnotationModify:k,onAnnotationModifyComplete:function(){N(x,j)},onMouseDown:J.onMouseDown,onMouseMove:J.onMouseMove,onMouseUp:J.onMouseUp,createPolygonFunc:tn.createElementsFunc,createBrushFunc:on.createElementsFunc})}),(0,t.jsx)("div",{className:D().pblock,children:(0,t.jsx)("div",{className:D().progress,children:(0,t.jsx)(A.Z,{percent:50,status:"active"})})})]}),(0,t.jsxs)(E.Z,{disLoc:"right",children:[(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Interactor"}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"})]}),(0,t.jsxs)("div",{className:D().rightSideBar,children:[(0,t.jsx)("div",{className:D().determinOutline,children:(0,t.jsx)(T.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){y(void 0)},children:"Determine Outline"})}),(0,t.jsx)(s.Z,{selectedLabel:X,onLabelSelect:function(a){w(a),y(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,t.jsx)(l.Z,{selectedAnnotation:j,annotations:x,onAnnotationSelect:function(a){a!=null&&a.delete||y(a)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(a){p(x.filter(function(P){return P.annotationId!=a.annotationId})),y(void 0)}})]})]})};B.default=m}}]);
