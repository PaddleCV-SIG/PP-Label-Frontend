(self.webpackChunkpp_labeling_frontend=self.webpackChunkpp_labeling_frontend||[]).push([[333],{26647:function(l){l.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2"}},52822:function(l){l.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},32495:function(l){l.exports={listItem:"listItem___1MXXF",eye:"eye___3nddM",delete:"delete___y9u-D",roundBall:"roundBall___DMczd",popover:"popover___E0HLD",annotationId:"annotationId___1ks8N",labelName:"labelName___130ie",listItemActive:"listItemActive___1rNB-"}},38670:function(l){l.exports={labelList:"labelList___3uLRO",listHeader:"listHeader___1ZPcO",eye:"eye___2yUvw",roundBall:"roundBall___1xKCU"}},5882:function(l){l.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(l){l.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(l){l.exports={container:"container___G0FNe"}},80961:function(l){l.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(l){l.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},72869:function(l){l.exports={map:"map___92VPN",customControlIcon:"customControlIcon___3Ki2y"}},20474:function(l){l.exports={RSPop1:"RSPop1___vz5Me",RSPop2:"RSPop2___34pQA"}},55252:function(l){l.exports={RSPop1:"RSPop1___17x8k",RSPop2:"RSPop2___27kK5"}},75513:function(l){l.exports={segment:"segment___3WmPw",mainStage:"mainStage___2kT1s",rightSideBar:"rightSideBar___11FX3",determinOutline:"determinOutline___1g1YI"}},27992:function(l,b,n){"use strict";var se=n(20136),g=n(55241),G=n(77883),S=n(70507),P=n(57663),u=n(71577),D=n(2824),i=n(67294),p=n(61541),L=n(26647),W=n.n(L),Z=n(85893),T=1,s=100,a=10;function K(z){return z?z<=T?T:z>=s?s:z:a}var q=function(R){var H=(0,i.useState)(K(R.size)),ue=(0,D.Z)(H,2),N=ue[0],ee=ue[1],r=function(v){ee(K(v))};return(0,i.useEffect)(function(){r(R.size)},[R.size]),(0,Z.jsxs)(g.Z,{overlayClassName:W().popover,placement:R.disLoc||"right",content:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(u.Z,{type:"text",onClick:function(){var v,F=K(N-1);r(F),(v=R.onChange)===null||v===void 0||v.call(0,F)},children:"-"}),(0,Z.jsx)(S.Z,{min:T,max:s,value:N,onChange:function(v){var F;(F=R.onChange)===null||F===void 0||F.call(0,v)},controls:!1,style:{textAlign:"center"}}),(0,Z.jsx)(u.Z,{type:"text",onClick:function(){var v,F=K(N+1);r(F),(v=R.onChange)===null||v===void 0||v.call(0,F)},children:"+"})]}),trigger:"hover",children:[" ",(0,Z.jsx)(p.Z,{imgSrc:R.imgSrc,onClick:R.onClick,children:R.children})]})};b.Z=q},63097:function(l,b,n){"use strict";var se=n(20136),g=n(55241),G=n(2824),S=n(67294),P=n(52822),u=n.n(P),D=n(63144),i=n(85893),p=function(W){var Z=(0,S.useState)(W.color||"#FFF"),T=(0,G.Z)(Z,2),s=T[0],a=T[1];return(0,S.useEffect)(function(){a(W.color||"#FFF")},[W]),W.changeable?(0,i.jsx)(g.Z,{getPopupContainer:function(q){return q.parentElement||document.body},overlayClassName:u().popover,openClassName:u().popoverOpenClassName,placement:"bottom",content:(0,i.jsx)(D.xS,{disableAlpha:!0,color:s,onChange:function(q){a(q.hex)},onChangeComplete:W.onChange}),trigger:"click",children:(0,i.jsx)("div",{className:u().roundBall,style:{backgroundColor:s}})}):(0,i.jsx)("div",{className:u().roundBall,style:{backgroundColor:s}})};b.Z=p},5041:function(l,b,n){"use strict";n.d(b,{Z:function(){return ne}});var se=n(54421),g=n(38272),G=n(57663),S=n(71577),P=n(2824),u=n(67294),D=n(56131),i=n.n(D),p=n(49111),L=n(19650),W=n(11849),Z=n(5882),T=n.n(Z),s=n(63097),a=n(85893),K=function(m){var f=(0,W.Z)({},m.label),e=(0,u.useState)(f.invisible),U=(0,P.Z)(e,2),$=U[0],te=U[1],Y=(0,a.jsx)(g.ZP.Item,{className:"".concat(T().listItem," ").concat(m.active?T().listItemActive:""),unselectable:"on",onClick:function(){m.onClick(f)},children:(0,a.jsxs)(L.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:T().eye,style:{backgroundImage:$?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){te(!$),m.onLabelModify(f)}})," ",f.name,(0,a.jsx)(s.Z,{color:f.color,changeable:!0,onChange:function(y){f.color=y.hex,m.onLabelModify(f)}})]})});return Y},q=K,z=n(71194),R=n(50146),H=n(47673),ue=n(24044),N=n(9715),ee=n(93766),r=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],re=function(m){var f,e,U=(0,u.useState)(((f=m.defaultLabel)===null||f===void 0?void 0:f.color)||r[m.order||0]),$=(0,P.Z)(U,2),te=$[0],Y=$[1];(0,u.useEffect)(function(){var d;Y(((d=m.defaultLabel)===null||d===void 0?void 0:d.color)||r[m.order||0])},[m]);var ae=ee.Z.useForm(),y=(0,P.Z)(ae,1),k=y[0];return(0,a.jsx)(R.Z,{title:"Add Label",visible:m.visible,onCancel:m.onCancel,footer:null,children:(0,a.jsxs)(ee.Z,{form:k,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(e=m.defaultLabel)===null||e===void 0?void 0:e.name},onFinish:function(A){var oe={name:A.labelname,color:te};m.onLabelAdd(oe),k.resetFields()},autoComplete:"off",children:[(0,a.jsx)(ee.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,a.jsx)(ue.Z,{})}),(0,a.jsx)(ee.Z.Item,{label:"Select Color",name:"color",children:(0,a.jsx)(s.Z,{color:te,onChange:function(A){Y(A.hex)}})}),(0,a.jsx)(ee.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsxs)(L.Z,{children:[(0,a.jsx)(S.Z,{onClick:function(){var A;(A=m.onCancel)===null||A===void 0||A.call(0),k.resetFields()},children:"\u53D6\u6D88"}),(0,a.jsx)(S.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},v=re,F=[{color:"#FF0000",name:"Label 1"},{color:"#008000",name:"Label 2"}],ve=function(m){var f=(0,u.useState)(F),e=(0,P.Z)(f,2),U=e[0],$=e[1],te=(0,u.useState)(!1),Y=(0,P.Z)(te,2),ae=Y[0],y=Y[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.ZP,{className:i().labelList,size:"large",header:(0,a.jsx)("div",{className:i().listHeader,children:"Label List"}),footer:(0,a.jsx)("div",{children:(0,a.jsx)(S.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){y(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:U,renderItem:function(d){var A;return(0,a.jsx)(q,{onClick:m.onLabelSelect,label:d,active:d.name==((A=m.selectedLabel)===null||A===void 0?void 0:A.name),onLabelDelete:m.onLabelDelete,onLabelModify:m.onLabelModify})}}),(0,a.jsx)(v,{order:U.length,visible:ae,onLabelAdd:function(d){U.push(d),$(U),y(!1)},onCancel:function(){y(!1)}})]})},ne=ve},8088:function(l,b,n){"use strict";var se=n(67294),g=n(78677),G=n.n(g),S=n(85893),P=function(D){return(0,S.jsx)("div",{className:"".concat(G().container," ").concat(D.className),children:D.children})};b.Z=P},44434:function(l,b,n){"use strict";var se=n(67294),g=n(80961),G=n.n(g),S=n(85893),P=function(D){var i=G().leftToolbar;return D.disLoc=="right"&&(i=G().rightToolbar),(0,S.jsx)("div",{className:i,children:D.children})};b.Z=P},61541:function(l,b,n){"use strict";var se=n(49111),g=n(19650),G=n(67294),S=n(82499),P=n.n(S),u=n(85893),D=function(p){return(0,u.jsx)("div",{unselectable:"on",className:"".concat(P().toolBarButtonContainerWrapper," ").concat(p.active&&P().toolBarButtonContainerWrapperActive),onClick:p.onClick,children:(0,u.jsx)(g.Z,{align:"center",className:P().toolBarButtonContainer,size:0,children:(0,u.jsxs)(g.Z,{align:"center",direction:"vertical",className:P().toolBarButton,size:0,children:[(0,u.jsx)("img",{src:p.imgSrc}),(0,u.jsx)("div",{className:P().buttonText,children:p.children})]})})})};b.Z=D},42999:function(l,b,n){"use strict";n.r(b),n.d(b,{default:function(){return ze}});var se=n(20136),g=n(55241),G=n(49111),S=n(19650),P=n(62350),u=n(75443),D=n(57663),i=n(71577),p=n(2824),L=n(67294),W=n(75513),Z=n.n(W),T=n(8088),s=n(61541),a=n(44434),K=n(5041),q=n(47673),z=n(24044),R=n(13062),H=n(71230),ue=n(59250),N=n(13013),ee=n(89032),r=n(15746),re=n(30887),v=n(54689),F=n(34792),ve=n(48086),ne=n(89366),V=n(57254),m=n(20474),f=n.n(m),e=n(85893);function U(o){ve.default.info("Click on menu item."),console.log("click",o)}var $=(0,e.jsxs)(v.Z,{onClick:U,children:[(0,e.jsx)(v.Z.Item,{icon:(0,e.jsx)(ne.Z,{}),children:"1st menu item"},"1"),(0,e.jsx)(v.Z.Item,{icon:(0,e.jsx)(ne.Z,{}),children:"2nd menu item"},"2"),(0,e.jsx)(v.Z.Item,{icon:(0,e.jsx)(ne.Z,{}),children:"3rd menu item"},"3")]}),te=function(){return(0,e.jsxs)("div",{children:[(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(r.Z,{span:12,className:f().RSPop1,children:(0,e.jsx)("span",{children:"PD parameter"})}),(0,e.jsx)(r.Z,{span:12,className:f().RSPop2,children:(0,e.jsx)(N.Z,{overlay:$,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Dropdown ",(0,e.jsx)(V.Z,{})]})})})]}),(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(r.Z,{span:12,className:f().RSPop1,children:(0,e.jsx)("span",{children:"Simplified distance"})}),(0,e.jsx)(r.Z,{span:12,className:f().RSPop2,children:(0,e.jsx)(z.Z,{placeholder:"Basic usage"})})]}),(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(r.Z,{span:12,className:f().RSPop1,children:(0,e.jsx)("span",{children:"Simplified angle"})}),(0,e.jsx)(r.Z,{span:12,className:f().RSPop2,children:(0,e.jsx)(z.Z,{placeholder:"Basic usage"})})]}),(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(r.Z,{span:12,className:f().RSPop1,children:(0,e.jsx)("span",{children:"Threshold of building simplification "})}),(0,e.jsx)(r.Z,{span:12,className:f().RSPop2,children:(0,e.jsx)(z.Z,{placeholder:"Basic usage"})})]})]})},Y=te,ae=n(98858),y=n(4914),k=n(55252),d=n.n(k);function A(o){ve.default.info("Click on menu item."),console.log("click",o)}var oe=(0,e.jsxs)(v.Z,{onClick:A,children:[(0,e.jsx)(v.Z.Item,{icon:(0,e.jsx)(ne.Z,{}),children:"band_1"},"1"),(0,e.jsx)(v.Z.Item,{icon:(0,e.jsx)(ne.Z,{}),children:"band_2"},"2"),(0,e.jsx)(v.Z.Item,{icon:(0,e.jsx)(ne.Z,{}),children:"band_3"},"3")]}),ye=function(){return(0,e.jsxs)("div",{children:[(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(r.Z,{className:d().RSPop1,children:(0,e.jsx)("span",{children:"R"})}),(0,e.jsx)(r.Z,{className:d().RSPop2,children:(0,e.jsx)(N.Z,{overlay:oe,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Band ",(0,e.jsx)(V.Z,{})]})})}),(0,e.jsx)(r.Z,{className:d().RSPop1,children:(0,e.jsx)("span",{children:"G"})}),(0,e.jsx)(r.Z,{className:d().RSPop2,children:(0,e.jsx)(N.Z,{overlay:oe,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Band ",(0,e.jsx)(V.Z,{})]})})}),(0,e.jsx)(r.Z,{className:d().RSPop1,children:(0,e.jsx)("span",{children:"B"})}),(0,e.jsx)(r.Z,{className:d().RSPop2,children:(0,e.jsx)(N.Z,{overlay:oe,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Band ",(0,e.jsx)(V.Z,{})]})})})]}),(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(r.Z,{className:d().RSPop1,children:(0,e.jsx)("span",{children:"R"})}),(0,e.jsx)(r.Z,{className:d().RSPop2,children:(0,e.jsx)(N.Z,{overlay:oe,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Band ",(0,e.jsx)(V.Z,{})]})})}),(0,e.jsx)(r.Z,{className:d().RSPop1,children:(0,e.jsx)("span",{children:"G"})}),(0,e.jsx)(r.Z,{className:d().RSPop2,children:(0,e.jsx)(N.Z,{overlay:oe,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Band ",(0,e.jsx)(V.Z,{})]})})}),(0,e.jsx)(r.Z,{className:d().RSPop1,children:(0,e.jsx)("span",{children:"B"})}),(0,e.jsx)(r.Z,{className:d().RSPop2,children:(0,e.jsx)(N.Z,{overlay:oe,children:(0,e.jsxs)(i.Z,{style:{width:"100%"},children:["Band ",(0,e.jsx)(V.Z,{})]})})})]}),(0,e.jsxs)(y.Z,{title:"Data source information",column:1,bordered:!0,children:[(0,e.jsx)(y.Z.Item,{label:"FileName",children:"A/XXX.tif B/XXX.tf"}),(0,e.jsx)(y.Z.Item,{label:"Row",children:"1234"}),(0,e.jsx)(y.Z.Item,{label:"Column",children:"897"}),(0,e.jsx)(y.Z.Item,{label:"Bands",children:"7 7"}),(0,e.jsx)(y.Z.Item,{label:"DataType",children:"UInt16"}),(0,e.jsx)(y.Z.Item,{label:"EPSG",children:"7030"}),(0,e.jsx)(y.Z.Item,{label:"Unit",children:"m"})]})]})},Le=ye,ie=n(11849),Ee=n(93224),Be=n(41004),Me=n(72869),Se=n.n(Me),nn=n(74607),be=function(c){var C=c.children,j=c.leafletMapRef,J=(0,Ee.Z)(c,["children","leafletMapRef"]);return L.useEffect(function(){if(j.current){var I=j.current.leafletElement;I.pm.addControls({drawMarker:!1,drawCircle:!1,drawCircleMarker:!1,drawPolyline:!1,drawRectangle:!1,drawPolygon:!1,editMode:!1,dragMode:!1,cutPolygon:!0,rotateMode:!1,removalMode:!1}),I.pm.setGlobalOptions({pmIgnore:!1}),I.pm.Toolbar.createCustomControl({name:"StoreShapes",title:"Store all shapes",block:"custom",className:Se().customControlIcon,toggle:!1,afterClick:function(){var le=JSON.stringify(I.pm.getGeomanDrawLayers(!0).toGeoJSON()),O="data.geojson",Q=document.createElement("a");Q.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(le)),Q.setAttribute("download",O),Q.style.display="none",document.body.appendChild(Q),Q.click(),console.log(le)}}),I.on("pm:create",function(X){c.onShapeCreate(X)}),I.on("pm:edit",function(X){c.onShapeEdit(X)})}},[]),(0,e.jsx)(Be.Z,(0,ie.Z)((0,ie.Z)({ref:j},J),{},{children:C}))},De=be,fe=n(88014),Re=n(16072),he=n(18836),xe={lat:0,lng:0,zoom:2},Ae=function(c){var C=[xe.lat,xe.lng];return(0,e.jsx)(De,{leafletMapRef:c.leafletMapRef,className:Se().map,center:C,zoom:xe.zoom,onShapeCreate:c.onShapeCreate,onShapeEdit:c.onShapeEdit,children:(0,e.jsxs)(fe.Z,{position:"topright",children:[(0,e.jsx)(fe.Z.BaseLayer,{checked:!0,name:"TianDiTu.Vector",children:(0,e.jsxs)(Re.Z,{attribution:'\xA9 <a href="https://www.tianditu.gov.cn/">TianDiTu</a> GS(2021)3715',children:[(0,e.jsx)(he.Z,{url:"https://t2.tianditu.gov.cn/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk=8e879a4cad078fd3ce7456f2737fc4cc"}),(0,e.jsx)(he.Z,{url:"https://t2.tianditu.gov.cn/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk=8e879a4cad078fd3ce7456f2737fc4cc"})]})}),(0,e.jsx)(fe.Z.BaseLayer,{name:"OpenStreetMap.Mapnik",children:(0,e.jsx)(he.Z,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),(0,e.jsx)(fe.Z.Overlay,{name:"Esri.WorldImagery",children:(0,e.jsx)(he.Z,{attribution:"Tiles \xA9 Esri \u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})})]})})},Ie=Ae,tn=n(54421),je=n(38272),Oe=n(38670),pe=n.n(Oe),_e=n(32495),ce=n.n(_e),Te=n(63097),Ne=function(c){var C=(0,ie.Z)({},c.annotation),j=!1,J=(0,e.jsxs)(je.ZP.Item,{className:"".concat(ce().listItem," ").concat(c.active?ce().listItemActive:""),unselectable:"on",onClick:function(){c.onClick(C)},children:[(0,e.jsxs)(S.Z,{align:"center",size:5,children:[(0,e.jsx)("a",{className:ce().eye,style:{backgroundImage:j?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){c.onAnnotationModify(C)}})," ",(0,e.jsx)("span",{className:ce().annotationId,children:C.properties.annotationId}),(0,e.jsx)("span",{className:ce().labelName,children:C.properties.labelName}),(0,e.jsx)(Te.Z,{color:C.properties.stroke})]}),(0,e.jsx)("a",{className:ce().delete,onClick:function(){c.onAnnotationDelete(C)}})]});return J},Fe=Ne,We=function(c){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(je.ZP,{className:pe().labelList,size:"large",header:(0,e.jsx)("div",{className:pe().listHeader,children:"Annotation List"}),bordered:!0,dataSource:c.annotations.features,renderItem:function(j){return(0,e.jsx)(Fe,{onClick:c.onAnnotationSelect,annotation:j,active:!1,onAnnotationDelete:c.onAnnotationDelete,onAnnotationModify:c.onAnnotationModify})},footer:(0,e.jsx)("div",{children:(0,e.jsx)(i.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){c.onAnnotationSelect(void 0)},block:!0,children:"Add Annotation"})})})})},Ue=We;function Ge(o){var c=(0,L.useState)(0),C=(0,p.Z)(c,2),j=C[0],J=C[1],I=(0,L.useState)(!1),X=(0,p.Z)(I,2),le=X[0],O=X[1],Q=(0,L.useState)(o.currentLabel),me=(0,p.Z)(Q,2),E=me[0],Pe=me[1];(0,L.useEffect)(function(){Pe(o.currentLabel)},[o.currentLabel]);var B=function(){var t,_=(t=o.leafletMapRef.current)===null||t===void 0?void 0:t.leafletElement.pm.globalDrawModeEnabled();console.log(_)},M=function(t){if(O(!0),t){var _,w;(_=o.leafletMapRef.current)===null||_===void 0||_.leafletElement.pm.enableDraw(t),(w=o.leafletMapRef.current)===null||w===void 0||w.leafletElement.pm.setPathOptions({color:E==null?void 0:E.color,fillColor:E==null?void 0:E.color,fillOpacity:.4}),B()}else{var Ce;(Ce=o.leafletMapRef.current)===null||Ce===void 0||Ce.leafletElement.pm.disableDraw(t),O(!1),B()}},h=function(t){var _;(_=o.leafletMapRef.current)===null||_===void 0||_.leafletElement.pm.disableDraw(t),O(!1),B()},de=function(){var t;return(t=o.leafletMapRef.current)===null||t===void 0?void 0:t.leafletElement.pm.Draw.getActiveShape()},Ve=function(){if(de()=="Polygon"){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.pm.Draw.Polygon._removeLastVertex(),B()}else B(),O(!1)},Je=function(){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.pm.toggleGlobalDragMode(),B()},Xe=function(){if(de()=="Polygon"){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.pm.Draw.Polygon._finishShape(),B(),O(!1)}else B(),O(!1)},He=function(){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.pm.enableGlobalRemovalMode(),B()},$e=function(){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.pm.toggleGlobalEditMode(),B(),O(!1)},Ye=function(){var t;console.log((t=o.leafletMapRef.current)===null||t===void 0?void 0:t.leafletElement.pm.getGeomanDrawLayers(!0)),O(!1)};console.log("operation re-rendering. currentLabel:".concat(o.currentLabel));var Ze=function(t){var _=t._uid,w=t.toGeoJSON();J(j+1),console.log("storeOnDb. currentLabel:".concat(o.currentLabel)),w.properties={labelName:E==null?void 0:E.name,stroke:E==null?void 0:E.color,annotationId:j+1},console.log("Store Layer on DB. Id:"+_,w),console.log(JSON.stringify(w)),o.setAnnotations((0,ie.Z)((0,ie.Z)({},o.annotations),{},{features:o.annotations.features.concat(w)})),console.log((0,ie.Z)((0,ie.Z)({},o.annotations),{},{features:o.annotations.features.concat(w)}))};function ke(x){console.log(o.currentLabel),x.layer.bindPopup("Label: "+x.layer._uid).openPopup(),O(!1),Ze(x.layer)}var Qe=function(t){we(t.layer),console.log(t)};function we(x){console.log(o.currentLabel);var t=x._uid,_=x.toGeoJSON();console.log("Update Layer on DB. Id:"+t,_)}var qe=function(){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.zoomIn(),B()},en=function(){var t;(t=o.leafletMapRef.current)===null||t===void 0||t.leafletElement.zoomOut(),B()};return{polyVisable:le,RSDraw:M,RSDrawDisable:h,removeLastVertex:Ve,moveShape:Je,finishShape:Xe,removeShape:He,editMode:$e,saveGeoJson:Ye,storeOnDb:Ze,onShapeCreate:ke,onShapeEdit:Qe,toolZoomIn:qe,toolZoomOut:en,currentShape:de}}var ge=n(27992),Ke=function(){var c=(0,L.useState)(void 0),C=(0,p.Z)(c,2),j=C[0],J=C[1],I=(0,L.useState)(),X=(0,p.Z)(I,2),le=X[0],O=X[1],Q=(0,L.useState)({type:"FeatureCollection",features:[]}),me=(0,p.Z)(Q,2),E=me[0],Pe=me[1];console.log("rs is re-rendering! currentLabel: ".concat(JSON.stringify(le)));var B=L.useRef(null),M=Ge({leafletMapRef:B,currentLabel:le,setAnnotations:Pe,annotations:E});return(0,e.jsxs)(T.Z,{className:Z().segment,children:[(0,e.jsxs)(a.Z,{children:[(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Intelligent Interaction"}),(0,e.jsx)(g.Z,{placement:"rightTop",visible:M.polyVisable,content:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(i.Z,{type:"primary",onClick:function(){M.finishShape()},children:"Finish"}),(0,e.jsx)(i.Z,{type:"primary",onClick:function(){M.removeLastVertex()},children:"Remove Last Vertex"}),(0,e.jsx)(u.Z,{title:"Are you sure cancel this task?",okText:"Yes",cancelText:"No",children:(0,e.jsx)(i.Z,{type:"primary",onClick:function(){M.RSDrawDisable(M.currentShape())},children:"Cancel"})})]})}),trigger:j=="Polygon"?"hover":"click",children:(0,e.jsx)(s.Z,{active:j=="Polygon",imgSrc:"./pics/buttons/polygon.png",onClick:function(){J("Polygon"),M.RSDraw("Polygon")},children:"Polygon"})}),(0,e.jsx)(s.Z,{onClick:function(){M.editMode()},imgSrc:"./pics/buttons/brush.png",children:"Edit"}),(0,e.jsxs)(g.Z,{placement:"rightTop",title:"title",content:"content",trigger:j=="rubber"?"hover":"click",children:[" ",(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/rubber.png",onClick:function(){M.removeShape()},children:"Rubber"})]}),(0,e.jsx)(s.Z,{onClick:function(){M.toolZoomIn()},imgSrc:"./pics/buttons/zoom_in.png",children:"Zoom in"}),(0,e.jsx)(s.Z,{onClick:function(){M.toolZoomOut()},imgSrc:"./pics/buttons/zoom_out.png",children:"Zoom out"}),(0,e.jsx)(s.Z,{onClick:function(){M.saveGeoJson()},imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){return moveShape()},children:"Move"}),(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/prev.png",children:"Undo"}),(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/next.png",children:"Redo"}),(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,e.jsx)("div",{className:Z().mainStage,children:(0,e.jsx)(Ie,{leafletMapRef:B,onShapeCreate:M.onShapeCreate,onShapeEdit:M.onShapeEdit})}),(0,e.jsxs)(a.Z,{disLoc:"right",children:[(0,e.jsx)(ge.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,e.jsx)(ge.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,e.jsx)(ge.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"}),(0,e.jsxs)(g.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of boundary simplification",content:(0,e.jsx)(Y,{}),trigger:j=="boundry"?"click":"hover",children:[" ",(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/border_simplify.png",onClick:function(){J("boundry")},children:"Boundary"})]}),(0,e.jsxs)(g.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of remote sensing",content:(0,e.jsx)(Le,{}),trigger:j=="colorgun"?"click":"hover",children:[" ",(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/remote_sensing_setting.png",onClick:function(){J("colorgun")},children:"Remote Sensing"})]}),(0,e.jsxs)(g.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Switch grids",content:"content",trigger:j=="grid"?"click":"hover",children:[" ",(0,e.jsx)(s.Z,{imgSrc:"./pics/buttons/switch_grid.png",onClick:function(){J("grid")},children:"Grids"})]})]}),(0,e.jsxs)("div",{className:Z().rightSideBar,children:[(0,e.jsx)("div",{className:Z().determinOutline,children:(0,e.jsx)(i.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,children:"Determine Outline"})}),(0,e.jsx)(K.Z,{selectedLabel:le,onLabelSelect:function(de){O(de),console.log(de)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,e.jsx)(Ue,{annotations:E,onAnnotationSelect:function(){},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(){}})]})]})},ze=Ke}}]);
