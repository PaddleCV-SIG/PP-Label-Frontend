(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[454],{85024:function(I){I.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(I){I.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},26647:function(I){I.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",slider:"slider___ALra-",popoverLeft:"popoverLeft___15lGe"}},8982:function(I){I.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(I){I.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},8978:function(I,W,t){"use strict";t.d(W,{Z:function(){return K}});var $=t(11849),F=t(2824),V=t(91220),H=t(67294),p=t(85893);function z(n){if(!n||!n.width||!n.color||!n.points||n.points.length<2||n.frontendId==null)return"";var i=n.type=="rubber"?0:n.frontendId;return"".concat(n.width,",").concat(i,",").concat(n.points.join(","))}function Z(n){var i,o=n.canvasRef,c=n.annotation,s=c.result;if(!s)return(0,p.jsx)(p.Fragment,{});var g=(i=o.current)===null||i===void 0?void 0:i.getContext("2d");if(!g)return(0,p.jsx)(p.Fragment,{});for(var h=[],L=0,r=0;r<s.length;r++)s.at(r)==","?(h.push(parseFloat(s.slice(L,r))),L=r+1):s.at(r)=="|"?(h.push(parseFloat(s.slice(L,r))),A(h,g,c),h=[],L=r+1):r==s.length-1&&(h.push(parseFloat(s.slice(L,s.length))),A(h,g,c));return(0,p.jsx)(p.Fragment,{})}function A(n,i,o){var c;if(n.length<4){console.log("found incorrect points:",n);return}var s=n[0],g=n[1];if(s==0){var h;B(i,n.slice(2),(h=o.label)===null||h===void 0?void 0:h.color);return}if(g==0){Y(i,s,n.slice(2),void 0);return}Y(i,s,n.slice(2),(c=o.label)===null||c===void 0?void 0:c.color)}function Y(n,i,o,c){n.beginPath(),n.moveTo(o[0],o[1]);for(var s=0;s<=o.length/2-1;s++){var g=o[2*s],h=o[2*s+1];n.lineTo(g,h)}n.lineCap="round",n.lineJoin="round",n.lineWidth=i,c&&(n.strokeStyle=c),n.globalCompositeOperation=c?"source-over":"destination-out",n.stroke()}function B(n,i,o){n.globalCompositeOperation=o?"source-over":"destination-out",o&&(n.fillStyle=o);for(var c=0;c<=i.length/2-1;c++){var s=i[2*c],g=i[2*c+1];n.fillRect(s,g,1,1)}}function N(n){if(!n||n.length==0)return 0;var i=0,o=(0,V.Z)(n),c;try{for(o.s();!(c=o.n()).done;){var s=c.value;s.frontendId>i&&(i=s.frontendId)}}catch(g){o.e(g)}finally{o.f()}return i}function m(n,i){return n=="rubber"||i==2?"rubber":"brush"}function K(n){var i=(0,H.useState)(),o=(0,F.Z)(i,2),c=o[0],s=o[1],g=function(d){var v,M;if(!(n.currentTool!="brush"&&n.currentTool!="rubber"||!((v=n.currentLabel)!==null&&v!==void 0&&v.color)||!n.brushSize)){var y=d.mouseX,e=d.mouseY,O=m(n.currentTool,d.e.evt.button);console.log("frontendId: ",n.frontendIdOps.frontendId,"maxId:",N(n.annotations));var S=n.frontendIdOps.frontendId>0?n.frontendIdOps.frontendId:N(n.annotations)+1;S!=n.frontendIdOps.frontendId&&n.frontendIdOps.setFrontendId(S);var _=z({width:n.brushSize||10,color:(M=n.currentLabel)===null||M===void 0?void 0:M.color,points:[y,e,y,e],type:O,frontendId:S});if(!!_){s(O);var x={dataId:n.dataId,label:n.currentLabel,labelId:n.currentLabel.labelId,frontendId:S,result:_,type:"brush"};n.onAnnotationAdd(x)}}},h=function(d){var v;if(!(!c||!n.currentAnnotation||!n.currentAnnotation.result||n.currentAnnotation.result.length<2||!((v=n.currentLabel)!==null&&v!==void 0&&v.color))){var M=d.mouseX,y=d.mouseY,e=n.currentAnnotation.result+",".concat(M,",").concat(y);n.onAnnotationModify((0,$.Z)((0,$.Z)({},n.currentAnnotation),{},{result:e}))}},L=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||(s(void 0),n.onMouseUp())};return{onMouseDown:g,onMouseMove:h,onMouseUp:L,drawAnnotation:Z}}},14836:function(I,W,t){"use strict";t.d(W,{Z:function(){return L}});var $=t(54421),F=t(38272),V=t(57663),H=t(71577),p=t(91220),z=t(67294),Z=t(56159),A=t.n(Z),Y=t(49111),B=t(19650),N=t(2824),m=t(11849),K=t(85024),n=t.n(K),i=t(63097),o=t(85893),c=function(d){var v=(0,m.Z)({},d.annotation),M=(0,z.useState)(v.invisible),y=(0,N.Z)(M,2),e=y[0],O=y[1],S=(0,z.useState)(0),_=(0,N.Z)(S,2),x=_[0],C=_[1];(0,z.useEffect)(function(){O(d.annotation.invisible)},[d.annotation.invisible]);var D=(0,o.jsxs)(F.ZP.Item,{className:"".concat(n().listItem," ").concat(d.active?n().listItemActive:""),unselectable:"on",onClick:function(){d.onClick(v)},children:[(0,o.jsxs)(B.Z,{align:"center",size:5,children:[(0,o.jsx)("a",{className:n().eye,style:{backgroundImage:e?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(R){R.stopPropagation(),O(!e),d.onAnnotationModify(v)}})," ",(0,o.jsx)("span",{className:n().annotationId,children:v.frontendId}),(0,o.jsx)("span",{className:n().labelName,children:v.label.name}),(0,o.jsx)(i.Z,{color:v.label.color})]}),(0,o.jsx)("a",{className:n().delete,onClick:function(R){R.stopPropagation();var J=new Date().getTime();J-x<300||(C(J),d.onAnnotationDelete(v))}})]});return D},s=c,g=t(48971),h=function(d){var v=(0,g.YB)(),M=v.formatMessage({id:"component.PPAnnotationList.annotationList"}),y=v.formatMessage({id:"component.PPAnnotationList.addAnnotation"}),e=new Set,O=[],S=(0,p.Z)(d.annotations),_;try{for(S.s();!(_=S.n()).done;){var x=_.value;e.has(x.frontendId)||(O.push(x),e.add(x.frontendId))}}catch(C){S.e(C)}finally{S.f()}return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(F.ZP,{className:A().labelList,size:"large",header:(0,o.jsx)("div",{className:A().listHeader,children:M}),bordered:!0,dataSource:O,renderItem:function(D){var b;return(0,o.jsx)(s,{onClick:d.onAnnotationSelect,annotation:D,active:D.frontendId==((b=d.currAnnotation)===null||b===void 0?void 0:b.frontendId),onAnnotationDelete:d.onAnnotationDelete,onAnnotationModify:d.onAnnotationModify})},footer:function(){return d.onAnnotationAdd?(0,o.jsx)("div",{children:(0,o.jsx)(H.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){d.onAnnotationAdd()},block:!0,children:y})}):(0,o.jsx)("div",{})}})})},L=h},27992:function(I,W,t){"use strict";var $=t(20136),F=t(55241),V=t(13062),H=t(71230),p=t(77883),z=t(70507),Z=t(89032),A=t(15746),Y=t(66126),B=t(75454),N=t(2824),m=t(67294),K=t(61541),n=t(26647),i=t.n(n),o=t(85893),c=0,s=100,g=10,h=function(r){var d=(0,m.useState)(x(r.size)),v=(0,N.Z)(d,2),M=v[0],y=v[1];function e(C){y(x(C))}var O=r.step?r.step:10,S=r.minSize==null?c:r.minSize,_=r.maxSize==null?s:r.maxSize;function x(C){return C==null?g:C<=S?S:C>=_?_:C}return(0,m.useEffect)(function(){e(r.size)},[r.size]),(0,o.jsxs)(F.Z,{overlayClassName:"".concat(i().popover," ").concat(r.disLoc=="left"?i().popoverLeft:""),placement:r.disLoc||"right",content:(0,o.jsxs)(H.Z,{children:[(0,o.jsx)(A.Z,{span:16,children:(0,o.jsx)(B.Z,{className:i().slider,value:M,max:_,min:S,onChange:function(D){var b;(b=r.onChange)===null||b===void 0||b.call(0,D)},tooltipVisible:!1})}),(0,o.jsx)(A.Z,{span:8,children:(0,o.jsx)(z.Z,{min:S,max:_,value:M,onChange:function(D){var b;(b=r.onChange)===null||b===void 0||b.call(0,D)},step:O})})]}),trigger:"hover",children:[" ",(0,o.jsx)(K.Z,{imgSrc:r.imgSrc||"",onClick:r.onClick,active:r.active,children:r.children})]})};W.Z=h},21028:function(I,W,t){"use strict";t.r(W),t.d(W,{MOST_HISTORY_STEPS:function(){return x},default:function(){return D}});var $=t(57663),F=t(71577),V=t(20136),H=t(55241),p=t(34669),z=t(54458),Z=t(2824),A=t(67294),Y=t(75721),B=t.n(Y),N=t(8088),m=t(61541),K=t(44434),n=t(27992),i=t(5041),o=t(57436),c=t(14836),s=t(13062),g=t(71230),h=t(66126),L=t(75454),r=t(89032),d=t(15746),v=t(8982),M=t.n(v),y=t(48971),e=t(85893),O=function(R){var J=(0,y.YB)(),G=J.formatMessage({id:"component.PPMedical.windowWidth"}),j=J.formatMessage({id:"component.PPMedical.windowLevel"});return(0,e.jsxs)("div",{children:[(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(d.Z,{span:6,className:M().Pop1,children:(0,e.jsx)("span",{children:G})}),(0,e.jsx)(d.Z,{span:18,className:M().Pop2,children:(0,e.jsx)(L.Z,{min:1,max:R.wwValue||100,defaultValue:37})})]}),(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(d.Z,{span:6,className:M().Pop1,children:(0,e.jsx)("span",{children:j})}),(0,e.jsx)(d.Z,{span:18,className:M().Pop2,children:(0,e.jsx)(L.Z,{min:1,max:R.wlValue||100,defaultValue:37})})]})]})},S=O,_=t(8978),x=40,C=function(){var R,J=(0,A.useState)(void 0),G=(0,Z.Z)(J,2),j=G[0],Q=G[1],Pn=(0,A.useState)({color:"",name:""}),rn=(0,Z.Z)(Pn,2),q=rn[0],sn=rn[1],Sn=(0,A.useState)(),ln=(0,Z.Z)(Sn,2),U=ln[0],nn=ln[1],Mn=(0,A.useState)([]),dn=(0,Z.Z)(Mn,2),E=dn[0],An=dn[1],_n=(0,A.useState)(10),un=(0,Z.Z)(_n,2),w=un[0],cn=un[1],xn=(0,A.useState)(1),vn=(0,Z.Z)(xn,2),tn=vn[0],en=vn[1],fn=function(a){a||en(1),a<.1||a>3?en(1):en(a)},T=function(a){nn(a),a!=null&&a.label&&sn(a.label)},X=function(a){An(a)};(0,A.useEffect)(function(){localStorage.removeItem("history"),k([])},[]);function k(l,a){var u=localStorage.getItem("history"),f=u?JSON.parse(u):{index:-1,items:[]},hn={currentAnnotation:a,annotations:l};if(JSON.stringify(f.items[f.index])!=JSON.stringify(hn)){var Jn=f.index>x?f.index-x:0,Yn=f.items.splice(Jn,f.index==0?1:f.index+1);f.items=Yn.concat([hn]),f.index<=x?f.index++:f.index=x+1,localStorage.setItem("history",JSON.stringify(f))}}var Cn=function(){var a=localStorage.getItem("history");if(!!a){var u=JSON.parse(a);if(!!u&&!(u.index>=u.items.length-1)){u.index++,localStorage.setItem("history",JSON.stringify(u));var f=u.items[u.index];nn(f.currentAnnotation),X(f.annotations)}}},bn=function(){var a=localStorage.getItem("history");if(!!a){var u=JSON.parse(a);if(!(!u||!u.index)&&!(u.index<=0)){u.index--,localStorage.setItem("history",JSON.stringify(u));var f=u.items[u.index];nn(f.currentAnnotation),X(f.annotations)}}},on=function(a){for(var u=[],f=0;f<E.length;f++)E[f].annotationId==a.annotationId?u.push(a):u.push(E[f]);T(a),X(u)},mn=drawBrush({currentLabel:q,brushSize:w,currentTool:j,annotations:E,currentAnnotation:U,onAnnotationAdd:function(a){var u=E.concat([a]);X(u),U||T(a)},onAnnotationModify:on,onMouseUp:function(){k(E,U)}}),gn=drawPolygon({currentLabel:q,brushSize:w,currentTool:j,annotations:E,currentAnnotation:U,onAnnotationAdd:function(a){var u=E.concat([a]);X(u),U||T(a)},onAnnotationModify:on,onMouseUp:function(){k(E,U)}}),an=j=="polygon"?gn:mn,P=(0,y.YB)(),yn=P.formatMessage({id:"pages.toolBar.polygon"}),In=P.formatMessage({id:"pages.toolBar.brush"}),Bn=P.formatMessage({id:"pages.toolBar.rubber"}),Ln=P.formatMessage({id:"pages.toolBar.zoomIn"}),jn=P.formatMessage({id:"pages.toolBar.zoomOut"}),En=P.formatMessage({id:"pages.toolBar.move"}),On=P.formatMessage({id:"pages.toolBar.unDo"}),Zn=P.formatMessage({id:"pages.toolBar.reDo"}),Dn=P.formatMessage({id:"pages.toolBar.save"}),Tn=P.formatMessage({id:"pages.toolBar.edit"}),pn=P.formatMessage({id:"pages.toolBar.clearMark"}),Rn=P.formatMessage({id:"pages.toolBar.interactor"}),zn=P.formatMessage({id:"pages.toolBar.segmentThreshold"}),Nn=P.formatMessage({id:"pages.toolBar.transparency"}),Un=P.formatMessage({id:"pages.toolBar.visualRadius"}),Wn=P.formatMessage({id:"pages.toolBar.determineOutline"}),Fn=P.formatMessage({id:"pages.toolBar.medicalSetting"}),Kn=P.formatMessage({id:"pages.toolBar.divideData"}),Hn=P.formatMessage({id:"pages.toolBar.export"});return(0,e.jsxs)(N.Z,{className:B().segment,children:[(0,e.jsxs)(K.Z,{children:[(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/polygon.png",active:j=="polygon",onClick:function(){Q("polygon"),T(void 0)},children:yn}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/edit.png",children:Tn}),(0,e.jsx)(_.Z,{size:w,active:j=="brush",onClick:function(){j!="rubber"&&j!="brush"&&T(void 0),Q("brush")},onChange:function(a){cn(a)},children:In}),(0,e.jsx)(_.Z,{size:w,active:j=="rubber",onClick:function(){j!="rubber"&&j!="brush"&&T(void 0),Q("rubber")},onChange:function(a){cn(a)},imgSrc:"./pics/buttons/rubber.png",children:Bn}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){fn(tn+.1)},children:Ln}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){fn(tn-.1)},children:jn}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/save.png",children:Dn}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){Q("mover")},children:En}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){bn()},children:On}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){Cn()},children:Zn}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:pn})]}),(0,e.jsxs)("div",{id:"dr",className:B().mainStage,children:[(0,e.jsx)("div",{className:B().draw,children:(0,e.jsx)(o.Z,{width:(R=document.getElementById("dr"))===null||R===void 0?void 0:R.clientWidth,scale:tn,annotations:E,currentTool:j,currentAnnotation:U,setCurrentAnnotation:T,onAnnotationModify:on,onAnnotationModifyComplete:function(){k(E,U)},onMouseDown:an.onMouseDown,onMouseMove:an.onMouseMove,onMouseUp:an.onMouseUp,createPolygonFunc:gn.createElementsFunc,createBrushFunc:mn.createElementsFunc})}),(0,e.jsx)("div",{className:B().pblock,children:(0,e.jsx)("div",{className:B().progress,children:(0,e.jsx)(z.Z,{percent:50,status:"active"})})})]}),(0,e.jsxs)(K.Z,{disLoc:"right",children:[(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:Rn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:zn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:Nn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:Un}),(0,e.jsxs)(H.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,e.jsx)(S,{}),trigger:"hover",children:[" ",(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:Fn})]}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/data_division.png",children:Kn}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/export.png",children:Hn})]}),(0,e.jsxs)("div",{className:B().rightSideBar,children:[(0,e.jsx)("div",{className:B().determinOutline,children:(0,e.jsx)(F.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){T(void 0)},children:Wn})}),(0,e.jsx)(i.Z,{selectedLabel:q,onLabelSelect:function(a){sn(a),T(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,e.jsx)(c.Z,{selectedAnnotation:U,annotations:E,onAnnotationSelect:function(a){a!=null&&a.delete||T(a)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(a){X(E.filter(function(u){return u.annotationId!=a.annotationId})),T(void 0)}})]})]})},D=C}}]);
