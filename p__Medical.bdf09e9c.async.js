(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[454],{57560:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},8982:function(y){y.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(y){y.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},43801:function(y,p,n){"use strict";n.d(p,{Z:function(){return M}});var K=n(11849),j=n(2824),I=n(91220),O=n(67294),z=n(65031),S=n(85893);function D(e,v,l,m){if(!(!e||!v||!l||!m))return{width:e,color:v,points:l,tool:m}}function b(e,v,l,m,u,h,d){if(!e||!e.lines)return(0,S.jsx)(S.Fragment,{});var a=(d==null?void 0:d.annotationId)==e.annotationId,A=a&&u=="mover",P=[],g=(0,I.Z)(e.lines),E;try{for(g.s();!(E=g.n()).done;){var _=E.value;!_.width||!_.color||!_.points||!_.tool||P.push((0,S.jsx)(z.x1,{stroke:_.color,strokeWidth:_.width,globalCompositeOperation:_.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:_.points,tension:.01,onDragMove:function(){},onDragEnd:function(){l()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:A?1:0}))}}catch(x){g.e(x)}finally{g.f()}return(0,S.jsx)(z.ZA,{draggable:A,children:P})}function U(e,v){return e=="rubber"||v==2?"rubber":"brush"}function t(e){var v=0,l=(0,I.Z)(e),m;try{for(l.s();!(m=l.n()).done;){var u=m.value;!u||u.annotationId>v&&(v=u.annotationId)}}catch(h){l.e(h)}finally{l.f()}return v}function M(e){var v=(0,O.useState)(),l=(0,j.Z)(v,2),m=l[0],u=l[1],h=function(P,g){var E;if(!(e.currentTool!="brush"&&e.currentTool!="rubber")){var _=P.evt.offsetX/g,x=P.evt.offsetY/g,i=U(e.currentTool,P.evt.button),s=D(e.brushSize||10,(E=e.currentLabel)===null||E===void 0?void 0:E.color,[_,x,_,x],i);if(!!s)if(u(i),e.currentAnnotation){var R,Y={tool:"brush",annotationId:e.currentAnnotation.annotationId,label:e.currentAnnotation.label,lines:(R=e.currentAnnotation.lines)===null||R===void 0?void 0:R.concat([s])};e.onAnnotationModify(Y)}else{if(i=="rubber")return;e.onAnnotationAdd({tool:"brush",annotationId:t(e.annotations)+1,label:e.currentLabel,lines:[s]})}}},d=function(P,g){var E;if(!(!m||!e.currentAnnotation)){var _=P.evt.offsetX/g,x=P.evt.offsetY/g,i=[_,x],s=[];(E=e.currentAnnotation)!==null&&E!==void 0&&E.lines&&(i=e.currentAnnotation.lines[e.currentAnnotation.lines.length-1].points.concat(i),s=e.currentAnnotation.lines);var R=D(e.brushSize||10,e.currentLabel.color,i,m);!R||(s.pop(),s.push(R),e.onAnnotationModify((0,K.Z)((0,K.Z)({},e.currentAnnotation),{},{lines:s})))}},a=function(){e.currentTool!="brush"&&e.currentTool!="rubber"||(u(void 0),e.onMouseUp())};return{onMouseDown:h,onMouseMove:d,onMouseUp:a,createElementsFunc:b}}},58967:function(y,p,n){"use strict";var K=n(20136),j=n(55241),I=n(77883),O=n(70507),z=n(57663),S=n(71577),D=n(2824),b=n(67294),U=n(61541),t=n(57560),M=n.n(t),e=n(85893),v=1,l=50,m=10;function u(d){return d?d<=v?v:d>=l?l:d:m}var h=function(a){var A=(0,b.useState)(u(a.size)),P=(0,D.Z)(A,2),g=P[0],E=P[1],_=function(i){E(u(i))};return(0,b.useEffect)(function(){_(a.size)},[a.size]),(0,e.jsxs)(j.Z,{overlayClassName:M().popover,placement:"right",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{type:"text",onClick:function(){var i,s=u(g-1);_(s),(i=a.onChange)===null||i===void 0||i.call(0,s)},children:"-"}),(0,e.jsx)(O.Z,{min:v,max:l,value:g,onChange:function(i){var s;(s=a.onChange)===null||s===void 0||s.call(0,i)},controls:!1,style:{textAlign:"center"}}),(0,e.jsx)(S.Z,{type:"text",onClick:function(){var i,s=u(g+1);_(s),(i=a.onChange)===null||i===void 0||i.call(0,s)},children:"+"})]}),trigger:a.active?"hover":"click",children:[" ",(0,e.jsx)(U.Z,{active:a.active,imgSrc:a.imgSrc||"./pics/buttons/brush.png",onClick:a.onClick,children:a.children||"Brush"})]})};p.Z=h},27992:function(y,p,n){"use strict";var K=n(20136),j=n(55241),I=n(77883),O=n(70507),z=n(57663),S=n(71577),D=n(2824),b=n(67294),U=n(61541),t=n(26647),M=n.n(t),e=n(85893),v=1,l=100,m=10;function u(d){return d?d<=v?v:d>=l?l:d:m}var h=function(a){var A=(0,b.useState)(u(a.size)),P=(0,D.Z)(A,2),g=P[0],E=P[1],_=function(i){E(u(i))};return(0,b.useEffect)(function(){_(a.size)},[a.size]),(0,e.jsxs)(j.Z,{overlayClassName:"".concat(M().popover," ").concat(a.disLoc=="left"?M().popoverLeft:""),placement:a.disLoc||"right",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(S.Z,{type:"text",onClick:function(){var i,s=u(g-1);_(s),(i=a.onChange)===null||i===void 0||i.call(0,s)},children:"-"}),(0,e.jsx)(O.Z,{min:v,max:l,value:g,onChange:function(i){var s;(s=a.onChange)===null||s===void 0||s.call(0,i)},controls:!1,style:{textAlign:"center"}}),(0,e.jsx)(S.Z,{type:"text",onClick:function(){var i,s=u(g+1);_(s),(i=a.onChange)===null||i===void 0||i.call(0,s)},children:"+"})]}),trigger:"hover",children:[" ",(0,e.jsx)(U.Z,{imgSrc:a.imgSrc,onClick:a.onClick,children:a.children})]})};p.Z=h},13931:function(y,p,n){"use strict";n.d(p,{Z:function(){return U}});var K=n(91220),j=n(11849),I=n(65031),O=n(85893);function z(t){var M=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return M?{r:parseInt(M[1],16),g:parseInt(M[2],16),b:parseInt(M[3],16)}:null}function S(t,M){if(!(!t||!M))return{color:t,points:M}}function D(t,M,e,v,l,m,u){if(!t||!t.lines||!t.lines[0])return[(0,O.jsx)(O.Fragment,{})];var h=t.lines[0].points,d=t.lines[0].color,a=z(d);if(!a)return[(0,O.jsx)(O.Fragment,{})];var A=(u==null?void 0:u.annotationId)==t.annotationId,P=A?.5:.1,g=void 0,E=[];return h.forEach(function(_,x){if(!g){g=_;return}E.push((0,O.jsx)(I.Cd,{onMouseDown:function(){l=="mover"&&m(t)},draggable:l=="mover",onDragMove:function(s){console.log("Circle onDrageMove");var R=s.evt.offsetX/v,Y=s.evt.offsetY/v;h[x-1]=R,h[x]=Y;var B=(0,j.Z)((0,j.Z)({},t),{},{lines:[{color:d,points:h}]});M(B)},onMouseOver:function(){console.log("Circle onMouseOver"),l=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:g,y:_,radius:5,fill:d})),g=void 0}),[(0,O.jsxs)(I.ZA,{children:[(0,O.jsx)(I.x1,{onMouseOver:function(){l=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){l=="mover"&&m(t)},stroke:d,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:h,tension:0,closed:!0,fill:"rgba(".concat(a.r,", ").concat(a.g,", ").concat(a.b,", ").concat(P,")")}),E]},t.annotationId)]}function b(t){var M=0,e=(0,K.Z)(t),v;try{for(e.s();!(v=e.n()).done;){var l=v.value;!l||l.annotationId>M&&(M=l.annotationId)}}catch(m){e.e(m)}finally{e.f()}return M}function U(t){var M=function(u,h){var d,a=u.evt.offsetX/h,A=u.evt.offsetY/h,P=S((d=t.currentLabel)===null||d===void 0?void 0:d.color,[a,A]);!P||t.onAnnotationAdd({tool:"polygon",annotationId:b(t.annotations)+1,label:t.currentLabel,lines:[P]})},e=function(u,h){var d,a;if(!!t.currentAnnotation){var A=u.evt.offsetX/h,P=u.evt.offsetY/h,g=t.currentAnnotation.lines||[],E=S((d=t.currentLabel)===null||d===void 0?void 0:d.color,(a=g[0])===null||a===void 0?void 0:a.points.concat([A,P]));if(!!E){var _={tool:"polygon",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:[E]};t.onAnnotationModify(_)}}},v=function(u,h){t.currentTool=="polygon"&&(t.currentAnnotation?e(u,h):M(u,h))},l=function(){t.currentTool=="polygon"&&t.onMouseUp()};return{onMouseDown:v,onMouseMove:function(){},onMouseUp:l,createElementsFunc:D}}},29919:function(y,p,n){"use strict";var K=n(67294),j=n(61541),I=n(85893),O=function(S){return(0,I.jsx)(j.Z,{active:S.active,imgSrc:S.imgSrc||"./pics/buttons/polygon.png",onClick:S.onClick,children:S.children})};p.Z=O},21028:function(y,p,n){"use strict";n.r(p),n.d(p,{MOST_HISTORY_STEPS:function(){return X},default:function(){return hn}});var K=n(57663),j=n(71577),I=n(20136),O=n(55241),z=n(34669),S=n(54458),D=n(2824),b=n(67294),U=n(75721),t=n.n(U),M=n(8088),e=n(61541),v=n(44434),l=n(58967),m=n(27992),u=n(5041),h=n(57436),d=n(14836),a=n(29919),A=n(43801),P=n(13931),g=n(13062),E=n(71230),_=n(66126),x=n(75454),i=n(89032),s=n(15746),R=n(8982),Y=n.n(R),B=n(48971),o=n(85893),fn=function(F){var V=(0,B.YB)().formatMessage({id:"component.PPMedical.windowWidth"}),$=(0,B.YB)().formatMessage({id:"component.PPMedical.windowLevel"});return(0,o.jsxs)("div",{children:[(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(s.Z,{span:6,className:Y().Pop1,children:(0,o.jsx)("span",{children:V})}),(0,o.jsx)(s.Z,{span:18,className:Y().Pop2,children:(0,o.jsx)(x.Z,{min:1,max:F.wwValue||100,defaultValue:37})})]}),(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(s.Z,{span:6,className:Y().Pop1,children:(0,o.jsx)("span",{children:$})}),(0,o.jsx)(s.Z,{span:18,className:Y().Pop2,children:(0,o.jsx)(x.Z,{min:1,max:F.wlValue||100,defaultValue:37})})]})]})},mn=fn,X=40,gn=function(){var F,V=(0,b.useState)(void 0),$=(0,D.Z)(V,2),T=$[0],H=$[1],Pn=(0,b.useState)({color:"",name:""}),tn=(0,D.Z)(Pn,2),G=tn[0],on=tn[1],En=(0,b.useState)(),rn=(0,D.Z)(En,2),W=rn[0],k=rn[1],Bn=(0,b.useState)([]),an=(0,D.Z)(Bn,2),L=an[0],Cn=an[1],xn=(0,b.useState)(10),sn=(0,D.Z)(xn,2),J=sn[0],ln=sn[1],Sn=(0,b.useState)(1),un=(0,D.Z)(Sn,2),Q=un[0],q=un[1],dn=function(r){r||q(1),r<.1||r>3?q(1):q(r)},Z=function(r){k(r),r!=null&&r.label&&on(r.label)},N=function(r){Cn(r)};(0,b.useEffect)(function(){localStorage.removeItem("history"),w([])},[]);function w(c,r){var f=localStorage.getItem("history"),C=f?JSON.parse(f):{index:-1,items:[]},_n={currentAnnotation:r,annotations:c};if(JSON.stringify(C.items[C.index])!=JSON.stringify(_n)){var Hn=C.index>X?C.index-X:0,Jn=C.items.splice(Hn,C.index==0?1:C.index+1);C.items=Jn.concat([_n]),C.index<=X?C.index++:C.index=X+1,localStorage.setItem("history",JSON.stringify(C))}}var On=function(){var r=localStorage.getItem("history");if(!!r){var f=JSON.parse(r);if(!!f&&!(f.index>=f.items.length-1)){f.index++,localStorage.setItem("history",JSON.stringify(f));var C=f.items[f.index];k(C.currentAnnotation),N(C.annotations)}}},bn=function(){var r=localStorage.getItem("history");if(!!r){var f=JSON.parse(r);if(!(!f||!f.index)&&!(f.index<=0)){f.index--,localStorage.setItem("history",JSON.stringify(f));var C=f.items[f.index];k(C.currentAnnotation),N(C.annotations)}}},nn=function(r){for(var f=[],C=0;C<L.length;C++)L[C].annotationId==r.annotationId?f.push(r):f.push(L[C]);Z(r),N(f)},cn=(0,A.Z)({currentLabel:G,brushSize:J,currentTool:T,annotations:L,currentAnnotation:W,onAnnotationAdd:function(r){var f=L.concat([r]);N(f),W||Z(r)},onAnnotationModify:nn,onMouseUp:function(){w(L,W)}}),vn=(0,P.Z)({currentLabel:G,brushSize:J,currentTool:T,annotations:L,currentAnnotation:W,onAnnotationAdd:function(r){var f=L.concat([r]);N(f),W||Z(r)},onAnnotationModify:nn,onMouseUp:function(){w(L,W)}}),en=T=="polygon"?vn:cn,An=(0,B.YB)().formatMessage({id:"pages.toolBar.polygon"}),Dn=(0,B.YB)().formatMessage({id:"pages.toolBar.brush"}),yn=(0,B.YB)().formatMessage({id:"pages.toolBar.rubber"}),Ln=(0,B.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),pn=(0,B.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),jn=(0,B.YB)().formatMessage({id:"pages.toolBar.move"}),In=(0,B.YB)().formatMessage({id:"pages.toolBar.unDo"}),Tn=(0,B.YB)().formatMessage({id:"pages.toolBar.reDo"}),Zn=(0,B.YB)().formatMessage({id:"pages.toolBar.save"}),Rn=(0,B.YB)().formatMessage({id:"pages.toolBar.edit"}),Un=(0,B.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Wn=(0,B.YB)().formatMessage({id:"pages.toolBar.interactor"}),Kn=(0,B.YB)().formatMessage({id:"pages.toolBar.segmentThreshold"}),zn=(0,B.YB)().formatMessage({id:"pages.toolBar.diaphaneity"}),Yn=(0,B.YB)().formatMessage({id:"pages.toolBar.visualRadius"}),Fn=(0,B.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),Nn=(0,B.YB)().formatMessage({id:"pages.toolBar.medicalSetting"}),Xn=(0,B.YB)().formatMessage({id:"pages.toolBar.divideData"}),$n=(0,B.YB)().formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(M.Z,{className:t().segment,children:[(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(a.Z,{active:T=="polygon",onClick:function(){H("polygon"),Z(void 0)},children:An}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/edit.png",children:Rn}),(0,o.jsx)(l.Z,{size:J,active:T=="brush",onClick:function(){T!="rubber"&&T!="brush"&&Z(void 0),H("brush")},onChange:function(r){ln(r)},children:Dn}),(0,o.jsx)(l.Z,{size:J,active:T=="rubber",onClick:function(){T!="rubber"&&T!="brush"&&Z(void 0),H("rubber")},onChange:function(r){ln(r)},imgSrc:"./pics/buttons/rubber.png",children:yn}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){dn(Q+.1)},children:Ln}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){dn(Q-.1)},children:pn}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/save.png",children:Zn}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){H("mover")},children:jn}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){bn()},children:In}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){On()},children:Tn}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:Un})]}),(0,o.jsxs)("div",{id:"dr",className:t().mainStage,children:[(0,o.jsx)("div",{className:t().draw,children:(0,o.jsx)(h.Z,{width:(F=document.getElementById("dr"))===null||F===void 0?void 0:F.clientWidth,scale:Q,annotations:L,currentTool:T,currentAnnotation:W,setCurrentAnnotation:Z,onAnnotationModify:nn,onAnnotationModifyComplete:function(){w(L,W)},onMouseDown:en.onMouseDown,onMouseMove:en.onMouseMove,onMouseUp:en.onMouseUp,createPolygonFunc:vn.createElementsFunc,createBrushFunc:cn.createElementsFunc})}),(0,o.jsx)("div",{className:t().pblock,children:(0,o.jsx)("div",{className:t().progress,children:(0,o.jsx)(S.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(v.Z,{disLoc:"right",children:[(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:Wn}),(0,o.jsx)(m.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:Kn}),(0,o.jsx)(m.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:zn}),(0,o.jsx)(m.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:Yn}),(0,o.jsxs)(O.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,o.jsx)(mn,{}),trigger:"hover",children:[" ",(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:Nn})]}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/data_division.png",children:Xn}),(0,o.jsx)(e.Z,{imgSrc:"./pics/buttons/export.png",children:$n})]}),(0,o.jsxs)("div",{className:t().rightSideBar,children:[(0,o.jsx)("div",{className:t().determinOutline,children:(0,o.jsx)(j.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){Z(void 0)},children:Fn})}),(0,o.jsx)(u.Z,{selectedLabel:G,onLabelSelect:function(r){on(r),Z(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(d.Z,{selectedAnnotation:W,annotations:L,onAnnotationSelect:function(r){r!=null&&r.delete||Z(r)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(r){N(L.filter(function(f){return f.annotationId!=r.annotationId})),Z(void 0)}})]})]})},hn=gn}}]);
