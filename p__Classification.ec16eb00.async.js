(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(B,F,e){"use strict";e.d(F,{Z:function(){return _}});var $=e(94663),I=e(80112);function p(T){return Function.toString.call(T).indexOf("[native code]")!==-1}var j=e(18597);function i(T,n,A){return(0,j.Z)()?i=Reflect.construct:i=function(Z,R,t){var K=[null];K.push.apply(K,R);var m=Function.bind.apply(Z,K),W=new m;return t&&(0,I.Z)(W,t.prototype),W},i.apply(null,arguments)}function _(T){var n=typeof Map=="function"?new Map:void 0;return _=function(h){if(h===null||!p(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n!="undefined"){if(n.has(h))return n.get(h);n.set(h,Z)}function Z(){return i(h,arguments,(0,$.Z)(this).constructor)}return Z.prototype=Object.create(h.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),(0,I.Z)(Z,h)},_(T)}},52822:function(B){B.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(B){B.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(B){B.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(B){B.exports={container:"container___G0FNe"}},83930:function(B){B.exports={stage:"stage___3H5QL"}},80961:function(B){B.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(B){B.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(B){B.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(B,F,e){"use strict";var $=e(20136),I=e(55241),p=e(2824),j=e(67294),i=e(52822),_=e.n(i),T=e(63144),n=e(85893),A=function(Z){var R=(0,j.useState)(Z.color||"#FFF"),t=(0,p.Z)(R,2),K=t[0],m=t[1];return(0,j.useEffect)(function(){m(Z.color||"#FFF")},[Z]),Z.changeable?(0,n.jsx)(I.Z,{getPopupContainer:function(x){return x.parentElement||document.body},overlayClassName:_().popover,openClassName:_().popoverOpenClassName,placement:"bottom",content:(0,n.jsx)(T.xS,{disableAlpha:!0,color:K,onChange:function(x){m(x.hex)},onChangeComplete:Z.onChange}),trigger:"click",children:(0,n.jsx)("div",{className:_().roundBall,style:{backgroundColor:K}})}):(0,n.jsx)("div",{className:_().roundBall,style:{backgroundColor:K}})};F.Z=A},5041:function(B,F,e){"use strict";e.d(F,{Z:function(){return P}});var $=e(54421),I=e(38272),p=e(57663),j=e(71577),i=e(2824),_=e(67294),T=e(56131),n=e.n(T),A=e(49111),h=e(19650),Z=e(11849),R=e(5882),t=e.n(R),K=e(63097),m=e(85893),W=function(o){var s=(0,Z.Z)({},o.label),l=(0,_.useState)(s.invisible),L=(0,i.Z)(l,2),u=L[0],g=L[1],d=(0,m.jsx)(I.ZP.Item,{className:"".concat(t().listItem," ").concat(s.active?t().listItemActive:""),unselectable:"on",onClick:function(){o.onClick(s)},children:(0,m.jsxs)(h.Z,{align:"center",size:5,children:[(0,m.jsx)("a",{className:t().eye,style:{backgroundImage:u?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){g(!u),o.onLabelModify(s)}})," ",s.name,(0,m.jsx)(K.Z,{color:s.color,changeable:!0,onChange:function(M){s.color=M.hex,o.onLabelModify(s)}}),(0,m.jsx)("a",{className:t().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){o.onLabelDelete(s)}})]})});return d},x=W,O=e(71194),w=e(50146),G=e(47673),J=e(24044),X=e(9715),N=e(93766),U=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],C=function(o){var s,l,L=(0,_.useState)(((s=o.defaultLabel)===null||s===void 0?void 0:s.color)||U[o.order||0]),u=(0,i.Z)(L,2),g=u[0],d=u[1];(0,_.useEffect)(function(){var v;d(((v=o.defaultLabel)===null||v===void 0?void 0:v.color)||U[o.order||0])},[o]);var r=N.Z.useForm(),M=(0,i.Z)(r,1),c=M[0];return(0,m.jsx)(w.Z,{title:"Add Label",visible:o.visible,onCancel:o.onCancel,footer:null,children:(0,m.jsxs)(N.Z,{form:c,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(l=o.defaultLabel)===null||l===void 0?void 0:l.name},onFinish:function(E){var a={name:E.labelname,color:g};o.onLabelAdd(a),c.resetFields()},autoComplete:"off",children:[(0,m.jsx)(N.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,m.jsx)(J.Z,{})}),(0,m.jsx)(N.Z.Item,{label:"Select Color",name:"color",children:(0,m.jsx)(K.Z,{color:g,onChange:function(E){d(E.hex)}})}),(0,m.jsx)(N.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,m.jsxs)(h.Z,{children:[(0,m.jsx)(j.Z,{onClick:function(){var E;(E=o.onCancel)===null||E===void 0||E.call(0),c.resetFields()},children:"\u53D6\u6D88"}),(0,m.jsx)(j.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},D=C,b=function(o){var s;console.log("render pplabellist");var l=(0,_.useState)(!1),L=(0,i.Z)(l,2),u=L[0],g=L[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(I.ZP,{className:n().labelList,size:"large",header:(0,m.jsx)("div",{className:n().listHeader,children:"Label List"}),footer:(0,m.jsx)("div",{children:(0,m.jsx)(j.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){g(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:o.labels,renderItem:function(r){return(0,m.jsx)(x,{onClick:o.onLabelSelect,label:r,onLabelDelete:o.onLabelDelete,onLabelModify:o.onLabelModify})}}),(0,m.jsx)(D,{order:(s=o.labels)===null||s===void 0?void 0:s.length,visible:u,onLabelAdd:function(r){o.onLabelAdd(r),g(!1)},onCancel:function(){g(!1)}})]})},P=b},8088:function(B,F,e){"use strict";var $=e(67294),I=e(78677),p=e.n(I),j=e(85893),i=function(T){return(0,j.jsx)("div",{className:"".concat(p().container," ").concat(T.className),children:T.children})};F.Z=i},57436:function(B,F,e){"use strict";var $=e(91220),I=e(2824),p=e(67294),j=e(65031),i=e(84420),_=e.n(i),T=e(83930),n=e.n(T),A=e(85893),h="./pics/basketball.jpg",Z=function(t){var K=_()(t.imgSrc||""),m=(0,I.Z)(K,1),W=m[0],x=(W==null?void 0:W.width)||0,O=(W==null?void 0:W.height)||0,w=(0,p.useState)(),G=(0,I.Z)(w,2),J=G[0],X=G[1],N=(0,p.useState)(),U=(0,I.Z)(N,2),C=U[0],D=U[1],b=(0,p.useState)({x:0,y:0}),P=(0,I.Z)(b,2),S=P[0],o=P[1];function s(){var r=document.getElementById("dr");r&&(X(r.clientWidth),D(r.clientHeight))}(0,p.useEffect)(function(){window.removeEventListener("resize",s),window.addEventListener("resize",s);var r=document.getElementById("dr");r&&(X(r.clientWidth),D(r.clientHeight),o({x:r.clientWidth/2,y:r.clientHeight/2}))},[]);var l=[];if(t.annotations){var L=(0,$.Z)(t.annotations),u;try{for(L.s();!(u=L.n()).done;){var g=u.value;if(!!g){var d=g.tool=="polygon"?t.createPolygonFunc:t.createBrushFunc;d&&l.push(d(g,t.onAnnotationModify,t.onAnnotationModifyComplete,t.scale,t.currentTool,t.setCurrentAnnotation,t.currentAnnotation))}}}catch(r){L.e(r)}finally{L.f()}}return(0,A.jsx)(j.Hf,{width:J,height:C,className:n().stage,children:(0,A.jsx)(j.mh,{onMouseDown:function(M){t.onMouseDown&&t.onMouseDown(M,t.scale)},onMouseMove:function(M){t.onMouseMove&&t.onMouseMove(M,t.scale)},onMouseUp:function(M){t.onMouseUp&&t.onMouseUp(M,t.scale)},onContextMenu:function(M){M.evt.preventDefault()},draggable:!1,children:(0,A.jsxs)(j.ZA,{draggable:t.currentTool=="mover",onDragEnd:function(M){},children:[(0,A.jsx)(j.Ee,{draggable:!1,image:W,x:S.x,y:S.y,offsetX:x/2,offsetY:O/2,scaleX:t.scale,scaleY:t.scale}),l]})})})};F.Z=Z},44434:function(B,F,e){"use strict";var $=e(67294),I=e(80961),p=e.n(I),j=e(85893),i=function(T){var n=p().leftToolbar;return T.disLoc=="right"&&(n=p().rightToolbar),(0,j.jsx)("div",{className:n,children:T.children})};F.Z=i},61541:function(B,F,e){"use strict";var $=e(49111),I=e(19650),p=e(67294),j=e(82499),i=e.n(j),_=e(85893),T=function(A){return(0,_.jsx)("div",{unselectable:"on",className:"".concat(i().toolBarButtonContainerWrapper," ").concat(A.active&&i().toolBarButtonContainerWrapperActive),onClick:A.onClick,children:(0,_.jsx)(I.Z,{align:"center",className:i().toolBarButtonContainer,size:0,children:(0,_.jsxs)(I.Z,{align:"center",direction:"vertical",className:i().toolBarButton,size:0,children:[(0,_.jsx)("img",{src:A.imgSrc}),(0,_.jsx)("div",{className:i().buttonText,children:A.children})]})})})};F.Z=T},29214:function(B,F,e){"use strict";e.r(F);var $=e(20228),I=e(11382),p=e(34669),j=e(54458),i=e(34792),_=e(48086),T=e(2824),n=e(67294),A=e(73199),h=e.n(A),Z=e(8088),R=e(61541),t=e(44434),K=e(5041),m=e(57436),W=e(37071),x=e(64322),O=e(85893),w=localStorage.getItem("basePath"),G=function(N){console.log("selectlabel",N)},J=function(){var N,U=(0,n.useState)("mover"),C=(0,T.Z)(U,2),D=C[0],b=C[1],P=(0,n.useState)(!1),S=(0,T.Z)(P,2),o=S[0],s=S[1],l=(0,x._D)(n.useState),L=(0,x.Gd)(n.useState),u=(0,x.jL)(n.useState,{oneHot:!1,pageOnSelect:G}),g=(0,x.iA)(n.useState),d=(0,x.A5)(n.useState),r=(0,x.CV)(n.useState),M=W.Z.getQueryVariable("projectId");return console.log("projectId",M),(0,n.useEffect)(function(){s(!0),L.getCurr(M).then(function(c){u.getAll(c.projectId),g.getAll(c.projectId,0)}),s(!1)},[M]),(0,n.useEffect)(function(){!g.curr||d.getAll(g.curr.taskId,0)},[g.curr]),(0,O.jsxs)(Z.Z,{className:h().classes,children:[(0,O.jsxs)(t.Z,{children:[(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){l.change(.1)},children:"Zoom in"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){l.change(-.1)},children:"Zoom out"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){_.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){b("mover"),_.default.info("You can move the image now.")},children:"Move"})]}),(0,O.jsx)("div",{id:"dr",className:h().mainStage,children:(0,O.jsxs)(I.Z,{tip:"loading",spinning:o,children:[(0,O.jsx)("div",{className:h().draw,children:(0,O.jsx)(m.Z,{scale:l.curr,currentTool:D,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat(w,"/datas/").concat((N=d.curr)===null||N===void 0?void 0:N.dataId,"/image")})}),(0,O.jsx)("div",{className:h().pblock,children:(0,O.jsx)("div",{className:h().progress,children:(0,O.jsx)(j.Z,{percent:50,status:"active"})})}),(0,O.jsx)("div",{className:h().prevTask,onClick:function(){return g.turnTo(g.currIdx-1)}}),(0,O.jsx)("div",{className:h().nextTask,onClick:function(){return g.turnTo(g.currIdx+1)}})]})}),(0,O.jsxs)(t.Z,{disLoc:"right",children:[(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,O.jsx)(R.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,O.jsx)("div",{className:h().rightSideBar,children:(0,O.jsx)(K.Z,{labels:u.all,selectedLabel:u.curr,onLabelSelect:u.onSelect,onLabelAdd:u.onAdd,onLabelDelete:u.onDelete,onLabelModify:function(){}})})]})};F.default=J},64322:function(B,F,e){"use strict";e.d(F,{gu:function(){return m},_D:function(){return O},Gd:function(){return w},jL:function(){return G},iA:function(){return J},CV:function(){return X},A5:function(){return N}});var $=e(86582),I=e(91220),p=e(3182),j=e(34792),i=e(48086),_=e(2824),T=e(94043),n=e.n(T),A=e(37071),h=e(81139),Z=localStorage.getItem("basePath"),R=new h.VK(Z?{basePath:Z}:void 0),t=new h.U(R),K=new h.sD(R),m=function(C){return JSON.parse(JSON.stringify(C))};function W(U){return U&&(U.toLowerCase().replace(/([-_][a-z])/g,function(C){return C.toUpperCase().replace("-","").replace("_","")}),U)}var x=function(C,D,b){if(!!b){for(var P=0;P<D.length;P++)if(C[b]==D[P][b])return P}},O=function(C){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],b=C(1),P=(0,_.Z)(b,2),S=P[0],o=P[1],s=function(L){var u=S;u+=L,u<D[0]&&(u=D[0],i.default.error("Smallest scale is "+D[0])),u>D[1]&&(u=D[1],i.default.error("Largest scale is "+D[1])),o(u)};return{curr:S,change:s}},w=function(C){var D=C([]),b=(0,_.Z)(D,2),P=b[0],S=b[1],o=C(),s=(0,_.Z)(o,2),l=s[0],L=s[1],u=function(){var c=(0,p.Z)(n().mark(function v(){var E;return n().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,y.next=3,t.getAll();case 3:return E=y.sent,S(E),y.abrupt("return",E);case 8:y.prev=8,y.t0=y.catch(0),console.log("project getAll err",y.t0),A.Z.parseError(y.t0,i.default);case 12:case"end":return y.stop()}},v,null,[[0,8]])}));return function(){return c.apply(this,arguments)}}(),g=function(){var c=(0,p.Z)(n().mark(function v(E){var a;return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(E!=null){f.next=2;break}return f.abrupt("return",void 0);case 2:if(!(P.length>1)){f.next=5;break}return i.default.error("Currently have multiple projects stored, use turnTo instead"),f.abrupt("return");case 5:return f.prev=5,f.next=8,t.get(E);case 8:return a=f.sent,S([a]),L(0),f.abrupt("return",a);case 14:f.prev=14,f.t0=f.catch(5),console.log("prject getcurr err",f.t0),A.Z.parseError(f.t0,i.default);case 18:case"end":return f.stop()}},v,null,[[5,14]])}));return function(E){return c.apply(this,arguments)}}(),d=function(){var c=(0,p.Z)(n().mark(function v(E){return n().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:typeof E=="number"?t.remove(E):t.remove(E.projectId),u();case 2:case"end":return y.stop()}},v)}));return function(E){return c.apply(this,arguments)}}(),r=function(){var c=(0,p.Z)(n().mark(function v(E){var a;return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,t.create(E);case 3:return a=f.sent,console.log(a),f.abrupt("return",a);case 8:f.prev=8,f.t0=f.catch(0),console.log("project create err",f.t0),A.Z.parseError(f.t0,i.default);case 12:case"end":return f.stop()}},v,null,[[0,8]])}));return function(E){return c.apply(this,arguments)}}(),M=function(){var c=(0,p.Z)(n().mark(function v(E,a){return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:t.update(E,a).then(function(Y){console.log("project update res",Y)}).catch(function(Y){console.log("project update err ",Y),A.Z.parseError(Y,i.default)});case 1:case"end":return f.stop()}},v)}));return function(E,a){return c.apply(this,arguments)}}();return{all:P,getAll:u,getCurr:g,remove:d,create:r,update:M,get curr(){if(l!=null)return P[l]}}},G=function(C,D){var b=D.oneHot,P=b===void 0?!0:b,S=D.pageOnSelect,o=C([]),s=(0,_.Z)(o,2),l=s[0],L=s[1],u=C(),g=(0,_.Z)(u,2),d=g[0],r=g[1],M=C(P),c=(0,_.Z)(M,2),v=c[0],E=c[1],a=function(){var Q=(0,p.Z)(n().mark(function q(k){var z,V,ee,ne;return n().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.prev=0,H.next=3,t.getLabels(k);case 3:z=H.sent,V=(0,I.Z)(z);try{for(V.s();!(ee=V.n()).done;)ne=ee.value,ne.active=!1}catch(ae){V.e(ae)}finally{V.f()}return L(z),H.abrupt("return",z);case 10:H.prev=10,H.t0=H.catch(0),console.log("label getall err ",H.t0),A.Z.parseError(H.t0,i.default);case 14:case"end":return H.stop()}},q,null,[[0,10]])}));return function(k){return Q.apply(this,arguments)}}(),y=function(q){var k=x(q,l,"labelId");if(r(k),console.log("onehot",v),v){var z=(0,I.Z)(l),V;try{for(z.s();!(V=z.n()).done;){var ee=V.value;ee.active=!1}}catch(ne){z.e(ne)}finally{z.f()}l[k].active=!0,console.log("all",l)}else l[k].active=!l[k].active;S(l[k]),L((0,$.Z)(l))},f=function(){},Y=function(){},te=function(){},re=function(){E(!v)};return{all:l,getAll:a,onSelect:y,onAdd:f,onDelete:Y,onModify:te,toggleOneHot:re,get curr(){if(d!=null)return l[d]}}},J=function(C){var D=C([]),b=(0,_.Z)(D,2),P=b[0],S=b[1],o=C(0),s=(0,_.Z)(o,2),l=s[0],L=s[1],u=function(r){if(console.log("turnto",P,r),P.length!=0){if(r==-1){i.default.error("This is the first image. No previous image.");return}if(r==P.length){i.default.error("This is the final image. No next image.");return}L(r)}},g=function(){var d=(0,p.Z)(n().mark(function r(M,c){var v;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.getTasks(M);case 3:return v=a.sent,S(v),c!=null&&u(c),a.abrupt("return",v);case 9:a.prev=9,a.t0=a.catch(0),console.log("task getall err ",a.t0),A.Z.parseError(a.t0,i.default);case 13:case"end":return a.stop()}},r,null,[[0,9]])}));return function(M,c){return d.apply(this,arguments)}}();return{currIdx:l,all:P,turnTo:u,getAll:g,get curr(){if(l!=null)return P[l]}}},X=function(C){var D=C([]),b=(0,_.Z)(D,2),P=b[0],S=b[1],o=function(){var s=(0,p.Z)(n().mark(function l(L){var u;return n().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u=dataApi.getAnnotations(L),S(u),d.abrupt("return",u);case 6:d.prev=6,d.t0=d.catch(0),console.log("ann getAll err",d.t0),A.Z.parseError(d.t0,i.default);case 10:case"end":return d.stop()}},l,null,[[0,6]])}));return function(L){return s.apply(this,arguments)}}();return{all:P,getAll:o}},N=function(C){var D=C(),b=(0,_.Z)(D,2),P=b[0],S=b[1],o=C([]),s=(0,_.Z)(o,2),l=s[0],L=s[1],u=function(){var d=(0,p.Z)(n().mark(function r(M){return n().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:S(M);case 1:case"end":return v.stop()}},r)}));return function(M){return d.apply(this,arguments)}}(),g=function(){var d=(0,p.Z)(n().mark(function r(M,c){var v;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,K.getDatas(M);case 3:return v=a.sent,c!=null&&u(c),L(v),a.abrupt("return",v);case 9:a.prev=9,a.t0=a.catch(0),console.log("data getall err ",a.t0),A.Z.parseError(a.t0,i.default);case 13:case"end":return a.stop()}},r,null,[[0,9]])}));return function(M,c){return d.apply(this,arguments)}}();return{all:l,getAll:g,turnTo:u,get curr(){if(l.length!=0)return l[P]}}}}}]);
