(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[580],{91220:function(P,_,e){"use strict";e.d(_,{Z:function(){return f}});var Z=e(64254);function f(c,d){var o;if(typeof Symbol=="undefined"||c[Symbol.iterator]==null){if(Array.isArray(c)||(o=(0,Z.Z)(c))||d&&c&&typeof c.length=="number"){o&&(c=o);var M=0,s=function(){};return{s,n:function(){return M>=c.length?{done:!0}:{done:!1,value:c[M++]}},e:function(p){throw p},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,j=!1,l;return{s:function(){o=c[Symbol.iterator]()},n:function(){var p=o.next();return v=p.done,p},e:function(p){j=!0,l=p},f:function(){try{!v&&o.return!=null&&o.return()}finally{if(j)throw l}}}}},41435:function(P,_,e){"use strict";e.d(_,{Z:function(){return M}});var Z=e(94663),f=e(80112);function c(s){return Function.toString.call(s).indexOf("[native code]")!==-1}var d=e(18597);function o(s,v,j){return(0,d.Z)()?o=Reflect.construct:o=function(i,p,m){var C=[null];C.push.apply(C,p);var U=Function.bind.apply(i,C),y=new U;return m&&(0,f.Z)(y,m.prototype),y},o.apply(null,arguments)}function M(s){var v=typeof Map=="function"?new Map:void 0;return M=function(l){if(l===null||!c(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof v!="undefined"){if(v.has(l))return v.get(l);v.set(l,i)}function i(){return o(l,arguments,(0,Z.Z)(this).constructor)}return i.prototype=Object.create(l.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),(0,f.Z)(i,l)},M(s)}},38619:function(P){P.exports={modal:"modal___2aO7U"}},41180:function(P){P.exports={ppcard:"ppcard___27hGd",title:"title___22R8f"}},48627:function(P){P.exports={container:"container___2RXc3"}},26389:function(P){P.exports={modal:"modal___2gJ6d"}},31982:function(P,_,e){"use strict";var Z=e(89032),f=e(15746),c=e(11849),d=e(13062),o=e(71230),M=e(11700),s=e(67294),v=e(41180),j=e.n(v),l=e(85893),i=function(m){return(0,l.jsxs)("div",{className:j().ppcard,style:m.style,hidden:m.hidden,children:[(0,l.jsx)(o.Z,{className:j().titleRow,style:{display:m.title?void 0:"none"},children:(0,l.jsx)(M.Z,{className:j().title,children:m.title})}),(0,l.jsx)(o.Z,{style:{marginTop:26},children:(0,l.jsx)(f.Z,{span:24,style:(0,c.Z)({paddingLeft:30,paddingRight:30,textAlign:"center"},m.innerStyle),children:m.children})})]})};_.Z=i},11428:function(P,_,e){"use strict";var Z=e(67294),f=e(48627),c=e.n(f),d=e(85893),o=function(s){return(0,d.jsx)("div",{className:"".concat(c().container),style:{backgroundImage:"url(./pics/background.png)"},children:s.children})};_.Z=o},35261:function(P,_,e){"use strict";var Z=e(71194),f=e(50146),c=e(49111),d=e(19650),o=e(47673),M=e(24044),s=e(34792),v=e(48086),j=e(57663),l=e(71577),i=e(9715),p=e(93766),m=e(2824),C=e(67294),U=e(48971),y=e(26389),R=e.n(y),$=e(45194),h=e(85893),z=function(V){var D=(0,U.YB)(),ne=(0,C.useState)(!1),W=(0,m.Z)(ne,2),G=W[0],F=W[1],n=(0,C.useState)(!1),K=(0,m.Z)(n,2),Y=K[0],L=K[1],H=D.formatMessage({id:"component.PPCreater.cancel"}),J=p.Z.useForm(),Q=(0,m.Z)(J,1),O=Q[0];return(0,h.jsxs)("span",{hidden:V.visible==!1,children:[(0,h.jsx)(l.Z,{type:"primary",onClick:function(){return L(!0)},children:"Export Dataset"}),(0,h.jsx)(f.Z,{className:R().modal,title:D.formatMessage({id:"component.PPExportModal.title"}),visible:Y,onCancel:function(){return L(!1)},footer:null,children:(0,h.jsxs)(p.Z,{form:O,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(B){var t=B.path;if(!t){v.default.error(D.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}F(!0),(0,$.Tr)(V.project.projectId,t).then(function(){v.default.success(D.formatMessage({id:"component.PPExportModal.exportSuccess"})),L(!1)}).finally(function(){F(!1)})},autoComplete:"off",children:[(0,h.jsx)(p.Z.Item,{label:D.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,h.jsx)(M.Z,{})}),(0,h.jsx)(p.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,h.jsxs)(d.Z,{children:[(0,h.jsx)(l.Z,{onClick:function(){L(!1),O.resetFields()},children:H}),(0,h.jsx)(l.Z,{type:"primary",htmlType:"submit",loading:G,children:D.formatMessage({id:"component.PPExportModal.export"})})]})})]})})]})};_.Z=z},65732:function(P,_,e){"use strict";e.r(_),e.d(_,{default:function(){return J}});var Z=e(47673),f=e(24044),c=e(57663),d=e(71577),o=e(11849),M=e(34792),s=e(48086),v=e(3182),j=e(9715),l=e(93766),i=e(2824),p=e(43358),m=e(34041),C=e(94043),U=e.n(C),y=e(67294),R=e(48971),$=e(11428),h=e(31982),z=e(37071),A=e(45194),V=e(71194),D=e(50146),ne=e(49111),W=e(19650),G=e(38619),F=e.n(G),n=e(85893),K=function(O){var x=(0,R.YB)(),B=(0,y.useState)(!1),t=(0,i.Z)(B,2),b=t[0],E=t[1],N=x.formatMessage({id:"component.PPCreater.cancel"}),X=l.Z.useForm(),k=(0,i.Z)(X,1),I=k[0];function w(){var u=O.project.otherSettings;return u!=null&&u.perviousModel&&u!==null&&u!==void 0&&u.models&&u!==null&&u!==void 0&&u.models[u==null?void 0:u.perviousModel]?!0:(s.default.error("Please set and save ML settings first!"),!1)}return(0,n.jsxs)("span",{hidden:O.visible==!1,children:[(0,n.jsx)(d.Z,{type:"primary",onClick:function(){w()&&E(!0)},children:"Train Model"}),(0,n.jsx)(D.Z,{className:F().modal,title:"Train Model",visible:b,onCancel:function(){return E(!1)},footer:null,children:(0,n.jsxs)(l.Z,{form:I,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(q){var ee=q.path;O.trainModel(ee),E(!1)},autoComplete:"off",children:[(0,n.jsx)(l.Z.Item,{label:"Dataset Path",name:"path",rules:[{required:!0,message:"Please input dataset path"}],children:(0,n.jsx)(f.Z,{})}),(0,n.jsx)(l.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(d.Z,{onClick:function(){E(!1),I.resetFields()},children:N}),(0,n.jsx)(d.Z,{type:"primary",htmlType:"submit",children:"Train"})]})})]})})]})},Y=K,L=e(35261),H=function(){var O,x,B,t=(0,A.Gd)(y.useState),b=z.Z.getQueryVariable("projectId"),E=(0,A.RZ)(y.useState),N=m.Z.Option,X=l.Z.useForm(),k=(0,i.Z)(X,1),I=k[0];(0,y.useEffect)(function(){function r(){return a.apply(this,arguments)}function a(){return a=(0,v.Z)(U().mark(function S(){var te,re,T;return U().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,A.bo)();case 2:if(g.sent){g.next=4;break}return g.abrupt("return");case 4:if(t.getAll(),b){g.next=8;break}return s.default.error("Machine Learning settings are specific to every project. Please choose a project first."),g.abrupt("return");case 8:return g.next=10,t.getCurr(b);case 10:T=g.sent,T!=null&&(te=T.otherSettings)!==null&&te!==void 0&&te.mlBackendUrl&&E.setMlBackendUrl(T==null||(re=T.otherSettings)===null||re===void 0?void 0:re.mlBackendUrl);case 12:case"end":return g.stop()}},S)})),a.apply(this,arguments)}r()},[]),(0,y.useEffect)(function(){if(!!t.curr){var r=t.curr.otherSettings?t.curr.otherSettings:{},a=r.models&&r.perviousModel?r.models[r.perviousModel]:{},S={mlBackendUrl:r.mlBackendUrl,modelName:r.perviousModel,trainBatchSize:a.trainBatchSize};I.setFieldsValue(S),r!=null&&r.mlBackendUrl&&E.setMlBackendUrl(r.mlBackendUrl)}},[t.curr]);function w(){if(!t.curr){s.default.error("Please choose a project first!");return}var r=I.getFieldValue("mlBackendUrl");E.setMlBackendUrl(r);var a=(0,o.Z)((0,o.Z)({},t.curr.otherSettings),{},{mlBackendUrl:r});t.update(t.curr.projectId,{otherSettings:a})}function u(r){if(console.log("saveMlsettings",t.curr,r),!t.curr){s.default.error("Please select model first!");return}t.curr.otherSettings||(t.curr.otherSettings={});var a=t.curr.otherSettings.models?t.curr.otherSettings.models:{};a[r.modelName]=r,t.curr.otherSettings.mlBackendUrl=I.getFieldValue("mlBackendUrl"),t.curr.otherSettings.perviousModel=r.modelName,t.curr.otherSettings.models=a,t.update(t.curr.projectId,{otherSettings:t.curr.otherSettings}),s.default.info("Ml setting saved. Let's start trainig or inference!")}function q(r){var a=t.curr.otherSettings;E.train(a.perviousModel,r,a.models[a.perviousModel])}function ee(){var r=t.curr.otherSettings;if(!r||!r.mlBackendUrl||!r.perviousModel){s.default.error("Please set and save ml settings first.");return}s.default.info("Running inference."),t.predict(t.curr.projectId,{mlBackendUrl:r.mlBackendUrl,model:r.perviousModel,sameServer:!1,createLabel:!0}).then(function(){s.default.info("Prediction Complete")})}return(0,n.jsxs)($.Z,{children:[(0,n.jsxs)(h.Z,{children:["Project:",(0,n.jsx)(m.Z,{placeholder:"Select a project",onChange:function(a){return t.getCurr(a)},value:(O=t.curr)===null||O===void 0?void 0:O.projectId,children:(x=t.all)===null||x===void 0?void 0:x.map(function(r){return(0,n.jsx)(N,{value:r.projectId,children:r.name})})})]}),(0,n.jsxs)(h.Z,{hidden:t.curr==null,children:[(0,n.jsx)(Y,{model:E,project:t.curr,trainModel:q}),(0,n.jsx)(L.Z,{project:t.curr}),(0,n.jsx)(d.Z,{type:"primary",onClick:function(){var a,S;if(!((a=t.curr)!==null&&a!==void 0&&(S=a.otherSettings)!==null&&S!==void 0&&S.mlBackendUrl)){s.default.error("Set backend url first");return}window.open("".concat(t.curr.otherSettings.mlBackendUrl.replace("model","visualdl")),"_blank")},children:"Progress"}),(0,n.jsx)(d.Z,{type:"primary",onClick:ee,children:"Run Inference"})]}),(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(d.Z,{type:"primary",onClick:function(){console.log("pjid",t.curr.projectId),R.m8.push("/".concat(t.curr.taskCategory.name,"?projectId=").concat(t.curr.projectId))},children:"Label"}),(0,n.jsx)(d.Z,{type:"primary",onClick:function(){R.m8.push("/project_overview?projectId=".concat(t.curr.projectId))},children:"Project Overview"})]}),(0,n.jsx)(h.Z,{children:(0,n.jsxs)(l.Z,{form:I,layout:"horizontal",size:"large",style:{marginTop:"5.69rem"},onFinish:function(a){console.log("form finish",a),u(a)},hidden:t.curr==null,children:[(0,n.jsxs)(f.Z.Group,{compact:!0,children:[(0,n.jsx)(l.Z.Item,{name:"mlBackendUrl",rules:[{required:!0,message:"Please input ml backend url"}],style:{fontSize:"1.5rem"},children:(0,n.jsx)(f.Z,{allowClear:!0,addonBefore:"ML Backend URL ",style:{textAlign:"left"}})}),(0,n.jsx)(d.Z,{type:"primary",onClick:w,children:"Set"})]}),(0,n.jsx)(l.Z.Item,{name:"modelName",label:"Model",labelCol:{span:6},wrapperCol:{span:16},rules:[{required:!0,message:"Please select a model"}],style:{fontSize:"1.5rem"},children:(0,n.jsx)(m.Z,{placeholder:"Select a model",children:(B=E.all)===null||B===void 0?void 0:B.map(function(r){return(0,n.jsx)(N,{value:r.name,children:r.name})})})}),(0,n.jsx)(l.Z.Item,{name:"trainBatchSize",label:"Training Batch Size",labelCol:{span:6},wrapperCol:{span:16},style:{fontSize:"1.5rem"},children:(0,n.jsx)(f.Z,{placeholder:"Training batch size"})}),(0,n.jsx)(l.Z.Item,{wrapperCol:{span:16,offset:6},children:(0,n.jsx)(d.Z,{htmlType:"submit",type:"primary",style:{height:"2.5rem",width:"48%"},block:!0,children:"Save"})})]})})]})},J=H}}]);
