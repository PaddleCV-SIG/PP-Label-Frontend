(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{71212:function(T){T.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},13931:function(T,x,t){"use strict";t.d(x,{Z:function(){return Y}});var K=t(91220),S=t(11849),b=t(65031),f=t(85893);function y(n){var l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return l?{r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)}:null}function _(n,l){if(!(!n||!l))return{color:n,points:l}}function W(n,l,E,O,c,v,d){if(!n||!n.lines||!n.lines[0])return[(0,f.jsx)(f.Fragment,{})];var r=n.lines[0].points,o=n.lines[0].color,u=y(o);if(!u)return[(0,f.jsx)(f.Fragment,{})];var A=(d==null?void 0:d.annotationId)==n.annotationId,p=A?.5:.1,m=void 0,h=[];return r.forEach(function(g,L){if(!m){m=g;return}h.push((0,f.jsx)(b.Cd,{onMouseDown:function(){c=="mover"&&v(n)},draggable:c=="mover",onDragMove:function(j){console.log("Circle onDrageMove");var U=j.evt.offsetX/O,Z=j.evt.offsetY/O;r[L-1]=U,r[L]=Z;var R=(0,S.Z)((0,S.Z)({},n),{},{lines:[{color:o,points:r}]});l(R)},onMouseOver:function(){console.log("Circle onMouseOver"),c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:m,y:g,radius:5,fill:o})),m=void 0}),[(0,f.jsxs)(b.ZA,{children:[(0,f.jsx)(b.x1,{onMouseOver:function(){c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){c=="mover"&&v(n)},stroke:o,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:r,tension:0,closed:!0,fill:"rgba(".concat(u.r,", ").concat(u.g,", ").concat(u.b,", ").concat(p,")")}),h]},n.annotationId)]}function M(n){var l=0,E=(0,K.Z)(n),O;try{for(E.s();!(O=E.n()).done;){var c=O.value;!c||c.annotationId>l&&(l=c.annotationId)}}catch(v){E.e(v)}finally{E.f()}return l}function Y(n){var l=function(d,r){var o,u=d.evt.offsetX/r,A=d.evt.offsetY/r,p=_((o=n.currentLabel)===null||o===void 0?void 0:o.color,[u,A]);!p||n.onAnnotationAdd({tool:"polygon",annotationId:M(n.annotations)+1,label:n.currentLabel,lines:[p]})},E=function(d,r){var o,u;if(!!n.currentAnnotation){var A=d.evt.offsetX/r,p=d.evt.offsetY/r,m=n.currentAnnotation.lines||[],h=_((o=n.currentLabel)===null||o===void 0?void 0:o.color,(u=m[0])===null||u===void 0?void 0:u.points.concat([A,p]));if(!!h){var g={tool:"polygon",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:[h]};n.onAnnotationModify(g)}}},O=function(d,r){n.currentTool=="polygon"&&(n.currentAnnotation?E(d,r):l(d,r))},c=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:O,onMouseMove:function(){},onMouseUp:c,createElementsFunc:W}}},29919:function(T,x,t){"use strict";var K=t(67294),S=t(61541),b=t(85893),f=function(_){return(0,b.jsx)(S.Z,{active:_.active,imgSrc:_.imgSrc||"./pics/buttons/polygon.png",onClick:_.onClick,children:_.children})};x.Z=f},82881:function(T,x,t){"use strict";t.r(x);var K=t(57663),S=t(71577),b=t(34669),f=t(54458),y=t(2824),_=t(67294),W=t(71212),M=t.n(W),Y=t(8088),n=t(61541),l=t(44434),E=t(5041),O=t(57436),c=t(14836),v=t(29919),d=t(13931),r=t(48971),o=t(85893),u=40,A=function(){var m,h=(0,_.useState)(void 0),g=(0,y.Z)(h,2),L=g[0],B=g[1],j=(0,_.useState)({color:"",name:""}),U=(0,y.Z)(j,2),Z=U[0],R=U[1],q=(0,_.useState)(),J=(0,y.Z)(q,2),C=J[0],k=J[1],nn=(0,_.useState)([]),X=(0,y.Z)(nn,2),P=X[0],I=X[1],on=(0,_.useState)(1),z=(0,y.Z)(on,2),N=z[0],F=z[1],$=function(e){e||F(1),e<.1||e>3?F(1):F(e)},D=function(e){k(e),e!=null&&e.label&&R(e.label)};(0,_.useEffect)(function(){localStorage.removeItem("history"),w([])},[]);function w(i,e){var a=localStorage.getItem("history"),s=a?JSON.parse(a):{index:-1,items:[]},V={currentAnnotation:e,annotations:i};if(JSON.stringify(s.items[s.index])!=JSON.stringify(V)){var Pn=s.index>u?s.index-u:0,Mn=s.items.splice(Pn,s.index==0?1:s.index+1);s.items=Mn.concat([V]),s.index<=u?s.index++:s.index=u+1,localStorage.setItem("history",JSON.stringify(s))}}var en=function(){var e=localStorage.getItem("history");if(!!e){var a=JSON.parse(e);if(!!a&&!(a.index>=a.items.length-1)){a.index++,localStorage.setItem("history",JSON.stringify(a));var s=a.items[a.index];k(s.currentAnnotation),I(s.annotations)}}},tn=function(){var e=localStorage.getItem("history");if(!!e){var a=JSON.parse(e);if(!(!a||!a.index)&&!(a.index<=0)){a.index--,localStorage.setItem("history",JSON.stringify(a));var s=a.items[a.index];k(s.currentAnnotation),I(s.annotations)}}},Q=function(e){for(var a=[],s=0;s<P.length;s++)P[s].annotationId==e.annotationId?a.push(e):a.push(P[s]);D(e),I(a)},G=(0,d.Z)({currentLabel:Z,currentTool:L,annotations:P,currentAnnotation:C,onAnnotationAdd:function(e){var a=P.concat([e]);I(a),C||D(e)},onAnnotationModify:Q,onMouseUp:function(){w(P,C)}}),H=G,rn=(0,r.YB)().formatMessage({id:"pages.toolBar.polygon"}),an=(0,r.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),sn=(0,r.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),ln=(0,r.YB)().formatMessage({id:"pages.toolBar.move"}),un=(0,r.YB)().formatMessage({id:"pages.toolBar.unDo"}),_n=(0,r.YB)().formatMessage({id:"pages.toolBar.reDo"}),dn=(0,r.YB)().formatMessage({id:"pages.toolBar.save"}),cn=(0,r.YB)().formatMessage({id:"pages.toolBar.edit"}),fn=(0,r.YB)().formatMessage({id:"pages.toolBar.clearMark"}),vn=(0,r.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),mn=(0,r.YB)().formatMessage({id:"pages.toolBar.divideData"}),gn=(0,r.YB)().formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(Y.Z,{className:M().key,children:[(0,o.jsxs)(l.Z,{children:[(0,o.jsx)(v.Z,{active:L=="polygon",onClick:function(){B("polygon"),D(void 0)},children:rn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/edit.png",children:cn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){$(N+.1)},children:an}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){$(N-.1)},children:sn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:dn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){B("mover")},children:ln}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){tn()},children:un}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){en()},children:_n}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:fn})]}),(0,o.jsxs)("div",{id:"dr",className:M().mainStage,children:[(0,o.jsx)("div",{className:M().draw,children:(0,o.jsx)(O.Z,{width:(m=document.getElementById("dr"))===null||m===void 0?void 0:m.clientWidth,scale:N,annotations:P,currentTool:L,currentAnnotation:C,setCurrentAnnotation:D,onAnnotationModify:Q,onAnnotationModifyComplete:function(){w(P,C)},onMouseDown:H.onMouseDown,onMouseMove:H.onMouseMove,onMouseUp:H.onMouseUp,createPolygonFunc:G.createElementsFunc})}),(0,o.jsx)("div",{className:M().pblock,children:(0,o.jsx)("div",{className:M().progress,children:(0,o.jsx)(f.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(l.Z,{disLoc:"right",children:[(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:mn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:gn})]}),(0,o.jsxs)("div",{className:M().rightSideBar,children:[(0,o.jsx)("div",{className:M().finished,children:(0,o.jsx)(S.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){D(void 0)},children:vn})}),(0,o.jsx)(E.Z,{selectedLabel:Z,onLabelSelect:function(e){R(e),D(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(c.Z,{selectedAnnotation:C,annotations:P,onAnnotationSelect:function(e){e!=null&&e.delete||D(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){I(P.filter(function(a){return a.annotationId!=e.annotationId})),D(void 0)}})]})]})};x.default=A}}]);
