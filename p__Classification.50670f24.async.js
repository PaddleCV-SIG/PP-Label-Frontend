(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{52822:function(i){i.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(i){i.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(i){i.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(i){i.exports={container:"container___G0FNe"}},83930:function(i){i.exports={stage:"stage___3H5QL"}},80961:function(i){i.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(i){i.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(i){i.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(i,B,e){"use strict";var U=e(20136),C=e(55241),A=e(2824),g=e(67294),m=e(52822),c=e.n(m),j=e(63144),d=e(85893),l=function(Z){var v=(0,g.useState)(Z.color||"#FFF"),t=(0,A.Z)(v,2),P=t[0],a=t[1];return(0,g.useEffect)(function(){a(Z.color||"#FFF")},[Z]),Z.changeable?(0,d.jsx)(C.Z,{getPopupContainer:function(F){return F.parentElement||document.body},overlayClassName:c().popover,openClassName:c().popoverOpenClassName,placement:"bottom",content:(0,d.jsx)(j.xS,{disableAlpha:!0,color:P,onChange:function(F){a(F.hex)},onChangeComplete:Z.onChange}),trigger:"click",children:(0,d.jsx)("div",{className:c().roundBall,style:{backgroundColor:P}})}):(0,d.jsx)("div",{className:c().roundBall,style:{backgroundColor:P}})};B.Z=l},5041:function(i,B,e){"use strict";e.d(B,{Z:function(){return z}});var U=e(54421),C=e(38272),A=e(57663),g=e(71577),m=e(2824),c=e(67294),j=e(56131),d=e.n(j),l=e(49111),p=e(19650),Z=e(11849),v=e(5882),t=e.n(v),P=e(63097),a=e(85893),h=function(s){var o=(0,Z.Z)({},s.label),f=(0,c.useState)(o.invisible),L=(0,m.Z)(f,2),D=L[0],S=L[1],_=(0,a.jsx)(C.ZP.Item,{className:"".concat(t().listItem," ").concat(o.active?t().listItemActive:""),unselectable:"on",onClick:function(){s.onClick(o)},children:(0,a.jsxs)(p.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:t().eye,style:{backgroundImage:D?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){S(!D),s.onLabelModify(o)}})," ",o.name,(0,a.jsx)(P.Z,{color:o.color,changeable:!0,onChange:function(b){o.color=b.hex,s.onLabelModify(o)}}),(0,a.jsx)("a",{className:t().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){s.onLabelDelete(o)}})]})});return _},F=h,J=e(71194),k=e(50146),Q=e(47673),E=e(24044),X=e(9715),O=e(93766),R=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],r=function(s){var o,f,L=(0,c.useState)(((o=s.defaultLabel)===null||o===void 0?void 0:o.color)||R[s.order||0]),D=(0,m.Z)(L,2),S=D[0],_=D[1];(0,c.useEffect)(function(){var T;_(((T=s.defaultLabel)===null||T===void 0?void 0:T.color)||R[s.order||0])},[s]);var n=O.Z.useForm(),b=(0,m.Z)(n,1),I=b[0];return(0,a.jsx)(k.Z,{title:"Add Label",visible:s.visible,onCancel:s.onCancel,footer:null,children:(0,a.jsxs)(O.Z,{form:I,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(f=s.defaultLabel)===null||f===void 0?void 0:f.name},onFinish:function(y){var w={name:y.labelname,color:S};s.onLabelAdd(w),I.resetFields()},autoComplete:"off",children:[(0,a.jsx)(O.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,a.jsx)(E.Z,{})}),(0,a.jsx)(O.Z.Item,{label:"Select Color",name:"color",children:(0,a.jsx)(P.Z,{color:S,onChange:function(y){_(y.hex)}})}),(0,a.jsx)(O.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsxs)(p.Z,{children:[(0,a.jsx)(g.Z,{onClick:function(){var y;(y=s.onCancel)===null||y===void 0||y.call(0),I.resetFields()},children:"\u53D6\u6D88"}),(0,a.jsx)(g.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},H=r,Y=function(s){var o,f=(0,c.useState)(!1),L=(0,m.Z)(f,2),D=L[0],S=L[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.ZP,{className:d().labelList,size:"large",header:(0,a.jsx)("div",{className:d().listHeader,children:"Label List"}),footer:(0,a.jsx)("div",{children:(0,a.jsx)(g.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){S(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:s.labels,renderItem:function(n){return(0,a.jsx)(F,{onClick:s.onLabelSelect,label:n,onLabelDelete:s.onLabelDelete,onLabelModify:s.onLabelModify})}}),(0,a.jsx)(H,{order:(o=s.labels)===null||o===void 0?void 0:o.length,visible:D,onLabelAdd:function(n){s.onLabelAdd(n),S(!1)},onCancel:function(){S(!1)}})]})},z=Y},8088:function(i,B,e){"use strict";var U=e(67294),C=e(78677),A=e.n(C),g=e(85893),m=function(j){return(0,g.jsx)("div",{className:"".concat(A().container," ").concat(j.className),children:j.children})};B.Z=m},57436:function(i,B,e){"use strict";var U=e(91220),C=e(2824),A=e(67294),g=e(65031),m=e(84420),c=e.n(m),j=e(83930),d=e.n(j),l=e(85893),p="./pics/basketball.jpg",Z=function(t){var P=c()(t.imgSrc||""),a=(0,C.Z)(P,1),h=a[0],F=(h==null?void 0:h.width)||0,J=(h==null?void 0:h.height)||0,k=(0,A.useState)(),Q=(0,C.Z)(k,2),E=Q[0],X=Q[1],O=(0,A.useState)(),R=(0,C.Z)(O,2),r=R[0],H=R[1],Y=(0,A.useState)({x:0,y:0}),z=(0,C.Z)(Y,2),K=z[0],s=z[1];function o(){var n=document.getElementById("dr");n&&(X(n.clientWidth),H(n.clientHeight))}(0,A.useEffect)(function(){window.removeEventListener("resize",o),window.addEventListener("resize",o);var n=document.getElementById("dr");n&&(X(n.clientWidth),H(n.clientHeight),s({x:n.clientWidth/2,y:n.clientHeight/2}))},[]);var f=[];if(t.annotations){var L=(0,U.Z)(t.annotations),D;try{for(L.s();!(D=L.n()).done;){var S=D.value;if(!!S){var _=S.tool=="polygon"?t.createPolygonFunc:t.createBrushFunc;_&&f.push(_(S,t.onAnnotationModify,t.onAnnotationModifyComplete,t.scale,t.currentTool,t.setCurrentAnnotation,t.currentAnnotation))}}}catch(n){L.e(n)}finally{L.f()}}return(0,l.jsx)(g.Hf,{width:E,height:r,className:d().stage,children:(0,l.jsx)(g.mh,{onMouseDown:function(b){t.onMouseDown&&t.onMouseDown(b,t.scale)},onMouseMove:function(b){t.onMouseMove&&t.onMouseMove(b,t.scale)},onMouseUp:function(b){t.onMouseUp&&t.onMouseUp(b,t.scale)},onContextMenu:function(b){b.evt.preventDefault()},draggable:!1,children:(0,l.jsxs)(g.ZA,{draggable:t.currentTool=="mover",onDragEnd:function(b){},children:[(0,l.jsx)(g.Ee,{draggable:!1,image:h,x:K.x,y:K.y,offsetX:F/2,offsetY:J/2,scaleX:t.scale,scaleY:t.scale}),f]})})})};B.Z=Z},44434:function(i,B,e){"use strict";var U=e(67294),C=e(80961),A=e.n(C),g=e(85893),m=function(j){var d=A().leftToolbar;return j.disLoc=="right"&&(d=A().rightToolbar),(0,g.jsx)("div",{className:d,children:j.children})};B.Z=m},61541:function(i,B,e){"use strict";var U=e(49111),C=e(19650),A=e(67294),g=e(82499),m=e.n(g),c=e(85893),j=function(l){return(0,c.jsx)("div",{unselectable:"on",className:"".concat(m().toolBarButtonContainerWrapper," ").concat(l.active&&m().toolBarButtonContainerWrapperActive),onClick:l.onClick,children:(0,c.jsx)(C.Z,{align:"center",className:m().toolBarButtonContainer,size:0,children:(0,c.jsxs)(C.Z,{align:"center",direction:"vertical",className:m().toolBarButton,size:0,children:[(0,c.jsx)("img",{src:l.imgSrc}),(0,c.jsx)("div",{className:m().buttonText,children:l.children})]})})})};B.Z=j},81034:function(i,B,e){"use strict";e.r(B),e.d(B,{default:function(){return z}});var U=e(20228),C=e(11382),A=e(34669),g=e(54458),m=e(3182),c=e(86582),j=e(34792),d=e(48086),l=e(2824),p=e(94043),Z=e.n(p),v=e(67294),t=e(73199),P=e.n(t),a=e(8088),h=e(61541),F=e(44434),J=e(5041),k=e(57436),Q=e(3275),E=e(93120),X=e(37071),O=function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],f=s(1),L=(0,l.Z)(f,2),D=L[0],S=L[1],_=function(b){var I=D;I+=b,I<o[0]&&(I=o[0],d.default.error("Smallest scale is "+o[0])),I>o[1]&&(I=o[1],d.default.error("Largest scale is "+o[1])),S(I)};return{scale:D,changeScale:_}},R=O,r=e(85893),H=localStorage.getItem("basePath"),Y=function(){var s=(0,v.useState)(),o=(0,l.Z)(s,2),f=o[0],L=o[1],D=(0,v.useState)(),S=(0,l.Z)(D,2),_=S[0],n=S[1],b=(0,v.useState)(),I=(0,l.Z)(b,2),T=I[0],y=I[1],w=(0,v.useState)(0),se=(0,l.Z)(w,2),W=se[0],le=se[1],Pe=(0,v.useState)(),re=(0,l.Z)(Pe,2),ie=re[0],Ee=re[1],Le=(0,v.useState)(),ue=(0,l.Z)(Le,2),Ye=ue[0],Se=ue[1],Me=(0,v.useState)(),ce=(0,l.Z)(Me,2),Je=ce[0],xe=ce[1],be=(0,v.useState)(),de=(0,l.Z)(be,2),De=de[0],Be=de[1],Ae=(0,v.useState)(),ve=(0,l.Z)(Ae,2),je=ve[0],Ie=ve[1],Ze=(0,v.useState)({color:"",name:""}),me=(0,l.Z)(Ze,2),Te=me[0],Fe=me[1],Oe=(0,v.useState)("mover"),fe=(0,l.Z)(Oe,2),ye=fe[0],We=fe[1],Ue=(0,v.useState)(0),ge=(0,l.Z)(Ue,2),Re=ge[0],Ke=ge[1],Ne=(0,v.useState)(""),_e=(0,l.Z)(Ne,2),pe=_e[0],He=_e[1],ze=(0,v.useState)(!1),Ce=(0,l.Z)(ze,2),$e=Ce[0],q=Ce[1],ee=R(v.useState),ke=function(){if(console.log("turning next ",W,T.length),W+1>=T.length){d.default.error("This is the last task.");return}le(W+1)},Qe=function(){if(console.log("turning prev ",W,T.length),W-1<0){d.default.error("This is the first task.");return}le(W-1)},Xe=function(x){var V=(0,c.Z)(_);if(V[(0,E.cq)(x,_,"name")].active=!x.active,x.active){var N=je.filter(function($){return $.labelId==x.labelId})[0];console.log("filter ann ",N),E.A9.remove(N.annotationId)}else console.log("add ann",{taskId:ie.taskId,labelId:x.labelId}),E.A9.create({taskId:ie.taskId,labelId:x.labelId,dataId:De.dataId}).catch(function($){console.log("err",$)});n(V),Fe(x)};return(0,v.useEffect)(function(){function M(){return x.apply(this,arguments)}function x(){return x=(0,m.Z)(Z().mark(function V(){var N,$,he,te,ne,G,ae;return Z().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(u.prev=0,q(!0),f){u.next=17;break}return u.next=5,(0,Q.refreshProject)();case 5:return N=u.sent,u.next=8,E.F$.getTasks(N.projectId);case 8:return $=u.sent,u.next=11,E.F$.getLabels(N.projectId);case 11:return he=u.sent,n((0,E.gu)(he)),y($),L(N),q(!1),u.abrupt("return");case 17:return(0,E.xC)(f.projectId).then(function(oe){Ke(oe)}),Ee(T[W]),te=T[W].taskId,E.Qp.getAnnotations(te).then(function(oe){xe(oe)}),u.next=23,E.Qp.getDatas(te);case 23:return ne=u.sent,Se(ne),G=ne[0],Be(G),u.next=29,E.Bl.getAnnotations(G.dataId);case 29:ae=u.sent,Ie(ae),n((0,E.JZ)(_,ae)),He("".concat(H,"/datas/").concat(G.dataId,"/image")),console.log("hereraasdf",_),q(!1),u.next=41;break;case 37:u.prev=37,u.t0=u.catch(0),console.log(u.t0),X.Z.parseError(u.t0,d.default);case 41:case"end":return u.stop()}},V,null,[[0,37]])})),x.apply(this,arguments)}M()},[W,f]),(0,r.jsxs)(a.Z,{className:P().classes,children:[(0,r.jsxs)(F.Z,{children:[(0,r.jsx)(h.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){ee.changeScale(.1)},children:"Zoom in"}),(0,r.jsx)(h.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){ee.changeScale(-.1)},children:"Zoom out"}),(0,r.jsx)(h.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){d.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,r.jsx)(h.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){We("mover"),d.default.info("You can move the image now.")},children:"Move"})]}),(0,r.jsx)("div",{id:"dr",className:P().mainStage,children:(0,r.jsxs)(C.Z,{tip:"loading",spinning:$e,children:[(0,r.jsx)("div",{className:P().draw,children:(0,r.jsx)(k.Z,{scale:ee.scale,currentTool:ye,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:pe})}),(0,r.jsx)("div",{className:P().pblock,children:(0,r.jsx)("div",{className:P().progress,children:(0,r.jsx)(g.Z,{percent:Re,status:"active"})})}),(0,r.jsx)("div",{className:P().prevTask,onClick:function(){Qe()}}),(0,r.jsx)("div",{className:P().nextTask,onClick:function(){ke()}})]})}),(0,r.jsxs)(F.Z,{disLoc:"right",children:[(0,r.jsx)(h.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,r.jsx)(h.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,r.jsx)("div",{className:P().rightSideBar,children:(0,r.jsx)(J.Z,{labels:_,selectedLabel:Te,onLabelSelect:function(x){Xe(x)},onLabelAdd:function(x){f!=null&&f.projectId&&(0,E.jc)(f.projectId,x,n)},onLabelDelete:function(x){(0,E.SP)(x,n)},onLabelModify:function(){}})})]})},z=Y}}]);
