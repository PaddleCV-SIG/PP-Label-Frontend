(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{72285:function(w){w.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},22351:function(w,U,s){"use strict";s.r(U),s.d(U,{default:function(){return sn}});var fn=s(57663),G=s(71577),vn=s(34669),K=s(54458),Z=s(2824),O=s(67294),W=s(72285),C=s.n(W),z=s(8088),y=s(61541),J=s(44434),V=s(5041),Q=s(57436),q=s(14836),_=s(29919),nn=s(91220),B=s(11849),N=s(65031),o=s(85893);function tn(t){var l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return l?{r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)}:null}function H(t,l){if(!(!t||!l))return{color:t,points:l}}function on(t,l,h,S,c,m,d){if(!t||!t.lines||!t.lines[0])return[(0,o.jsx)(o.Fragment,{})];var i=t.lines[0].points,u=t.lines[0].color,v=tn(u);if(!v)return[(0,o.jsx)(o.Fragment,{})];var j=(d==null?void 0:d.annotationId)==t.annotationId,x=j?.5:.1,g=void 0,M=[];return i.forEach(function(p,I){if(!g){g=p;return}M.push((0,o.jsx)(N.Cd,{onMouseDown:function(){c=="mover"&&m(t)},draggable:c=="mover",onDragMove:function(A){console.log("Circle onDrageMove");var R=A.evt.offsetX/S,D=A.evt.offsetY/S;i[I-1]=R,i[I]=D;var L=(0,B.Z)((0,B.Z)({},t),{},{lines:[{color:u,points:i}]});l(L)},onMouseOver:function(){console.log("Circle onMouseOver"),c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:g,y:p,radius:5,fill:u})),console.log(I,i),i.length>4&&i.splice(I+1,2),g=void 0}),[(0,o.jsxs)(N.ZA,{children:[(0,o.jsx)(N.UL,{onMouseOver:function(){c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){c=="mover"&&m(t)},stroke:u,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",x:i[0],y:i[1],width:i[2]-i[0],height:i[3]-i[1],closed:!0,fill:"rgba(".concat(v.r,", ").concat(v.g,", ").concat(v.b,", ").concat(x,")")}),M]},t.annotationId)]}function en(t){var l=0,h=(0,nn.Z)(t),S;try{for(h.s();!(S=h.n()).done;){var c=S.value;!c||c.annotationId>l&&(l=c.annotationId)}}catch(m){h.e(m)}finally{h.f()}return l}function rn(t){var l=function(d,i){var u,v=d.evt.offsetX/i,j=d.evt.offsetY/i,x=H((u=t.currentLabel)===null||u===void 0?void 0:u.color,[v,j]);!x||t.onAnnotationAdd({tool:"polygon",annotationId:en(t.annotations)+1,label:t.currentLabel,lines:[x]})},h=function(d,i){var u,v;if(!!t.currentAnnotation){var j=d.evt.offsetX/i,x=d.evt.offsetY/i,g=t.currentAnnotation.lines||[],M=H((u=t.currentLabel)===null||u===void 0?void 0:u.color,(v=g[0])===null||v===void 0?void 0:v.points.concat([j,x]));if(!!M){var p={tool:"polygon",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:[M]};t.onAnnotationModify(p)}}},S=function(d,i){t.currentTool=="polygon"&&(t.currentAnnotation?h(d,i):l(d,i))},c=function(){t.currentTool=="polygon"&&t.onMouseUp()};return{onMouseDown:S,onMouseMove:function(){},onMouseUp:c,createElementsFunc:on}}var P=40,an=function(){var l,h=(0,O.useState)(void 0),S=(0,Z.Z)(h,2),c=S[0],m=S[1],d=(0,O.useState)({color:"",name:""}),i=(0,Z.Z)(d,2),u=i[0],v=i[1],j=(0,O.useState)(),x=(0,Z.Z)(j,2),g=x[0],M=x[1],p=(0,O.useState)([]),I=(0,Z.Z)(p,2),f=I[0],A=I[1],R=(0,O.useState)(1),D=(0,Z.Z)(R,2),L=D[0],T=D[1],Y=function(n){n||T(1),n<.1||n>3?T(1):T(n)},b=function(n){M(n),n!=null&&n.label&&v(n.label)};(0,O.useEffect)(function(){localStorage.removeItem("history"),E([])},[]);function E(r,n){var e=localStorage.getItem("history"),a=e?JSON.parse(e):{index:-1,items:[]},$={currentAnnotation:n,annotations:r};if(JSON.stringify(a.items[a.index])!=JSON.stringify($)){var un=a.index>P?a.index-P:0,dn=a.items.splice(un,a.index==0?1:a.index+1);a.items=dn.concat([$]),a.index<=P?a.index++:a.index=P+1,localStorage.setItem("history",JSON.stringify(a))}}var ln=function(){var n=localStorage.getItem("history");if(!!n){var e=JSON.parse(n);if(!!e&&!(e.index>=e.items.length-1)){e.index++,localStorage.setItem("history",JSON.stringify(e));var a=e.items[e.index];M(a.currentAnnotation),A(a.annotations)}}},cn=function(){var n=localStorage.getItem("history");if(!!n){var e=JSON.parse(n);if(!(!e||!e.index)&&!(e.index<=0)){e.index--,localStorage.setItem("history",JSON.stringify(e));var a=e.items[e.index];M(a.currentAnnotation),A(a.annotations)}}},F=function(n){for(var e=[],a=0;a<f.length;a++)f[a].annotationId==n.annotationId?e.push(n):e.push(f[a]);b(n),A(e)},X=rn({currentLabel:u,currentTool:c,annotations:f,currentAnnotation:g,onAnnotationAdd:function(n){var e=f.concat([n]);A(e),g||b(n)},onAnnotationModify:F,onMouseUp:function(){E(f,g)}}),k=X;return(0,o.jsxs)(z.Z,{className:C().det,children:[(0,o.jsxs)(J.Z,{children:[(0,o.jsx)(_.Z,{active:c=="polygon",onClick:function(){m("polygon"),b(void 0)},children:"Polygon"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){Y(L+.1)},children:"Zoom in"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){Y(L-.1)},children:"Zoom out"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){m("mover")},children:"Move"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){cn()},children:"Undo"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){ln()},children:"Redo"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{id:"dr",className:C().mainStage,children:[(0,o.jsx)("div",{className:C().draw,children:(0,o.jsx)(Q.Z,{width:(l=document.getElementById("dr"))===null||l===void 0?void 0:l.clientWidth,scale:L,annotations:f,currentTool:c,currentAnnotation:g,setCurrentAnnotation:b,onAnnotationModify:F,onAnnotationModifyComplete:function(){E(f,g)},onMouseDown:k.onMouseDown,onMouseMove:k.onMouseMove,onMouseUp:k.onMouseUp,createPolygonFunc:X.createElementsFunc})}),(0,o.jsx)("div",{className:C().pblock,children:(0,o.jsx)("div",{className:C().progress,children:(0,o.jsx)(K.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(J.Z,{disLoc:"right",children:[(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(y.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"})]}),(0,o.jsxs)("div",{className:C().rightSideBar,children:[(0,o.jsx)("div",{className:C().determinOutline,children:(0,o.jsx)(G.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){b(void 0)},children:"Determine Outline"})}),(0,o.jsx)(V.Z,{selectedLabel:u,onLabelSelect:function(n){v(n),b(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(q.Z,{selectedAnnotation:g,annotations:f,onAnnotationSelect:function(n){n!=null&&n.delete||b(n)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(n){A(f.filter(function(e){return e.annotationId!=n.annotationId})),b(void 0)}})]})]})},sn=an}}]);
