(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[943],{13237:function(K){K.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___26yoA",toolBarButtonContainer:"toolBarButtonContainer___3TAcy",toolBarButton:"toolBarButton___utzQD",buttonText:"buttonText___10yo3",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___UC85Z",popover:"popover___V2uUa",slider:"slider___293AL",popoverLeft:"popoverLeft___2uQ3J"}},85024:function(K){K.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(K){K.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},26647:function(K){K.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",slider:"slider___ALra-",popoverLeft:"popoverLeft___15lGe"}},8978:function(K,$,n){"use strict";n.d($,{Z:function(){return tn}});var k=n(11849),H=n(2824),Y=n(91220),z=n(67294),b=n(85893);function _(e){if(!e||!e.width||!e.color||!e.points||e.points.length<2||e.frontendId==null)return"";var h=e.type=="rubber"?0:e.frontendId;return"".concat(e.width,",").concat(h,",").concat(e.points.join(","))}function u(e){var h,r=e.canvasRef,v=e.annotation,m=v.result;if(!m)return(0,b.jsx)(b.Fragment,{});var x=(h=r.current)===null||h===void 0?void 0:h.getContext("2d");if(!x)return(0,b.jsx)(b.Fragment,{});for(var j=[],t=0,g=0;g<m.length;g++)m.at(g)==","?(j.push(parseFloat(m.slice(t,g))),t=g+1):m.at(g)=="|"?(j.push(parseFloat(m.slice(t,g))),i(j,x,v),j=[],t=g+1):g==m.length-1&&(j.push(parseFloat(m.slice(t,m.length))),i(j,x,v));return(0,b.jsx)(b.Fragment,{})}function i(e,h,r){var v;if(e.length<4){console.log("found incorrect points:",e);return}var m=e[0],x=e[1];if(m==0){var j;I(h,e.slice(2),(j=r.label)===null||j===void 0?void 0:j.color);return}if(x==0){d(h,m,e.slice(2),void 0);return}d(h,m,e.slice(2),(v=r.label)===null||v===void 0?void 0:v.color)}function d(e,h,r,v){e.beginPath(),e.moveTo(r[0],r[1]);for(var m=0;m<=r.length/2-1;m++){var x=r[2*m],j=r[2*m+1];e.lineTo(x,j)}e.lineCap="round",e.lineJoin="round",e.lineWidth=h,v&&(e.strokeStyle=v),e.globalCompositeOperation=v?"source-over":"destination-out",e.stroke()}function I(e,h,r){e.globalCompositeOperation=r?"source-over":"destination-out",r&&(e.fillStyle=r);for(var v=0;v<=h.length/2-1;v++){var m=h[2*v],x=h[2*v+1];e.fillRect(m,x,1,1)}}function A(e){if(!e||e.length==0)return 0;var h=0,r=(0,Y.Z)(e),v;try{for(r.s();!(v=r.n()).done;){var m=v.value;m.frontendId>h&&(h=m.frontendId)}}catch(x){r.e(x)}finally{r.f()}return h}function en(e,h){return e=="rubber"||h==2?"rubber":"brush"}function tn(e){var h=(0,z.useState)(),r=(0,H.Z)(h,2),v=r[0],m=r[1],x=function(C){var M,J;if(!(e.currentTool!="brush"&&e.currentTool!="rubber"||!((M=e.currentLabel)!==null&&M!==void 0&&M.color)||!e.brushSize)){var w=C.mouseX,U=C.mouseY,X=en(e.currentTool,C.e.evt.button);console.log("frontendId: ",e.frontendIdOps.frontendId,"maxId:",A(e.annotations));var D=e.frontendIdOps.frontendId>0?e.frontendIdOps.frontendId:A(e.annotations)+1;D!=e.frontendIdOps.frontendId&&e.frontendIdOps.setFrontendId(D);var nn=_({width:e.brushSize||10,color:(J=e.currentLabel)===null||J===void 0?void 0:J.color,points:[w,U,w,U],type:X,frontendId:D});if(!!nn){m(X);var O={dataId:e.dataId,label:e.currentLabel,labelId:e.currentLabel.labelId,frontendId:D,result:nn,type:"brush"};e.onAnnotationAdd(O)}}},j=function(C){var M;if(!(!v||!e.currentAnnotation||!e.currentAnnotation.result||e.currentAnnotation.result.length<2||!((M=e.currentLabel)!==null&&M!==void 0&&M.color))){var J=C.mouseX,w=C.mouseY,U=e.currentAnnotation.result+",".concat(J,",").concat(w);e.onAnnotationModify((0,k.Z)((0,k.Z)({},e.currentAnnotation),{},{result:U}))}},t=function(){e.currentTool!="brush"&&e.currentTool!="rubber"||(m(void 0),e.onMouseUp())};return{onMouseDown:x,onMouseMove:j,onMouseUp:t,drawAnnotation:u}}},57406:function(K,$,n){"use strict";n.d($,{pL:function(){return H},oo:function(){return Y}});var k=n(91220);function H(_){var u=0;if(!_)return u;var i=(0,k.Z)(_),d;try{for(i.s();!(d=i.n()).done;){var I=d.value;!I||!I.frontendId||I.frontendId>u&&(u=I.frontendId)}}catch(A){i.e(A)}finally{i.f()}return u}function Y(_){var u=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(_);return u?{r:parseInt(u[1],16),g:parseInt(u[2],16),b:parseInt(u[3],16)}:null}function z(_){var u=_.toString(16);return u.length==1?"0"+u:u}function b(_,u,i){return"#"+z(_)+z(u)+z(i)}},14836:function(K,$,n){"use strict";n.d($,{Z:function(){return t}});var k=n(54421),H=n(38272),Y=n(57663),z=n(71577),b=n(91220),_=n(67294),u=n(56159),i=n.n(u),d=n(49111),I=n(19650),A=n(2824),en=n(11849),tn=n(85024),e=n.n(tn),h=n(63097),r=n(85893),v=function(C){var M=(0,en.Z)({},C.annotation),J=(0,_.useState)(M.invisible),w=(0,A.Z)(J,2),U=w[0],X=w[1],D=(0,_.useState)(0),nn=(0,A.Z)(D,2),O=nn[0],on=nn[1];(0,_.useEffect)(function(){X(C.annotation.invisible)},[C.annotation.invisible]);var V=(0,r.jsxs)(H.ZP.Item,{className:"".concat(e().listItem," ").concat(C.active?e().listItemActive:""),unselectable:"on",onClick:function(){C.onClick(M)},children:[(0,r.jsxs)(I.Z,{align:"center",size:5,children:[(0,r.jsx)("a",{className:e().eye,style:{backgroundImage:U?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(cn){cn.stopPropagation(),X(!U),C.onAnnotationModify(M)}})," ",(0,r.jsx)("span",{className:e().annotationId,children:M.frontendId}),(0,r.jsx)("span",{className:e().labelName,children:M.label.name}),(0,r.jsx)(h.Z,{color:M.label.color})]}),(0,r.jsx)("a",{className:e().delete,onClick:function(cn){cn.stopPropagation();var fn=new Date().getTime();fn-O<300||(on(fn),C.onAnnotationDelete(M))}})]});return V},m=v,x=n(48971),j=function(C){var M=(0,x.YB)(),J=M.formatMessage({id:"component.PPAnnotationList.annotationList"}),w=M.formatMessage({id:"component.PPAnnotationList.addAnnotation"}),U=new Set,X=[],D=(0,b.Z)(C.annotations),nn;try{for(D.s();!(nn=D.n()).done;){var O=nn.value;U.has(O.frontendId)||(X.push(O),U.add(O.frontendId))}}catch(on){D.e(on)}finally{D.f()}return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(H.ZP,{className:i().labelList,size:"large",header:(0,r.jsx)("div",{className:i().listHeader,children:J}),bordered:!0,dataSource:X,renderItem:function(V){var q;return(0,r.jsx)(m,{onClick:C.onAnnotationSelect,annotation:V,active:V.frontendId==((q=C.currAnnotation)===null||q===void 0?void 0:q.frontendId),onAnnotationDelete:C.onAnnotationDelete,onAnnotationModify:C.onAnnotationModify})},footer:function(){return C.onAnnotationAdd?(0,r.jsx)("div",{children:(0,r.jsx)(z.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){C.onAnnotationAdd()},block:!0,children:w})}):(0,r.jsx)("div",{})}})})},t=j},27992:function(K,$,n){"use strict";var k=n(20136),H=n(55241),Y=n(13062),z=n(71230),b=n(77883),_=n(70507),u=n(89032),i=n(15746),d=n(66126),I=n(75454),A=n(2824),en=n(67294),tn=n(61541),e=n(26647),h=n.n(e),r=n(85893),v=0,m=100,x=10,j=function(g){var C=(0,en.useState)(nn(g.size)),M=(0,A.Z)(C,2),J=M[0],w=M[1];function U(O){w(nn(O))}var X=g.minSize==null?v:g.minSize,D=g.maxSize==null?m:g.maxSize;function nn(O){return O==null?x:O<=X?X:O>=D?D:O}return(0,en.useEffect)(function(){U(g.size)},[g.size]),(0,r.jsxs)(H.Z,{overlayClassName:"".concat(h().popover," ").concat(g.disLoc=="left"?h().popoverLeft:""),placement:g.disLoc||"right",content:(0,r.jsxs)(z.Z,{children:[(0,r.jsx)(i.Z,{span:16,children:(0,r.jsx)(I.Z,{className:h().slider,value:J,max:D,min:X,onChange:function(on){var V;(V=g.onChange)===null||V===void 0||V.call(0,on)},tooltipVisible:!1})}),(0,r.jsx)(i.Z,{span:8,children:(0,r.jsx)(_.Z,{min:X,max:D,value:J,onChange:function(on){var V;(V=g.onChange)===null||V===void 0||V.call(0,on)},step:10})})]}),trigger:"hover",children:[" ",(0,r.jsx)(tn.Z,{imgSrc:g.imgSrc||"",onClick:g.onClick,active:g.active,children:g.children})]})};$.Z=j},10137:function(K,$,n){"use strict";var k=n(34669),H=n(54458),Y=n(67294),z=n(85893),b=function(u){var i,d;return(0,z.jsxs)("div",{className:"progress",children:[(0,z.jsx)(H.Z,{className:"progressBar",percent:Math.ceil(u.project.finished/((i=u.task.all)===null||i===void 0?void 0:i.length)*100),status:"active",showInfo:!1})," ",(0,z.jsxs)("span",{className:"progressDesc",children:["Current labeling ",u.task.currIdx==null?1:u.task.currIdx+1," of"," ",(d=u.task.all)===null||d===void 0?void 0:d.length,". Already labeled ",u.project.finished||0,"."]})]})};$.Z=b},91861:function(K,$,n){"use strict";n.d($,{Ad:function(){return z},k3:function(){return b},Vd:function(){return _},td:function(){return u}});var k=n(34792),H=n(48086),Y=40;function z(){localStorage.removeItem("history"),b([])}function b(i){var d=localStorage.getItem("history"),I=d?JSON.parse(d):{index:-1,items:[]};if(JSON.stringify(I.items[I.index])!=JSON.stringify(i)){var A=I.index>Y?I.index-Y:0,en=I.items.splice(A,I.index==0?1:I.index+1);I.items=en.concat([i]),I.index<=Y?I.index++:I.index=Y+1,localStorage.setItem("history",JSON.stringify(I))}}function _(){var i=localStorage.getItem("history");if(!!i){var d=JSON.parse(i);if(!!d){if(d.index>=d.items.length-1){H.default.error("No next history!");return}return d.index++,localStorage.setItem("history",JSON.stringify(d)),d.items[d.index]}}}function u(){var i=localStorage.getItem("history");if(!!i){var d=JSON.parse(i);if(console.log("history",d),!d||!d.index||d.index<=1){H.default.error("No previous history!");return}return d.index--,localStorage.setItem("history",JSON.stringify(d)),d.items[d.index]}}},89943:function(K,$,n){"use strict";n.r($),n.d($,{MOST_HISTORY_STEPS:function(){return yn},default:function(){return bn}});var k=n(11849),H=n(57663),Y=n(71577),z=n(34792),b=n(48086),_=n(91220),u=n(2824),i=n(67294),d=n(48971),I=n(8088),A=n(61541),en=n(44434),tn=n(27992),e=n(5041),h=n(57436),r=n(14836),v=n(91861),m=n(8978),x=n(65031),j=n(57406),t=n(85893);function g(a,y){if(!(!a||!y))return y.join(",")}function C(a){var y,l=a.annotation;if(!l||!l.result||l.result.length<2||!((y=l.label)!==null&&y!==void 0&&y.color))return(0,t.jsx)(t.Fragment,{});var F=l.result.split(",").map(Number),W=l.label.color,E=(0,j.oo)(W);if(!E)return(0,t.jsx)(t.Fragment,{});var Q=.3,Z=void 0,L=[];return F.forEach(function(c,S){if(!Z){Z=c;return}L.push((0,t.jsx)(x.Cd,{onMouseDown:function(){a.currentTool=="editor"&&a.onSelect(l)},draggable:a.currentTool=="editor",onDragMove:function(T){var sn;T.cancelBubble=!0;var R=(sn=a.stageRef)===null||sn===void 0?void 0:sn.current,P=R.findOne(".baseImage"),B=!1,G=T.target.x();G>P.width()/2&&(G=P.width()/2,B=!0),G<-P.width()/2&&(G=-P.width()/2,B=!0);var ln=T.target.y();ln>P.height()/2&&(ln=P.height()/2,B=!0),ln<-P.height()/2&&(ln=-P.height()/2,B=!0),B&&T.target.setPosition({x:G,y:ln}),F[S-1]=G,F[S]=ln;var dn=(0,k.Z)((0,k.Z)({},l),{},{result:F.join(",")});a.onDrag(dn)},onMouseOver:function(){var T;a.currentTool=="editor"&&(T=a.stageRef)!==null&&T!==void 0&&T.current&&(a.stageRef.current.container().style.cursor="cell")},onMouseOut:function(){var T;(T=a.stageRef)!==null&&T!==void 0&&T.current&&(a.stageRef.current.container().style.cursor="default")},x:Z,y:c,radius:5/a.scale,fill:W})),Z=void 0}),(0,t.jsxs)(x.ZA,{children:[(0,t.jsx)(x.x1,{onMouseOver:function(){a.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){a.currentTool=="editor"&&a.onSelect(l)},stroke:W,strokeWidth:2/a.scale,globalCompositeOperation:"source-over",lineCap:"round",points:F,tension:0,closed:!0,fill:"rgba(".concat(E.r,", ").concat(E.g,", ").concat(E.b,", ").concat(Q,")")}),L]},l.frontendId)}function M(a){var y=0;if(!a)return y;var l=(0,_.Z)(a),F;try{for(l.s();!(F=l.n()).done;){var W=F.value;!W||!W.frontendId||W.frontendId>y&&(y=W.frontendId)}}catch(E){l.e(E)}finally{l.f()}return y}function J(a){var y=function(Q,Z){var L,c,S=g((L=a.currentLabel)===null||L===void 0?void 0:L.color,[Q,Z]);!S||(console.log(S),a.onAnnotationAdd({dataId:a.dataId,type:"polygon",frontendId:M(a.annotations)+1,label:a.currentLabel,labelId:(c=a.currentLabel)===null||c===void 0?void 0:c.labelId,result:S}))},l=function(Q,Z){var L;if(!(!a.currentAnnotation||!a.currentAnnotation.result||!((L=a.currentLabel)!==null&&L!==void 0&&L.color))){var c=a.currentAnnotation.result+",".concat(Q,",").concat(Z),S=(0,k.Z)((0,k.Z)({},a.currentAnnotation),{},{result:c});a.modifyAnnoByFrontendId(S)}},F=function(Q){if(a.currentTool=="polygon"){var Z=Q.mouseX+Q.offsetX,L=Q.mouseY+Q.offsetY;console.log("currentAnnotation:",a.currentAnnotation),a.currentAnnotation?l(Z,L):y(Z,L)}},W=function(){a.currentTool=="polygon"&&a.onMouseUp&&a.onMouseUp()};return{onMouseDown:F,onMouseMove:function(){},onMouseUp:W,drawAnnotation:C}}var w=n(10137),U=n(45194),X=n(20136),D=n(55241),nn=n(47673),O=n(24044),on=n(3182),V=n(9715),q=n(93766),cn=n(94043),fn=n.n(cn),In=n(37071),An=n(13237),mn=n.n(An),Mn=function(y){var l=(0,U.Gd)(i.useState),F=In.Z.getQueryVariable("projectId"),W=(0,U.RZ)(i.useState),E=q.Z.useForm(),Q=(0,u.Z)(E,1),Z=Q[0];(0,i.useEffect)(function(){function c(){return S.apply(this,arguments)}function S(){return S=(0,on.Z)(fn().mark(function an(){var T,sn,R;return fn().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,U.bo)();case 2:if(B.sent){B.next=4;break}return B.abrupt("return");case 4:if(l.getAll(),F){B.next=8;break}return b.default.error("Machine Learning settings are specific to every project. Please choose a project first."),B.abrupt("return");case 8:return B.next=10,l.getCurr(F);case 10:R=B.sent,R!=null&&(T=R.otherSettings)!==null&&T!==void 0&&T.mlBackendUrl&&W.setMlBackendUrl(R==null||(sn=R.otherSettings)===null||sn===void 0?void 0:sn.mlBackendUrl);case 12:case"end":return B.stop()}},an)})),S.apply(this,arguments)}c()},[]),(0,i.useEffect)(function(){if(!!l.curr){var c=l.curr.otherSettings?l.curr.otherSettings:{},S=c.models&&c.perviousModel?c.models[c.perviousModel]:{},an={mlBackendUrl:c.mlBackendUrl,modelName:c.perviousModel,trainBatchSize:S.trainBatchSize};Z.setFieldsValue(an),c!=null&&c.mlBackendUrl&&W.setMlBackendUrl(c.mlBackendUrl)}},[l.curr]);function L(c){if(console.log("saveMlsettings",l.curr,c),!l.curr){b.default.error("Please select model first!");return}l.curr.otherSettings||(l.curr.otherSettings={});var S=l.curr.otherSettings.models?l.curr.otherSettings.models:{};S[c.modelName]=c,l.curr.otherSettings.mlBackendUrl=Z.getFieldValue("mlBackendUrl"),l.curr.otherSettings.perviousModel=c.modelName,l.curr.otherSettings.models=S,l.update(l.curr.projectId,{otherSettings:l.curr.otherSettings}),b.default.info("Ml setting saved. Let's start trainig or inference!")}return(0,t.jsxs)(D.Z,{overlayClassName:"".concat(mn().popover," ").concat(mn().popoverLeft),placement:"left",content:(0,t.jsxs)(q.Z,{form:Z,layout:"horizontal",size:"large",onFinish:function(S){console.log("form finish",S),L(S)},hidden:l.curr==null,children:[(0,t.jsx)(q.Z.Item,{name:"mlBackendUrl",label:"ML Backend URL",labelCol:{span:6},wrapperCol:{span:18},style:{fontSize:"1.5rem"},children:(0,t.jsx)(O.Z,{placeholder:"http://127.0.0.1:1234/model"})}),(0,t.jsx)(q.Z.Item,{name:"ml_model_abs_path",label:"Model Path",labelCol:{span:6},wrapperCol:{span:18},style:{fontSize:"1.5rem"},children:(0,t.jsx)(O.Z,{placeholder:"Absolute path"})}),(0,t.jsx)(q.Z.Item,{name:"ml_weight_abs_path",label:"Weight Path",labelCol:{span:6},wrapperCol:{span:18},style:{fontSize:"1.5rem"},children:(0,t.jsx)(O.Z,{placeholder:"Absolute path"})}),(0,t.jsx)(q.Z.Item,{wrapperCol:{span:16,offset:6},children:(0,t.jsx)(Y.Z,{htmlType:"submit",type:"primary",style:{height:"2.5rem",width:"48%"},block:!0,children:"Save"})})]}),trigger:"hover",children:[" ",(0,t.jsx)(A.Z,{imgSrc:y.imgSrc||"",onClick:y.onClick,active:y.active,children:y.children})]})},_n=Mn,yn=40,Sn=function(){var y,l=(0,i.useState)(0),F=(0,u.Z)(l,2),W=F[0],E=F[1],Q=(0,i.useState)(10),Z=(0,u.Z)(Q,2),L=Z[0],c=Z[1],S=(0,i.useState)(60),an=(0,u.Z)(S,2),T=an[0],sn=an[1],R=(0,U.$L)(i.useState,i.useEffect,{effectTrigger:{postTaskChange:function(){return(0,v.Ad)()}},label:{oneHot:!0,postSelect:function(){f.setCurr(void 0),E(0)},preUnsetCurr:xn},tool:{defaultTool:"mover"},task:{push:!0}}),P=R.tool,B=R.task,G=R.data,ln=R.project,dn=R.scale,un=R.label,f=R.annotation;function xn(){f.setCurr(void 0),E(0),P.setCurr("mover")}var p=function(o){f.setCurr(o),o!=null&&o.frontendId?E(o.frontendId):E(0)};(0,i.useEffect)(function(){(0,v.Ad)()},[]),(0,i.useEffect)(function(){var s=setInterval(function(){var o;console.log("triggered!",G),f.pushToBackend((o=G.curr)===null||o===void 0?void 0:o.dataId)},2e4);return function(){clearInterval(s)}},[f,G,G.curr]);var Bn=function(o){!o||(f.all.pop(),f.all.push(o),p(o),f.setAll(f.all))},gn=function(o){var rn=[],vn=(0,_.Z)(f.all),Pn;try{for(vn.s();!(Pn=vn.n()).done;){var Cn=Pn.value;Cn.frontendId==o.frontendId?rn.push(o):rn.push(Cn)}}catch(Ln){vn.e(Ln)}finally{vn.f()}p(o),f.setAll(rn)},hn={dataId:(y=G.curr)===null||y===void 0?void 0:y.dataId,currentLabel:un.curr,brushSize:L,scale:dn.curr,currentTool:P.curr,annotations:f.all,currentAnnotation:f.curr,onAnnotationAdd:function(o){var rn=f.all.concat([o]);f.setAll(rn),p(o)},onAnnotationModify:Bn,modifyAnnoByFrontendId:gn,onMouseUp:function(){(0,v.k3)({annos:f.all,currAnno:f.curr})},frontendIdOps:{frontendId:W,setFrontendId:E}},N=(0,d.YB)(),jn=(0,m.Z)(hn),On=J(hn),En={polygon:On,brush:jn};return(0,t.jsxs)(I.Z,{className:"segment",children:[(0,t.jsxs)(en.Z,{children:[(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/polygon.png",active:P.curr=="polygon",onClick:function(){if(!un.curr){b.default.error("Please select a label first");return}P.setCurr("polygon"),p(void 0)},children:N.formatMessage({id:"pages.toolBar.polygon"})}),(0,t.jsx)(A.Z,{active:P.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){P.setCurr("editor"),p(void 0)},children:N.formatMessage({id:"pages.toolBar.edit"})}),(0,t.jsx)(tn.Z,{imgSrc:"./pics/buttons/brush.png",size:L,active:P.curr=="brush",onClick:function(){if(!un.curr){b.default.error("Please select a label first");return}P.curr!="rubber"&&P.curr!="brush"&&p(void 0),P.setCurr("brush")},onChange:function(o){c(o)},children:N.formatMessage({id:"pages.toolBar.brush"})}),(0,t.jsx)(tn.Z,{size:L,active:P.curr=="rubber",onClick:function(){P.curr!="rubber"&&P.curr!="brush"&&p(void 0),P.setCurr("rubber")},onChange:function(o){c(o)},imgSrc:"./pics/buttons/rubber.png",children:N.formatMessage({id:"pages.toolBar.rubber"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){dn.change(.1)},children:N.formatMessage({id:"pages.toolBar.zoomIn"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){dn.change(-.1)},children:N.formatMessage({id:"pages.toolBar.zoomOut"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){var o;f.pushToBackend((o=G.curr)===null||o===void 0?void 0:o.dataId)},children:N.formatMessage({id:"pages.toolBar.save"})}),(0,t.jsx)(A.Z,{active:P.curr=="mover",imgSrc:"./pics/buttons/move.png",onClick:function(){P.setCurr("mover")},children:N.formatMessage({id:"pages.toolBar.move"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var o=(0,v.td)();o&&(f.setAll(o.annos),p(o.currAnno))},children:N.formatMessage({id:"pages.toolBar.unDo"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var o=(0,v.Vd)();o&&(f.setAll(o.annos),p(o.currAnno))},children:N.formatMessage({id:"pages.toolBar.reDo"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){f.setAll([]),f.setCurr(void 0)},children:N.formatMessage({id:"pages.toolBar.clearMark"})})]}),(0,t.jsxs)("div",{id:"dr",className:"mainStage",children:[(0,t.jsx)("div",{className:"draw",children:(0,t.jsx)(h.Z,{scale:dn.curr,annotations:f.all,currentTool:P.curr,currentAnnotation:f.curr,setCurrentAnnotation:p,onAnnotationModify:gn,onAnnotationModifyComplete:function(){(0,v.k3)({annos:f.all,currAnno:f.curr})},frontendIdOps:{frontendId:W,setFrontendId:E},imgSrc:G.imgSrc,transparency:T,onAnnotationAdd:function(o){var rn=f.all.concat([o]);f.setAll(rn),f.curr||p(o)},drawTool:En})}),(0,t.jsx)("div",{className:"pblock",children:(0,t.jsx)(w.Z,{task:B,project:ln})}),(0,t.jsx)("div",{className:"prevTask",onClick:function(){!B.prevTask()||p(void 0)}}),(0,t.jsx)("div",{className:"nextTask",onClick:function(){!B.nextTask()||p(void 0)}})]}),(0,t.jsxs)(en.Z,{disLoc:"right",children:[(0,t.jsx)(_n,{imgSrc:"./pics/buttons/intelligent_interaction.png",onClick:function(){return setShowPPAIModal(!0)},children:N.formatMessage({id:"pages.toolBar.interactor"})}),(0,t.jsx)(tn.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:N.formatMessage({id:"pages.toolBar.segmentThreshold"})}),(0,t.jsx)(tn.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",size:T,maxSize:100,minSize:0,onChange:function(o){sn(o)},children:N.formatMessage({id:"pages.toolBar.transparency"})}),(0,t.jsx)(tn.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:N.formatMessage({id:"pages.toolBar.visualRadius"})}),(0,t.jsx)(A.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){d.m8.push("/project_overview?projectId=".concat(ln.curr.projectId))},children:"Project Overview"})]}),(0,t.jsxs)("div",{className:"rightSideBar",children:[(0,t.jsx)("div",{className:"determinOutline",children:(0,t.jsx)(Y.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){p(void 0)},children:N.formatMessage({id:"pages.toolBar.determineOutline"})})}),(0,t.jsx)(e.Z,{hideColorPicker:!1,labels:un.all,activeIds:un.activeIds,onLabelSelect:un.onSelect,onLabelModify:function(){},onLabelDelete:un.remove,onLabelAdd:function(o){un.create((0,k.Z)((0,k.Z)({},o),{},{projectId:ln.curr.projectId})).then(function(rn){p(void 0),un.setCurr(rn)})}}),(0,t.jsx)(r.Z,{currAnnotation:f.curr,annotations:f.all,onAnnotationSelect:function(o){o!=null&&o.delete||p(o)},onAnnotationAdd:function(){p(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(o){f.setAll(f.all.filter(function(rn){return rn.frontendId!=o.frontendId})),p(void 0)}})]})]})},bn=Sn}}]);
