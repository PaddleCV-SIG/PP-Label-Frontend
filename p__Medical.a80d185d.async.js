(self.webpackChunkpp_labeling_frontend=self.webpackChunkpp_labeling_frontend||[]).push([[454],{57560:function(A){A.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(A){A.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},8982:function(A){A.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(A){A.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},43801:function(A,D,t){"use strict";t.d(D,{Z:function(){return L}});var W=t(11849),Z=t(2824),U=t(91220),I=t(67294),z=t(65031),y=t(85893);function x(n,u,c,d){if(!(!n||!u||!c||!d))return{width:n,color:u,points:c,tool:d}}function h(n,u){if(!n||!n.lines)return[(0,y.jsx)(y.Fragment,{})];var c=[],d=(0,U.Z)(n.lines),v;try{for(d.s();!(v=d.n()).done;){var m=v.value;!m.width||!m.color||!m.points||!m.tool||c.push((0,y.jsx)(z.x1,{stroke:m.color,strokeWidth:m.width,globalCompositeOperation:m.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:m.points,tension:.01,onClick:function(){return u(n)},onTap:function(){return u(n)}}))}}catch(f){d.e(f)}finally{d.f()}return c}function p(n,u){return n=="rubber"||u==2?"rubber":"brush"}function E(n){var u=0,c=(0,U.Z)(n),d;try{for(c.s();!(d=c.n()).done;){var v=d.value;!v||v.annotationId>u&&(u=v.annotationId)}}catch(m){c.e(m)}finally{c.f()}return u}function L(n){var u=(0,I.useState)(),c=(0,Z.Z)(u,2),d=c[0],v=c[1],m=function(P,S){var C;if(console.log(n.currentTool),!(n.currentTool!="brush"&&n.currentTool!="rubber")){var M=P.evt.offsetX/S,g=P.evt.offsetY/S,a=p(n.currentTool,P.evt.button),i=x(n.brushSize||10,(C=n.currentLabel)===null||C===void 0?void 0:C.color,[M,g,M,g],a);if(!!i)if(v(a),n.currentAnnotation){var T,R={tool:"brush",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:(T=n.currentAnnotation.lines)===null||T===void 0?void 0:T.concat([i])};n.onAnnotationModify(R)}else{if(a=="rubber")return;n.onAnnotationAdd({tool:"brush",annotationId:E(n.annotations)+1,label:n.currentLabel,lines:[i]})}}},f=function(P,S){var C;if(!(!d||!n.currentAnnotation)){var M=P.evt.offsetX/S,g=P.evt.offsetY/S,a=[M,g],i=[];(C=n.currentAnnotation)!==null&&C!==void 0&&C.lines&&(a=n.currentAnnotation.lines[n.currentAnnotation.lines.length-1].points.concat(a),i=n.currentAnnotation.lines);var T=x(n.brushSize||10,n.currentLabel.color,a,d);!T||(i.pop(),i.push(T),n.onAnnotationModify((0,W.Z)((0,W.Z)({},n.currentAnnotation),{},{lines:i})))}},s=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||(v(void 0),n.onMouseUp())};return{onMouseDown:m,onMouseMove:f,onMouseUp:s,createElementsFunc:h}}},58967:function(A,D,t){"use strict";var W=t(20136),Z=t(55241),U=t(77883),I=t(70507),z=t(57663),y=t(71577),x=t(2824),h=t(67294),p=t(61541),E=t(57560),L=t.n(E),n=t(85893),u=1,c=50,d=10;function v(f){return f?f<=u?u:f>=c?c:f:d}var m=function(s){var j=(0,h.useState)(v(s.size)),P=(0,x.Z)(j,2),S=P[0],C=P[1],M=function(a){C(v(a))};return(0,h.useEffect)(function(){M(s.size)},[s.size]),(0,n.jsxs)(Z.Z,{overlayClassName:L().popover,placement:"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{type:"text",onClick:function(){var a,i=v(S-1);M(i),(a=s.onChange)===null||a===void 0||a.call(0,i)},children:"-"}),(0,n.jsx)(I.Z,{min:u,max:c,value:S,onChange:function(a){var i;(i=s.onChange)===null||i===void 0||i.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(y.Z,{type:"text",onClick:function(){var a,i=v(S+1);M(i),(a=s.onChange)===null||a===void 0||a.call(0,i)},children:"+"})]}),trigger:s.active?"hover":"click",children:[" ",(0,n.jsx)(p.Z,{active:s.active,imgSrc:s.imgSrc||"./pics/buttons/brush.png",onClick:s.onClick,children:s.children||"Brush"})]})};D.Z=m},27992:function(A,D,t){"use strict";var W=t(20136),Z=t(55241),U=t(77883),I=t(70507),z=t(57663),y=t(71577),x=t(2824),h=t(67294),p=t(61541),E=t(26647),L=t.n(E),n=t(85893),u=1,c=100,d=10;function v(f){return f?f<=u?u:f>=c?c:f:d}var m=function(s){var j=(0,h.useState)(v(s.size)),P=(0,x.Z)(j,2),S=P[0],C=P[1],M=function(a){C(v(a))};return(0,h.useEffect)(function(){M(s.size)},[s.size]),(0,n.jsxs)(Z.Z,{overlayClassName:"".concat(L().popover," ").concat(s.disLoc=="left"?L().popoverLeft:""),placement:s.disLoc||"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{type:"text",onClick:function(){var a,i=v(S-1);M(i),(a=s.onChange)===null||a===void 0||a.call(0,i)},children:"-"}),(0,n.jsx)(I.Z,{min:u,max:c,value:S,onChange:function(a){var i;(i=s.onChange)===null||i===void 0||i.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(y.Z,{type:"text",onClick:function(){var a,i=v(S+1);M(i),(a=s.onChange)===null||a===void 0||a.call(0,i)},children:"+"})]}),trigger:"hover",children:[" ",(0,n.jsx)(p.Z,{imgSrc:s.imgSrc,onClick:s.onClick,children:s.children})]})};D.Z=m},21028:function(A,D,t){"use strict";t.r(D),t.d(D,{default:function(){return fn}});var W=t(57663),Z=t(71577),U=t(20136),I=t(55241),z=t(34669),y=t(54458),x=t(2824),h=t(67294),p=t(75721),E=t.n(p),L=t(8088),n=t(61541),u=t(44434),c=t(58967),d=t(27992),v=t(5041),m=t(57436),f=t(14836),s=t(29919),j=t(43801),P=t(13931),S=t(13062),C=t(71230),M=t(66126),g=t(75454),a=t(89032),i=t(15746),T=t(8982),R=t.n(T),o=t(85893),dn=function(N){return(0,o.jsxs)("div",{children:[(0,o.jsxs)(C.Z,{children:[(0,o.jsx)(i.Z,{span:6,className:R().Pop1,children:(0,o.jsx)("span",{children:"Ww"})}),(0,o.jsx)(i.Z,{span:18,className:R().Pop2,children:(0,o.jsx)(g.Z,{min:1,max:N.wwValue||100,defaultValue:37})})]}),(0,o.jsxs)(C.Z,{children:[(0,o.jsx)(i.Z,{span:6,className:R().Pop1,children:(0,o.jsx)("span",{children:"Wl"})}),(0,o.jsx)(i.Z,{span:18,className:R().Pop2,children:(0,o.jsx)(g.Z,{min:1,max:N.wlValue||100,defaultValue:37})})]})]})},vn=dn,_n=function(){var N=(0,h.useState)(void 0),q=(0,x.Z)(N,2),O=q[0],X=q[1],hn=(0,h.useState)({color:"",name:""}),nn=(0,x.Z)(hn,2),V=nn[0],tn=nn[1],gn=(0,h.useState)(),en=(0,x.Z)(gn,2),K=en[0],$=en[1],Pn=(0,h.useState)([]),on=(0,x.Z)(Pn,2),b=on[0],Y=on[1],Sn=(0,h.useState)(10),rn=(0,x.Z)(Sn,2),F=rn[0],an=rn[1],Cn=(0,h.useState)(1),sn=(0,x.Z)(Cn,2),G=sn[0],Q=sn[1],ln=function(e){e||Q(1),e<.1||e>3?Q(1):Q(e)},B=function(e){$(e),e!=null&&e.label&&tn(e.label)},J=function(e){Y(e)};(0,h.useEffect)(function(){localStorage.removeItem("history")},[]);function k(l,e){var r=localStorage.getItem("history"),_=r?JSON.parse(r):{index:-1,items:[]};console.log("history before set: ");var yn=JSON.stringify(_);console.log(yn);var w={currentAnnotation:e,annotations:l};if(JSON.stringify(_.items[_.index])==JSON.stringify(w)){console.log("equal with latest, do not add to history");return}var cn=_.items.splice(0,_.index==0?1:_.index+1);console.log("itemsToKeep: ".concat(JSON.stringify(cn))),console.log("itemsToAdd: ".concat(JSON.stringify(w))),_.items=cn.concat([w]),_.index++,localStorage.setItem("history",JSON.stringify(_)),console.log("history after set: "),console.log(JSON.stringify(_))}var xn=function(){var e=localStorage.getItem("history");if(!e){console.log("no historyStr, skip.");return}var r=JSON.parse(e);if(!!r){if(r.index>=r.items.length-1){console.log("already latest, skip. history.index:".concat(r.index," history.items.length:").concat(r.items.length));return}r.index++,localStorage.setItem("history",JSON.stringify(r)),console.log("After forward. history:".concat(JSON.stringify(r)));var _=r.items[r.index];$(_.currentAnnotation),Y(_.annotations)}},En=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!(!r||!r.index)&&!(r.index<=0)){r.index--,localStorage.setItem("history",JSON.stringify(r));var _=r.items[r.index];console.log("after backward: ".concat(JSON.stringify(r))),$(_.currentAnnotation),Y(_.annotations)}}},un=function(e){for(var r=[],_=0;_<b.length;_++)b[_].annotationId==e.annotationId?r.push(e):r.push(b[_]);B(e),J(r),k(r,e)},Mn=(0,j.Z)({currentLabel:V,brushSize:F,currentTool:O,annotations:b,currentAnnotation:K,onAnnotationAdd:function(e){var r=b.concat([e]);J(r),K||B(e),k(r,e)},onAnnotationModify:un}),An=(0,P.Z)({currentLabel:V,brushSize:F,currentTool:O,annotations:b,currentAnnotation:K,onAnnotationAdd:function(e){var r=b.concat([e]);J(r),K||B(e),k(r,e)},onAnnotationModify:un}),H=O=="polygon"?An:Mn;return(0,o.jsxs)(L.Z,{className:E().segment,children:[(0,o.jsxs)(u.Z,{children:[(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Intelligent Interaction"}),(0,o.jsx)(s.Z,{active:O=="polygon",onClick:function(){X("polygon"),B(void 0)},children:"Polygon"}),(0,o.jsx)(c.Z,{size:F,active:O=="brush",onClick:function(){O!="rubber"&&O!="brush"&&B(void 0),X("brush")},onChange:function(e){an(e)},children:"Brush"}),(0,o.jsx)(c.Z,{size:F,active:O=="rubber",onClick:function(){O!="rubber"&&O!="brush"&&B(void 0),X("rubber")},onChange:function(e){an(e)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){ln(G+.1)},children:"Zoom in"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){ln(G-.1)},children:"Zoom out"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",children:"Move"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){En()},children:"Undo"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){xn()},children:"Redo"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{className:E().mainStage,children:[(0,o.jsx)("div",{className:E().draw,children:(0,o.jsx)(m.Z,{scale:G,annotations:b,onMouseDown:H.onMouseDown,onMouseMove:H.onMouseMove,onMouseUp:H.onMouseUp,createElementsFunc:H.createElementsFunc})}),(0,o.jsx)("div",{className:E().pblock,children:(0,o.jsx)("div",{className:E().progress,children:(0,o.jsx)(y.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(u.Z,{disLoc:"right",children:[(0,o.jsx)(d.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,o.jsx)(d.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,o.jsx)(d.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"}),(0,o.jsxs)(I.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,o.jsx)(vn,{}),trigger:"hover",children:[" ",(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:"Medical Setting"})]})]}),(0,o.jsxs)("div",{className:E().rightSideBar,children:[(0,o.jsx)("div",{className:E().determinOutline,children:(0,o.jsx)(Z.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){B(void 0)},children:"Determine Outline"})}),(0,o.jsx)(v.Z,{selectedLabel:V,onLabelSelect:function(e){tn(e),B(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(f.Z,{selectedAnnotation:K,annotations:b,onAnnotationSelect:function(e){e!=null&&e.delete||B(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){J(b.filter(function(r){return r.annotationId!=e.annotationId})),B(void 0)}})]})]})},fn=_n}}]);
