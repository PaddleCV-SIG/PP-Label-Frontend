(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[507],{52822:function(u){u.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(u){u.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",delete:"delete___WHPf2",listItemActive:"listItemActive___3FRb7"}},56131:function(u){u.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(u){u.exports={container:"container___G0FNe"}},80961:function(u){u.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(u){u.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},63097:function(u,b,e){"use strict";var N=e(20136),_=e(55241),v=e(2824),d=e(67294),i=e(52822),r=e.n(i),f=e(63144),l=e(85893),I=function(F){var H=(0,d.useState)(F.color||"#FFF"),n=(0,v.Z)(H,2),x=n[0],a=n[1];return(0,d.useEffect)(function(){a(F.color||"#FFF")},[F]),F.changeable?(0,l.jsx)(_.Z,{getPopupContainer:function(S){return S.parentElement||document.body},overlayClassName:r().popover,openClassName:r().popoverOpenClassName,placement:"bottom",content:(0,l.jsx)(f.xS,{disableAlpha:!0,color:x,onChange:function(S){a(S.hex)},onChangeComplete:F.onChange}),trigger:"click",children:(0,l.jsx)("div",{className:r().roundBall,style:{backgroundColor:x}})}):(0,l.jsx)("div",{className:r().roundBall,style:{backgroundColor:x}})};b.Z=I},5041:function(u,b,e){"use strict";e.d(b,{Z:function(){return ne}});var N=e(54421),_=e(38272),v=e(57663),d=e(71577),i=e(2824),r=e(67294),f=e(56131),l=e.n(f),I=e(49111),w=e(19650),F=e(11849),H=e(5882),n=e.n(H),x=e(63097),a=e(85893),X=function(o){var s=(0,F.Z)({},o.label),B=(0,r.useState)(s.invisible),h=(0,i.Z)(B,2),j=h[0],U=h[1],E=(0,r.useState)(0),O=(0,i.Z)(E,2),P=O[0],y=O[1],C=o.hideEye?" ":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("a",{className:n().eye,style:{backgroundImage:j?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(T){T.stopPropagation(),U(!j),o.onLabelModify(s)}})," "]}),L=o.hideColorPicker?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(x.Z,{color:s.color,changeable:!0,onChange:function(T){s.color=T.hex,o.onLabelModify(s)}}),Z=(0,a.jsxs)(_.ZP.Item,{className:"".concat(n().listItem," ").concat(o.active?n().listItemActive:""),unselectable:"on",onClick:function(){o.onClick(s)},children:[(0,a.jsxs)(w.Z,{align:"center",size:5,children:[C,s.name,L]}),(0,a.jsx)("a",{className:n().delete,onClick:function(T){T.stopPropagation();var K=new Date().getTime();K-P<300||(y(K),o.onLabelDelete(s))}})]});return Z},S=X,t=e(71194),J=e(50146),q=e(47673),G=e(24044),ee=e(9715),D=e(93766),g=e(48971),Q=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],k=function(o){var s,B,h=(0,g.YB)(),j=h.formatMessage({id:"component.PPAddLabelModal.selectColor"}),U=h.formatMessage({id:"component.PPAddLabelModal.addLabel"}),E=h.formatMessage({id:"component.PPAddLabelModal.labelName"}),O=h.formatMessage({id:"component.PPCreater.cancel"}),P=h.formatMessage({id:"component.PPSegMode.ok"}),y=(0,r.useState)(((s=o.defaultLabel)===null||s===void 0?void 0:s.color)||Q[o.order||0]),C=(0,i.Z)(y,2),L=C[0],Z=C[1];(0,r.useEffect)(function(){var A;Z(((A=o.defaultLabel)===null||A===void 0?void 0:A.color)||Q[o.order||0])},[o]);var R=o.hideColorPicker?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(D.Z.Item,{label:j,name:"color",children:(0,a.jsx)(x.Z,{color:L,changeable:!0,onChange:function(M){Z(M.hex)}})}),T=D.Z.useForm(),K=(0,i.Z)(T,1),W=K[0];return(0,a.jsx)(J.Z,{title:U,visible:o.visible,onCancel:o.onCancel,footer:null,children:(0,a.jsxs)(D.Z,{form:W,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(B=o.defaultLabel)===null||B===void 0?void 0:B.name},onFinish:function(M){var z={name:M.labelname,color:L};o.onLabelAdd(z),W.resetFields()},autoComplete:"off",children:[(0,a.jsx)(D.Z.Item,{label:E,name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,a.jsx)(G.Z,{})}),R,(0,a.jsx)(D.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsxs)(w.Z,{children:[(0,a.jsx)(d.Z,{onClick:function(){var M;(M=o.onCancel)===null||M===void 0||M.call(0),W.resetFields()},children:O}),(0,a.jsx)(d.Z,{type:"primary",htmlType:"submit",children:P})]})})]})})},$=k,p=function(o){var s,B=(0,g.YB)(),h=B.formatMessage({id:"component.PPLabelList.addLabel"}),j=B.formatMessage({id:"component.PPLabelList.labelList"}),U=(0,r.useState)(!1),E=(0,i.Z)(U,2),O=E[0],P=E[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.ZP,{className:l().labelList,size:"large",header:(0,a.jsx)("div",{className:l().listHeader,children:j}),footer:(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){P(!0)},block:!0,children:h})}),bordered:!0,dataSource:o.labels,renderItem:function(C){var L;return(0,a.jsx)(S,{hideColorPicker:o.hideColorPicker,hideEye:o.hideEye,onClick:o.onLabelSelect,label:C,active:(L=o.activeIds)===null||L===void 0?void 0:L.has(C.labelId),onLabelDelete:o.onLabelDelete,onLabelModify:o.onLabelModify})}}),(0,a.jsx)($,{hideColorPicker:o.hideColorPicker,order:(s=o.labels)===null||s===void 0?void 0:s.length,visible:O,onLabelAdd:function(C){o.onLabelAdd(C),P(!1)},onCancel:function(){P(!1)}})]})},ne=p},8088:function(u,b,e){"use strict";var N=e(67294),_=e(78677),v=e.n(_),d=e(85893),i=function(f){return(0,d.jsx)("div",{className:"".concat(v().container," ").concat(f.className),children:f.children})};b.Z=i},57436:function(u,b,e){"use strict";var N=e(91220),_=e(2824),v=e(67294),d=e(65031),i=e(84420),r=e.n(i),f=e(48971),l=e(85893),I="./pics/basketball.jpg";function w(H){switch(H){case"mover":return"move";case"rectangle":case"polygon":return"crosshair";default:return"default"}}var F=function(n){var x,a;console.log("stage redraw");var X=r()(n.imgSrc||"","anonymous"),S=(0,_.Z)(X,1),t=S[0],J=(t==null?void 0:t.width)||0,q=(t==null?void 0:t.height)||0,G=n.transparency==null?0:n.transparency*.01,ee=(0,f.tT)("InteractorData",function(c){return c.interactorData});console.log("interactorData",ee);var D=void 0;n.currentTool=="polygon"||n.currentTool=="rectangle"||n.currentTool=="editor"?D=n.drawTool.polygon:n.currentTool=="brush"||n.currentTool=="rubber"?D=n.drawTool.brush:n.currentTool=="interactor"&&(D=n.drawTool.interactor);var g=D,Q=(0,v.useState)(0),k=(0,_.Z)(Q,2),$=k[0],p=k[1],ne=(0,v.useState)(0),V=(0,_.Z)(ne,2),o=V[0],s=V[1],B=(0,v.useState)({x:0,y:0}),h=(0,_.Z)(B,2),j=h[0],U=h[1],E=(0,v.useRef)(null),O=(0,v.useRef)(null),P=(0,v.useRef)(null);function y(){var c=document.getElementById("dr");c&&(p(c.clientWidth),s(c.clientHeight))}(0,v.useEffect)(function(){window.removeEventListener("resize",y),window.addEventListener("resize",y);var c=document.getElementById("dr");c&&(p(c.clientWidth),s(c.clientHeight))},[]),(0,v.useEffect)(function(){!E.current||(E.current.container().style.cursor=w(n.currentTool))},[n.currentTool]);var C=function(m){return{e:m,mouseX:(m.evt.offsetX-j.x-$/2)/n.scale+J/2,mouseY:(m.evt.offsetY-j.y-o/2)/n.scale+q/2,offsetX:-J/2,offsetY:-q/2,canvasRef:P,stageRef:E}},L=function(m){g==null||g.onMouseDown(C(m))},Z=function(m){g==null||g.onMouseMove(C(m))},R=function(m){g==null||g.onMouseUp(C(m))},T=function(m){m.cancelBubble=!0,m.evt.preventDefault()},K=[],W={onDrag:n.onAnnotationModify,scale:n.scale,currentTool:n.currentTool,onSelect:n.setCurrentAnnotation,stageRef:E,currentAnnotation:n.currentAnnotation,transparency:G,threshold:n.threshold,canvasRef:P,interactorData:ee,label:n.currentLabel};if(n.annotations){var A;console.log("PPStage rendering annotations:",n.annotations);var M=(A=P.current)===null||A===void 0?void 0:A.getContext("2d");M&&M.clearRect(0,0,M.canvas.width,M.canvas.height);var z=(0,N.Z)(n.annotations),oe;try{for(z.s();!(oe=z.n()).done;){var Y=oe.value;if(!!Y){W.annotation=Y;var te=void 0;if(Y.type=="polygon"||Y.type=="rectangle")te=n.drawTool.polygon.drawAnnotation(W);else if(Y.type=="brush"||Y.type=="rubber"){var ae;te=(ae=n.drawTool.brush)===null||ae===void 0?void 0:ae.drawAnnotation(W)}else continue;K.push(te)}}}catch(c){z.e(c)}finally{z.f()}}(x=n.drawTool.interactor)===null||x===void 0||x.drawAnnotation(W),(a=O.current)===null||a===void 0||a.batchDraw();var le=n.currentTool=="mover";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("canvas",{style:{display:"none"},id:"virtualCanvas",width:t==null?void 0:t.width,height:t==null?void 0:t.height}),(0,l.jsx)("canvas",{style:{display:"none"},id:"singleLineCanvas",width:t==null?void 0:t.width,height:t==null?void 0:t.height}),(0,l.jsx)("canvas",{style:{display:"none"},id:"canvasId",ref:P,width:t==null?void 0:t.width,height:t==null?void 0:t.height}),(0,l.jsx)("svg",{width:"0",height:"0",style:{position:"absolute",zIndex:"-1"},children:(0,l.jsx)("defs",{children:(0,l.jsx)("filter",{id:"remove-alpha",x:"0",y:"0",width:"100%",height:"100%",children:(0,l.jsx)("feComponentTransfer",{children:(0,l.jsx)("feFuncA",{type:"discrete",tableValues:"0 1"})})})})}),(0,l.jsxs)(d.Hf,{width:$,height:o,offsetX:-$/2,offsetY:-o/2,className:"stage",ref:E,draggable:le,onDragMove:function(m){n.currentTool=="mover"},onDragEnd:function(m){n.currentTool=="mover"&&U({x:m.target.x(),y:m.target.y()})},children:[(0,l.jsx)(d.mh,{onMouseDown:L,onMouseMove:Z,onMouseUp:R,onContextMenu:T,scaleX:n.scale,scaleY:n.scale,draggable:!1,children:(0,l.jsx)(d.Ee,{name:"baseImage",draggable:!1,image:t,x:-((t==null?void 0:t.width)||0)/2,y:-((t==null?void 0:t.height)||0)/2})}),(0,l.jsxs)(d.mh,{ref:O,name:"annotation",scaleX:n.scale,scaleY:n.scale,onMouseDown:L,onMouseMove:Z,onMouseUp:R,onContextMenu:T,opacity:G,children:[(0,l.jsx)(d.Ee,{x:-((t==null?void 0:t.width)||0)/2,y:-((t==null?void 0:t.height)||0)/2,image:P.current||void 0}),K]})]})]})};b.Z=F},44434:function(u,b,e){"use strict";var N=e(67294),_=e(80961),v=e.n(_),d=e(85893),i=function(f){var l=v().leftToolbar;return f.disLoc=="right"&&(l=v().rightToolbar),(0,d.jsx)("div",{className:l,children:f.children})};b.Z=i},61541:function(u,b,e){"use strict";var N=e(49111),_=e(19650),v=e(67294),d=e(82499),i=e.n(d),r=e(85893),f=function(I){return(0,r.jsx)("div",{unselectable:"on",className:"".concat(i().toolBarButtonContainerWrapper," ").concat(I.active&&i().toolBarButtonContainerWrapperActive),onClick:I.onClick,children:(0,r.jsx)(_.Z,{align:"center",className:i().toolBarButtonContainer,size:0,children:(0,r.jsxs)(_.Z,{align:"center",direction:"vertical",className:i().toolBarButton,size:0,children:[(0,r.jsx)("img",{src:I.imgSrc}),(0,r.jsx)("div",{className:i().buttonText,children:I.children})]})})})};b.Z=f}}]);
