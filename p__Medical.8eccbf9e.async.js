(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[454],{57560:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},8982:function(y){y.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(y){y.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},43801:function(y,L,n){"use strict";n.d(L,{Z:function(){return P}});var W=n(11849),j=n(2824),I=n(91220),O=n(67294),K=n(65031),x=n(85893);function D(t,v,l,m){if(!(!t||!v||!l||!m))return{width:t,color:v,points:l,tool:m}}function A(t,v,l,m,u,h,d){if(!t||!t.lines)return(0,x.jsx)(x.Fragment,{});var i=(d==null?void 0:d.annotationId)==t.annotationId,b=i&&u=="mover",M=[],g=(0,I.Z)(t.lines),E;try{for(g.s();!(E=g.n()).done;){var _=E.value;!_.width||!_.color||!_.points||!_.tool||M.push((0,x.jsx)(K.x1,{stroke:_.color,strokeWidth:_.width,globalCompositeOperation:_.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:_.points,tension:.01,onDragMove:function(){},onDragEnd:function(){l()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:b?1:0}))}}catch(S){g.e(S)}finally{g.f()}return(0,x.jsx)(K.ZA,{draggable:b,children:M})}function R(t,v){return t=="rubber"||v==2?"rubber":"brush"}function o(t){var v=0,l=(0,I.Z)(t),m;try{for(l.s();!(m=l.n()).done;){var u=m.value;!u||u.annotationId>v&&(v=u.annotationId)}}catch(h){l.e(h)}finally{l.f()}return v}function P(t){var v=(0,O.useState)(),l=(0,j.Z)(v,2),m=l[0],u=l[1],h=function(M,g){var E;if(!(t.currentTool!="brush"&&t.currentTool!="rubber")){var _=M.evt.offsetX/g,S=M.evt.offsetY/g,a=R(t.currentTool,M.evt.button),s=D(t.brushSize||10,(E=t.currentLabel)===null||E===void 0?void 0:E.color,[_,S,_,S],a);if(!!s)if(u(a),t.currentAnnotation){var p,z={tool:"brush",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:(p=t.currentAnnotation.lines)===null||p===void 0?void 0:p.concat([s])};t.onAnnotationModify(z)}else{if(a=="rubber")return;t.onAnnotationAdd({tool:"brush",annotationId:o(t.annotations)+1,label:t.currentLabel,lines:[s]})}}},d=function(M,g){var E;if(!(!m||!t.currentAnnotation)){var _=M.evt.offsetX/g,S=M.evt.offsetY/g,a=[_,S],s=[];(E=t.currentAnnotation)!==null&&E!==void 0&&E.lines&&(a=t.currentAnnotation.lines[t.currentAnnotation.lines.length-1].points.concat(a),s=t.currentAnnotation.lines);var p=D(t.brushSize||10,t.currentLabel.color,a,m);!p||(s.pop(),s.push(p),t.onAnnotationModify((0,W.Z)((0,W.Z)({},t.currentAnnotation),{},{lines:s})))}},i=function(){t.currentTool!="brush"&&t.currentTool!="rubber"||(u(void 0),t.onMouseUp())};return{onMouseDown:h,onMouseMove:d,onMouseUp:i,createElementsFunc:A}}},58967:function(y,L,n){"use strict";var W=n(20136),j=n(55241),I=n(77883),O=n(70507),K=n(57663),x=n(71577),D=n(2824),A=n(67294),R=n(61541),o=n(57560),P=n.n(o),t=n(85893),v=1,l=50,m=10;function u(d){return d?d<=v?v:d>=l?l:d:m}var h=function(i){var b=(0,A.useState)(u(i.size)),M=(0,D.Z)(b,2),g=M[0],E=M[1],_=function(a){E(u(a))};return(0,A.useEffect)(function(){_(i.size)},[i.size]),(0,t.jsxs)(j.Z,{overlayClassName:P().popover,placement:"right",content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g-1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"-"}),(0,t.jsx)(O.Z,{min:v,max:l,value:g,onChange:function(a){var s;(s=i.onChange)===null||s===void 0||s.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g+1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"+"})]}),trigger:i.active?"hover":"click",children:[" ",(0,t.jsx)(R.Z,{active:i.active,imgSrc:i.imgSrc||"./pics/buttons/brush.png",onClick:i.onClick,children:i.children||"Brush"})]})};L.Z=h},27992:function(y,L,n){"use strict";var W=n(20136),j=n(55241),I=n(77883),O=n(70507),K=n(57663),x=n(71577),D=n(2824),A=n(67294),R=n(61541),o=n(26647),P=n.n(o),t=n(85893),v=1,l=100,m=10;function u(d){return d?d<=v?v:d>=l?l:d:m}var h=function(i){var b=(0,A.useState)(u(i.size)),M=(0,D.Z)(b,2),g=M[0],E=M[1],_=function(a){E(u(a))};return(0,A.useEffect)(function(){_(i.size)},[i.size]),(0,t.jsxs)(j.Z,{overlayClassName:"".concat(P().popover," ").concat(i.disLoc=="left"?P().popoverLeft:""),placement:i.disLoc||"right",content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g-1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"-"}),(0,t.jsx)(O.Z,{min:v,max:l,value:g,onChange:function(a){var s;(s=i.onChange)===null||s===void 0||s.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g+1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"+"})]}),trigger:"hover",children:[" ",(0,t.jsx)(R.Z,{imgSrc:i.imgSrc,onClick:i.onClick,children:i.children})]})};L.Z=h},13931:function(y,L,n){"use strict";n.d(L,{Z:function(){return R}});var W=n(91220),j=n(11849),I=n(65031),O=n(85893);function K(o){var P=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return P?{r:parseInt(P[1],16),g:parseInt(P[2],16),b:parseInt(P[3],16)}:null}function x(o,P){if(!(!o||!P))return{color:o,points:P}}function D(o,P,t,v,l,m,u){if(!o||!o.lines||!o.lines[0])return[(0,O.jsx)(O.Fragment,{})];var h=o.lines[0].points,d=o.lines[0].color,i=K(d);if(!i)return[(0,O.jsx)(O.Fragment,{})];var b=(u==null?void 0:u.annotationId)==o.annotationId,M=b?.5:.1,g=void 0,E=[];return h.forEach(function(_,S){if(!g){g=_;return}E.push((0,O.jsx)(I.Cd,{onMouseDown:function(){l=="mover"&&m(o)},draggable:l=="mover",onDragMove:function(s){console.log("Circle onDrageMove");var p=s.evt.offsetX/v,z=s.evt.offsetY/v;h[S-1]=p,h[S]=z;var X=(0,j.Z)((0,j.Z)({},o),{},{lines:[{color:d,points:h}]});P(X)},onMouseOver:function(){console.log("Circle onMouseOver"),l=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:g,y:_,radius:5,fill:d})),g=void 0}),[(0,O.jsxs)(I.ZA,{children:[(0,O.jsx)(I.x1,{onMouseOver:function(){l=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){l=="mover"&&m(o)},stroke:d,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:h,tension:0,closed:!0,fill:"rgba(".concat(i.r,", ").concat(i.g,", ").concat(i.b,", ").concat(M,")")}),E]},o.annotationId)]}function A(o){var P=0,t=(0,W.Z)(o),v;try{for(t.s();!(v=t.n()).done;){var l=v.value;!l||l.annotationId>P&&(P=l.annotationId)}}catch(m){t.e(m)}finally{t.f()}return P}function R(o){var P=function(u,h){var d,i=u.evt.offsetX/h,b=u.evt.offsetY/h,M=x((d=o.currentLabel)===null||d===void 0?void 0:d.color,[i,b]);!M||o.onAnnotationAdd({tool:"polygon",annotationId:A(o.annotations)+1,label:o.currentLabel,lines:[M]})},t=function(u,h){var d,i;if(!!o.currentAnnotation){var b=u.evt.offsetX/h,M=u.evt.offsetY/h,g=o.currentAnnotation.lines||[],E=x((d=o.currentLabel)===null||d===void 0?void 0:d.color,(i=g[0])===null||i===void 0?void 0:i.points.concat([b,M]));if(!!E){var _={tool:"polygon",annotationId:o.currentAnnotation.annotationId,label:o.currentAnnotation.label,lines:[E]};o.onAnnotationModify(_)}}},v=function(u,h){o.currentTool=="polygon"&&(o.currentAnnotation?t(u,h):P(u,h))},l=function(){o.currentTool=="polygon"&&o.onMouseUp()};return{onMouseDown:v,onMouseMove:function(){},onMouseUp:l,createElementsFunc:D}}},29919:function(y,L,n){"use strict";var W=n(67294),j=n(61541),I=n(85893),O=function(x){return(0,I.jsx)(j.Z,{active:x.active,imgSrc:x.imgSrc||"./pics/buttons/polygon.png",onClick:x.onClick,children:x.children})};L.Z=O},21028:function(y,L,n){"use strict";n.r(L),n.d(L,{MOST_HISTORY_STEPS:function(){return Y},default:function(){return hn}});var W=n(57663),j=n(71577),I=n(20136),O=n(55241),K=n(34669),x=n(54458),D=n(2824),A=n(67294),R=n(75721),o=n.n(R),P=n(8088),t=n(61541),v=n(44434),l=n(58967),m=n(27992),u=n(5041),h=n(57436),d=n(14836),i=n(29919),b=n(43801),M=n(13931),g=n(13062),E=n(71230),_=n(66126),S=n(75454),a=n(89032),s=n(15746),p=n(8982),z=n.n(p),X=n(48971),e=n(85893),fn=function(F){var V=(0,X.YB)().formatMessage({id:"component.PPMedical.windowWidth"}),$=(0,X.YB)().formatMessage({id:"component.PPMedical.windowLevel"});return(0,e.jsxs)("div",{children:[(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(s.Z,{span:6,className:z().Pop1,children:(0,e.jsx)("span",{children:V})}),(0,e.jsx)(s.Z,{span:18,className:z().Pop2,children:(0,e.jsx)(S.Z,{min:1,max:F.wwValue||100,defaultValue:37})})]}),(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(s.Z,{span:6,className:z().Pop1,children:(0,e.jsx)("span",{children:$})}),(0,e.jsx)(s.Z,{span:18,className:z().Pop2,children:(0,e.jsx)(S.Z,{min:1,max:F.wlValue||100,defaultValue:37})})]})]})},mn=fn,Y=40,gn=function(){var F,V=(0,A.useState)(void 0),$=(0,D.Z)(V,2),T=$[0],H=$[1],Mn=(0,A.useState)({color:"",name:""}),on=(0,D.Z)(Mn,2),G=on[0],en=on[1],En=(0,A.useState)(),rn=(0,D.Z)(En,2),U=rn[0],Q=rn[1],Cn=(0,A.useState)([]),an=(0,D.Z)(Cn,2),B=an[0],Sn=an[1],xn=(0,A.useState)(10),sn=(0,D.Z)(xn,2),J=sn[0],ln=sn[1],On=(0,A.useState)(1),un=(0,D.Z)(On,2),k=un[0],q=un[1],dn=function(r){r||q(1),r<.1||r>3?q(1):q(r)},Z=function(r){Q(r),r!=null&&r.label&&en(r.label)},N=function(r){Sn(r)};(0,A.useEffect)(function(){localStorage.removeItem("history"),w([])},[]);function w(c,r){var f=localStorage.getItem("history"),C=f?JSON.parse(f):{index:-1,items:[]},_n={currentAnnotation:r,annotations:c};if(JSON.stringify(C.items[C.index])!=JSON.stringify(_n)){var Dn=C.index>Y?C.index-Y:0,yn=C.items.splice(Dn,C.index==0?1:C.index+1);C.items=yn.concat([_n]),C.index<=Y?C.index++:C.index=Y+1,localStorage.setItem("history",JSON.stringify(C))}}var An=function(){var r=localStorage.getItem("history");if(!!r){var f=JSON.parse(r);if(!!f&&!(f.index>=f.items.length-1)){f.index++,localStorage.setItem("history",JSON.stringify(f));var C=f.items[f.index];Q(C.currentAnnotation),N(C.annotations)}}},bn=function(){var r=localStorage.getItem("history");if(!!r){var f=JSON.parse(r);if(!(!f||!f.index)&&!(f.index<=0)){f.index--,localStorage.setItem("history",JSON.stringify(f));var C=f.items[f.index];Q(C.currentAnnotation),N(C.annotations)}}},nn=function(r){for(var f=[],C=0;C<B.length;C++)B[C].annotationId==r.annotationId?f.push(r):f.push(B[C]);Z(r),N(f)},cn=(0,b.Z)({currentLabel:G,brushSize:J,currentTool:T,annotations:B,currentAnnotation:U,onAnnotationAdd:function(r){var f=B.concat([r]);N(f),U||Z(r)},onAnnotationModify:nn,onMouseUp:function(){w(B,U)}}),vn=(0,M.Z)({currentLabel:G,brushSize:J,currentTool:T,annotations:B,currentAnnotation:U,onAnnotationAdd:function(r){var f=B.concat([r]);N(f),U||Z(r)},onAnnotationModify:nn,onMouseUp:function(){w(B,U)}}),tn=T=="polygon"?vn:cn;return(0,e.jsxs)(P.Z,{className:o().segment,children:[(0,e.jsxs)(v.Z,{children:[(0,e.jsx)(i.Z,{active:T=="polygon",onClick:function(){H("polygon"),Z(void 0)},children:"Polygon"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,e.jsx)(l.Z,{size:J,active:T=="brush",onClick:function(){T!="rubber"&&T!="brush"&&Z(void 0),H("brush")},onChange:function(r){ln(r)},children:"Brush"}),(0,e.jsx)(l.Z,{size:J,active:T=="rubber",onClick:function(){T!="rubber"&&T!="brush"&&Z(void 0),H("rubber")},onChange:function(r){ln(r)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){dn(k+.1)},children:"Zoom in"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){dn(k-.1)},children:"Zoom out"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){H("mover")},children:"Move"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){bn()},children:"Undo"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){An()},children:"Redo"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,e.jsxs)("div",{id:"dr",className:o().mainStage,children:[(0,e.jsx)("div",{className:o().draw,children:(0,e.jsx)(h.Z,{width:(F=document.getElementById("dr"))===null||F===void 0?void 0:F.clientWidth,scale:k,annotations:B,currentTool:T,currentAnnotation:U,setCurrentAnnotation:Z,onAnnotationModify:nn,onAnnotationModifyComplete:function(){w(B,U)},onMouseDown:tn.onMouseDown,onMouseMove:tn.onMouseMove,onMouseUp:tn.onMouseUp,createPolygonFunc:vn.createElementsFunc,createBrushFunc:cn.createElementsFunc})}),(0,e.jsx)("div",{className:o().pblock,children:(0,e.jsx)("div",{className:o().progress,children:(0,e.jsx)(x.Z,{percent:50,status:"active"})})})]}),(0,e.jsxs)(v.Z,{disLoc:"right",children:[(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Interactor"}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,e.jsx)(m.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"}),(0,e.jsxs)(O.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,e.jsx)(mn,{}),trigger:"hover",children:[" ",(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:"Medical Setting"})]}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,e.jsx)(t.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"})]}),(0,e.jsxs)("div",{className:o().rightSideBar,children:[(0,e.jsx)("div",{className:o().determinOutline,children:(0,e.jsx)(j.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){Z(void 0)},children:"Determine Outline"})}),(0,e.jsx)(u.Z,{selectedLabel:G,onLabelSelect:function(r){en(r),Z(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,e.jsx)(d.Z,{selectedAnnotation:U,annotations:B,onAnnotationSelect:function(r){r!=null&&r.delete||Z(r)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(r){N(B.filter(function(f){return f.annotationId!=r.annotationId})),Z(void 0)}})]})]})},hn=gn}}]);
