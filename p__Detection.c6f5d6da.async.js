(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(h,p,n){"use strict";n.d(p,{Z:function(){return L}});var E=n(94663),K=n(80112);function k(W){return Function.toString.call(W).indexOf("[native code]")!==-1}var w=n(18597);function $(W,y,b){return(0,w.Z)()?$=Reflect.construct:$=function(R,B,H){var u=[null];u.push.apply(u,B);var F=Function.bind.apply(R,u),C=new F;return H&&(0,K.Z)(C,H.prototype),C},$.apply(null,arguments)}function L(W){var y=typeof Map=="function"?new Map:void 0;return L=function(l){if(l===null||!k(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof y!="undefined"){if(y.has(l))return y.get(l);y.set(l,R)}function R(){return $(l,arguments,(0,E.Z)(this).constructor)}return R.prototype=Object.create(l.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),(0,K.Z)(R,l)},L(W)}},6277:function(h){h.exports={modal:"modal___26yNn"}},45092:function(h){h.exports={modal:"modal___1H_FQ"}},72285:function(h){h.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},85871:function(h,p,n){"use strict";var E=n(71194),K=n(50146),k=n(49111),w=n(19650),$=n(57663),L=n(71577),W=n(13062),y=n(71230),b=n(89032),l=n(15746),R=n(77883),B=n(70507),H=n(34792),u=n(48086),F=n(9715),C=n(93766),N=n(2824),x=n(67294),t=n(48971),un=n(6277),U=n.n(un),d=n(85893),on=function(S){var q=(0,t.YB)(),rn=(0,x.useState)(60),nn=(0,N.Z)(rn,2),j=nn[0],tn=nn[1],X=(0,x.useState)(20),Z=(0,N.Z)(X,2),Y=Z[0],v=Z[1],vn=(0,x.useState)(20),fn=(0,N.Z)(vn,2),en=fn[0],mn=fn[1],e=(0,x.useState)(!1),o=(0,N.Z)(e,2),c=o[0],f=o[1],i=(0,t.YB)().formatMessage({id:"pages.toolBar.divideData"}),A=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.train"}),m=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.validation"}),r=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.test"}),_=(0,t.YB)().formatMessage({id:"component.PPCreater.cancel"}),g=(0,t.YB)().formatMessage({id:"component.PPSegMode.ok"}),I=C.Z.useForm(),D=(0,N.Z)(I,1),O=D[0];return(0,d.jsx)(K.Z,{className:U().modal,title:i,visible:S.visible,onCancel:S.onCancel,footer:null,children:(0,d.jsxs)(C.Z,{form:O,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(){if(j+Y+en!=100){u.default.error("Train, Validation and Test total percent should equal 100!");return}console.log("x trainData: ".concat(j,", validationData: ").concat(Y,", testData: ").concat(en,", props.project.curr.projectId: ").concat(S.project.curr.projectId)),f(!0),S.splitDataset(S.project.curr.projectId,{train:j*.01,validation:Y*.01,test:en*.01}).then(function(){var M;console.log("success"),u.default.success(q.formatMessage({id:"component.PPDivideDataModal.success"})),(M=S.onFinish)===null||M===void 0||M.call(0)}).finally(function(){f(!1)})},autoComplete:"off",layout:"vertical",children:[(0,d.jsxs)(y.Z,{children:[(0,d.jsx)(l.Z,{span:8,children:(0,d.jsx)(C.Z.Item,{label:A,name:"train",children:(0,d.jsx)(B.Z,{addonAfter:"%",defaultValue:60,precision:0,min:0,max:100,value:j,onChange:tn})})}),(0,d.jsx)(l.Z,{span:8,children:(0,d.jsx)(C.Z.Item,{label:m,name:"validation",children:(0,d.jsx)(B.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:Y,onChange:v})})}),(0,d.jsx)(l.Z,{span:8,children:(0,d.jsx)(C.Z.Item,{label:r,name:"test",children:(0,d.jsx)(B.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:en,onChange:mn})})})]}),(0,d.jsx)(C.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,d.jsxs)(w.Z,{children:[(0,d.jsx)(L.Z,{onClick:function(){var M;(M=S.onCancel)===null||M===void 0||M.call(0),O.resetFields()},children:_}),(0,d.jsx)(L.Z,{type:"primary",htmlType:"submit",loading:c,children:g})]})})]})})};p.Z=on},62850:function(h,p,n){"use strict";var E=n(71194),K=n(50146),k=n(49111),w=n(19650),$=n(57663),L=n(71577),W=n(47673),y=n(24044),b=n(34792),l=n(48086),R=n(9715),B=n(93766),H=n(2824),u=n(67294),F=n(48971),C=n(45092),N=n.n(C),x=n(85893),t=function(U){var d=(0,F.YB)(),on=(0,u.useState)(!1),an=(0,H.Z)(on,2),S=an[0],q=an[1],rn=(0,F.YB)().formatMessage({id:"component.PPCreater.cancel"}),nn=B.Z.useForm(),j=(0,H.Z)(nn,1),tn=j[0];return(0,x.jsx)(K.Z,{className:N().modal,title:(0,F.YB)().formatMessage({id:"component.PPExportModal.title"}),visible:U.visible,onCancel:U.onCancel,footer:null,children:(0,x.jsxs)(B.Z,{form:tn,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(Z){console.log(Z);var Y=Z.path;if(!Y){l.default.error(d.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}q(!0),U.exportDataset(U.project.curr.projectId,Y).then(function(){var v;l.default.success(d.formatMessage({id:"component.PPExportModal.exportSuccess"})),(v=U.onFinish)===null||v===void 0||v.call(0)}).finally(function(){q(!1)})},autoComplete:"off",children:[(0,x.jsx)(B.Z.Item,{label:d.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,x.jsx)(y.Z,{})}),(0,x.jsx)(B.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,x.jsxs)(w.Z,{children:[(0,x.jsx)(L.Z,{onClick:function(){var Z;(Z=U.onCancel)===null||Z===void 0||Z.call(0),tn.resetFields()},children:rn}),(0,x.jsx)(L.Z,{type:"primary",htmlType:"submit",loading:S,children:d.formatMessage({id:"component.PPExportModal.export"})})]})})]})})};p.Z=t},33549:function(h,p,n){"use strict";n.r(p),n.d(p,{default:function(){return mn}});var E=n(11849),K=n(20228),k=n(11382),w=n(34669),$=n(54458),L=n(34792),W=n(48086),y=n(91220),b=n(2824),l=n(67294),R=n(72285),B=n.n(R),H=n(8088),u=n(61541),F=n(44434),C=n(5041),N=n(57436),x=n(14836),t=n(85893),un=function(o){return(0,t.jsx)(u.Z,{active:o.active,imgSrc:o.imgSrc||"./pics/buttons/rectangle.png",onClick:o.onClick,children:o.children})},U=un,d=n(65031);function on(e){var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null}function an(e){if(!(!e||e.length<2))return{xmin:e[0],ymin:e[1],xmax:e[2]||void 0,ymax:e[3]||void 0}}function S(e,o,c,f,i,A,m){if(!e||!e.points||!e.label||!e.label.color)return[(0,t.jsx)(t.Fragment,{})];var r=e.points,_=e.label.color,g=on(_);if(!g)return[(0,t.jsx)(t.Fragment,{})];var I=(m==null?void 0:m.annotationId)==e.annotationId,D=I?.5:.1,O=r.xmax!=null&&r.ymax!=null?(0,t.jsx)(d.UL,{onMouseOver:function(){i=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){i=="mover"&&A(e)},stroke:_,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",x:r.xmin,y:r.ymin,width:r.xmax-r.xmin,height:r.ymax-r.ymin,closed:!0,fill:"rgba(".concat(g.r,", ").concat(g.g,", ").concat(g.b,", ").concat(D,")")}):(0,t.jsx)(t.Fragment,{});function z(M){if(!M&&(r.xmax==null||r.ymax==null))return(0,t.jsx)(t.Fragment,{});var sn=function(P){if(i=="editor"){var _n=P.target.x(),ln=P.target.y();M?(r.xmin=_n,r.ymin=ln):(r.xmax=_n,r.ymax=ln);var T=(0,E.Z)((0,E.Z)({},e),{},{points:r});o(T)}};return(0,t.jsx)(d.Cd,{onMouseDown:function(){(i=="editor"||i=="mover")&&A(e)},draggable:i=="editor",onDragMove:sn,onDragEnd:sn,onMouseOver:function(){i=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},x:M?r.xmin:r.xmax,y:M?r.ymin:r.ymax,radius:5,fill:_})}return[(0,t.jsxs)(d.ZA,{children:[O,z(!0),z(!1)]},e.annotationId)]}function q(e){var o=1;if(!e||e.length==0)return o;var c=(0,y.Z)(e),f;try{for(c.s();!(f=c.n()).done;){var i=f.value;i.frontendId&&o<=i.frontendId&&(o=i.frontendId+1)}}catch(A){c.e(A)}finally{c.f()}return o}function rn(e){var o=function(m,r,_,g){var I=(m.evt.offsetX+r)/g,D=(m.evt.offsetY+_)/g,O=an([I,D]);!O||e.onAnnotationAdd({frontendId:q(e.annotations),type:"rectangle",label:e.currentLabel,points:O})},c=function(m,r,_,g){if(!(!e.currentAnnotation||!e.currentAnnotation.points)){var I=(m.evt.offsetX+r)/g,D=(m.evt.offsetY+_)/g,O=e.currentAnnotation.points;if(!!O){O.xmax=I,O.ymax=D;var z={type:"rectangle",frontendId:e.currentAnnotation.frontendId,label:e.currentAnnotation.label,points:O};e.onAnnotationModify(z)}}},f=function(m,r,_,g){e.currentTool=="rectangle"&&(e.currentAnnotation?c(m,r,_,g):o(m,r,_,g))},i=function(){e.currentTool=="rectangle"&&e.onMouseUp()};return{onMouseDown:f,onMouseMove:function(){},onMouseUp:i,createElementsFunc:S}}var nn=n(64322),j=40;function tn(){localStorage.removeItem("history"),X([])}function X(e){var o=localStorage.getItem("history"),c=o?JSON.parse(o):{index:-1,items:[]};if(JSON.stringify(c.items[c.index])!=JSON.stringify(e)){var f=c.index>j?c.index-j:0,i=c.items.splice(f,c.index==0?1:c.index+1);c.items=i.concat([e]),c.index<=j?c.index++:c.index=j+1,localStorage.setItem("history",JSON.stringify(c))}}function Z(){var e=localStorage.getItem("history");if(!!e){var o=JSON.parse(e);if(!!o&&!(o.index>=o.items.length-1))return o.index++,localStorage.setItem("history",JSON.stringify(o)),o.items[o.index]}}function Y(){var e=localStorage.getItem("history");if(!!e){var o=JSON.parse(e);if(!(!o||!o.index)&&!(o.index<=0))return o.index--,localStorage.setItem("history",JSON.stringify(o)),o.items[o.index]}}var v=n(48971),vn=n(85871),fn=n(62850),en=function(){var o,c=(0,nn.$L)(l.useState,l.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:tn}}),f=(0,b.Z)(c,10),i=f[0],A=f[1],m=f[2],r=f[3],_=f[4],g=f[5],I=f[6],D=f[7],O=f[8],z=f[9],M=(0,l.useState)(),sn=(0,b.Z)(M,2),J=sn[0],P=sn[1],_n=(0,l.useState)([]),ln=(0,b.Z)(_n,2),T=ln[0],G=ln[1],hn=(0,l.useState)(!1),xn=(0,b.Z)(hn,2),yn=xn[0],gn=xn[1],Cn=(0,l.useState)(!1),Dn=(0,b.Z)(Cn,2),An=Dn[0],Mn=Dn[1],In=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));T.push(a),G(T),P(a)},pn=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));var Q=[],V=(0,y.Z)(T),dn;try{for(V.s();!(dn=V.n()).done;){var cn=dn.value;cn.frontendId==a.frontendId?Q.push(a):Q.push(cn)}}catch(Pn){V.e(Pn)}finally{V.f()}console.log("modifyAnnotation, newAnnos:",Q,"anno:",a),G(Q),P(a)},Bn=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));var Q=[],V=(0,y.Z)(T),dn;try{for(V.s();!(dn=V.n()).done;){var cn=dn.value;cn.frontendId!=a.frontendId&&Q.push(cn)}}catch(Pn){V.e(Pn)}finally{V.f()}G(Q),P(void 0)},Yn=function(a){!a||(console.log("modifyAnnotation",a,"anno.label:",a==null?void 0:a.label),a.taskId=_.curr.taskId,a.dataId=g.curr.dataId,r.modify(a))},On=rn({currentLabel:D.curr,currentTool:i.curr,annotations:T,currentAnnotation:J,onAnnotationAdd:In,onAnnotationModify:pn,onMouseUp:function(){X({annos:T,currAnno:J})}}),En=On,Sn=(0,v.YB)().formatMessage({id:"pages.toolBar.rectangle"}),jn=(0,v.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),Zn=(0,v.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),Tn=(0,v.YB)().formatMessage({id:"pages.toolBar.move"}),Ln=(0,v.YB)().formatMessage({id:"pages.toolBar.unDo"}),Rn=(0,v.YB)().formatMessage({id:"pages.toolBar.reDo"}),Un=(0,v.YB)().formatMessage({id:"pages.toolBar.save"}),Kn=(0,v.YB)().formatMessage({id:"pages.toolBar.edit"}),Wn=(0,v.YB)().formatMessage({id:"pages.toolBar.clearMark"}),bn=(0,v.YB)().formatMessage({id:"pages.toolBar.undef"}),Fn=(0,v.YB)().formatMessage({id:"pages.toolBar.divideData"}),Nn=(0,v.YB)().formatMessage({id:"pages.toolBar.export"});return(0,t.jsxs)(H.Z,{className:B().det,children:[(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(U,{active:i.curr=="rectangle",onClick:function(){if(!D.curr){W.default.error("Please choose a label category first!");return}i.setCurr("rectangle"),P(void 0)},children:Sn}),(0,t.jsx)(u.Z,{active:i.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){i.setCurr("editor")},children:Kn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){m.change(.1)},children:jn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){m.change(-.1)},children:Zn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){W.default.info("Annotations are saved automatically. You don't need to click save.")},children:Un}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/move.png",active:i.curr=="mover",onClick:function(){i.setCurr("mover")},children:Tn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var a=Y();!a||(P(a.currAnno),G(a.annos))},children:Ln}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var a=Z();!a||(P(a.currAnno),G(a.annos))},children:Rn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:Wn})]}),(0,t.jsx)("div",{id:"dr",className:"mainStage",children:(0,t.jsxs)(k.Z,{tip:"loading",spinning:!!A.curr,children:[(0,t.jsx)("div",{className:"draw",children:(0,t.jsx)(N.Z,{scale:m.curr,annotations:T,currentTool:i.curr,currentAnnotation:J,setCurrentAnnotation:P,onAnnotationModify:pn,onAnnotationModifyComplete:function(){X({annos:T,currAnno:J})},onMouseDown:En.onMouseDown,onMouseMove:En.onMouseMove,onMouseUp:En.onMouseUp,createRectangleFunc:On.createElementsFunc,imgSrc:g.imgSrc})}),(0,t.jsx)("div",{className:"pblock",children:(0,t.jsxs)("div",{className:"progress",children:[(0,t.jsx)($.Z,{className:"progressBar",percent:I.progress,status:"active",showInfo:!1})," ",(0,t.jsxs)("span",{className:"progressDesc",children:["Current labeling ",_.currIdx==null?1:_.currIdx+1," of"," ",(o=_.all)===null||o===void 0?void 0:o.length,". Already labeled ",_.finished(I.progress)||0,"."]})]})}),(0,t.jsx)("div",{className:"prevTask",onClick:function(){!_.prevTask()||(P(void 0),G([]))}}),(0,t.jsx)("div",{className:"nextTask",onClick:function(){!_.nextTask()||(P(void 0),G([]))}})]})}),(0,t.jsxs)(F.Z,{disLoc:"right",children:[(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){gn(!0)},children:Fn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){Mn(!0)},children:Nn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){P(void 0)},children:bn})]}),(0,t.jsxs)("div",{className:"rightSideBar",children:[(0,t.jsx)(C.Z,{labels:D.all,activeIds:D.activeIds,onLabelSelect:function(a){D.onSelect(a),P(void 0)},onLabelModify:function(){},onLabelDelete:D.remove,onLabelAdd:function(a){return D.create((0,E.Z)((0,E.Z)({},a),{},{projectId:I.curr.projectId}))}}),(0,t.jsx)(x.Z,{annotations:T,currAnnotation:J,onAnnotationSelect:P,onAnnotationAdd:function(){P(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(a){Bn(a)}})]}),(0,t.jsx)(vn.Z,{visible:yn,splitDataset:O,project:I,onCancel:function(){gn(!1)},onFinish:function(){gn(!1)}}),(0,t.jsx)(fn.Z,{visible:An,exportDataset:z,project:I,onCancel:function(){Mn(!1)},onFinish:function(){Mn(!1)}})]})},mn=en},15746:function(h,p,n){"use strict";var E=n(21584);p.Z=E.Z},89032:function(h,p,n){"use strict";var E=n(38663),K=n.n(E),k=n(6999)},71230:function(h,p,n){"use strict";var E=n(92820);p.Z=E.Z},13062:function(h,p,n){"use strict";var E=n(38663),K=n.n(E),k=n(6999)}}]);
