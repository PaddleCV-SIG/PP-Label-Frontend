(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[454],{57560:function(L){L.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(L){L.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},8982:function(L){L.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(L){L.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},43801:function(L,j,n){"use strict";n.d(j,{Z:function(){return P}});var z=n(11849),I=n(2824),Z=n(91220),O=n(67294),Y=n(65031),x=n(85893);function y(o,_,i,g){if(!(!o||!_||!i||!g))return{width:o,color:_,points:i,tool:g}}function b(o,_,i,g,s,h,u){if(console.log("drawLine: ",o),!o||!o.points)return(0,x.jsx)(x.Fragment,{});var a=(u==null?void 0:u.annotationId)==o.annotationId,A=a&&s=="mover",E=[],B=(0,Z.Z)(o.points),S;try{for(B.s();!(S=B.n()).done;){var c=S.value;console.log("rendering line: ",c),!(!c.width||!c.color||!c.tool)&&E.push((0,x.jsx)(Y.x1,{stroke:c.color,strokeWidth:c.width,globalCompositeOperation:c.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:c.points,tension:0,onDragMove:function(){},onDragEnd:function(){i()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:A?1:0}))}}catch(M){B.e(M)}finally{B.f()}return(0,x.jsx)(Y.ZA,{draggable:A,children:E})}function W(o,_){return o=="rubber"||_==2?"rubber":"brush"}function t(o){var _=0,i=(0,Z.Z)(o),g;try{for(i.s();!(g=i.n()).done;){var s=g.value;!s||!s.frontendId||s.frontendId>_&&(_=s.frontendId+1)}}catch(h){i.e(h)}finally{i.f()}return _}function P(o){var _=(0,O.useState)(),i=(0,I.Z)(_,2),g=i[0],s=i[1],h=function(E,B,S,c){var M;if(!(o.currentTool!="brush"&&o.currentTool!="rubber"||!o.currentLabel.color)){var l=(E.evt.offsetX+B)/c,d=(E.evt.offsetY+S)/c,T=W(o.currentTool,E.evt.button),D=y(o.brushSize||10,(M=o.currentLabel)===null||M===void 0?void 0:M.color,[l,d,l,d],T);if(!!D)if(s(T),o.currentAnnotation){var f,e={tool:"brush",annotationId:o.currentAnnotation.annotationId,label:o.currentAnnotation.label,points:(f=o.currentAnnotation.points)===null||f===void 0?void 0:f.concat([D])};o.onAnnotationModify(e)}else{if(T=="rubber")return;o.onAnnotationAdd({type:T,annotationId:t(o.annotations)+1,label:o.currentLabel,points:[D]})}}},u=function(E,B,S,c){var M;if(!(!g||!o.currentAnnotation||!o.currentLabel.color)){var l=(E.evt.offsetX+B)/c,d=(E.evt.offsetY+S)/c,T=[l,d],D=[];(M=o.currentAnnotation)!==null&&M!==void 0&&M.points&&(T=o.currentAnnotation.points[o.currentAnnotation.points.length-1].points.concat(T),D=o.currentAnnotation.points);var f=y(o.brushSize||10,o.currentLabel.color,T,g);!f||(D.pop(),D.push(f),o.onAnnotationModify((0,z.Z)((0,z.Z)({},o.currentAnnotation),{},{points:D})))}},a=function(){o.currentTool!="brush"&&o.currentTool!="rubber"||(s(void 0),o.onMouseUp())};return{onMouseDown:h,onMouseMove:u,onMouseUp:a,createElementsFunc:b}}},58967:function(L,j,n){"use strict";var z=n(20136),I=n(55241),Z=n(77883),O=n(70507),Y=n(57663),x=n(71577),y=n(2824),b=n(67294),W=n(61541),t=n(57560),P=n.n(t),o=n(85893),_=1,i=50,g=10;function s(u){return u?u<=_?_:u>=i?i:u:g}var h=function(a){var A=(0,b.useState)(s(a.size)),E=(0,y.Z)(A,2),B=E[0],S=E[1],c=function(l){S(s(l))};return(0,b.useEffect)(function(){c(a.size)},[a.size]),(0,o.jsxs)(I.Z,{overlayClassName:P().popover,placement:"right",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.Z,{type:"text",onClick:function(){var l,d=s(B-1);c(d),(l=a.onChange)===null||l===void 0||l.call(0,d)},children:"-"}),(0,o.jsx)(O.Z,{min:_,max:i,value:B,onChange:function(l){var d;(d=a.onChange)===null||d===void 0||d.call(0,l)},controls:!1,style:{textAlign:"center"}}),(0,o.jsx)(x.Z,{type:"text",onClick:function(){var l,d=s(B+1);c(d),(l=a.onChange)===null||l===void 0||l.call(0,d)},children:"+"})]}),trigger:a.active?"hover":"click",children:[" ",(0,o.jsx)(W.Z,{active:a.active,imgSrc:a.imgSrc||"./pics/buttons/brush.png",onClick:a.onClick,children:a.children||"Brush"})]})};j.Z=h},27992:function(L,j,n){"use strict";var z=n(20136),I=n(55241),Z=n(77883),O=n(70507),Y=n(57663),x=n(71577),y=n(2824),b=n(67294),W=n(61541),t=n(26647),P=n.n(t),o=n(85893),_=1,i=100,g=10;function s(u){return u?u<=_?_:u>=i?i:u:g}var h=function(a){var A=(0,b.useState)(s(a.size)),E=(0,y.Z)(A,2),B=E[0],S=E[1],c=function(l){S(s(l))};return(0,b.useEffect)(function(){c(a.size)},[a.size]),(0,o.jsxs)(I.Z,{overlayClassName:"".concat(P().popover," ").concat(a.disLoc=="left"?P().popoverLeft:""),placement:a.disLoc||"right",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.Z,{type:"text",onClick:function(){var l,d=s(B-1);c(d),(l=a.onChange)===null||l===void 0||l.call(0,d)},children:"-"}),(0,o.jsx)(O.Z,{min:_,max:i,value:B,onChange:function(l){var d;(d=a.onChange)===null||d===void 0||d.call(0,l)},controls:!1,style:{textAlign:"center"}}),(0,o.jsx)(x.Z,{type:"text",onClick:function(){var l,d=s(B+1);c(d),(l=a.onChange)===null||l===void 0||l.call(0,d)},children:"+"})]}),trigger:"hover",children:[" ",(0,o.jsx)(W.Z,{imgSrc:a.imgSrc,onClick:a.onClick,children:a.children})]})};j.Z=h},13931:function(L,j,n){"use strict";n.d(j,{Z:function(){return W}});var z=n(91220),I=n(11849),Z=n(65031),O=n(85893);function Y(t){var P=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return P?{r:parseInt(P[1],16),g:parseInt(P[2],16),b:parseInt(P[3],16)}:null}function x(t,P){if(!(!t||!P))return{color:t,points:P}}function y(t,P,o,_,i,g,s){if(!t||!t.lines||!t.lines[0])return[(0,O.jsx)(O.Fragment,{})];var h=t.lines[0].points,u=t.lines[0].color,a=Y(u);if(!a)return[(0,O.jsx)(O.Fragment,{})];var A=(s==null?void 0:s.annotationId)==t.annotationId,E=A?.5:.1,B=void 0,S=[];return h.forEach(function(c,M){if(!B){B=c;return}S.push((0,O.jsx)(Z.Cd,{onMouseDown:function(){i=="mover"&&g(t)},draggable:i=="mover",onDragMove:function(d){console.log("Circle onDrageMove");var T=d.evt.offsetX/_,D=d.evt.offsetY/_;h[M-1]=T,h[M]=D;var f=(0,I.Z)((0,I.Z)({},t),{},{lines:[{color:u,points:h}]});P(f)},onMouseOver:function(){console.log("Circle onMouseOver"),i=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:B,y:c,radius:5,fill:u})),B=void 0}),[(0,O.jsxs)(Z.ZA,{children:[(0,O.jsx)(Z.x1,{onMouseOver:function(){i=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){i=="mover"&&g(t)},stroke:u,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:h,tension:0,closed:!0,fill:"rgba(".concat(a.r,", ").concat(a.g,", ").concat(a.b,", ").concat(E,")")}),S]},t.annotationId)]}function b(t){var P=0,o=(0,z.Z)(t),_;try{for(o.s();!(_=o.n()).done;){var i=_.value;!i||i.annotationId>P&&(P=i.annotationId)}}catch(g){o.e(g)}finally{o.f()}return P}function W(t){var P=function(s,h){var u,a=s.evt.offsetX/h,A=s.evt.offsetY/h,E=x((u=t.currentLabel)===null||u===void 0?void 0:u.color,[a,A]);!E||t.onAnnotationAdd({tool:"polygon",annotationId:b(t.annotations)+1,label:t.currentLabel,lines:[E]})},o=function(s,h){var u,a;if(!!t.currentAnnotation){var A=s.evt.offsetX/h,E=s.evt.offsetY/h,B=t.currentAnnotation.lines||[],S=x((u=t.currentLabel)===null||u===void 0?void 0:u.color,(a=B[0])===null||a===void 0?void 0:a.points.concat([A,E]));if(!!S){var c={tool:"polygon",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:[S]};t.onAnnotationModify(c)}}},_=function(s,h){t.currentTool=="polygon"&&(t.currentAnnotation?o(s,h):P(s,h))},i=function(){t.currentTool=="polygon"&&t.onMouseUp()};return{onMouseDown:_,onMouseMove:function(){},onMouseUp:i,createElementsFunc:y}}},29919:function(L,j,n){"use strict";var z=n(67294),I=n(61541),Z=n(85893),O=function(x){return(0,Z.jsx)(I.Z,{active:x.active,imgSrc:x.imgSrc||"./pics/buttons/polygon.png",onClick:x.onClick,children:x.children})};j.Z=O},21028:function(L,j,n){"use strict";n.r(j),n.d(j,{MOST_HISTORY_STEPS:function(){return X},default:function(){return hn}});var z=n(57663),I=n(71577),Z=n(20136),O=n(55241),Y=n(34669),x=n(54458),y=n(2824),b=n(67294),W=n(75721),t=n.n(W),P=n(8088),o=n(61541),_=n(44434),i=n(58967),g=n(27992),s=n(5041),h=n(57436),u=n(14836),a=n(29919),A=n(43801),E=n(13931),B=n(13062),S=n(71230),c=n(66126),M=n(75454),l=n(89032),d=n(15746),T=n(8982),D=n.n(T),f=n(48971),e=n(85893),fn=function(F){var V=(0,f.YB)().formatMessage({id:"component.PPMedical.windowWidth"}),$=(0,f.YB)().formatMessage({id:"component.PPMedical.windowLevel"});return(0,e.jsxs)("div",{children:[(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(d.Z,{span:6,className:D().Pop1,children:(0,e.jsx)("span",{children:V})}),(0,e.jsx)(d.Z,{span:18,className:D().Pop2,children:(0,e.jsx)(M.Z,{min:1,max:F.wwValue||100,defaultValue:37})})]}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(d.Z,{span:6,className:D().Pop1,children:(0,e.jsx)("span",{children:$})}),(0,e.jsx)(d.Z,{span:18,className:D().Pop2,children:(0,e.jsx)(M.Z,{min:1,max:F.wlValue||100,defaultValue:37})})]})]})},mn=fn,X=40,gn=function(){var F,V=(0,b.useState)(void 0),$=(0,y.Z)(V,2),R=$[0],H=$[1],Pn=(0,b.useState)({color:"",name:""}),en=(0,y.Z)(Pn,2),G=en[0],tn=en[1],En=(0,b.useState)(),rn=(0,y.Z)(En,2),K=rn[0],k=rn[1],Bn=(0,b.useState)([]),an=(0,y.Z)(Bn,2),p=an[0],Cn=an[1],xn=(0,b.useState)(10),sn=(0,y.Z)(xn,2),J=sn[0],ln=sn[1],Sn=(0,b.useState)(1),un=(0,y.Z)(Sn,2),Q=un[0],q=un[1],dn=function(r){r||q(1),r<.1||r>3?q(1):q(r)},U=function(r){k(r),r!=null&&r.label&&tn(r.label)},N=function(r){Cn(r)};(0,b.useEffect)(function(){localStorage.removeItem("history"),w([])},[]);function w(v,r){var m=localStorage.getItem("history"),C=m?JSON.parse(m):{index:-1,items:[]},_n={currentAnnotation:r,annotations:v};if(JSON.stringify(C.items[C.index])!=JSON.stringify(_n)){var Hn=C.index>X?C.index-X:0,Jn=C.items.splice(Hn,C.index==0?1:C.index+1);C.items=Jn.concat([_n]),C.index<=X?C.index++:C.index=X+1,localStorage.setItem("history",JSON.stringify(C))}}var On=function(){var r=localStorage.getItem("history");if(!!r){var m=JSON.parse(r);if(!!m&&!(m.index>=m.items.length-1)){m.index++,localStorage.setItem("history",JSON.stringify(m));var C=m.items[m.index];k(C.currentAnnotation),N(C.annotations)}}},bn=function(){var r=localStorage.getItem("history");if(!!r){var m=JSON.parse(r);if(!(!m||!m.index)&&!(m.index<=0)){m.index--,localStorage.setItem("history",JSON.stringify(m));var C=m.items[m.index];k(C.currentAnnotation),N(C.annotations)}}},nn=function(r){for(var m=[],C=0;C<p.length;C++)p[C].annotationId==r.annotationId?m.push(r):m.push(p[C]);U(r),N(m)},cn=(0,A.Z)({currentLabel:G,brushSize:J,currentTool:R,annotations:p,currentAnnotation:K,onAnnotationAdd:function(r){var m=p.concat([r]);N(m),K||U(r)},onAnnotationModify:nn,onMouseUp:function(){w(p,K)}}),vn=(0,E.Z)({currentLabel:G,brushSize:J,currentTool:R,annotations:p,currentAnnotation:K,onAnnotationAdd:function(r){var m=p.concat([r]);N(m),K||U(r)},onAnnotationModify:nn,onMouseUp:function(){w(p,K)}}),on=R=="polygon"?vn:cn,An=(0,f.YB)().formatMessage({id:"pages.toolBar.polygon"}),yn=(0,f.YB)().formatMessage({id:"pages.toolBar.brush"}),Dn=(0,f.YB)().formatMessage({id:"pages.toolBar.rubber"}),Ln=(0,f.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),pn=(0,f.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),jn=(0,f.YB)().formatMessage({id:"pages.toolBar.move"}),In=(0,f.YB)().formatMessage({id:"pages.toolBar.unDo"}),Tn=(0,f.YB)().formatMessage({id:"pages.toolBar.reDo"}),Zn=(0,f.YB)().formatMessage({id:"pages.toolBar.save"}),Rn=(0,f.YB)().formatMessage({id:"pages.toolBar.edit"}),Un=(0,f.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Wn=(0,f.YB)().formatMessage({id:"pages.toolBar.interactor"}),Kn=(0,f.YB)().formatMessage({id:"pages.toolBar.segmentThreshold"}),zn=(0,f.YB)().formatMessage({id:"pages.toolBar.diaphaneity"}),Yn=(0,f.YB)().formatMessage({id:"pages.toolBar.visualRadius"}),Fn=(0,f.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),Nn=(0,f.YB)().formatMessage({id:"pages.toolBar.medicalSetting"}),Xn=(0,f.YB)().formatMessage({id:"pages.toolBar.divideData"}),$n=(0,f.YB)().formatMessage({id:"pages.toolBar.export"});return(0,e.jsxs)(P.Z,{className:t().segment,children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(a.Z,{active:R=="polygon",onClick:function(){H("polygon"),U(void 0)},children:An}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/edit.png",children:Rn}),(0,e.jsx)(i.Z,{size:J,active:R=="brush",onClick:function(){R!="rubber"&&R!="brush"&&U(void 0),H("brush")},onChange:function(r){ln(r)},children:yn}),(0,e.jsx)(i.Z,{size:J,active:R=="rubber",onClick:function(){R!="rubber"&&R!="brush"&&U(void 0),H("rubber")},onChange:function(r){ln(r)},imgSrc:"./pics/buttons/rubber.png",children:Dn}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){dn(Q+.1)},children:Ln}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){dn(Q-.1)},children:pn}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/save.png",children:Zn}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){H("mover")},children:jn}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){bn()},children:In}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){On()},children:Tn}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:Un})]}),(0,e.jsxs)("div",{id:"dr",className:t().mainStage,children:[(0,e.jsx)("div",{className:t().draw,children:(0,e.jsx)(h.Z,{width:(F=document.getElementById("dr"))===null||F===void 0?void 0:F.clientWidth,scale:Q,annotations:p,currentTool:R,currentAnnotation:K,setCurrentAnnotation:U,onAnnotationModify:nn,onAnnotationModifyComplete:function(){w(p,K)},onMouseDown:on.onMouseDown,onMouseMove:on.onMouseMove,onMouseUp:on.onMouseUp,createPolygonFunc:vn.createElementsFunc,createBrushFunc:cn.createElementsFunc})}),(0,e.jsx)("div",{className:t().pblock,children:(0,e.jsx)("div",{className:t().progress,children:(0,e.jsx)(x.Z,{percent:50,status:"active"})})})]}),(0,e.jsxs)(_.Z,{disLoc:"right",children:[(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:Wn}),(0,e.jsx)(g.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:Kn}),(0,e.jsx)(g.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:zn}),(0,e.jsx)(g.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:Yn}),(0,e.jsxs)(O.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,e.jsx)(mn,{}),trigger:"hover",children:[" ",(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:Nn})]}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/data_division.png",children:Xn}),(0,e.jsx)(o.Z,{imgSrc:"./pics/buttons/export.png",children:$n})]}),(0,e.jsxs)("div",{className:t().rightSideBar,children:[(0,e.jsx)("div",{className:t().determinOutline,children:(0,e.jsx)(I.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){U(void 0)},children:Fn})}),(0,e.jsx)(s.Z,{selectedLabel:G,onLabelSelect:function(r){tn(r),U(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,e.jsx)(u.Z,{selectedAnnotation:K,annotations:p,onAnnotationSelect:function(r){r!=null&&r.delete||U(r)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(r){N(p.filter(function(m){return m.annotationId!=r.annotationId})),U(void 0)}})]})]})},hn=gn}}]);
