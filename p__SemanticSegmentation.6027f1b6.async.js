(self.webpackChunkpp_labeling_frontend=self.webpackChunkpp_labeling_frontend||[]).push([[540],{91220:function(B,y,t){"use strict";t.d(y,{Z:function(){return R}});var Z=t(64254);function R(M,W){var m;if(typeof Symbol=="undefined"||M[Symbol.iterator]==null){if(Array.isArray(M)||(m=(0,Z.Z)(M))||W&&M&&typeof M.length=="number"){m&&(M=m);var f=0,L=function(){};return{s:L,n:function(){return f>=M.length?{done:!0}:{done:!1,value:M[f++]}},e:function(n){throw n},f:L}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var E=!0,x=!1,P;return{s:function(){m=M[Symbol.iterator]()},n:function(){var n=m.next();return E=n.done,n},e:function(n){x=!0,P=n},f:function(){try{!E&&m.return!=null&&m.return()}finally{if(x)throw P}}}}},57560:function(B){B.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(B){B.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},54777:function(B){B.exports={segment:"segment___1YMcl",mainStage:"mainStage___2otee",draw:"draw___equn4",pblock:"pblock___2bT7z",progress:"progress___1porz",rightSideBar:"rightSideBar___2X7jK",determinOutline:"determinOutline___2ls57"}},43801:function(B,y,t){"use strict";t.d(y,{Z:function(){return C}});var Z=t(11849),R=t(2824),M=t(91220),W=t(67294),m=t(65031),f=t(85893);function L(n,l,u,g){if(!(!n||!l||!u||!g))return{width:n,color:l,points:u,tool:g}}function E(n){if(!n)return[(0,f.jsx)(f.Fragment,{})];var l=[],u=(0,M.Z)(n),g;try{for(u.s();!(g=u.n()).done;){var d=g.value;if(!(!d||!d.lines)){var b=(0,M.Z)(d.lines),h;try{for(b.s();!(h=b.n()).done;){var r=h.value;!r.width||!r.color||!r.points||!r.tool||l.push((0,f.jsx)(m.x1,{stroke:r.color,strokeWidth:r.width,globalCompositeOperation:r.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:r.points,tension:.01}))}}catch(o){b.e(o)}finally{b.f()}}}}catch(o){u.e(o)}finally{u.f()}return l}function x(n,l){return n=="rubber"||l==2?"rubber":"brush"}function P(n){var l=0,u=(0,M.Z)(n),g;try{for(u.s();!(g=u.n()).done;){var d=g.value;!d||d.annotationId>l&&(l=d.annotationId)}}catch(b){u.e(b)}finally{u.f()}return l}function C(n){var l=(0,W.useState)(),u=(0,R.Z)(l,2),g=u[0],d=u[1],b=function(A,D){var S;if(console.log(n.currentTool),!(n.currentTool!="brush"&&n.currentTool!="rubber")){var O=A.evt.offsetX/D,c=A.evt.offsetY/D,a=x(n.currentTool,A.evt.button),_=L(n.brushSize||10,(S=n.currentLabel)===null||S===void 0?void 0:S.color,[O,c,O,c],a);if(!!_)if(d(a),n.currentAnnotation){var U,p={annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:(U=n.currentAnnotation.lines)===null||U===void 0?void 0:U.concat([_])};n.onAnnotationModify(p)}else{if(a=="rubber")return;n.onAnnotationAdd({annotationId:P(n.annotations)+1,label:n.currentLabel,lines:[_]})}}},h=function(A,D){var S;if(!(!g||!n.currentAnnotation)){var O=A.evt.offsetX/D,c=A.evt.offsetY/D,a=[O,c],_=[];(S=n.currentAnnotation)!==null&&S!==void 0&&S.lines&&(a=n.currentAnnotation.lines[n.currentAnnotation.lines.length-1].points.concat(a),_=n.currentAnnotation.lines);var U=L(n.brushSize||10,n.currentLabel.color,a,g);!U||(_.pop(),_.push(U),n.onAnnotationModify((0,Z.Z)((0,Z.Z)({},n.currentAnnotation),{},{lines:_})))}},r=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||d(void 0)};return{onMouseDown:b,onMouseMove:h,onMouseUp:r,createElementsFunc:E}}},58967:function(B,y,t){"use strict";var Z=t(20136),R=t(55241),M=t(77883),W=t(70507),m=t(57663),f=t(71577),L=t(2824),E=t(67294),x=t(61541),P=t(57560),C=t.n(P),n=t(85893),l=1,u=50,g=10;function d(h){return h?h<=l?l:h>=u?u:h:g}var b=function(r){var o=(0,E.useState)(d(r.size)),A=(0,L.Z)(o,2),D=A[0],S=A[1],O=function(a){S(d(a))};return(0,E.useEffect)(function(){O(r.size)},[r.size]),(0,n.jsxs)(R.Z,{overlayClassName:C().popover,placement:"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{type:"text",onClick:function(){var a,_=d(D-1);O(_),(a=r.onChange)===null||a===void 0||a.call(0,_)},children:"-"}),(0,n.jsx)(W.Z,{min:l,max:u,value:D,onChange:function(a){var _;(_=r.onChange)===null||_===void 0||_.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(f.Z,{type:"text",onClick:function(){var a,_=d(D+1);O(_),(a=r.onChange)===null||a===void 0||a.call(0,_)},children:"+"})]}),trigger:r.active?"hover":"click",children:[" ",(0,n.jsx)(x.Z,{active:r.active,imgSrc:r.imgSrc||"./pics/buttons/brush.png",onClick:r.onClick,children:r.children||"Brush"})]})};y.Z=b},27992:function(B,y,t){"use strict";var Z=t(20136),R=t(55241),M=t(77883),W=t(70507),m=t(57663),f=t(71577),L=t(2824),E=t(67294),x=t(61541),P=t(26647),C=t.n(P),n=t(85893),l=1,u=100,g=10;function d(h){return h?h<=l?l:h>=u?u:h:g}var b=function(r){var o=(0,E.useState)(d(r.size)),A=(0,L.Z)(o,2),D=A[0],S=A[1],O=function(a){S(d(a))};return(0,E.useEffect)(function(){O(r.size)},[r.size]),(0,n.jsxs)(R.Z,{overlayClassName:"".concat(C().popover," ").concat(r.disLoc=="left"?C().popoverLeft:""),placement:r.disLoc||"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{type:"text",onClick:function(){var a,_=d(D-1);O(_),(a=r.onChange)===null||a===void 0||a.call(0,_)},children:"-"}),(0,n.jsx)(W.Z,{min:l,max:u,value:D,onChange:function(a){var _;(_=r.onChange)===null||_===void 0||_.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(f.Z,{type:"text",onClick:function(){var a,_=d(D+1);O(_),(a=r.onChange)===null||a===void 0||a.call(0,_)},children:"+"})]}),trigger:"hover",children:[" ",(0,n.jsx)(x.Z,{imgSrc:r.imgSrc,onClick:r.onClick,children:r.children})]})};y.Z=b},86089:function(B,y,t){"use strict";t.r(y);var Z=t(57663),R=t(71577),M=t(34669),W=t(54458),m=t(2824),f=t(67294),L=t(54777),E=t.n(L),x=t(8088),P=t(61541),C=t(44434),n=t(58967),l=t(27992),u=t(5041),g=t(57436),d=t(14836),b=t(29919),h=t(43801),r=t(13931),o=t(85893),A=function(){var S=(0,f.useState)(void 0),O=(0,m.Z)(S,2),c=O[0],a=O[1],_=(0,f.useState)({color:"",name:""}),U=(0,m.Z)(_,2),p=U[0],$=U[1],on=(0,f.useState)(),V=(0,m.Z)(on,2),j=V[0],F=V[1],rn=(0,f.useState)([]),G=(0,m.Z)(rn,2),T=G[0],J=G[1],an=(0,f.useState)(10),Q=(0,m.Z)(an,2),K=Q[0],w=Q[1],_n=(0,f.useState)(1),q=(0,m.Z)(_n,2),k=q[0],H=q[1],nn=function(e){e||H(1),e<.1||e>3?H(1):H(e)},I=function(e){F(e),e!=null&&e.label&&$(e.label)},z=function(e){J(e)};(0,f.useEffect)(function(){localStorage.removeItem("history")},[]);function X(s,e){var i=localStorage.getItem("history"),v=i?JSON.parse(i):{index:-1,items:[]};console.log("history before set: ");var dn=JSON.stringify(v);console.log(dn);var Y={currentAnnotation:e,annotations:s};if(JSON.stringify(v.items[v.index])==JSON.stringify(Y)){console.log("equal with latest, do not add to history");return}var en=v.items.splice(0,v.index==0?1:v.index+1);console.log("itemsToKeep: ".concat(JSON.stringify(en))),console.log("itemsToAdd: ".concat(JSON.stringify(Y))),v.items=en.concat([Y]),v.index++,localStorage.setItem("history",JSON.stringify(v)),console.log("history after set: "),console.log(JSON.stringify(v))}var sn=function(){var e=localStorage.getItem("history");if(!e){console.log("no historyStr, skip.");return}var i=JSON.parse(e);if(!!i){if(i.index>=i.items.length-1){console.log("already latest, skip. history.index:".concat(i.index," history.items.length:").concat(i.items.length));return}i.index++,localStorage.setItem("history",JSON.stringify(i)),console.log("After forward. history:".concat(JSON.stringify(i)));var v=i.items[i.index];F(v.currentAnnotation),J(v.annotations)}},ln=function(){var e=localStorage.getItem("history");if(!!e){var i=JSON.parse(e);if(!(!i||!i.index)&&!(i.index<=0)){i.index--,localStorage.setItem("history",JSON.stringify(i));var v=i.items[i.index];console.log("after backward: ".concat(JSON.stringify(i))),F(v.currentAnnotation),J(v.annotations)}}},tn=function(e){for(var i=[],v=0;v<T.length;v++)T[v].annotationId==e.annotationId?i.push(e):i.push(T[v]);I(e),z(i),X(i,e)},un=(0,h.Z)({currentLabel:p,brushSize:K,currentTool:c,annotations:T,currentAnnotation:j,onAnnotationAdd:function(e){var i=T.concat([e]);z(i),j||I(e),X(i,e)},onAnnotationModify:tn}),cn=(0,r.Z)({currentLabel:p,brushSize:K,currentTool:c,annotations:T,currentAnnotation:j,onAnnotationAdd:function(e){var i=T.concat([e]);z(i),j||I(e),X(i,e)},onAnnotationModify:tn}),N=c=="polygon"?cn:un;return(0,o.jsxs)(x.Z,{className:E().segment,children:[(0,o.jsxs)(C.Z,{children:[(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Intelligent Interaction"}),(0,o.jsx)(b.Z,{active:c=="polygon",onClick:function(){a("polygon"),I(void 0)},children:"Polygon"}),(0,o.jsx)(n.Z,{size:K,active:c=="brush",onClick:function(){c!="rubber"&&c!="brush"&&I(void 0),a("brush")},onChange:function(e){w(e)},children:"Brush"}),(0,o.jsx)(n.Z,{size:K,active:c=="rubber",onClick:function(){c!="rubber"&&c!="brush"&&I(void 0),a("rubber")},onChange:function(e){w(e)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){nn(k+.1)},children:"Zoom in"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){nn(k-.1)},children:"Zoom out"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/move.png",children:"Move"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){ln()},children:"Undo"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){sn()},children:"Redo"}),(0,o.jsx)(P.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{className:E().mainStage,children:[(0,o.jsx)("div",{className:E().draw,children:(0,o.jsx)(g.Z,{scale:k,annotations:T,onMouseDown:N.onMouseDown,onMouseMove:N.onMouseMove,onMouseUp:N.onMouseUp,createElementsFunc:N.createElementsFunc})}),(0,o.jsx)("div",{className:E().pblock,children:(0,o.jsx)("div",{className:E().progress,children:(0,o.jsx)(W.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(C.Z,{disLoc:"right",children:[(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"})]}),(0,o.jsxs)("div",{className:E().rightSideBar,children:[(0,o.jsx)("div",{className:E().determinOutline,children:(0,o.jsx)(R.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){I(void 0)},children:"Determine Outline"})}),(0,o.jsx)(u.Z,{selectedLabel:p,onLabelSelect:function(e){$(e),I(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(d.Z,{selectedAnnotation:j,annotations:T,onAnnotationSelect:function(e){e!=null&&e.delete||I(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){z(T.filter(function(i){return i.annotationId!=e.annotationId})),I(void 0)}})]})]})};y.default=A}}]);
