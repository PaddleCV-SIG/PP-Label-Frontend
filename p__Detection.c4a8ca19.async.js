(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(I,P,n){"use strict";n.d(P,{Z:function(){return d}});var y=n(94663),M=n(80112);function B(o){return Function.toString.call(o).indexOf("[native code]")!==-1}var E=n(18597);function x(o,i,A){return(0,E.Z)()?x=Reflect.construct:x=function(h,F,J){var r=[null];r.push.apply(r,F);var z=Function.bind.apply(h,r),c=new z;return J&&(0,M.Z)(c,J.prototype),c},x.apply(null,arguments)}function d(o){var i=typeof Map=="function"?new Map:void 0;return d=function(s){if(s===null||!B(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof i!="undefined"){if(i.has(s))return i.get(s);i.set(s,h)}function h(){return x(s,arguments,(0,y.Z)(this).constructor)}return h.prototype=Object.create(s.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),(0,M.Z)(h,s)},d(o)}},85024:function(I){I.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(I){I.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},72285:function(I){I.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},14836:function(I,P,n){"use strict";n.d(P,{Z:function(){return X}});var y=n(54421),M=n(38272),B=n(57663),E=n(71577),x=n(91220),d=n(67294),o=n(56159),i=n.n(o),A=n(49111),s=n(19650),h=n(2824),F=n(8870),J=n(85024),r=n.n(J),z=n(63097),c=n(85893),$=function(l){var g=(0,F.Z)({},l.annotation),R=(0,d.useState)(g.invisible),H=(0,h.Z)(R,2),k=H[0],f=H[1],Z=(0,d.useState)(0),u=(0,h.Z)(Z,2),v=u[0],L=u[1];(0,d.useEffect)(function(){f(l.annotation.invisible)},[l.annotation.invisible]);var N=(0,c.jsxs)(M.ZP.Item,{className:"".concat(r().listItem," ").concat(l.active?r().listItemActive:""),unselectable:"on",onClick:function(){l.onClick(g)},children:[(0,c.jsxs)(s.Z,{align:"center",size:5,children:[(0,c.jsx)("a",{className:r().eye,style:{backgroundImage:k?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(S){S.stopPropagation(),f(!k),l.onAnnotationModify(g)}})," ",(0,c.jsx)("span",{className:r().annotationId,children:g.frontendId}),(0,c.jsx)("span",{className:r().labelName,children:g.label.name}),(0,c.jsx)(z.Z,{color:g.label.color})]}),(0,c.jsx)("a",{className:r().delete,onClick:function(S){S.stopPropagation();var V=new Date().getTime();V-v<300||(L(V),l.onAnnotationDelete(g))}})]});return N},G=$,e=n(48971),Q=function(l){var g=(0,e.YB)(),R=g.formatMessage({id:"component.PPAnnotationList.annotationList"}),H=g.formatMessage({id:"component.PPAnnotationList.addAnnotation"}),k=new Set,f=[],Z=(0,x.Z)(l.annotations),u;try{for(Z.s();!(u=Z.n()).done;){var v=u.value;k.has(v.frontendId)||(f.push(v),k.add(v.frontendId))}}catch(L){Z.e(L)}finally{Z.f()}return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(M.ZP,{className:i().labelList,size:"large",header:(0,c.jsx)("div",{className:i().listHeader,children:R}),bordered:!0,dataSource:f,renderItem:function(N){var b;return(0,c.jsx)(G,{onClick:l.onAnnotationSelect,annotation:N,active:N.frontendId==((b=l.currAnnotation)===null||b===void 0?void 0:b.frontendId),onAnnotationDelete:l.onAnnotationDelete,onAnnotationModify:l.onAnnotationModify})},footer:(0,c.jsx)("div",{children:(0,c.jsx)(E.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){l.onAnnotationAdd()},block:!0,children:H})})})})},X=Q},91861:function(I,P,n){"use strict";n.d(P,{Ad:function(){return M},k3:function(){return B},Vd:function(){return E},td:function(){return x}});var y=40;function M(){localStorage.removeItem("history"),B([])}function B(d){var o=localStorage.getItem("history"),i=o?JSON.parse(o):{index:-1,items:[]};if(JSON.stringify(i.items[i.index])!=JSON.stringify(d)){var A=i.index>y?i.index-y:0,s=i.items.splice(A,i.index==0?1:i.index+1);i.items=s.concat([d]),i.index<=y?i.index++:i.index=y+1,localStorage.setItem("history",JSON.stringify(i))}}function E(){var d=localStorage.getItem("history");if(!!d){var o=JSON.parse(d);if(!!o&&!(o.index>=o.items.length-1))return o.index++,localStorage.setItem("history",JSON.stringify(o)),o.items[o.index]}}function x(){var d=localStorage.getItem("history");if(!!d){var o=JSON.parse(d);if(!(!o||!o.index)&&!(o.index<=0))return o.index--,localStorage.setItem("history",JSON.stringify(o)),o.items[o.index]}}},30289:function(I,P,n){"use strict";n.r(P),n.d(P,{default:function(){return H}});var y=n(8870),M=n(20228),B=n(11382),E=n(34669),x=n(54458),d=n(34792),o=n(48086),i=n(91220),A=n(2824),s=n(67294),h=n(72285),F=n.n(h),J=n(8088),r=n(61541),z=n(44434),c=n(5041),$=n(57436),G=n(14836),e=n(85893),Q=function(f){return(0,e.jsx)(r.Z,{active:f.active,imgSrc:f.imgSrc||"./pics/buttons/rectangle.png",onClick:f.onClick,children:f.children})},X=Q,W=n(50501),l=n(91861),g=n(48971),R=function(){var f,Z=(0,W.$L)(s.useState,s.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:l.Ad}}),u=(0,A.Z)(Z,10),v=u[0],L=u[1],N=u[2],b=u[3],S=u[4],V=u[5],w=u[6],O=u[7],Zn=u[8],Nn=u[9],sn=(0,s.useState)(),nn=(0,A.Z)(sn,2),Y=nn[0],m=nn[1],ln=(0,s.useState)([]),tn=(0,A.Z)(ln,2),C=tn[0],D=tn[1],cn=(0,s.useState)(!1),en=(0,A.Z)(cn,2),bn=en[0],dn=en[1],un=(0,s.useState)(!1),on=(0,A.Z)(un,2),Bn=on[0],fn=on[1],vn=function(t){if(!t.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(t));C.push(t),D(C),m(t)},an=function(t){if(!t.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(t));var T=[],j=(0,i.Z)(C),U;try{for(j.s();!(U=j.n()).done;){var K=U.value;K.frontendId==t.frontendId?T.push(t):T.push(K)}}catch(_){j.e(_)}finally{j.f()}console.log("modifyAnnotation, newAnnos:",T,"anno:",t),D(T),m(t)},mn=function(t){if(!t.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(t));var T=[],j=(0,i.Z)(C),U;try{for(j.s();!(U=j.n()).done;){var K=U.value;K.frontendId!=t.frontendId&&T.push(K)}}catch(_){j.e(_)}finally{j.f()}D(T),m(void 0)},kn=function(t){!t||(console.log("modifyAnnotation",t,"anno.label:",t==null?void 0:t.label),t.taskId=S.curr.taskId,t.dataId=V.curr.dataId,b.modify(t))},rn=drawRectangle({currentLabel:O.curr,currentTool:v.curr,annotations:C,currentAnnotation:Y,onAnnotationAdd:vn,onAnnotationModify:an,onMouseUp:function(){(0,l.k3)({annos:C,currAnno:Y})}}),q=rn,p=(0,g.YB)(),gn=p.formatMessage({id:"pages.toolBar.rectangle"}),pn=p.formatMessage({id:"pages.toolBar.zoomIn"}),hn=p.formatMessage({id:"pages.toolBar.zoomOut"}),Sn=p.formatMessage({id:"pages.toolBar.move"}),yn=p.formatMessage({id:"pages.toolBar.unDo"}),xn=p.formatMessage({id:"pages.toolBar.reDo"}),An=p.formatMessage({id:"pages.toolBar.save"}),In=p.formatMessage({id:"pages.toolBar.edit"}),Cn=p.formatMessage({id:"pages.toolBar.clearMark"}),jn=p.formatMessage({id:"pages.toolBar.undef"}),Pn=p.formatMessage({id:"pages.toolBar.divideData"}),Mn=p.formatMessage({id:"pages.toolBar.export"});return(0,e.jsxs)(J.Z,{className:F().det,children:[(0,e.jsxs)(z.Z,{children:[(0,e.jsx)(X,{active:v.curr=="rectangle",onClick:function(){if(!O.curr){o.default.error("Please choose a label category first!");return}v.setCurr("rectangle"),m(void 0)},children:gn}),(0,e.jsx)(r.Z,{active:v.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){v.setCurr("editor")},children:In}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){N.change(.1)},children:pn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){N.change(-.1)},children:hn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){o.default.info("Annotations are saved automatically. You don't need to click save.")},children:An}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/move.png",active:v.curr=="mover",onClick:function(){v.setCurr("mover")},children:Sn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var t=(0,l.td)();!t||(m(t.currAnno),D(t.annos))},children:yn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var t=(0,l.Vd)();!t||(m(t.currAnno),D(t.annos))},children:xn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:Cn})]}),(0,e.jsx)("div",{id:"dr",className:"mainStage",children:(0,e.jsxs)(B.Z,{tip:"loading",spinning:!!L.curr,children:[(0,e.jsx)("div",{className:"draw",children:(0,e.jsx)($.Z,{scale:N.curr,annotations:C,currentTool:v.curr,currentAnnotation:Y,setCurrentAnnotation:m,onAnnotationModify:an,onAnnotationModifyComplete:function(){(0,l.k3)({annos:C,currAnno:Y})},onMouseDown:q.onMouseDown,onMouseMove:q.onMouseMove,onMouseUp:q.onMouseUp,createRectangleFunc:rn.createElementsFunc,imgSrc:V.imgSrc})}),(0,e.jsx)("div",{className:"pblock",children:(0,e.jsxs)("div",{className:"progress",children:[(0,e.jsx)(x.Z,{className:"progressBar",percent:w.progress,status:"active",showInfo:!1})," ",(0,e.jsxs)("span",{className:"progressDesc",children:["Current labeling ",S.currIdx==null?1:S.currIdx+1," of"," ",(f=S.all)===null||f===void 0?void 0:f.length,". Already labeled ",S.finished(w.progress)||0,"."]})]})}),(0,e.jsx)("div",{className:"prevTask",onClick:function(){!S.prevTask()||(m(void 0),D([]))}}),(0,e.jsx)("div",{className:"nextTask",onClick:function(){!S.nextTask()||(m(void 0),D([]))}})]})}),(0,e.jsxs)(z.Z,{disLoc:"right",children:[(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){dn(!0)},children:Pn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){fn(!0)},children:Mn}),(0,e.jsx)(r.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){m(void 0)},children:jn})]}),(0,e.jsxs)("div",{className:"rightSideBar",children:[(0,e.jsx)(c.Z,{labels:O.all,activeIds:O.activeIds,onLabelSelect:function(t){O.onSelect(t),m(void 0)},onLabelModify:function(){},onLabelDelete:O.remove,onLabelAdd:function(t){return O.create((0,y.Z)((0,y.Z)({},t),{},{projectId:w.curr.projectId}))}}),(0,e.jsx)(G.Z,{annotations:C,currAnnotation:Y,onAnnotationSelect:m,onAnnotationAdd:function(){m(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(t){mn(t)}})]})]})},H=R}}]);
