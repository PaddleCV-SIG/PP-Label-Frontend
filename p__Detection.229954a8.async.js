(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(m,g,n){"use strict";n.d(g,{Z:function(){return u}});var f=n(94663),h=n(80112);function L(a){return Function.toString.call(a).indexOf("[native code]")!==-1}var W=n(18597);function x(a,r,I){return(0,W.Z)()?x=Reflect.construct:x=function(y,O,D){var d=[null];d.push.apply(d,O);var l=Function.bind.apply(y,d),p=new l;return D&&(0,h.Z)(p,D.prototype),p},x.apply(null,arguments)}function u(a){var r=typeof Map=="function"?new Map:void 0;return u=function(s){if(s===null||!L(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r!="undefined"){if(r.has(s))return r.get(s);r.set(s,y)}function y(){return x(s,arguments,(0,f.Z)(this).constructor)}return y.prototype=Object.create(s.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),(0,h.Z)(y,s)},u(a)}},85024:function(m){m.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(m){m.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},6277:function(m){m.exports={modal:"modal___26yNn"}},45092:function(m){m.exports={modal:"modal___1H_FQ"}},72285:function(m){m.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},14836:function(m,g,n){"use strict";n.d(g,{Z:function(){return Q}});var f=n(54421),h=n(38272),L=n(57663),W=n(71577),x=n(67294),u=n(56159),a=n.n(u),r=n(49111),I=n(19650),s=n(2824),y=n(11849),O=n(85024),D=n.n(O),d=n(63097),l=n(85893),p=function(e){var _=(0,y.Z)({},e.annotation),v=(0,x.useState)(_.invisible),E=(0,s.Z)(v,2),S=E[0],j=E[1],V=(0,x.useState)(0),R=(0,s.Z)(V,2),C=R[0],z=R[1];(0,x.useEffect)(function(){j(e.annotation.invisible)},[e.annotation.invisible]);var c=(0,l.jsxs)(h.ZP.Item,{className:"".concat(D().listItem," ").concat(e.active?D().listItemActive:""),unselectable:"on",onClick:function(){e.onClick(_)},children:[(0,l.jsxs)(I.Z,{align:"center",size:5,children:[(0,l.jsx)("a",{className:D().eye,style:{backgroundImage:S?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(U){U.stopPropagation(),j(!S),e.onAnnotationModify(_)}})," ",(0,l.jsx)("span",{className:D().annotationId,children:_.frontendId}),(0,l.jsx)("span",{className:D().labelName,children:_.label.name}),(0,l.jsx)(d.Z,{color:_.label.color})]}),(0,l.jsx)("a",{className:D().delete,onClick:function(U){U.stopPropagation();var J=new Date().getTime();J-C<300||(z(J),e.onAnnotationDelete(_))}})]});return c},T=p,M=n(48971),t=function(e){var _=(0,M.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),v=(0,M.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(h.ZP,{className:a().labelList,size:"large",header:(0,l.jsx)("div",{className:a().listHeader,children:_}),bordered:!0,dataSource:e.annotations,renderItem:function(S){var j;return(0,l.jsx)(T,{onClick:e.onAnnotationSelect,annotation:S,active:S.frontendId==((j=e.currAnnotation)===null||j===void 0?void 0:j.frontendId),onAnnotationDelete:e.onAnnotationDelete,onAnnotationModify:e.onAnnotationModify})},footer:(0,l.jsx)("div",{children:(0,l.jsx)(W.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){e.onAnnotationAdd()},block:!0,children:v})})})})},Q=t},85871:function(m,g,n){"use strict";var f=n(71194),h=n(50146),L=n(49111),W=n(19650),x=n(57663),u=n(71577),a=n(13062),r=n(71230),I=n(89032),s=n(15746),y=n(77883),O=n(70507),D=n(34792),d=n(48086),l=n(9715),p=n(93766),T=n(2824),M=n(67294),t=n(48971),Q=n(6277),B=n.n(Q),e=n(85893),_=function(E){var S=(0,t.YB)(),j=(0,M.useState)(60),V=(0,T.Z)(j,2),R=V[0],C=V[1],z=(0,M.useState)(20),c=(0,T.Z)(z,2),P=c[0],U=c[1],J=(0,M.useState)(20),w=(0,T.Z)(J,2),Z=w[0],q=w[1],H=(0,M.useState)(!1),N=(0,T.Z)(H,2),sn=N[0],nn=N[1],rn=(0,t.YB)().formatMessage({id:"pages.toolBar.divideData"}),tn=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.train"}),$=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.validation"}),A=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.test"}),ln=(0,t.YB)().formatMessage({id:"component.PPCreater.cancel"}),en=(0,t.YB)().formatMessage({id:"component.PPSegMode.ok"}),K=p.Z.useForm(),F=(0,T.Z)(K,1),on=F[0];return(0,e.jsx)(h.Z,{className:B().modal,title:rn,visible:E.visible,onCancel:E.onCancel,footer:null,children:(0,e.jsxs)(p.Z,{form:on,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(){if(R+P+Z!=100){d.default.error("Train, Validation and Test total percent should equal 100!");return}console.log("x trainData: ".concat(R,", validationData: ").concat(P,", testData: ").concat(Z,", props.project.curr.projectId: ").concat(E.project.curr.projectId)),nn(!0),E.splitDataset(E.project.curr.projectId,{train:R*.01,validation:P*.01,test:Z*.01}).then(function(){var b;console.log("success"),d.default.success(S.formatMessage({id:"component.PPDivideDataModal.success"})),(b=E.onFinish)===null||b===void 0||b.call(0)}).finally(function(){nn(!1)})},autoComplete:"off",layout:"vertical",children:[(0,e.jsxs)(r.Z,{children:[(0,e.jsx)(s.Z,{span:8,children:(0,e.jsx)(p.Z.Item,{label:tn,name:"train",children:(0,e.jsx)(O.Z,{addonAfter:"%",defaultValue:60,precision:0,min:0,max:100,value:R,onChange:C})})}),(0,e.jsx)(s.Z,{span:8,children:(0,e.jsx)(p.Z.Item,{label:$,name:"validation",children:(0,e.jsx)(O.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:P,onChange:U})})}),(0,e.jsx)(s.Z,{span:8,children:(0,e.jsx)(p.Z.Item,{label:A,name:"test",children:(0,e.jsx)(O.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:Z,onChange:q})})})]}),(0,e.jsx)(p.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsxs)(W.Z,{children:[(0,e.jsx)(u.Z,{onClick:function(){var b;(b=E.onCancel)===null||b===void 0||b.call(0),on.resetFields()},children:ln}),(0,e.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:sn,children:en})]})})]})})};g.Z=_},62850:function(m,g,n){"use strict";var f=n(71194),h=n(50146),L=n(49111),W=n(19650),x=n(57663),u=n(71577),a=n(47673),r=n(24044),I=n(34792),s=n(48086),y=n(9715),O=n(93766),D=n(2824),d=n(67294),l=n(48971),p=n(45092),T=n.n(p),M=n(85893),t=function(B){var e=(0,l.YB)(),_=(0,d.useState)(!1),v=(0,D.Z)(_,2),E=v[0],S=v[1],j=(0,l.YB)().formatMessage({id:"component.PPCreater.cancel"}),V=O.Z.useForm(),R=(0,D.Z)(V,1),C=R[0];return(0,M.jsx)(h.Z,{className:T().modal,title:(0,l.YB)().formatMessage({id:"component.PPExportModal.title"}),visible:B.visible,onCancel:B.onCancel,footer:null,children:(0,M.jsxs)(O.Z,{form:C,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(c){console.log(c);var P=c.path;if(!P){s.default.error(e.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}S(!0),B.exportDataset(B.project.curr.projectId,P).then(function(){var U;s.default.success(e.formatMessage({id:"component.PPExportModal.exportSuccess"})),(U=B.onFinish)===null||U===void 0||U.call(0)}).finally(function(){S(!1)})},autoComplete:"off",children:[(0,M.jsx)(O.Z.Item,{label:e.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,M.jsx)(r.Z,{})}),(0,M.jsx)(O.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,M.jsxs)(W.Z,{children:[(0,M.jsx)(u.Z,{onClick:function(){var c;(c=B.onCancel)===null||c===void 0||c.call(0),C.resetFields()},children:j}),(0,M.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:E,children:e.formatMessage({id:"component.PPExportModal.export"})})]})})]})})};g.Z=t},91861:function(m,g,n){"use strict";n.d(g,{Ad:function(){return h},k3:function(){return L},Vd:function(){return W},td:function(){return x}});var f=40;function h(){localStorage.removeItem("history"),L([])}function L(u){var a=localStorage.getItem("history"),r=a?JSON.parse(a):{index:-1,items:[]};if(JSON.stringify(r.items[r.index])!=JSON.stringify(u)){var I=r.index>f?r.index-f:0,s=r.items.splice(I,r.index==0?1:r.index+1);r.items=s.concat([u]),r.index<=f?r.index++:r.index=f+1,localStorage.setItem("history",JSON.stringify(r))}}function W(){var u=localStorage.getItem("history");if(!!u){var a=JSON.parse(u);if(!!a&&!(a.index>=a.items.length-1))return a.index++,localStorage.setItem("history",JSON.stringify(a)),a.items[a.index]}}function x(){var u=localStorage.getItem("history");if(!!u){var a=JSON.parse(u);if(!(!a||!a.index)&&!(a.index<=0))return a.index--,localStorage.setItem("history",JSON.stringify(a)),a.items[a.index]}}},30289:function(m,g,n){"use strict";n.r(g),n.d(g,{default:function(){return V}});var f=n(11849),h=n(20228),L=n(11382),W=n(34669),x=n(54458),u=n(34792),a=n(48086),r=n(91220),I=n(2824),s=n(67294),y=n(72285),O=n.n(y),D=n(8088),d=n(61541),l=n(44434),p=n(5041),T=n(57436),M=n(14836),t=n(85893),Q=function(C){return(0,t.jsx)(d.Z,{active:C.active,imgSrc:C.imgSrc||"./pics/buttons/rectangle.png",onClick:C.onClick,children:C.children})},B=Q,e=n(64322),_=n(91861),v=n(48971),E=n(85871),S=n(62850),j=function(){var C,z=(0,e.$L)(s.useState,s.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:_.Ad}}),c=(0,I.Z)(z,10),P=c[0],U=c[1],J=c[2],w=c[3],Z=c[4],q=c[5],H=c[6],N=c[7],sn=c[8],nn=c[9],rn=(0,s.useState)(),tn=(0,I.Z)(rn,2),$=tn[0],A=tn[1],ln=(0,s.useState)([]),en=(0,I.Z)(ln,2),K=en[0],F=en[1],on=(0,s.useState)(!1),an=(0,I.Z)(on,2),b=an[0],dn=an[1],Pn=(0,s.useState)(!1),vn=(0,I.Z)(Pn,2),gn=vn[0],cn=vn[1],Mn=function(o){if(!o.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(o));K.push(o),F(K),A(o)},mn=function(o){if(!o.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(o));var k=[],Y=(0,r.Z)(K),G;try{for(Y.s();!(G=Y.n()).done;){var X=G.value;X.frontendId==o.frontendId?k.push(o):k.push(X)}}catch(fn){Y.e(fn)}finally{Y.f()}console.log("modifyAnnotation, newAnnos:",k,"anno:",o),F(k),A(o)},En=function(o){if(!o.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(o));var k=[],Y=(0,r.Z)(K),G;try{for(Y.s();!(G=Y.n()).done;){var X=G.value;X.frontendId!=o.frontendId&&k.push(X)}}catch(fn){Y.e(fn)}finally{Y.f()}F(k),A(void 0)},Zn=function(o){!o||(console.log("modifyAnnotation",o,"anno.label:",o==null?void 0:o.label),o.taskId=Z.curr.taskId,o.dataId=q.curr.dataId,w.modify(o))},_n=drawRectangle({currentLabel:N.curr,currentTool:P.curr,annotations:K,currentAnnotation:$,onAnnotationAdd:Mn,onAnnotationModify:mn,onMouseUp:function(){(0,_.k3)({annos:K,currAnno:$})}}),un=_n,Dn=(0,v.YB)().formatMessage({id:"pages.toolBar.rectangle"}),pn=(0,v.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),Cn=(0,v.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),An=(0,v.YB)().formatMessage({id:"pages.toolBar.move"}),hn=(0,v.YB)().formatMessage({id:"pages.toolBar.unDo"}),xn=(0,v.YB)().formatMessage({id:"pages.toolBar.reDo"}),On=(0,v.YB)().formatMessage({id:"pages.toolBar.save"}),In=(0,v.YB)().formatMessage({id:"pages.toolBar.edit"}),yn=(0,v.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Bn=(0,v.YB)().formatMessage({id:"pages.toolBar.undef"}),Sn=(0,v.YB)().formatMessage({id:"pages.toolBar.divideData"}),jn=(0,v.YB)().formatMessage({id:"pages.toolBar.export"});return(0,t.jsxs)(D.Z,{className:O().det,children:[(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(B,{active:P.curr=="rectangle",onClick:function(){if(!N.curr){a.default.error("Please choose a label category first!");return}P.setCurr("rectangle"),A(void 0)},children:Dn}),(0,t.jsx)(d.Z,{active:P.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){P.setCurr("editor")},children:In}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){J.change(.1)},children:pn}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){J.change(-.1)},children:Cn}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){a.default.info("Annotations are saved automatically. You don't need to click save.")},children:On}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/move.png",active:P.curr=="mover",onClick:function(){P.setCurr("mover")},children:An}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var o=(0,_.td)();!o||(A(o.currAnno),F(o.annos))},children:hn}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var o=(0,_.Vd)();!o||(A(o.currAnno),F(o.annos))},children:xn}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:yn})]}),(0,t.jsx)("div",{id:"dr",className:"mainStage",children:(0,t.jsxs)(L.Z,{tip:"loading",spinning:!!U.curr,children:[(0,t.jsx)("div",{className:"draw",children:(0,t.jsx)(T.Z,{scale:J.curr,annotations:K,currentTool:P.curr,currentAnnotation:$,setCurrentAnnotation:A,onAnnotationModify:mn,onAnnotationModifyComplete:function(){(0,_.k3)({annos:K,currAnno:$})},onMouseDown:un.onMouseDown,onMouseMove:un.onMouseMove,onMouseUp:un.onMouseUp,createRectangleFunc:_n.createElementsFunc,imgSrc:q.imgSrc})}),(0,t.jsx)("div",{className:"pblock",children:(0,t.jsxs)("div",{className:"progress",children:[(0,t.jsx)(x.Z,{className:"progressBar",percent:H.progress,status:"active",showInfo:!1})," ",(0,t.jsxs)("span",{className:"progressDesc",children:["Current labeling ",Z.currIdx==null?1:Z.currIdx+1," of"," ",(C=Z.all)===null||C===void 0?void 0:C.length,". Already labeled ",Z.finished(H.progress)||0,"."]})]})}),(0,t.jsx)("div",{className:"prevTask",onClick:function(){!Z.prevTask()||(A(void 0),F([]))}}),(0,t.jsx)("div",{className:"nextTask",onClick:function(){!Z.nextTask()||(A(void 0),F([]))}})]})}),(0,t.jsxs)(l.Z,{disLoc:"right",children:[(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){dn(!0)},children:Sn}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){cn(!0)},children:jn}),(0,t.jsx)(d.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){A(void 0)},children:Bn})]}),(0,t.jsxs)("div",{className:"rightSideBar",children:[(0,t.jsx)(p.Z,{labels:N.all,activeIds:N.activeIds,onLabelSelect:function(o){N.onSelect(o),A(void 0)},onLabelModify:function(){},onLabelDelete:N.remove,onLabelAdd:function(o){return N.create((0,f.Z)((0,f.Z)({},o),{},{projectId:H.curr.projectId}))}}),(0,t.jsx)(M.Z,{annotations:K,currAnnotation:$,onAnnotationSelect:A,onAnnotationAdd:function(){A(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(o){En(o)}})]}),(0,t.jsx)(E.Z,{visible:b,splitDataset:sn,project:H,onCancel:function(){dn(!1)},onFinish:function(){dn(!1)}}),(0,t.jsx)(S.Z,{visible:gn,exportDataset:nn,project:H,onCancel:function(){cn(!1)},onFinish:function(){cn(!1)}})]})},V=j},15746:function(m,g,n){"use strict";var f=n(21584);g.Z=f.Z},89032:function(m,g,n){"use strict";var f=n(38663),h=n.n(f),L=n(6999)},71230:function(m,g,n){"use strict";var f=n(92820);g.Z=f.Z},13062:function(m,g,n){"use strict";var f=n(38663),h=n.n(f),L=n(6999)}}]);
