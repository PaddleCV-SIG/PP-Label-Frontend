(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{85024:function(S){S.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(S){S.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},71212:function(S){S.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},14836:function(S,b,t){"use strict";t.d(b,{Z:function(){return d}});var N=t(54421),I=t(38272),j=t(57663),h=t(71577),E=t(67294),P=t(56159),R=t.n(P),L=t(49111),U=t(19650),n=t(2824),l=t(11849),M=t(85024),v=t.n(M),x=t(63097),a=t(85893),A=function(c){var s=(0,l.Z)({},c.annotation),y=(0,E.useState)(s.invisible),m=(0,n.Z)(y,2),g=m[0],C=m[1],W=(0,E.useState)(0),p=(0,n.Z)(W,2),Y=p[0],H=p[1];(0,E.useEffect)(function(){C(c.annotation.invisible)},[c.annotation.invisible]);var k=(0,a.jsxs)(I.ZP.Item,{className:"".concat(v().listItem," ").concat(c.active?v().listItemActive:""),unselectable:"on",onClick:function(){c.onClick(s)},children:[(0,a.jsxs)(U.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:v().eye,style:{backgroundImage:g?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(Z){Z.stopPropagation(),C(!g),c.onAnnotationModify(s)}})," ",(0,a.jsx)("span",{className:v().annotationId,children:s.frontendId}),(0,a.jsx)("span",{className:v().labelName,children:s.label.name}),(0,a.jsx)(x.Z,{color:s.label.color})]}),(0,a.jsx)("a",{className:v().delete,onClick:function(Z){Z.stopPropagation();var F=new Date().getTime();F-Y<300||(H(F),c.onAnnotationDelete(s))}})]});return k},i=A,o=t(48971),f=function(c){var s=(0,o.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),y=(0,o.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(I.ZP,{className:R().labelList,size:"large",header:(0,a.jsx)("div",{className:R().listHeader,children:s}),bordered:!0,dataSource:c.annotations,renderItem:function(g){var C;return(0,a.jsx)(i,{onClick:c.onAnnotationSelect,annotation:g,active:g.frontendId==((C=c.currAnnotation)===null||C===void 0?void 0:C.frontendId),onAnnotationDelete:c.onAnnotationDelete,onAnnotationModify:c.onAnnotationModify})},footer:(0,a.jsx)("div",{children:(0,a.jsx)(h.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){c.onAnnotationAdd()},block:!0,children:y})})})})},d=f},13931:function(S,b,t){"use strict";t.d(b,{Z:function(){return U}});var N=t(91220),I=t(11849),j=t(65031),h=t(85893);function E(n){var l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return l?{r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)}:null}function P(n,l){if(!(!n||!l))return{color:n,points:l}}function R(n){if(!n.annotation||!n.annotation.points||!n.annotation.points[0])return[(0,h.jsx)(h.Fragment,{})];var l=n.annotation.points[0].points,M=n.annotation.points[0].color,v=E(M);if(!v)return[(0,h.jsx)(h.Fragment,{})];var x=.3,a=void 0,A=[];return l.forEach(function(i,o){if(!a){a=i;return}A.push((0,h.jsx)(j.Cd,{onMouseDown:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},draggable:n.currentTool=="editor",onDragMove:function(d){var O;d.cancelBubble=!0;var c=(O=n.stageRef)===null||O===void 0?void 0:O.current,s=c.findOne(".baseImage"),y=!1,m=d.target.x();m>s.width()/2&&(m=s.width()/2,y=!0),m<-s.width()/2&&(m=-s.width()/2,y=!0);var g=d.target.y();g>s.height()/2&&(g=s.height()/2,y=!0),g<-s.height()/2&&(g=-s.height()/2,y=!0),y&&d.target.setPosition({x:m,y:g}),l[o-1]=m,l[o]=g;var C=(0,I.Z)((0,I.Z)({},n.annotation),{},{points:[{color:M,points:l}]});n.onDrag(C)},onMouseOver:function(){var d;n.currentTool=="editor"&&(d=n.stageRef)!==null&&d!==void 0&&d.current&&(n.stageRef.current.container().style.cursor="cell")},onMouseOut:function(){var d;n.currentTool=="editor"&&(d=n.stageRef)!==null&&d!==void 0&&d.current&&(n.stageRef.current.container().style.cursor="default")},x:a,y:i,radius:5/n.scale,fill:M})),a=void 0}),[(0,h.jsxs)(j.ZA,{children:[(0,h.jsx)(j.x1,{onMouseOver:function(){n.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},stroke:M,strokeWidth:2/n.scale,globalCompositeOperation:"source-over",lineCap:"round",points:l,tension:0,closed:!0,fill:"rgba(".concat(v.r,", ").concat(v.g,", ").concat(v.b,", ").concat(x,")")}),A]},n.annotation.frontendId)]}function L(n){var l=0,M=(0,N.Z)(n),v;try{for(M.s();!(v=M.n()).done;){var x=v.value;!x||!x.frontendId||x.frontendId>l&&(l=x.frontendId)}}catch(a){M.e(a)}finally{M.f()}return l}function U(n){var l=function(A,i,o,f){var d,O=(A.evt.offsetX+i)/f,c=(A.evt.offsetY+o)/f,s=P((d=n.currentLabel)===null||d===void 0?void 0:d.color,[O,c]);!s||n.onAnnotationAdd({type:"polygon",frontendId:L(n.annotations)+1,label:n.currentLabel,points:[s]})},M=function(A,i,o,f){var d,O;if(!!n.currentAnnotation){var c=(A.evt.offsetX+i)/f,s=(A.evt.offsetY+o)/f,y=n.currentAnnotation.points||[],m=P((d=n.currentLabel)===null||d===void 0?void 0:d.color,(O=y[0])===null||O===void 0?void 0:O.points.concat([c,s]));if(!!m){var g={type:"polygon",frontendId:n.currentAnnotation.frontendId,label:n.currentAnnotation.label,points:[m]};n.onAnnotationModify(g)}}},v=function(A,i,o,f){n.currentTool=="polygon"&&(n.currentAnnotation?M(A,i,o,f):l(A,i,o,f))},x=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:v,onMouseMove:function(){},onMouseUp:x,createElementsFunc:R}}},29919:function(S,b,t){"use strict";var N=t(67294),I=t(61541),j=t(85893),h=function(P){return(0,j.jsx)(I.Z,{active:P.active,imgSrc:P.imgSrc||"./pics/buttons/polygon.png",onClick:P.onClick,children:P.children})};b.Z=h},82881:function(S,b,t){"use strict";t.r(b);var N=t(57663),I=t(71577),j=t(34669),h=t(54458),E=t(2824),P=t(67294),R=t(71212),L=t.n(R),U=t(8088),n=t(61541),l=t(44434),M=t(5041),v=t(57436),x=t(14836),a=t(29919),A=t(13931),i=t(48971),o=t(85893),f=40,d=function(){var c,s=(0,P.useState)(void 0),y=(0,E.Z)(s,2),m=y[0],g=y[1],C=(0,P.useState)({color:"",name:""}),W=(0,E.Z)(C,2),p=W[0],Y=W[1],H=(0,P.useState)(),k=(0,E.Z)(H,2),B=k[0],Z=k[1],F=(0,P.useState)([]),Q=(0,E.Z)(F,2),D=Q[0],K=Q[1],tn=(0,P.useState)(1),w=(0,E.Z)(tn,2),z=w[0],J=w[1],G=function(e){e||J(1),e<.1||e>3?J(1):J(e)},T=function(e){Z(e),e!=null&&e.label&&Y(e.label)};(0,P.useEffect)(function(){localStorage.removeItem("history"),$([])},[]);function $(u,e){var r=localStorage.getItem("history"),_=r?JSON.parse(r):{index:-1,items:[]},nn={currentAnnotation:e,annotations:u};if(JSON.stringify(_.items[_.index])!=JSON.stringify(nn)){var Pn=_.index>f?_.index-f:0,Mn=_.items.splice(Pn,_.index==0?1:_.index+1);_.items=Mn.concat([nn]),_.index<=f?_.index++:_.index=f+1,localStorage.setItem("history",JSON.stringify(_))}}var on=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!!r&&!(r.index>=r.items.length-1)){r.index++,localStorage.setItem("history",JSON.stringify(r));var _=r.items[r.index];Z(_.currentAnnotation),K(_.annotations)}}},en=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!(!r||!r.index)&&!(r.index<=0)){r.index--,localStorage.setItem("history",JSON.stringify(r));var _=r.items[r.index];Z(_.currentAnnotation),K(_.annotations)}}},V=function(e){for(var r=[],_=0;_<D.length;_++)D[_].annotationId==e.annotationId?r.push(e):r.push(D[_]);T(e),K(r)},q=(0,A.Z)({currentLabel:p,currentTool:m,annotations:D,currentAnnotation:B,onAnnotationAdd:function(e){var r=D.concat([e]);K(r),B||T(e)},onAnnotationModify:V,onMouseUp:function(){$(D,B)}}),X=q,an=(0,i.YB)().formatMessage({id:"pages.toolBar.polygon"}),rn=(0,i.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),sn=(0,i.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),ln=(0,i.YB)().formatMessage({id:"pages.toolBar.move"}),dn=(0,i.YB)().formatMessage({id:"pages.toolBar.unDo"}),cn=(0,i.YB)().formatMessage({id:"pages.toolBar.reDo"}),un=(0,i.YB)().formatMessage({id:"pages.toolBar.save"}),_n=(0,i.YB)().formatMessage({id:"pages.toolBar.edit"}),fn=(0,i.YB)().formatMessage({id:"pages.toolBar.clearMark"}),vn=(0,i.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),mn=(0,i.YB)().formatMessage({id:"pages.toolBar.divideData"}),gn=(0,i.YB)().formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(U.Z,{className:L().key,children:[(0,o.jsxs)(l.Z,{children:[(0,o.jsx)(a.Z,{active:m=="polygon",onClick:function(){g("polygon"),T(void 0)},children:an}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/edit.png",children:_n}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){G(z+.1)},children:rn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){G(z-.1)},children:sn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:un}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){g("mover")},children:ln}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){en()},children:dn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){on()},children:cn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:fn})]}),(0,o.jsxs)("div",{id:"dr",className:L().mainStage,children:[(0,o.jsx)("div",{className:L().draw,children:(0,o.jsx)(v.Z,{width:(c=document.getElementById("dr"))===null||c===void 0?void 0:c.clientWidth,scale:z,annotations:D,currentTool:m,currentAnnotation:B,setCurrentAnnotation:T,onAnnotationModify:V,onAnnotationModifyComplete:function(){$(D,B)},onMouseDown:X.onMouseDown,onMouseMove:X.onMouseMove,onMouseUp:X.onMouseUp,createPolygonFunc:q.createElementsFunc})}),(0,o.jsx)("div",{className:L().pblock,children:(0,o.jsx)("div",{className:L().progress,children:(0,o.jsx)(h.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(l.Z,{disLoc:"right",children:[(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:mn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:gn})]}),(0,o.jsxs)("div",{className:L().rightSideBar,children:[(0,o.jsx)("div",{className:L().finished,children:(0,o.jsx)(I.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){T(void 0)},children:vn})}),(0,o.jsx)(M.Z,{selectedLabel:p,onLabelSelect:function(e){Y(e),T(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(x.Z,{selectedAnnotation:B,annotations:D,onAnnotationSelect:function(e){e!=null&&e.delete||T(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){K(D.filter(function(r){return r.annotationId!=e.annotationId})),T(void 0)}})]})]})};b.default=d}}]);
