(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(u,b,e){"use strict";e.d(b,{Z:function(){return _}});var F=e(94663),P=e(80112);function L(m){return Function.toString.call(m).indexOf("[native code]")!==-1}var f=e(18597);function s(m,v,M){return(0,f.Z)()?s=Reflect.construct:s=function(E,Z,n){var i=[null];i.push.apply(i,Z);var t=Function.bind.apply(E,i),d=new t;return n&&(0,P.Z)(d,n.prototype),d},s.apply(null,arguments)}function _(m){var v=typeof Map=="function"?new Map:void 0;return _=function(g){if(g===null||!L(g))return g;if(typeof g!="function")throw new TypeError("Super expression must either be null or a function");if(typeof v!="undefined"){if(v.has(g))return v.get(g);v.set(g,E)}function E(){return s(g,arguments,(0,F.Z)(this).constructor)}return E.prototype=Object.create(g.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),(0,P.Z)(E,g)},_(m)}},52822:function(u){u.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(u){u.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(u){u.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(u){u.exports={container:"container___G0FNe"}},83930:function(u){u.exports={stage:"stage___3H5QL"}},80961:function(u){u.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(u){u.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(u){u.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(u,b,e){"use strict";var F=e(20136),P=e(55241),L=e(2824),f=e(67294),s=e(52822),_=e.n(s),m=e(63144),v=e(85893),M=function(E){var Z=(0,f.useState)(E.color||"#FFF"),n=(0,L.Z)(Z,2),i=n[0],t=n[1];return(0,f.useEffect)(function(){t(E.color||"#FFF")},[E]),E.changeable?(0,v.jsx)(P.Z,{getPopupContainer:function(y){return y.parentElement||document.body},overlayClassName:_().popover,openClassName:_().popoverOpenClassName,placement:"bottom",content:(0,v.jsx)(m.xS,{disableAlpha:!0,color:i,onChange:function(y){t(y.hex)},onChangeComplete:E.onChange}),trigger:"click",children:(0,v.jsx)("div",{className:_().roundBall,style:{backgroundColor:i}})}):(0,v.jsx)("div",{className:_().roundBall,style:{backgroundColor:i}})};b.Z=M},5041:function(u,b,e){"use strict";e.d(b,{Z:function(){return U}});var F=e(54421),P=e(38272),L=e(57663),f=e(71577),s=e(2824),_=e(67294),m=e(56131),v=e.n(m),M=e(49111),g=e(19650),E=e(11849),Z=e(5882),n=e.n(Z),i=e(63097),t=e(85893),d=function(a){var c=(0,E.Z)({},a.label),I=(0,_.useState)(c.invisible),D=(0,s.Z)(I,2),B=D[0],O=D[1],A=(0,t.jsx)(P.ZP.Item,{className:"".concat(n().listItem," ").concat(c.active?n().listItemActive:""),unselectable:"on",onClick:function(){a.onClick(c)},children:(0,t.jsxs)(g.Z,{align:"center",size:5,children:[(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:B?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){O(!B),a.onLabelModify(c)}})," ",c.name,(0,t.jsx)(i.Z,{color:c.color,changeable:!0,onChange:function(C){c.color=C.hex,a.onLabelModify(c)}}),(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(C){C.stopPropagation(),a.onLabelDelete(c)}})]})});return A},y=d,S=e(71194),N=e(50146),$=e(47673),z=e(24044),V=e(9715),h=e(93766),r=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],X=function(a){var c,I,D=(0,_.useState)(((c=a.defaultLabel)===null||c===void 0?void 0:c.color)||r[a.order||0]),B=(0,s.Z)(D,2),O=B[0],A=B[1];(0,_.useEffect)(function(){var l;A(((l=a.defaultLabel)===null||l===void 0?void 0:l.color)||r[a.order||0])},[a]);var o=h.Z.useForm(),C=(0,s.Z)(o,1),W=C[0];return(0,t.jsx)(N.Z,{title:"Add Label",visible:a.visible,onCancel:a.onCancel,footer:null,children:(0,t.jsxs)(h.Z,{form:W,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(I=a.defaultLabel)===null||I===void 0?void 0:I.name},onFinish:function(T){var k={name:T.labelname,color:O};a.onLabelAdd(k),W.resetFields()},autoComplete:"off",children:[(0,t.jsx)(h.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,t.jsx)(z.Z,{})}),(0,t.jsx)(h.Z.Item,{label:"Select Color",name:"color",children:(0,t.jsx)(i.Z,{color:O,onChange:function(T){A(T.hex)}})}),(0,t.jsx)(h.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,t.jsxs)(g.Z,{children:[(0,t.jsx)(f.Z,{onClick:function(){var T;(T=a.onCancel)===null||T===void 0||T.call(0),W.resetFields()},children:"\u53D6\u6D88"}),(0,t.jsx)(f.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},H=X,J=function(a){var c;console.log("render pplabellist");var I=(0,_.useState)(!1),D=(0,s.Z)(I,2),B=D[0],O=D[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.ZP,{className:v().labelList,size:"large",header:(0,t.jsx)("div",{className:v().listHeader,children:"Label List"}),footer:(0,t.jsx)("div",{children:(0,t.jsx)(f.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){O(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:a.labels,renderItem:function(o){return(0,t.jsx)(y,{onClick:a.onLabelSelect,label:o,onLabelDelete:a.onLabelDelete,onLabelModify:a.onLabelModify})}}),(0,t.jsx)(H,{order:(c=a.labels)===null||c===void 0?void 0:c.length,visible:B,onLabelAdd:function(o){a.onLabelAdd(o),O(!1)},onCancel:function(){O(!1)}})]})},U=J},8088:function(u,b,e){"use strict";var F=e(67294),P=e(78677),L=e.n(P),f=e(85893),s=function(m){return(0,f.jsx)("div",{className:"".concat(L().container," ").concat(m.className),children:m.children})};b.Z=s},57436:function(u,b,e){"use strict";var F=e(91220),P=e(2824),L=e(67294),f=e(65031),s=e(84420),_=e.n(s),m=e(83930),v=e.n(m),M=e(85893),g="./pics/basketball.jpg",E=function(n){var i=_()(n.imgSrc||""),t=(0,P.Z)(i,1),d=t[0],y=(d==null?void 0:d.width)||0,S=(d==null?void 0:d.height)||0,N=(0,L.useState)(),$=(0,P.Z)(N,2),z=$[0],V=$[1],h=(0,L.useState)(),r=(0,P.Z)(h,2),X=r[0],H=r[1],J=(0,L.useState)({x:0,y:0}),U=(0,P.Z)(J,2),R=U[0],a=U[1];function c(){var o=document.getElementById("dr");o&&(V(o.clientWidth),H(o.clientHeight))}(0,L.useEffect)(function(){window.removeEventListener("resize",c),window.addEventListener("resize",c);var o=document.getElementById("dr");o&&(V(o.clientWidth),H(o.clientHeight),a({x:o.clientWidth/2,y:o.clientHeight/2}))},[]);var I=[];if(n.annotations){var D=(0,F.Z)(n.annotations),B;try{for(D.s();!(B=D.n()).done;){var O=B.value;if(!!O){var A=O.tool=="polygon"?n.createPolygonFunc:n.createBrushFunc;A&&I.push(A(O,n.onAnnotationModify,n.onAnnotationModifyComplete,n.scale,n.currentTool,n.setCurrentAnnotation,n.currentAnnotation))}}}catch(o){D.e(o)}finally{D.f()}}return(0,M.jsx)(f.Hf,{width:z,height:X,className:v().stage,children:(0,M.jsx)(f.mh,{onMouseDown:function(C){n.onMouseDown&&n.onMouseDown(C,n.scale)},onMouseMove:function(C){n.onMouseMove&&n.onMouseMove(C,n.scale)},onMouseUp:function(C){n.onMouseUp&&n.onMouseUp(C,n.scale)},onContextMenu:function(C){C.evt.preventDefault()},draggable:!1,children:(0,M.jsxs)(f.ZA,{draggable:n.currentTool=="mover",onDragEnd:function(C){},children:[(0,M.jsx)(f.Ee,{draggable:!1,image:d,x:R.x,y:R.y,offsetX:y/2,offsetY:S/2,scaleX:n.scale,scaleY:n.scale}),I]})})})};b.Z=E},44434:function(u,b,e){"use strict";var F=e(67294),P=e(80961),L=e.n(P),f=e(85893),s=function(m){var v=L().leftToolbar;return m.disLoc=="right"&&(v=L().rightToolbar),(0,f.jsx)("div",{className:v,children:m.children})};b.Z=s},61541:function(u,b,e){"use strict";var F=e(49111),P=e(19650),L=e(67294),f=e(82499),s=e.n(f),_=e(85893),m=function(M){return(0,_.jsx)("div",{unselectable:"on",className:"".concat(s().toolBarButtonContainerWrapper," ").concat(M.active&&s().toolBarButtonContainerWrapperActive),onClick:M.onClick,children:(0,_.jsx)(P.Z,{align:"center",className:s().toolBarButtonContainer,size:0,children:(0,_.jsxs)(P.Z,{align:"center",direction:"vertical",className:s().toolBarButton,size:0,children:[(0,_.jsx)("img",{src:M.imgSrc}),(0,_.jsx)("div",{className:s().buttonText,children:M.children})]})})})};b.Z=m},29214:function(u,b,e){"use strict";e.r(b);var F=e(11849),P=e(20228),L=e(11382),f=e(34669),s=e(54458),_=e(34792),m=e(48086),v=e(86582),M=e(91220),g=e(3182),E=e(2824),Z=e(94043),n=e.n(Z),i=e(67294),t=e(73199),d=e.n(t),y=e(8088),S=e(61541),N=e(44434),$=e(5041),z=e(57436),V=e(37071),h=e(64322),r=e(85893),X=localStorage.getItem("basePath"),H=function(){var U,R=(0,i.useState)("mover"),a=(0,E.Z)(R,2),c=a[0],I=a[1],D=(0,i.useState)(!1),B=(0,E.Z)(D,2),O=B[0],A=B[1],o=V.Z.getQueryVariable("projectId"),C=(0,h._D)(i.useState),W=(0,h.CV)(i.useState),l=(0,h.iA)(i.useState),T=(0,h.A5)(i.useState),k=(0,h.Gd)(i.useState),_e=function(p){if(console.log("selectLabel",l.curr,T.curr,W.all),p.active)W.create({taskId:l.curr.taskId,labelId:p.labelId,dataId:T.curr.dataId});else{var Y=W.all.filter(function(w){return w.labelId==p.labelId})[0];console.log("filter ann ",Y),W.remove(Y.annotationId)}console.log("selectlabel",p)},j=(0,h.jL)(i.useState,{oneHot:!1,pageOnSelect:_e});return(0,i.useEffect)(function(){k.getCurr(o),j.getAll(o),l.getAll(o),l.getProgress(o)},[]),(0,i.useEffect)(function(){l.all&&l.all.length!=0&&l.turnTo(0)},[l.all]),(0,i.useEffect)(function(){if(l.currIdx!=null){var x=function(){var p=(0,g.Z)(n().mark(function Y(){var w,ee,ie,ne,te,G,oe,ae,Q,le,re;return n().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return console.log("onTaskChange",l.curr,j.all,l.progress),l.getProgress(l.curr.projectId),K.next=4,T.getAll(l.curr.taskId,0);case 4:return w=K.sent,ee=(0,E.Z)(w,2),ie=ee[0],ne=ee[1],K.next=10,W.getAll(ne.dataId);case 10:te=K.sent,G=(0,M.Z)(j.all);try{for(G.s();!(oe=G.n()).done;)ae=oe.value,ae.active=!1}catch(q){G.e(q)}finally{G.f()}Q=(0,M.Z)(j.all);try{for(re=function(){var se=le.value,ue=te.filter(function(de){return de.label.labelId==se.labelId});ue.length!=0&&(se.active=!0)},Q.s();!(le=Q.n()).done;)re()}catch(q){Q.e(q)}finally{Q.f()}console.log("label.all toggled",j.all),j.setAll((0,v.Z)(j.all)),A(!1);case 18:case"end":return K.stop()}},Y)}));return function(){return p.apply(this,arguments)}}();x()}},[l.currIdx]),(0,r.jsxs)(y.Z,{className:d().classes,children:[(0,r.jsxs)(N.Z,{children:[(0,r.jsx)(S.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){C.change(.1)},children:"Zoom in"}),(0,r.jsx)(S.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){C.change(-.1)},children:"Zoom out"}),(0,r.jsx)(S.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){m.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,r.jsx)(S.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){I("mover"),m.default.info("You can move the image now.")},children:"Move"})]}),(0,r.jsx)("div",{id:"dr",className:d().mainStage,children:(0,r.jsxs)(L.Z,{tip:"loading",spinning:O,children:[(0,r.jsx)("div",{className:d().draw,children:(0,r.jsx)(z.Z,{scale:C.curr,currentTool:c,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat(X,"/datas/").concat((U=T.curr)===null||U===void 0?void 0:U.dataId,"/image")})}),(0,r.jsx)("div",{className:d().pblock,children:(0,r.jsx)("div",{className:d().progress,children:(0,r.jsx)(s.Z,{percent:l.progress,status:"active"})})}),(0,r.jsx)("div",{className:d().prevTask,onClick:function(){return l.turnTo(l.currIdx-1)}}),(0,r.jsx)("div",{className:d().nextTask,onClick:function(){return l.turnTo(l.currIdx+1)}})]})}),(0,r.jsxs)(N.Z,{disLoc:"right",children:[(0,r.jsx)(S.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,r.jsx)(S.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,r.jsx)("div",{className:d().rightSideBar,children:(0,r.jsx)($.Z,{labels:j.all,selectedLabel:j.curr,onLabelSelect:j.onSelect,onLabelAdd:function(p){return j.create((0,F.Z)((0,F.Z)({},p),{},{projectId:k.curr.projectId}))},onLabelDelete:j.remove,onLabelModify:function(){}})})]})};b.default=H}}]);
