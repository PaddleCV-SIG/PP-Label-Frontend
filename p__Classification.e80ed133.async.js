(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(_,C,e){"use strict";e.d(C,{Z:function(){return r}});var y=e(94663),d=e(80112);function g(m){return Function.toString.call(m).indexOf("[native code]")!==-1}var c=e(18597);function s(m,i,L){return(0,c.Z)()?s=Reflect.construct:s=function(P,S,n){var D=[null];D.push.apply(D,S);var t=Function.bind.apply(P,D),M=new t;return n&&(0,d.Z)(M,n.prototype),M},s.apply(null,arguments)}function r(m){var i=typeof Map=="function"?new Map:void 0;return r=function(v){if(v===null||!g(v))return v;if(typeof v!="function")throw new TypeError("Super expression must either be null or a function");if(typeof i!="undefined"){if(i.has(v))return i.get(v);i.set(v,P)}function P(){return s(v,arguments,(0,y.Z)(this).constructor)}return P.prototype=Object.create(v.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),(0,d.Z)(P,v)},r(m)}},52822:function(_){_.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(_){_.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(_){_.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(_){_.exports={container:"container___G0FNe"}},83930:function(_){_.exports={stage:"stage___3H5QL"}},80961:function(_){_.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(_){_.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(_){_.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(_,C,e){"use strict";var y=e(20136),d=e(55241),g=e(2824),c=e(67294),s=e(52822),r=e.n(s),m=e(63144),i=e(85893),L=function(P){var S=(0,c.useState)(P.color||"#FFF"),n=(0,g.Z)(S,2),D=n[0],t=n[1];return(0,c.useEffect)(function(){t(P.color||"#FFF")},[P]),P.changeable?(0,i.jsx)(d.Z,{getPopupContainer:function(O){return O.parentElement||document.body},overlayClassName:r().popover,openClassName:r().popoverOpenClassName,placement:"bottom",content:(0,i.jsx)(m.xS,{disableAlpha:!0,color:D,onChange:function(O){t(O.hex)},onChangeComplete:P.onChange}),trigger:"click",children:(0,i.jsx)("div",{className:r().roundBall,style:{backgroundColor:D}})}):(0,i.jsx)("div",{className:r().roundBall,style:{backgroundColor:D}})};C.Z=L},5041:function(_,C,e){"use strict";e.d(C,{Z:function(){return p}});var y=e(54421),d=e(38272),g=e(57663),c=e(71577),s=e(2824),r=e(67294),m=e(56131),i=e.n(m),L=e(49111),v=e(19650),P=e(11849),S=e(5882),n=e.n(S),D=e(63097),t=e(85893),M=function(l){var u=(0,P.Z)({},l.label),A=(0,r.useState)(u.invisible),b=(0,s.Z)(A,2),x=b[0],B=b[1],h=(0,t.jsx)(d.ZP.Item,{className:"".concat(n().listItem," ").concat(u.active?n().listItemActive:""),unselectable:"on",onClick:function(){l.onClick(u)},children:(0,t.jsxs)(v.Z,{align:"center",size:5,children:[(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:x?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){B(!x),l.onLabelModify(u)}})," ",u.name,(0,t.jsx)(D.Z,{color:u.color,changeable:!0,onChange:function(E){u.color=E.hex,l.onLabelModify(u)}}),(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){l.onLabelDelete(u)}})]})});return h},O=M,H=e(71194),$=e(50146),z=e(47673),V=e(24044),F=e(9715),o=e(93766),U=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],X=function(l){var u,A,b=(0,r.useState)(((u=l.defaultLabel)===null||u===void 0?void 0:u.color)||U[l.order||0]),x=(0,s.Z)(b,2),B=x[0],h=x[1];(0,r.useEffect)(function(){var j;h(((j=l.defaultLabel)===null||j===void 0?void 0:j.color)||U[l.order||0])},[l]);var a=o.Z.useForm(),E=(0,s.Z)(a,1),f=E[0];return(0,t.jsx)($.Z,{title:"Add Label",visible:l.visible,onCancel:l.onCancel,footer:null,children:(0,t.jsxs)(o.Z,{form:f,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(A=l.defaultLabel)===null||A===void 0?void 0:A.name},onFinish:function(W){var q={name:W.labelname,color:B};l.onLabelAdd(q),f.resetFields()},autoComplete:"off",children:[(0,t.jsx)(o.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,t.jsx)(V.Z,{})}),(0,t.jsx)(o.Z.Item,{label:"Select Color",name:"color",children:(0,t.jsx)(D.Z,{color:B,onChange:function(W){h(W.hex)}})}),(0,t.jsx)(o.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,t.jsxs)(v.Z,{children:[(0,t.jsx)(c.Z,{onClick:function(){var W;(W=l.onCancel)===null||W===void 0||W.call(0),f.resetFields()},children:"\u53D6\u6D88"}),(0,t.jsx)(c.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},Y=X,R=function(l){var u;console.log("render pplabellist");var A=(0,r.useState)(!1),b=(0,s.Z)(A,2),x=b[0],B=b[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.ZP,{className:i().labelList,size:"large",header:(0,t.jsx)("div",{className:i().listHeader,children:"Label List"}),footer:(0,t.jsx)("div",{children:(0,t.jsx)(c.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){B(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:l.labels,renderItem:function(a){return(0,t.jsx)(O,{onClick:l.onLabelSelect,label:a,onLabelDelete:l.onLabelDelete,onLabelModify:l.onLabelModify})}}),(0,t.jsx)(Y,{order:(u=l.labels)===null||u===void 0?void 0:u.length,visible:x,onLabelAdd:function(a){l.onLabelAdd(a),B(!1)},onCancel:function(){B(!1)}})]})},p=R},8088:function(_,C,e){"use strict";var y=e(67294),d=e(78677),g=e.n(d),c=e(85893),s=function(m){return(0,c.jsx)("div",{className:"".concat(g().container," ").concat(m.className),children:m.children})};C.Z=s},57436:function(_,C,e){"use strict";var y=e(91220),d=e(2824),g=e(67294),c=e(65031),s=e(84420),r=e.n(s),m=e(83930),i=e.n(m),L=e(85893),v="./pics/basketball.jpg",P=function(n){var D=r()(n.imgSrc||""),t=(0,d.Z)(D,1),M=t[0],O=(M==null?void 0:M.width)||0,H=(M==null?void 0:M.height)||0,$=(0,g.useState)(),z=(0,d.Z)($,2),V=z[0],F=z[1],o=(0,g.useState)(),U=(0,d.Z)(o,2),X=U[0],Y=U[1],R=(0,g.useState)({x:0,y:0}),p=(0,d.Z)(R,2),Z=p[0],l=p[1];function u(){var a=document.getElementById("dr");a&&(F(a.clientWidth),Y(a.clientHeight))}(0,g.useEffect)(function(){window.removeEventListener("resize",u),window.addEventListener("resize",u);var a=document.getElementById("dr");a&&(F(a.clientWidth),Y(a.clientHeight),l({x:a.clientWidth/2,y:a.clientHeight/2}))},[]);var A=[];if(n.annotations){var b=(0,y.Z)(n.annotations),x;try{for(b.s();!(x=b.n()).done;){var B=x.value;if(!!B){var h=B.tool=="polygon"?n.createPolygonFunc:n.createBrushFunc;h&&A.push(h(B,n.onAnnotationModify,n.onAnnotationModifyComplete,n.scale,n.currentTool,n.setCurrentAnnotation,n.currentAnnotation))}}}catch(a){b.e(a)}finally{b.f()}}return(0,L.jsx)(c.Hf,{width:V,height:X,className:i().stage,children:(0,L.jsx)(c.mh,{onMouseDown:function(E){n.onMouseDown&&n.onMouseDown(E,n.scale)},onMouseMove:function(E){n.onMouseMove&&n.onMouseMove(E,n.scale)},onMouseUp:function(E){n.onMouseUp&&n.onMouseUp(E,n.scale)},onContextMenu:function(E){E.evt.preventDefault()},draggable:!1,children:(0,L.jsxs)(c.ZA,{draggable:n.currentTool=="mover",onDragEnd:function(E){},children:[(0,L.jsx)(c.Ee,{draggable:!1,image:M,x:Z.x,y:Z.y,offsetX:O/2,offsetY:H/2,scaleX:n.scale,scaleY:n.scale}),A]})})})};C.Z=P},44434:function(_,C,e){"use strict";var y=e(67294),d=e(80961),g=e.n(d),c=e(85893),s=function(m){var i=g().leftToolbar;return m.disLoc=="right"&&(i=g().rightToolbar),(0,c.jsx)("div",{className:i,children:m.children})};C.Z=s},61541:function(_,C,e){"use strict";var y=e(49111),d=e(19650),g=e(67294),c=e(82499),s=e.n(c),r=e(85893),m=function(L){return(0,r.jsx)("div",{unselectable:"on",className:"".concat(s().toolBarButtonContainerWrapper," ").concat(L.active&&s().toolBarButtonContainerWrapperActive),onClick:L.onClick,children:(0,r.jsx)(d.Z,{align:"center",className:s().toolBarButtonContainer,size:0,children:(0,r.jsxs)(d.Z,{align:"center",direction:"vertical",className:s().toolBarButton,size:0,children:[(0,r.jsx)("img",{src:L.imgSrc}),(0,r.jsx)("div",{className:s().buttonText,children:L.children})]})})})};C.Z=m},29214:function(_,C,e){"use strict";e.r(C);var y=e(20228),d=e(11382),g=e(34669),c=e(54458),s=e(34792),r=e(48086),m=e(86582),i=e(91220),L=e(3182),v=e(2824),P=e(94043),S=e.n(P),n=e(67294),D=e(73199),t=e.n(D),M=e(8088),O=e(61541),H=e(44434),$=e(5041),z=e(57436),V=e(37071),F=e(64322),o=e(85893),U=localStorage.getItem("basePath"),X=function(){var R,p=(0,n.useState)("mover"),Z=(0,v.Z)(p,2),l=Z[0],u=Z[1],A=(0,n.useState)(!1),b=(0,v.Z)(A,2),x=b[0],B=b[1],h=V.Z.getQueryVariable("projectId"),a=(0,F._D)(n.useState),E=(0,F.CV)(n.useState),f=(0,F.iA)(n.useState),j=(0,F.A5)(n.useState),W=(0,F.Gd)(n.useState),q=function(N){if(console.log("selectLabel",f.curr,j.curr,E.all),N.active)E.create({taskId:f.curr.taskId,labelId:N.labelId,dataId:j.curr.dataId});else{var G=E.all.filter(function(k){return k.labelId==N.labelId})[0];console.log("filter ann ",G),E.remove(G.annotationId)}console.log("selectlabel",N)},I=(0,F.jL)(n.useState,{oneHot:!1,pageOnSelect:q});return(0,n.useEffect)(function(){W.getCurr(h),I.getAll(h),f.getAll(h)},[]),(0,n.useEffect)(function(){f.all&&f.all.length!=0&&f.turnTo(0)},[f.all]),(0,n.useEffect)(function(){if(f.currIdx!=null){var T=function(){var N=(0,L.Z)(S().mark(function G(){var k,ee,_e,ne,te,Q,ae,oe,J,le,re;return S().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return console.log("onTaskChange",f.curr,I.all),K.next=3,j.getAll(f.curr.taskId,0);case 3:return k=K.sent,ee=(0,v.Z)(k,2),_e=ee[0],ne=ee[1],K.next=9,E.getAll(ne.dataId);case 9:te=K.sent,Q=(0,i.Z)(I.all);try{for(Q.s();!(ae=Q.n()).done;)oe=ae.value,oe.active=!1}catch(w){Q.e(w)}finally{Q.f()}J=(0,i.Z)(I.all);try{for(re=function(){var se=le.value,ie=te.filter(function(ue){return ue.label.labelId==se.labelId});ie.length!=0&&(se.active=!0)},J.s();!(le=J.n()).done;)re()}catch(w){J.e(w)}finally{J.f()}console.log("label.all toggled",I.all),I.setAll((0,m.Z)(I.all)),B(!1);case 17:case"end":return K.stop()}},G)}));return function(){return N.apply(this,arguments)}}();T()}},[f.currIdx]),(0,o.jsxs)(M.Z,{className:t().classes,children:[(0,o.jsxs)(H.Z,{children:[(0,o.jsx)(O.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){a.change(.1)},children:"Zoom in"}),(0,o.jsx)(O.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){a.change(-.1)},children:"Zoom out"}),(0,o.jsx)(O.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){r.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,o.jsx)(O.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){u("mover"),r.default.info("You can move the image now.")},children:"Move"})]}),(0,o.jsx)("div",{id:"dr",className:t().mainStage,children:(0,o.jsxs)(d.Z,{tip:"loading",spinning:x,children:[(0,o.jsx)("div",{className:t().draw,children:(0,o.jsx)(z.Z,{scale:a.curr,currentTool:l,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat(U,"/datas/").concat((R=j.curr)===null||R===void 0?void 0:R.dataId,"/image")})}),(0,o.jsx)("div",{className:t().pblock,children:(0,o.jsx)("div",{className:t().progress,children:(0,o.jsx)(c.Z,{percent:50,status:"active"})})}),(0,o.jsx)("div",{className:t().prevTask,onClick:function(){return f.turnTo(f.currIdx-1)}}),(0,o.jsx)("div",{className:t().nextTask,onClick:function(){return f.turnTo(f.currIdx+1)}})]})}),(0,o.jsxs)(H.Z,{disLoc:"right",children:[(0,o.jsx)(O.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,o.jsx)(O.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,o.jsx)("div",{className:t().rightSideBar,children:(0,o.jsx)($.Z,{labels:I.all,selectedLabel:I.curr,onLabelSelect:I.onSelect,onLabelAdd:I.onAdd,onLabelDelete:I.onDelete,onLabelModify:function(){}})})]})};C.default=X}}]);
