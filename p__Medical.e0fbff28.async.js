(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[454],{57560:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},8982:function(y){y.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(y){y.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},43801:function(y,L,n){"use strict";n.d(L,{Z:function(){return P}});var W=n(11849),j=n(2824),I=n(91220),O=n(67294),K=n(65031),x=n(85893);function D(t,v,l,m){if(!(!t||!v||!l||!m))return{width:t,color:v,points:l,tool:m}}function b(t,v,l,m,u,h,c){if(!t||!t.lines)return(0,x.jsx)(x.Fragment,{});var i=(c==null?void 0:c.annotationId)==t.annotationId,A=i&&u=="mover",M=[],g=(0,I.Z)(t.lines),E;try{for(g.s();!(E=g.n()).done;){var _=E.value;!_.width||!_.color||!_.points||!_.tool||M.push((0,x.jsx)(K.x1,{stroke:_.color,strokeWidth:_.width,globalCompositeOperation:_.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:_.points,tension:.01,onDragMove:function(){},onDragEnd:function(){l()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:A?1:0}))}}catch(S){g.e(S)}finally{g.f()}return(0,x.jsx)(K.ZA,{draggable:A,children:M})}function R(t,v){return t=="rubber"||v==2?"rubber":"brush"}function e(t){var v=0,l=(0,I.Z)(t),m;try{for(l.s();!(m=l.n()).done;){var u=m.value;!u||u.annotationId>v&&(v=u.annotationId)}}catch(h){l.e(h)}finally{l.f()}return v}function P(t){var v=(0,O.useState)(),l=(0,j.Z)(v,2),m=l[0],u=l[1],h=function(M,g){var E;if(!(t.currentTool!="brush"&&t.currentTool!="rubber")){var _=M.evt.offsetX/g,S=M.evt.offsetY/g,a=R(t.currentTool,M.evt.button),s=D(t.brushSize||10,(E=t.currentLabel)===null||E===void 0?void 0:E.color,[_,S,_,S],a);if(!!s)if(u(a),t.currentAnnotation){var p,z={tool:"brush",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:(p=t.currentAnnotation.lines)===null||p===void 0?void 0:p.concat([s])};t.onAnnotationModify(z)}else{if(a=="rubber")return;t.onAnnotationAdd({tool:"brush",annotationId:e(t.annotations)+1,label:t.currentLabel,lines:[s]})}}},c=function(M,g){var E;if(!(!m||!t.currentAnnotation)){var _=M.evt.offsetX/g,S=M.evt.offsetY/g,a=[_,S],s=[];(E=t.currentAnnotation)!==null&&E!==void 0&&E.lines&&(a=t.currentAnnotation.lines[t.currentAnnotation.lines.length-1].points.concat(a),s=t.currentAnnotation.lines);var p=D(t.brushSize||10,t.currentLabel.color,a,m);!p||(s.pop(),s.push(p),t.onAnnotationModify((0,W.Z)((0,W.Z)({},t.currentAnnotation),{},{lines:s})))}},i=function(){t.currentTool!="brush"&&t.currentTool!="rubber"||(u(void 0),t.onMouseUp())};return{onMouseDown:h,onMouseMove:c,onMouseUp:i,createElementsFunc:b}}},58967:function(y,L,n){"use strict";var W=n(20136),j=n(55241),I=n(77883),O=n(70507),K=n(57663),x=n(71577),D=n(2824),b=n(67294),R=n(61541),e=n(57560),P=n.n(e),t=n(85893),v=1,l=50,m=10;function u(c){return c?c<=v?v:c>=l?l:c:m}var h=function(i){var A=(0,b.useState)(u(i.size)),M=(0,D.Z)(A,2),g=M[0],E=M[1],_=function(a){E(u(a))};return(0,b.useEffect)(function(){_(i.size)},[i.size]),(0,t.jsxs)(j.Z,{overlayClassName:P().popover,placement:"right",content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g-1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"-"}),(0,t.jsx)(O.Z,{min:v,max:l,value:g,onChange:function(a){var s;(s=i.onChange)===null||s===void 0||s.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g+1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"+"})]}),trigger:i.active?"hover":"click",children:[" ",(0,t.jsx)(R.Z,{active:i.active,imgSrc:i.imgSrc||"./pics/buttons/brush.png",onClick:i.onClick,children:i.children||"Brush"})]})};L.Z=h},27992:function(y,L,n){"use strict";var W=n(20136),j=n(55241),I=n(77883),O=n(70507),K=n(57663),x=n(71577),D=n(2824),b=n(67294),R=n(61541),e=n(26647),P=n.n(e),t=n(85893),v=1,l=100,m=10;function u(c){return c?c<=v?v:c>=l?l:c:m}var h=function(i){var A=(0,b.useState)(u(i.size)),M=(0,D.Z)(A,2),g=M[0],E=M[1],_=function(a){E(u(a))};return(0,b.useEffect)(function(){_(i.size)},[i.size]),(0,t.jsxs)(j.Z,{overlayClassName:"".concat(P().popover," ").concat(i.disLoc=="left"?P().popoverLeft:""),placement:i.disLoc||"right",content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g-1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"-"}),(0,t.jsx)(O.Z,{min:v,max:l,value:g,onChange:function(a){var s;(s=i.onChange)===null||s===void 0||s.call(0,a)},controls:!1,style:{textAlign:"center"}}),(0,t.jsx)(x.Z,{type:"text",onClick:function(){var a,s=u(g+1);_(s),(a=i.onChange)===null||a===void 0||a.call(0,s)},children:"+"})]}),trigger:"hover",children:[" ",(0,t.jsx)(R.Z,{imgSrc:i.imgSrc,onClick:i.onClick,children:i.children})]})};L.Z=h},13931:function(y,L,n){"use strict";n.d(L,{Z:function(){return R}});var W=n(91220),j=n(11849),I=n(65031),O=n(85893);function K(e){var P=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return P?{r:parseInt(P[1],16),g:parseInt(P[2],16),b:parseInt(P[3],16)}:null}function x(e,P){if(!(!e||!P))return{color:e,points:P}}function D(e,P,t,v,l,m,u){if(!e||!e.lines||!e.lines[0])return[(0,O.jsx)(O.Fragment,{})];var h=e.lines[0].points,c=e.lines[0].color,i=K(c);if(!i)return[(0,O.jsx)(O.Fragment,{})];var A=(u==null?void 0:u.annotationId)==e.annotationId,M=A?.5:.1,g=void 0,E=[];return h.forEach(function(_,S){if(!g){g=_;return}E.push((0,O.jsx)(I.Cd,{onMouseDown:function(){l=="mover"&&m(e)},draggable:l=="mover",onDragMove:function(s){console.log("Circle onDrageMove");var p=s.evt.offsetX/v,z=s.evt.offsetY/v;h[S-1]=p,h[S]=z;var o=(0,j.Z)((0,j.Z)({},e),{},{lines:[{color:c,points:h}]});P(o)},onMouseOver:function(){console.log("Circle onMouseOver"),l=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:g,y:_,radius:5,fill:c})),g=void 0}),[(0,O.jsxs)(I.ZA,{children:[(0,O.jsx)(I.x1,{onMouseOver:function(){l=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){l=="mover"&&m(e)},stroke:c,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:h,tension:0,closed:!0,fill:"rgba(".concat(i.r,", ").concat(i.g,", ").concat(i.b,", ").concat(M,")")}),E]},e.annotationId)]}function b(e){var P=0,t=(0,W.Z)(e),v;try{for(t.s();!(v=t.n()).done;){var l=v.value;!l||l.annotationId>P&&(P=l.annotationId)}}catch(m){t.e(m)}finally{t.f()}return P}function R(e){var P=function(u,h){var c,i=u.evt.offsetX/h,A=u.evt.offsetY/h,M=x((c=e.currentLabel)===null||c===void 0?void 0:c.color,[i,A]);!M||e.onAnnotationAdd({tool:"polygon",annotationId:b(e.annotations)+1,label:e.currentLabel,lines:[M]})},t=function(u,h){var c,i;if(!!e.currentAnnotation){var A=u.evt.offsetX/h,M=u.evt.offsetY/h,g=e.currentAnnotation.lines||[],E=x((c=e.currentLabel)===null||c===void 0?void 0:c.color,(i=g[0])===null||i===void 0?void 0:i.points.concat([A,M]));if(!!E){var _={tool:"polygon",annotationId:e.currentAnnotation.annotationId,label:e.currentAnnotation.label,lines:[E]};e.onAnnotationModify(_)}}},v=function(u,h){e.currentTool=="polygon"&&(e.currentAnnotation?t(u,h):P(u,h))},l=function(){e.currentTool=="polygon"&&e.onMouseUp()};return{onMouseDown:v,onMouseMove:function(){},onMouseUp:l,createElementsFunc:D}}},29919:function(y,L,n){"use strict";var W=n(67294),j=n(61541),I=n(85893),O=function(x){return(0,I.jsx)(j.Z,{active:x.active,imgSrc:x.imgSrc||"./pics/buttons/polygon.png",onClick:x.onClick,children:x.children})};L.Z=O},21028:function(y,L,n){"use strict";n.r(L),n.d(L,{MOST_HISTORY_STEPS:function(){return X},default:function(){return mn}});var W=n(57663),j=n(71577),I=n(20136),O=n(55241),K=n(34669),x=n(54458),D=n(2824),b=n(67294),R=n(75721),e=n.n(R),P=n(8088),t=n(61541),v=n(44434),l=n(58967),m=n(27992),u=n(5041),h=n(57436),c=n(14836),i=n(29919),A=n(43801),M=n(13931),g=n(13062),E=n(71230),_=n(66126),S=n(75454),a=n(89032),s=n(15746),p=n(8982),z=n.n(p),o=n(85893),vn=function(F){return(0,o.jsxs)("div",{children:[(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(s.Z,{span:6,className:z().Pop1,children:(0,o.jsx)("span",{children:"Ww"})}),(0,o.jsx)(s.Z,{span:18,className:z().Pop2,children:(0,o.jsx)(S.Z,{min:1,max:F.wwValue||100,defaultValue:37})})]}),(0,o.jsxs)(E.Z,{children:[(0,o.jsx)(s.Z,{span:6,className:z().Pop1,children:(0,o.jsx)("span",{children:"Wl"})}),(0,o.jsx)(s.Z,{span:18,className:z().Pop2,children:(0,o.jsx)(S.Z,{min:1,max:F.wlValue||100,defaultValue:37})})]})]})},_n=vn,X=40,fn=function(){var F,hn=(0,b.useState)(void 0),q=(0,D.Z)(hn,2),T=q[0],Y=q[1],Pn=(0,b.useState)({color:"",name:""}),nn=(0,D.Z)(Pn,2),J=nn[0],tn=nn[1],Mn=(0,b.useState)(),on=(0,D.Z)(Mn,2),U=on[0],V=on[1],En=(0,b.useState)([]),en=(0,D.Z)(En,2),B=en[0],Cn=en[1],Sn=(0,b.useState)(10),rn=(0,D.Z)(Sn,2),$=rn[0],an=rn[1],xn=(0,b.useState)(1),sn=(0,D.Z)(xn,2),G=sn[0],k=sn[1],ln=function(r){r||k(1),r<.1||r>3?k(1):k(r)},Z=function(r){V(r),r!=null&&r.label&&tn(r.label)},N=function(r){Cn(r)};(0,b.useEffect)(function(){localStorage.removeItem("history"),H([])},[]);function H(d,r){var f=localStorage.getItem("history"),C=f?JSON.parse(f):{index:-1,items:[]},dn={currentAnnotation:r,annotations:d};if(JSON.stringify(C.items[C.index])!=JSON.stringify(dn)){var An=C.index>X?C.index-X:0,Dn=C.items.splice(An,C.index==0?1:C.index+1);C.items=Dn.concat([dn]),C.index<=X?C.index++:C.index=X+1,localStorage.setItem("history",JSON.stringify(C))}}var On=function(){var r=localStorage.getItem("history");if(!!r){var f=JSON.parse(r);if(!!f&&!(f.index>=f.items.length-1)){f.index++,localStorage.setItem("history",JSON.stringify(f));var C=f.items[f.index];V(C.currentAnnotation),N(C.annotations)}}},bn=function(){var r=localStorage.getItem("history");if(!!r){var f=JSON.parse(r);if(!(!f||!f.index)&&!(f.index<=0)){f.index--,localStorage.setItem("history",JSON.stringify(f));var C=f.items[f.index];V(C.currentAnnotation),N(C.annotations)}}},w=function(r){for(var f=[],C=0;C<B.length;C++)B[C].annotationId==r.annotationId?f.push(r):f.push(B[C]);Z(r),N(f)},un=(0,A.Z)({currentLabel:J,brushSize:$,currentTool:T,annotations:B,currentAnnotation:U,onAnnotationAdd:function(r){var f=B.concat([r]);N(f),U||Z(r)},onAnnotationModify:w,onMouseUp:function(){H(B,U)}}),cn=(0,M.Z)({currentLabel:J,brushSize:$,currentTool:T,annotations:B,currentAnnotation:U,onAnnotationAdd:function(r){var f=B.concat([r]);N(f),U||Z(r)},onAnnotationModify:w,onMouseUp:function(){H(B,U)}}),Q=T=="polygon"?cn:un;return(0,o.jsxs)(P.Z,{className:e().segment,children:[(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(i.Z,{active:T=="polygon",onClick:function(){Y("polygon"),Z(void 0)},children:"Polygon"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,o.jsx)(l.Z,{size:$,active:T=="brush",onClick:function(){T!="rubber"&&T!="brush"&&Z(void 0),Y("brush")},onChange:function(r){an(r)},children:"Brush"}),(0,o.jsx)(l.Z,{size:$,active:T=="rubber",onClick:function(){T!="rubber"&&T!="brush"&&Z(void 0),Y("rubber")},onChange:function(r){an(r)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){ln(G+.1)},children:"Zoom in"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){ln(G-.1)},children:"Zoom out"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){Y("mover")},children:"Move"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){bn()},children:"Undo"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){On()},children:"Redo"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{id:"dr",className:e().mainStage,children:[(0,o.jsx)("div",{className:e().draw,children:(0,o.jsx)(h.Z,{width:(F=document.getElementById("dr"))===null||F===void 0?void 0:F.clientWidth,scale:G,annotations:B,currentTool:T,currentAnnotation:U,setCurrentAnnotation:Z,onAnnotationModify:w,onAnnotationModifyComplete:function(){H(B,U)},onMouseDown:Q.onMouseDown,onMouseMove:Q.onMouseMove,onMouseUp:Q.onMouseUp,createPolygonFunc:cn.createElementsFunc,createBrushFunc:un.createElementsFunc})}),(0,o.jsx)("div",{className:e().pblock,children:(0,o.jsx)("div",{className:e().progress,children:(0,o.jsx)(x.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(v.Z,{disLoc:"right",children:[(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Interactor"}),(0,o.jsx)(m.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,o.jsx)(m.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,o.jsx)(m.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"}),(0,o.jsxs)(O.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,o.jsx)(_n,{}),trigger:"hover",children:[" ",(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:"Medical Setting"})]}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"})]}),(0,o.jsxs)("div",{className:e().rightSideBar,children:[(0,o.jsx)("div",{className:e().determinOutline,children:(0,o.jsx)(j.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){Z(void 0)},children:"Determine Outline"})}),(0,o.jsx)(u.Z,{selectedLabel:J,onLabelSelect:function(r){tn(r),Z(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(c.Z,{selectedAnnotation:U,annotations:B,onAnnotationSelect:function(r){r!=null&&r.delete||Z(r)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(r){N(B.filter(function(f){return f.annotationId!=r.annotationId})),Z(void 0)}})]})]})},mn=fn}}]);
