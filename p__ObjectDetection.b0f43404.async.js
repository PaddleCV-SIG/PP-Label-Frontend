(self.webpackChunkpp_labeling_frontend=self.webpackChunkpp_labeling_frontend||[]).push([[408],{32774:function(k){k.exports={det:"det___2iG9x",mainStage:"mainStage___Qp8In",draw:"draw___2IpRn",pblock:"pblock___wJLzi",progress:"progress___2SU43",rightSideBar:"rightSideBar___1NCKK",determinOutline:"determinOutline___3M_ux"}},79331:function(k,w,s){"use strict";s.r(w),s.d(w,{default:function(){return an}});var dn=s(57663),X=s(71577),fn=s(34669),K=s(54458),I=s(2824),O=s(67294),$=s(32774),C=s.n($),z=s(8088),M=s(61541),G=s(44434),Q=s(5041),W=s(57436),V=s(14836),q=s(29919),_=s(91220),J=s(11849),R=s(65031),o=s(85893);function nn(t){var l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return l?{r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)}:null}function E(t,l){if(!(!t||!l))return{color:t,points:l}}function tn(t,l,S,m,f,y,c){if(!t||!t.lines||!t.lines[0])return[(0,o.jsx)(o.Fragment,{})];var r=t.lines[0].points,u=t.lines[0].color,g=nn(u);if(!g)return[(0,o.jsx)(o.Fragment,{})];var p=(c==null?void 0:c.annotationId)==t.annotationId,v=p?.5:.1,x=void 0,j=[];return r.forEach(function(h,d){if(!x){x=h;return}j.push((0,o.jsx)(R.Cd,{onMouseDown:function(){f=="mover"&&y(t)},draggable:f=="mover",onDragMove:function(D){console.log("Circle onDrageMove");var N=D.evt.offsetX/m,Z=D.evt.offsetY/m;r[d-1]=N,r[d]=Z;var L=(0,J.Z)((0,J.Z)({},t),{},{lines:[{color:u,points:r}]});l(L)},onMouseOver:function(){console.log("Circle onMouseOver"),f=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x,y:h,radius:5,fill:u})),console.log(d,r),r.length>4&&r.splice(d+1,2),x=void 0}),[(0,o.jsxs)(R.ZA,{children:[(0,o.jsx)(R.UL,{onMouseOver:function(){f=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){f=="mover"&&y(t)},stroke:u,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",x:r[0],y:r[1],width:r[2]-r[0],height:r[3]-r[1],closed:!0,fill:"rgba(".concat(g.r,", ").concat(g.g,", ").concat(g.b,", ").concat(v,")")}),j]},t.annotationId)]}function on(t){var l=0,S=(0,_.Z)(t),m;try{for(S.s();!(m=S.n()).done;){var f=m.value;!f||f.annotationId>l&&(l=f.annotationId)}}catch(y){S.e(y)}finally{S.f()}return l}function en(t){var l=function(c,r){var u,g=c.evt.offsetX/r,p=c.evt.offsetY/r,v=E((u=t.currentLabel)===null||u===void 0?void 0:u.color,[g,p]);!v||t.onAnnotationAdd({tool:"polygon",annotationId:on(t.annotations)+1,label:t.currentLabel,lines:[v]})},S=function(c,r){var u,g;if(!!t.currentAnnotation){var p=c.evt.offsetX/r,v=c.evt.offsetY/r,x=t.currentAnnotation.lines||[],j=E((u=t.currentLabel)===null||u===void 0?void 0:u.color,(g=x[0])===null||g===void 0?void 0:g.points.concat([p,v]));if(!!j){var h={tool:"polygon",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:[j]};t.onAnnotationModify(h)}}},m=function(c,r){t.currentTool=="polygon"&&(t.currentAnnotation?S(c,r):l(c,r))},f=function(){t.currentTool=="polygon"&&t.onMouseUp()};return{onMouseDown:m,onMouseMove:function(){},onMouseUp:f,createElementsFunc:tn}}var P=40,rn=function(){var l=(0,O.useState)(void 0),S=(0,I.Z)(l,2),m=S[0],f=S[1],y=(0,O.useState)({color:"",name:""}),c=(0,I.Z)(y,2),r=c[0],u=c[1],g=(0,O.useState)(),p=(0,I.Z)(g,2),v=p[0],x=p[1],j=(0,O.useState)([]),h=(0,I.Z)(j,2),d=h[0],A=h[1],D=(0,O.useState)(1),N=(0,I.Z)(D,2),Z=N[0],L=N[1],H=function(n){n||L(1),n<.1||n>3?L(1):L(n)},b=function(n){x(n),n!=null&&n.label&&u(n.label)};(0,O.useEffect)(function(){localStorage.removeItem("history"),T([])},[]);function T(i,n){var e=localStorage.getItem("history"),a=e?JSON.parse(e):{index:-1,items:[]},F={currentAnnotation:n,annotations:i};if(JSON.stringify(a.items[a.index])!=JSON.stringify(F)){var cn=a.index>P?a.index-P:0,un=a.items.splice(cn,a.index==0?1:a.index+1);a.items=un.concat([F]),a.index<=P?a.index++:a.index=P+1,localStorage.setItem("history",JSON.stringify(a))}}var sn=function(){var n=localStorage.getItem("history");if(!!n){var e=JSON.parse(n);if(!!e&&!(e.index>=e.items.length-1)){e.index++,localStorage.setItem("history",JSON.stringify(e));var a=e.items[e.index];x(a.currentAnnotation),A(a.annotations)}}},ln=function(){var n=localStorage.getItem("history");if(!!n){var e=JSON.parse(n);if(!(!e||!e.index)&&!(e.index<=0)){e.index--,localStorage.setItem("history",JSON.stringify(e));var a=e.items[e.index];x(a.currentAnnotation),A(a.annotations)}}},Y=function(n){for(var e=[],a=0;a<d.length;a++)d[a].annotationId==n.annotationId?e.push(n):e.push(d[a]);b(n),A(e)},B=en({currentLabel:r,currentTool:m,annotations:d,currentAnnotation:v,onAnnotationAdd:function(n){var e=d.concat([n]);A(e),v||b(n)},onAnnotationModify:Y,onMouseUp:function(){T(d,v)}}),U=B;return(0,o.jsxs)(z.Z,{className:C().det,children:[(0,o.jsxs)(G.Z,{children:[(0,o.jsx)(q.Z,{active:m=="polygon",onClick:function(){f("polygon"),b(void 0)},children:"Polygon"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){H(Z+.1)},children:"Zoom in"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){H(Z-.1)},children:"Zoom out"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){f("mover")},children:"Move"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){ln()},children:"Undo"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){sn()},children:"Redo"}),(0,o.jsx)(M.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{className:C().mainStage,children:[(0,o.jsx)("div",{className:C().draw,children:(0,o.jsx)(W.Z,{scale:Z,annotations:d,currentTool:m,currentAnnotation:v,setCurrentAnnotation:b,onAnnotationModify:Y,onAnnotationModifyComplete:function(){T(d,v)},onMouseDown:U.onMouseDown,onMouseMove:U.onMouseMove,onMouseUp:U.onMouseUp,createPolygonFunc:B.createElementsFunc})}),(0,o.jsx)("div",{className:C().pblock,children:(0,o.jsx)("div",{className:C().progress,children:(0,o.jsx)(K.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)("div",{className:C().rightSideBar,children:[(0,o.jsx)("div",{className:C().determinOutline,children:(0,o.jsx)(X.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){b(void 0)},children:"Determine Outline"})}),(0,o.jsx)(Q.Z,{selectedLabel:r,onLabelSelect:function(n){u(n),b(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(V.Z,{selectedAnnotation:v,annotations:d,onAnnotationSelect:function(n){n!=null&&n.delete||b(n)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(n){A(d.filter(function(e){return e.annotationId!=n.annotationId})),b(void 0)}})]})]})},an=rn}}]);
