(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(m,P,n){"use strict";n.d(P,{Z:function(){return u}});var f=n(94663),h=n(80112);function B(a){return Function.toString.call(a).indexOf("[native code]")!==-1}var N=n(18597);function x(a,r,I){return(0,N.Z)()?x=Reflect.construct:x=function(y,O,D){var l=[null];l.push.apply(l,O);var d=Function.bind.apply(y,l),p=new d;return D&&(0,h.Z)(p,D.prototype),p},x.apply(null,arguments)}function u(a){var r=typeof Map=="function"?new Map:void 0;return u=function(s){if(s===null||!B(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r!="undefined"){if(r.has(s))return r.get(s);r.set(s,y)}function y(){return x(s,arguments,(0,f.Z)(this).constructor)}return y.prototype=Object.create(s.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),(0,h.Z)(y,s)},u(a)}},85024:function(m){m.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(m){m.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},6277:function(m){m.exports={modal:"modal___26yNn"}},45092:function(m){m.exports={modal:"modal___1H_FQ"}},72285:function(m){m.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},14836:function(m,P,n){"use strict";n.d(P,{Z:function(){return G}});var f=n(54421),h=n(38272),B=n(57663),N=n(71577),x=n(67294),u=n(56159),a=n.n(u),r=n(49111),I=n(19650),s=n(2824),y=n(11849),O=n(85024),D=n.n(O),l=n(63097),d=n(85893),p=function(t){var v=(0,y.Z)({},t.annotation),b=(0,x.useState)(v.invisible),E=(0,s.Z)(b,2),M=E[0],R=E[1],j=(0,x.useState)(0),U=(0,s.Z)(j,2),C=U[0],$=U[1];(0,x.useEffect)(function(){R(t.annotation.invisible)},[t.annotation.invisible]);var c=(0,d.jsxs)(h.ZP.Item,{className:"".concat(D().listItem," ").concat(t.active?D().listItemActive:""),unselectable:"on",onClick:function(){t.onClick(v)},children:[(0,d.jsxs)(I.Z,{align:"center",size:5,children:[(0,d.jsx)("a",{className:D().eye,style:{backgroundImage:M?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(K){K.stopPropagation(),R(!M),t.onAnnotationModify(v)}})," ",(0,d.jsx)("span",{className:D().annotationId,children:v.frontendId}),(0,d.jsx)("span",{className:D().labelName,children:v.label.name}),(0,d.jsx)(l.Z,{color:v.label.color})]}),(0,d.jsx)("a",{className:D().delete,onClick:function(K){K.stopPropagation();var H=new Date().getTime();H-C<300||($(H),t.onAnnotationDelete(v))}})]});return c},T=p,g=n(48971),o=function(t){var v=(0,g.YB)(),b=v.formatMessage({id:"component.PPAnnotationList.annotationList"}),E=v.formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(h.ZP,{className:a().labelList,size:"large",header:(0,d.jsx)("div",{className:a().listHeader,children:b}),bordered:!0,dataSource:t.annotations,renderItem:function(R){var j;return(0,d.jsx)(T,{onClick:t.onAnnotationSelect,annotation:R,active:R.frontendId==((j=t.currAnnotation)===null||j===void 0?void 0:j.frontendId),onAnnotationDelete:t.onAnnotationDelete,onAnnotationModify:t.onAnnotationModify})},footer:(0,d.jsx)("div",{children:(0,d.jsx)(N.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){t.onAnnotationAdd()},block:!0,children:E})})})})},G=o},85871:function(m,P,n){"use strict";var f=n(71194),h=n(50146),B=n(49111),N=n(19650),x=n(57663),u=n(71577),a=n(13062),r=n(71230),I=n(89032),s=n(15746),y=n(77883),O=n(70507),D=n(34792),l=n(48086),d=n(9715),p=n(93766),T=n(2824),g=n(67294),o=n(48971),G=n(6277),S=n.n(G),t=n(85893),v=function(E){var M=(0,o.YB)(),R=(0,g.useState)(60),j=(0,T.Z)(R,2),U=j[0],C=j[1],$=(0,g.useState)(20),c=(0,T.Z)($,2),_=c[0],K=c[1],H=(0,g.useState)(20),q=(0,T.Z)(H,2),Z=q[0],nn=q[1],Y=(0,g.useState)(!1),F=(0,T.Z)(Y,2),rn=F[0],tn=F[1],ln=M.formatMessage({id:"pages.toolBar.divideData"}),en=M.formatMessage({id:"component.PPDivideDataModal.train"}),k=M.formatMessage({id:"component.PPDivideDataModal.validation"}),A=M.formatMessage({id:"component.PPDivideDataModal.test"}),dn=M.formatMessage({id:"component.PPCreater.cancel"}),on=M.formatMessage({id:"component.PPSegMode.ok"}),W=p.Z.useForm(),V=(0,T.Z)(W,1),an=V[0];return(0,t.jsx)(h.Z,{className:S().modal,title:ln,visible:E.visible,onCancel:E.onCancel,footer:null,children:(0,t.jsxs)(p.Z,{form:an,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(){if(U+_+Z!=100){l.default.error("Train, Validation and Test total percent should equal 100!");return}console.log("x trainData: ".concat(U,", validationData: ").concat(_,", testData: ").concat(Z,", props.project.curr.projectId: ").concat(E.project.curr.projectId)),tn(!0),E.splitDataset(E.project.curr.projectId,{train:U*.01,val:_*.01,test:Z*.01}).then(function(){var J;console.log("success"),l.default.success(M.formatMessage({id:"component.PPDivideDataModal.success"})),(J=E.onFinish)===null||J===void 0||J.call(0)}).finally(function(){tn(!1)})},autoComplete:"off",layout:"vertical",children:[(0,t.jsxs)(r.Z,{children:[(0,t.jsx)(s.Z,{span:8,children:(0,t.jsx)(p.Z.Item,{label:en,name:"train",children:(0,t.jsx)(O.Z,{addonAfter:"%",defaultValue:60,precision:0,min:0,max:100,value:U,onChange:C})})}),(0,t.jsx)(s.Z,{span:8,children:(0,t.jsx)(p.Z.Item,{label:k,name:"validation",children:(0,t.jsx)(O.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:_,onChange:K})})}),(0,t.jsx)(s.Z,{span:8,children:(0,t.jsx)(p.Z.Item,{label:A,name:"test",children:(0,t.jsx)(O.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:Z,onChange:nn})})})]}),(0,t.jsx)(p.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(u.Z,{onClick:function(){var J;(J=E.onCancel)===null||J===void 0||J.call(0),an.resetFields()},children:dn}),(0,t.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:rn,children:on})]})})]})})};P.Z=v},62850:function(m,P,n){"use strict";var f=n(71194),h=n(50146),B=n(49111),N=n(19650),x=n(57663),u=n(71577),a=n(47673),r=n(24044),I=n(34792),s=n(48086),y=n(9715),O=n(93766),D=n(2824),l=n(67294),d=n(48971),p=n(45092),T=n.n(p),g=n(85893),o=function(S){var t=(0,d.YB)(),v=(0,l.useState)(!1),b=(0,D.Z)(v,2),E=b[0],M=b[1],R=t.formatMessage({id:"component.PPCreater.cancel"}),j=O.Z.useForm(),U=(0,D.Z)(j,1),C=U[0];return(0,g.jsx)(h.Z,{className:T().modal,title:t.formatMessage({id:"component.PPExportModal.title"}),visible:S.visible,onCancel:S.onCancel,footer:null,children:(0,g.jsxs)(O.Z,{form:C,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(c){console.log(c);var _=c.path;if(!_){s.default.error(t.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}M(!0),S.exportDataset(S.project.curr.projectId,_).then(function(){var K;s.default.success(t.formatMessage({id:"component.PPExportModal.exportSuccess"})),(K=S.onFinish)===null||K===void 0||K.call(0)}).finally(function(){M(!1)})},autoComplete:"off",children:[(0,g.jsx)(O.Z.Item,{label:t.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,g.jsx)(r.Z,{})}),(0,g.jsx)(O.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,g.jsxs)(N.Z,{children:[(0,g.jsx)(u.Z,{onClick:function(){var c;(c=S.onCancel)===null||c===void 0||c.call(0),C.resetFields()},children:R}),(0,g.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:E,children:t.formatMessage({id:"component.PPExportModal.export"})})]})})]})})};P.Z=o},91861:function(m,P,n){"use strict";n.d(P,{Ad:function(){return h},k3:function(){return B},Vd:function(){return N},td:function(){return x}});var f=40;function h(){localStorage.removeItem("history"),B([])}function B(u){var a=localStorage.getItem("history"),r=a?JSON.parse(a):{index:-1,items:[]};if(JSON.stringify(r.items[r.index])!=JSON.stringify(u)){var I=r.index>f?r.index-f:0,s=r.items.splice(I,r.index==0?1:r.index+1);r.items=s.concat([u]),r.index<=f?r.index++:r.index=f+1,localStorage.setItem("history",JSON.stringify(r))}}function N(){var u=localStorage.getItem("history");if(!!u){var a=JSON.parse(u);if(!!a&&!(a.index>=a.items.length-1))return a.index++,localStorage.setItem("history",JSON.stringify(a)),a.items[a.index]}}function x(){var u=localStorage.getItem("history");if(!!u){var a=JSON.parse(u);if(!(!a||!a.index)&&!(a.index<=0))return a.index--,localStorage.setItem("history",JSON.stringify(a)),a.items[a.index]}}},30289:function(m,P,n){"use strict";n.r(P),n.d(P,{default:function(){return j}});var f=n(11849),h=n(20228),B=n(11382),N=n(34669),x=n(54458),u=n(34792),a=n(48086),r=n(91220),I=n(2824),s=n(67294),y=n(72285),O=n.n(y),D=n(8088),l=n(61541),d=n(44434),p=n(5041),T=n(57436),g=n(14836),o=n(85893),G=function(C){return(0,o.jsx)(l.Z,{active:C.active,imgSrc:C.imgSrc||"./pics/buttons/rectangle.png",onClick:C.onClick,children:C.children})},S=G,t=n(50727),v=n(91861),b=n(48971),E=n(85871),M=n(62850),R=function(){var C,$=(0,t.$L)(s.useState,s.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:v.Ad}}),c=(0,I.Z)($,10),_=c[0],K=c[1],H=c[2],q=c[3],Z=c[4],nn=c[5],Y=c[6],F=c[7],rn=c[8],tn=c[9],ln=(0,s.useState)(),en=(0,I.Z)(ln,2),k=en[0],A=en[1],dn=(0,s.useState)([]),on=(0,I.Z)(dn,2),W=on[0],V=on[1],an=(0,s.useState)(!1),sn=(0,I.Z)(an,2),J=sn[0],cn=sn[1],gn=(0,s.useState)(!1),mn=(0,I.Z)(gn,2),Mn=mn[0],un=mn[1],En=function(e){if(!e.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(e));W.push(e),V(W),A(e)},_n=function(e){if(!e.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(e));var Q=[],z=(0,r.Z)(W),X;try{for(z.s();!(X=z.n()).done;){var w=X.value;w.frontendId==e.frontendId?Q.push(e):Q.push(w)}}catch(vn){z.e(vn)}finally{z.f()}console.log("modifyAnnotation, newAnnos:",Q,"anno:",e),V(Q),A(e)},Dn=function(e){if(!e.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(e));var Q=[],z=(0,r.Z)(W),X;try{for(z.s();!(X=z.n()).done;){var w=X.value;w.frontendId!=e.frontendId&&Q.push(w)}}catch(vn){z.e(vn)}finally{z.f()}V(Q),A(void 0)},Bn=function(e){!e||(console.log("modifyAnnotation",e,"anno.label:",e==null?void 0:e.label),e.taskId=Z.curr.taskId,e.dataId=nn.curr.dataId,q.modify(e))},Pn=drawRectangle({currentLabel:F.curr,currentTool:_.curr,annotations:W,currentAnnotation:k,onAnnotationAdd:En,onAnnotationModify:_n,onMouseUp:function(){(0,v.k3)({annos:W,currAnno:k})}}),fn=Pn,L=(0,b.YB)(),pn=L.formatMessage({id:"pages.toolBar.rectangle"}),Cn=L.formatMessage({id:"pages.toolBar.zoomIn"}),An=L.formatMessage({id:"pages.toolBar.zoomOut"}),hn=L.formatMessage({id:"pages.toolBar.move"}),xn=L.formatMessage({id:"pages.toolBar.unDo"}),On=L.formatMessage({id:"pages.toolBar.reDo"}),In=L.formatMessage({id:"pages.toolBar.save"}),yn=L.formatMessage({id:"pages.toolBar.edit"}),Sn=L.formatMessage({id:"pages.toolBar.clearMark"}),jn=L.formatMessage({id:"pages.toolBar.undef"}),Zn=L.formatMessage({id:"pages.toolBar.divideData"}),Ln=L.formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(D.Z,{className:O().det,children:[(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(S,{active:_.curr=="rectangle",onClick:function(){if(!F.curr){a.default.error("Please choose a label category first!");return}_.setCurr("rectangle"),A(void 0)},children:pn}),(0,o.jsx)(l.Z,{active:_.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){_.setCurr("editor")},children:yn}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){H.change(.1)},children:Cn}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){H.change(-.1)},children:An}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){a.default.info("Annotations are saved automatically. You don't need to click save.")},children:In}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/move.png",active:_.curr=="mover",onClick:function(){_.setCurr("mover")},children:hn}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var e=(0,v.td)();!e||(A(e.currAnno),V(e.annos))},children:xn}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var e=(0,v.Vd)();!e||(A(e.currAnno),V(e.annos))},children:On}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:Sn})]}),(0,o.jsx)("div",{id:"dr",className:"mainStage",children:(0,o.jsxs)(B.Z,{tip:"loading",spinning:!!K.curr,children:[(0,o.jsx)("div",{className:"draw",children:(0,o.jsx)(T.Z,{scale:H.curr,annotations:W,currentTool:_.curr,currentAnnotation:k,setCurrentAnnotation:A,onAnnotationModify:_n,onAnnotationModifyComplete:function(){(0,v.k3)({annos:W,currAnno:k})},onMouseDown:fn.onMouseDown,onMouseMove:fn.onMouseMove,onMouseUp:fn.onMouseUp,createRectangleFunc:Pn.createElementsFunc,imgSrc:nn.imgSrc})}),(0,o.jsx)("div",{className:"pblock",children:(0,o.jsxs)("div",{className:"progress",children:[(0,o.jsx)(x.Z,{className:"progressBar",percent:Y.progress,status:"active",showInfo:!1})," ",(0,o.jsxs)("span",{className:"progressDesc",children:["Current labeling ",Z.currIdx==null?1:Z.currIdx+1," of"," ",(C=Z.all)===null||C===void 0?void 0:C.length,". Already labeled ",Z.finished(Y.progress)||0,"."]})]})}),(0,o.jsx)("div",{className:"prevTask",onClick:function(){!Z.prevTask()||(A(void 0),V([]))}}),(0,o.jsx)("div",{className:"nextTask",onClick:function(){!Z.nextTask()||(A(void 0),V([]))}})]})}),(0,o.jsxs)(d.Z,{disLoc:"right",children:[(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){cn(!0)},children:Zn}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){un(!0)},children:Ln}),(0,o.jsx)(l.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){A(void 0)},children:jn})]}),(0,o.jsxs)("div",{className:"rightSideBar",children:[(0,o.jsx)(p.Z,{labels:F.all,activeIds:F.activeIds,onLabelSelect:function(e){F.onSelect(e),A(void 0)},onLabelModify:function(){},onLabelDelete:F.remove,onLabelAdd:function(e){return F.create((0,f.Z)((0,f.Z)({},e),{},{projectId:Y.curr.projectId}))}}),(0,o.jsx)(g.Z,{annotations:W,currAnnotation:k,onAnnotationSelect:A,onAnnotationAdd:function(){A(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(e){Dn(e)}})]}),(0,o.jsx)(E.Z,{visible:J,splitDataset:rn,project:Y,onCancel:function(){cn(!1)},onFinish:function(){cn(!1)}}),(0,o.jsx)(M.Z,{visible:Mn,exportDataset:tn,project:Y,onCancel:function(){un(!1)},onFinish:function(){un(!1)}})]})},j=R},15746:function(m,P,n){"use strict";var f=n(21584);P.Z=f.Z},89032:function(m,P,n){"use strict";var f=n(38663),h=n.n(f),B=n(6999)},71230:function(m,P,n){"use strict";var f=n(92820);P.Z=f.Z},13062:function(m,P,n){"use strict";var f=n(38663),h=n.n(f),B=n(6999)}}]);
