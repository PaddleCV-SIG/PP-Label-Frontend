(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[89],{57560:function(T){T.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(T){T.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},54777:function(T){T.exports={segment:"segment___1YMcl",mainStage:"mainStage___2otee",draw:"draw___equn4",pblock:"pblock___2bT7z",progress:"progress___1porz",rightSideBar:"rightSideBar___2X7jK",determinOutline:"determinOutline___2ls57"}},43801:function(T,S,n){"use strict";n.d(S,{Z:function(){return M}});var j=n(11849),y=n(2824),I=n(91220),b=n(67294),L=n(65031),g=n(85893);function U(e,c,s,E){if(!(!e||!c||!s||!E))return{width:e,color:c,points:s,tool:E}}function A(e,c,s,E,u,h,d){if(!e||!e.lines)return(0,g.jsx)(g.Fragment,{});var a=(d==null?void 0:d.annotationId)==e.annotationId,_=a&&u=="mover",o=[],v=(0,I.Z)(e.lines),B;try{for(v.s();!(B=v.n()).done;){var f=B.value;!f.width||!f.color||!f.points||!f.tool||o.push((0,g.jsx)(L.x1,{stroke:f.color,strokeWidth:f.width,globalCompositeOperation:f.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:f.points,tension:.01,onDragMove:function(){},onDragEnd:function(){s()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:_?1:0}))}}catch(O){v.e(O)}finally{v.f()}return(0,g.jsx)(L.ZA,{draggable:_,children:o})}function R(e,c){return e=="rubber"||c==2?"rubber":"brush"}function t(e){var c=0,s=(0,I.Z)(e),E;try{for(s.s();!(E=s.n()).done;){var u=E.value;!u||u.annotationId>c&&(c=u.annotationId)}}catch(h){s.e(h)}finally{s.f()}return c}function M(e){var c=(0,b.useState)(),s=(0,y.Z)(c,2),E=s[0],u=s[1],h=function(o,v){var B;if(!(e.currentTool!="brush"&&e.currentTool!="rubber")){var f=o.evt.offsetX/v,O=o.evt.offsetY/v,i=R(e.currentTool,o.evt.button),l=U(e.brushSize||10,(B=e.currentLabel)===null||B===void 0?void 0:B.color,[f,O,f,O],i);if(!!l)if(u(i),e.currentAnnotation){var D,K={tool:"brush",annotationId:e.currentAnnotation.annotationId,label:e.currentAnnotation.label,lines:(D=e.currentAnnotation.lines)===null||D===void 0?void 0:D.concat([l])};e.onAnnotationModify(K)}else{if(i=="rubber")return;e.onAnnotationAdd({tool:"brush",annotationId:t(e.annotations)+1,label:e.currentLabel,lines:[l]})}}},d=function(o,v){var B;if(!(!E||!e.currentAnnotation)){var f=o.evt.offsetX/v,O=o.evt.offsetY/v,i=[f,O],l=[];(B=e.currentAnnotation)!==null&&B!==void 0&&B.lines&&(i=e.currentAnnotation.lines[e.currentAnnotation.lines.length-1].points.concat(i),l=e.currentAnnotation.lines);var D=U(e.brushSize||10,e.currentLabel.color,i,E);!D||(l.pop(),l.push(D),e.onAnnotationModify((0,j.Z)((0,j.Z)({},e.currentAnnotation),{},{lines:l})))}},a=function(){e.currentTool!="brush"&&e.currentTool!="rubber"||(u(void 0),e.onMouseUp())};return{onMouseDown:h,onMouseMove:d,onMouseUp:a,createElementsFunc:A}}},58967:function(T,S,n){"use strict";var j=n(20136),y=n(55241),I=n(77883),b=n(70507),L=n(57663),g=n(71577),U=n(2824),A=n(67294),R=n(61541),t=n(57560),M=n.n(t),e=n(85893),c=1,s=50,E=10;function u(d){return d?d<=c?c:d>=s?s:d:E}var h=function(a){var _=(0,A.useState)(u(a.size)),o=(0,U.Z)(_,2),v=o[0],B=o[1],f=function(i){B(u(i))};return(0,A.useEffect)(function(){f(a.size)},[a.size]),(0,e.jsxs)(y.Z,{overlayClassName:M().popover,placement:"right",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.Z,{type:"text",onClick:function(){var i,l=u(v-1);f(l),(i=a.onChange)===null||i===void 0||i.call(0,l)},children:"-"}),(0,e.jsx)(b.Z,{min:c,max:s,value:v,onChange:function(i){var l;(l=a.onChange)===null||l===void 0||l.call(0,i)},controls:!1,style:{textAlign:"center"}}),(0,e.jsx)(g.Z,{type:"text",onClick:function(){var i,l=u(v+1);f(l),(i=a.onChange)===null||i===void 0||i.call(0,l)},children:"+"})]}),trigger:a.active?"hover":"click",children:[" ",(0,e.jsx)(R.Z,{active:a.active,imgSrc:a.imgSrc||"./pics/buttons/brush.png",onClick:a.onClick,children:a.children||"Brush"})]})};S.Z=h},27992:function(T,S,n){"use strict";var j=n(20136),y=n(55241),I=n(77883),b=n(70507),L=n(57663),g=n(71577),U=n(2824),A=n(67294),R=n(61541),t=n(26647),M=n.n(t),e=n(85893),c=1,s=100,E=10;function u(d){return d?d<=c?c:d>=s?s:d:E}var h=function(a){var _=(0,A.useState)(u(a.size)),o=(0,U.Z)(_,2),v=o[0],B=o[1],f=function(i){B(u(i))};return(0,A.useEffect)(function(){f(a.size)},[a.size]),(0,e.jsxs)(y.Z,{overlayClassName:"".concat(M().popover," ").concat(a.disLoc=="left"?M().popoverLeft:""),placement:a.disLoc||"right",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.Z,{type:"text",onClick:function(){var i,l=u(v-1);f(l),(i=a.onChange)===null||i===void 0||i.call(0,l)},children:"-"}),(0,e.jsx)(b.Z,{min:c,max:s,value:v,onChange:function(i){var l;(l=a.onChange)===null||l===void 0||l.call(0,i)},controls:!1,style:{textAlign:"center"}}),(0,e.jsx)(g.Z,{type:"text",onClick:function(){var i,l=u(v+1);f(l),(i=a.onChange)===null||i===void 0||i.call(0,l)},children:"+"})]}),trigger:"hover",children:[" ",(0,e.jsx)(R.Z,{imgSrc:a.imgSrc,onClick:a.onClick,children:a.children})]})};S.Z=h},13931:function(T,S,n){"use strict";n.d(S,{Z:function(){return R}});var j=n(91220),y=n(11849),I=n(65031),b=n(85893);function L(t){var M=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return M?{r:parseInt(M[1],16),g:parseInt(M[2],16),b:parseInt(M[3],16)}:null}function g(t,M){if(!(!t||!M))return{color:t,points:M}}function U(t,M,e,c,s,E,u){if(!t||!t.lines||!t.lines[0])return[(0,b.jsx)(b.Fragment,{})];var h=t.lines[0].points,d=t.lines[0].color,a=L(d);if(!a)return[(0,b.jsx)(b.Fragment,{})];var _=(u==null?void 0:u.annotationId)==t.annotationId,o=_?.5:.1,v=void 0,B=[];return h.forEach(function(f,O){if(!v){v=f;return}B.push((0,b.jsx)(I.Cd,{onMouseDown:function(){s=="mover"&&E(t)},draggable:s=="mover",onDragMove:function(l){console.log("Circle onDrageMove");var D=l.evt.offsetX/c,K=l.evt.offsetY/c;h[O-1]=D,h[O]=K;var Y=(0,y.Z)((0,y.Z)({},t),{},{lines:[{color:d,points:h}]});M(Y)},onMouseOver:function(){console.log("Circle onMouseOver"),s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:v,y:f,radius:5,fill:d})),v=void 0}),[(0,b.jsxs)(I.ZA,{children:[(0,b.jsx)(I.x1,{onMouseOver:function(){s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){s=="mover"&&E(t)},stroke:d,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:h,tension:0,closed:!0,fill:"rgba(".concat(a.r,", ").concat(a.g,", ").concat(a.b,", ").concat(o,")")}),B]},t.annotationId)]}function A(t){var M=0,e=(0,j.Z)(t),c;try{for(e.s();!(c=e.n()).done;){var s=c.value;!s||s.annotationId>M&&(M=s.annotationId)}}catch(E){e.e(E)}finally{e.f()}return M}function R(t){var M=function(u,h){var d,a=u.evt.offsetX/h,_=u.evt.offsetY/h,o=g((d=t.currentLabel)===null||d===void 0?void 0:d.color,[a,_]);!o||t.onAnnotationAdd({tool:"polygon",annotationId:A(t.annotations)+1,label:t.currentLabel,lines:[o]})},e=function(u,h){var d,a;if(!!t.currentAnnotation){var _=u.evt.offsetX/h,o=u.evt.offsetY/h,v=t.currentAnnotation.lines||[],B=g((d=t.currentLabel)===null||d===void 0?void 0:d.color,(a=v[0])===null||a===void 0?void 0:a.points.concat([_,o]));if(!!B){var f={tool:"polygon",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:[B]};t.onAnnotationModify(f)}}},c=function(u,h){t.currentTool=="polygon"&&(t.currentAnnotation?e(u,h):M(u,h))},s=function(){t.currentTool=="polygon"&&t.onMouseUp()};return{onMouseDown:c,onMouseMove:function(){},onMouseUp:s,createElementsFunc:U}}},29919:function(T,S,n){"use strict";var j=n(67294),y=n(61541),I=n(85893),b=function(g){return(0,I.jsx)(y.Z,{active:g.active,imgSrc:g.imgSrc||"./pics/buttons/polygon.png",onClick:g.onClick,children:g.children})};S.Z=b},86089:function(T,S,n){"use strict";n.r(S),n.d(S,{MOST_HISTORY_STEPS:function(){return v}});var j=n(57663),y=n(71577),I=n(34669),b=n(54458),L=n(2824),g=n(67294),U=n(54777),A=n.n(U),R=n(8088),t=n(61541),M=n(44434),e=n(58967),c=n(27992),s=n(5041),E=n(57436),u=n(14836),h=n(29919),d=n(43801),a=n(13931),_=n(48971),o=n(85893),v=40,B=function(){var O,i=(0,g.useState)(void 0),l=(0,L.Z)(i,2),D=l[0],K=l[1],Y=(0,g.useState)({color:"",name:""}),w=(0,L.Z)(Y,2),N=w[0],G=w[1],sn=(0,g.useState)(),V=(0,L.Z)(sn,2),W=V[0],X=V[1],_n=(0,g.useState)([]),Q=(0,L.Z)(_n,2),x=Q[0],Z=Q[1],ln=(0,g.useState)(10),q=(0,L.Z)(ln,2),z=q[0],nn=q[1],un=(0,g.useState)(1),en=(0,L.Z)(un,2),$=en[0],k=en[1],on=function(r){r||k(1),r<.1||r>3?k(1):k(r)},p=function(r){X(r),r!=null&&r.label&&G(r.label)};(0,g.useEffect)(function(){localStorage.removeItem("history"),F([])},[]);function F(m,r){var P=localStorage.getItem("history"),C=P?JSON.parse(P):{index:-1,items:[]},an={currentAnnotation:r,annotations:m};if(JSON.stringify(C.items[C.index])!=JSON.stringify(an)){var Tn=C.index>v?C.index-v:0,In=C.items.splice(Tn,C.index==0?1:C.index+1);C.items=In.concat([an]),C.index<=v?C.index++:C.index=v+1,localStorage.setItem("history",JSON.stringify(C))}}var dn=function(){var r=localStorage.getItem("history");if(!!r){var P=JSON.parse(r);if(!!P&&!(P.index>=P.items.length-1)){P.index++,localStorage.setItem("history",JSON.stringify(P));var C=P.items[P.index];X(C.currentAnnotation),Z(C.annotations)}}},cn=function(){var r=localStorage.getItem("history");if(!!r){var P=JSON.parse(r);if(!(!P||!P.index)&&!(P.index<=0)){P.index--,localStorage.setItem("history",JSON.stringify(P));var C=P.items[P.index];X(C.currentAnnotation),Z(C.annotations)}}},H=function(r){for(var P=[],C=0;C<x.length;C++)x[C].annotationId==r.annotationId?P.push(r):P.push(x[C]);p(r),Z(P)},tn=(0,d.Z)({currentLabel:N,brushSize:z,currentTool:D,annotations:x,currentAnnotation:W,onAnnotationAdd:function(r){var P=x.concat([r]);Z(P),W||p(r)},onAnnotationModify:H,onMouseUp:function(){F(x,W)}}),rn=(0,a.Z)({currentLabel:N,brushSize:z,currentTool:D,annotations:x,currentAnnotation:W,onAnnotationAdd:function(r){var P=x.concat([r]);Z(P),W||p(r)},onAnnotationModify:H,onMouseUp:function(){F(x,W)}}),J=D=="polygon"?rn:tn,vn=(0,_.YB)().formatMessage({id:"pages.toolBar.polygon"}),fn=(0,_.YB)().formatMessage({id:"pages.toolBar.brush"}),mn=(0,_.YB)().formatMessage({id:"pages.toolBar.rubber"}),Pn=(0,_.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),gn=(0,_.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),Mn=(0,_.YB)().formatMessage({id:"pages.toolBar.move"}),En=(0,_.YB)().formatMessage({id:"pages.toolBar.unDo"}),hn=(0,_.YB)().formatMessage({id:"pages.toolBar.reDo"}),On=(0,_.YB)().formatMessage({id:"pages.toolBar.save"}),Cn=(0,_.YB)().formatMessage({id:"pages.toolBar.edit"}),Bn=(0,_.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Dn=(0,_.YB)().formatMessage({id:"pages.toolBar.interactor"}),bn=(0,_.YB)().formatMessage({id:"pages.toolBar.segmentThreshold"}),An=(0,_.YB)().formatMessage({id:"pages.toolBar.diaphaneity"}),Ln=(0,_.YB)().formatMessage({id:"pages.toolBar.visualRadius"}),Sn=(0,_.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),xn=(0,_.YB)().formatMessage({id:"pages.toolBar.divideData"}),yn=(0,_.YB)().formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(R.Z,{className:A().segment,children:[(0,o.jsxs)(M.Z,{children:[(0,o.jsx)(h.Z,{active:D=="polygon",onClick:function(){K("polygon"),p(void 0)},children:vn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/edit.png",children:Cn}),(0,o.jsx)(e.Z,{size:z,active:D=="brush",onClick:function(){D!="rubber"&&D!="brush"&&p(void 0),K("brush")},onChange:function(r){nn(r)},children:fn}),(0,o.jsx)(e.Z,{size:z,active:D=="rubber",onClick:function(){D!="rubber"&&D!="brush"&&p(void 0),K("rubber")},onChange:function(r){nn(r)},imgSrc:"./pics/buttons/rubber.png",children:mn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){on($+.1)},children:Pn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){on($-.1)},children:gn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/save.png",children:On}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){K("mover")},children:Mn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){cn()},children:En}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){dn()},children:hn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:Bn})]}),(0,o.jsxs)("div",{id:"dr",className:A().mainStage,children:[(0,o.jsx)("div",{className:A().draw,children:(0,o.jsx)(E.Z,{width:(O=document.getElementById("dr"))===null||O===void 0?void 0:O.clientWidth,scale:$,annotations:x,currentTool:D,currentAnnotation:W,setCurrentAnnotation:p,onAnnotationModify:H,onAnnotationModifyComplete:function(){F(x,W)},onMouseDown:J.onMouseDown,onMouseMove:J.onMouseMove,onMouseUp:J.onMouseUp,createPolygonFunc:rn.createElementsFunc,createBrushFunc:tn.createElementsFunc})}),(0,o.jsx)("div",{className:A().pblock,children:(0,o.jsx)("div",{className:A().progress,children:(0,o.jsx)(b.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(M.Z,{disLoc:"right",children:[(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:Dn}),(0,o.jsx)(c.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:bn}),(0,o.jsx)(c.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:An}),(0,o.jsx)(c.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:Ln}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/data_division.png",children:xn}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/export.png",children:yn})]}),(0,o.jsxs)("div",{className:A().rightSideBar,children:[(0,o.jsx)("div",{className:A().determinOutline,children:(0,o.jsx)(y.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){p(void 0)},children:Sn})}),(0,o.jsx)(s.Z,{selectedLabel:N,onLabelSelect:function(r){G(r),p(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(u.Z,{selectedAnnotation:W,annotations:x,onAnnotationSelect:function(r){r!=null&&r.delete||p(r)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(r){Z(x.filter(function(P){return P.annotationId!=r.annotationId})),p(void 0)}})]})]})};S.default=B}}]);
