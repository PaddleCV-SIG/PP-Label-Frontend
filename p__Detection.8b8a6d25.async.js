(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(M,E,n){"use strict";n.d(E,{Z:function(){return _}});var m=n(94663),L=n(80112);function X(i){return Function.toString.call(i).indexOf("[native code]")!==-1}var q=n(18597);function T(i,d,K){return(0,q.Z)()?T=Reflect.construct:T=function(V,R,p){var f=[null];f.push.apply(f,R);var u=Function.bind.apply(V,f),I=new u;return p&&(0,L.Z)(I,p.prototype),I},T.apply(null,arguments)}function _(i){var d=typeof Map=="function"?new Map:void 0;return _=function(s){if(s===null||!X(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof d!="undefined"){if(d.has(s))return d.get(s);d.set(s,V)}function V(){return T(s,arguments,(0,m.Z)(this).constructor)}return V.prototype=Object.create(s.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),(0,L.Z)(V,s)},_(i)}},85024:function(M){M.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(M){M.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},6277:function(M){M.exports={modal:"modal___26yNn"}},45092:function(M){M.exports={modal:"modal___1H_FQ"}},72285:function(M){M.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},14836:function(M,E,n){"use strict";n.d(E,{Z:function(){return dn}});var m=n(54421),L=n(38272),X=n(57663),q=n(71577),T=n(67294),_=n(56159),i=n.n(_),d=n(49111),K=n(19650),s=n(2824),V=n(11849),R=n(85024),p=n.n(R),f=n(63097),u=n(85893),I=function(o){var B=(0,V.Z)({},o.annotation),tn=(0,T.useState)(B.invisible),C=(0,s.Z)(tn,2),z=C[0],H=C[1],an=(0,T.useState)(0),S=(0,s.Z)(an,2),P=S[0],rn=S[1];(0,T.useEffect)(function(){H(o.annotation.invisible)},[o.annotation.invisible]);var W=(0,u.jsxs)(L.ZP.Item,{className:"".concat(p().listItem," ").concat(o.active?p().listItemActive:""),unselectable:"on",onClick:function(){o.onClick(B)},children:[(0,u.jsxs)(K.Z,{align:"center",size:5,children:[(0,u.jsx)("a",{className:p().eye,style:{backgroundImage:z?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(G){G.stopPropagation(),H(!z),o.onAnnotationModify(B)}})," ",(0,u.jsx)("span",{className:p().annotationId,children:B.frontendId}),(0,u.jsx)("span",{className:p().labelName,children:B.label.name}),(0,u.jsx)(f.Z,{color:B.label.color})]}),(0,u.jsx)("a",{className:p().delete,onClick:function(G){G.stopPropagation();var e=new Date().getTime();e-P<300||(rn(e),o.onAnnotationDelete(B))}})]});return W},Q=I,D=n(48971),t=function(o){var B=(0,D.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),tn=(0,D.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(L.ZP,{className:i().labelList,size:"large",header:(0,u.jsx)("div",{className:i().listHeader,children:B}),bordered:!0,dataSource:o.annotations,renderItem:function(z){var H;return(0,u.jsx)(Q,{onClick:o.onAnnotationSelect,annotation:z,active:z.frontendId==((H=o.currAnnotation)===null||H===void 0?void 0:H.frontendId),onAnnotationDelete:o.onAnnotationDelete,onAnnotationModify:o.onAnnotationModify})},footer:(0,u.jsx)("div",{children:(0,u.jsx)(q.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){o.onAnnotationAdd()},block:!0,children:tn})})})})},dn=t},85871:function(M,E,n){"use strict";var m=n(71194),L=n(50146),X=n(49111),q=n(19650),T=n(57663),_=n(71577),i=n(13062),d=n(71230),K=n(89032),s=n(15746),V=n(77883),R=n(70507),p=n(34792),f=n(48086),u=n(9715),I=n(93766),Q=n(2824),D=n(67294),t=n(48971),dn=n(6277),J=n.n(dn),o=n(85893),B=function(C){var z=(0,t.YB)(),H=(0,D.useState)(60),an=(0,Q.Z)(H,2),S=an[0],P=an[1],rn=(0,D.useState)(20),W=(0,Q.Z)(rn,2),$=W[0],G=W[1],e=(0,D.useState)(20),c=(0,Q.Z)(e,2),U=c[0],g=c[1],v=(0,D.useState)(!1),b=(0,Q.Z)(v,2),h=b[0],j=b[1],r=(0,t.YB)().formatMessage({id:"pages.toolBar.divideData"}),y=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.train"}),O=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.validation"}),Z=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.test"}),N=(0,t.YB)().formatMessage({id:"component.PPCreater.cancel"}),sn=(0,t.YB)().formatMessage({id:"component.PPSegMode.ok"}),cn=I.Z.useForm(),k=(0,Q.Z)(cn,1),w=k[0];return(0,o.jsx)(L.Z,{className:J().modal,title:r,visible:C.visible,onCancel:C.onCancel,footer:null,children:(0,o.jsxs)(I.Z,{form:w,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(){if(S+$+U!=100){f.default.error("Train, Validation and Test total percent should equal 100!");return}console.log("x trainData: ".concat(S,", validationData: ").concat($,", testData: ").concat(U,", props.project.curr.projectId: ").concat(C.project.curr.projectId)),j(!0),C.splitDataset(C.project.curr.projectId,{train:S*.01,validation:$*.01,test:U*.01}).then(function(){var F;console.log("success"),f.default.success(z.formatMessage({id:"component.PPDivideDataModal.success"})),(F=C.onFinish)===null||F===void 0||F.call(0)}).finally(function(){j(!1)})},autoComplete:"off",layout:"vertical",children:[(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(s.Z,{span:8,children:(0,o.jsx)(I.Z.Item,{label:y,name:"train",children:(0,o.jsx)(R.Z,{addonAfter:"%",defaultValue:60,precision:0,min:0,max:100,value:S,onChange:P})})}),(0,o.jsx)(s.Z,{span:8,children:(0,o.jsx)(I.Z.Item,{label:O,name:"validation",children:(0,o.jsx)(R.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:$,onChange:G})})}),(0,o.jsx)(s.Z,{span:8,children:(0,o.jsx)(I.Z.Item,{label:Z,name:"test",children:(0,o.jsx)(R.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:U,onChange:g})})})]}),(0,o.jsx)(I.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,o.jsxs)(q.Z,{children:[(0,o.jsx)(_.Z,{onClick:function(){var F;(F=C.onCancel)===null||F===void 0||F.call(0),w.resetFields()},children:N}),(0,o.jsx)(_.Z,{type:"primary",htmlType:"submit",loading:h,children:sn})]})})]})})};E.Z=B},62850:function(M,E,n){"use strict";var m=n(71194),L=n(50146),X=n(49111),q=n(19650),T=n(57663),_=n(71577),i=n(47673),d=n(24044),K=n(34792),s=n(48086),V=n(9715),R=n(93766),p=n(2824),f=n(67294),u=n(48971),I=n(45092),Q=n.n(I),D=n(85893),t=function(J){var o=(0,u.YB)(),B=(0,f.useState)(!1),tn=(0,p.Z)(B,2),C=tn[0],z=tn[1],H=(0,u.YB)().formatMessage({id:"component.PPCreater.cancel"}),an=R.Z.useForm(),S=(0,p.Z)(an,1),P=S[0];return(0,D.jsx)(L.Z,{className:Q().modal,title:(0,u.YB)().formatMessage({id:"component.PPExportModal.title"}),visible:J.visible,onCancel:J.onCancel,footer:null,children:(0,D.jsxs)(R.Z,{form:P,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(W){console.log(W);var $=W.path;if(!$){s.default.error(o.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}z(!0),J.exportDataset(J.project.curr.projectId,$).then(function(){var G;s.default.success(o.formatMessage({id:"component.PPExportModal.exportSuccess"})),(G=J.onFinish)===null||G===void 0||G.call(0)}).finally(function(){z(!1)})},autoComplete:"off",children:[(0,D.jsx)(R.Z.Item,{label:o.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,D.jsx)(d.Z,{})}),(0,D.jsx)(R.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,D.jsxs)(q.Z,{children:[(0,D.jsx)(_.Z,{onClick:function(){var W;(W=J.onCancel)===null||W===void 0||W.call(0),P.resetFields()},children:H}),(0,D.jsx)(_.Z,{type:"primary",htmlType:"submit",loading:C,children:o.formatMessage({id:"component.PPExportModal.export"})})]})})]})})};E.Z=t},91861:function(M,E,n){"use strict";n.d(E,{Ad:function(){return L},k3:function(){return X},Vd:function(){return q},td:function(){return T}});var m=40;function L(){localStorage.removeItem("history"),X([])}function X(_){var i=localStorage.getItem("history"),d=i?JSON.parse(i):{index:-1,items:[]};if(JSON.stringify(d.items[d.index])!=JSON.stringify(_)){var K=d.index>m?d.index-m:0,s=d.items.splice(K,d.index==0?1:d.index+1);d.items=s.concat([_]),d.index<=m?d.index++:d.index=m+1,localStorage.setItem("history",JSON.stringify(d))}}function q(){var _=localStorage.getItem("history");if(!!_){var i=JSON.parse(_);if(!!i&&!(i.index>=i.items.length-1))return i.index++,localStorage.setItem("history",JSON.stringify(i)),i.items[i.index]}}function T(){var _=localStorage.getItem("history");if(!!_){var i=JSON.parse(_);if(!(!i||!i.index)&&!(i.index<=0))return i.index--,localStorage.setItem("history",JSON.stringify(i)),i.items[i.index]}}},80212:function(M,E,n){"use strict";n.r(E),n.d(E,{default:function(){return G}});var m=n(11849),L=n(20228),X=n(11382),q=n(34669),T=n(54458),_=n(34792),i=n(48086),d=n(91220),K=n(2824),s=n(67294),V=n(72285),R=n.n(V),p=n(8088),f=n(61541),u=n(44434),I=n(5041),Q=n(57436),D=n(14836),t=n(85893),dn=function(c){return(0,t.jsx)(f.Z,{active:c.active,imgSrc:c.imgSrc||"./pics/buttons/rectangle.png",onClick:c.onClick,children:c.children})},J=dn,o=n(65031);function B(e){var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}function tn(e){if(!(!e||e.length<2))return{xmin:e[0],ymin:e[1],xmax:e[2]||void 0,ymax:e[3]||void 0}}function C(e,c,U,g,v,b,h,j){if(!e||!e.points||!e.label||!e.label.color)return[(0,t.jsx)(t.Fragment,{})];var r=e.points,y=e.label.color,O=B(y);if(!O)return[(0,t.jsx)(t.Fragment,{})];var Z=(j==null?void 0:j.frontendId)==e.frontendId,N=Z?.5:.1,sn=r.xmax!=null&&r.ymax!=null?(0,t.jsx)(o.UL,{onMouseOver:function(){v=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){v=="editor"&&b(e)},stroke:y,strokeWidth:2/g,globalCompositeOperation:"source-over",lineCap:"round",x:r.xmin,y:r.ymin,width:r.xmax-r.xmin,height:r.ymax-r.ymin,closed:!0,fill:"rgba(".concat(O.r,", ").concat(O.g,", ").concat(O.b,", ").concat(N,")")}):(0,t.jsx)(t.Fragment,{});function cn(k){if(!k&&(r.xmax==null||r.ymax==null))return(0,t.jsx)(t.Fragment,{});var w=function(F){if(v=="editor"){var vn=h==null?void 0:h.current,A=vn.findOne(".baseImage"),Y=!1,en=F.target.x();en>A.width()/2&&(en=A.width()/2,Y=!0),en<-A.width()/2&&(en=-A.width()/2,Y=!0);var nn=F.target.y();nn>A.height()/2&&(nn=A.height()/2,Y=!0),nn<-A.height()/2&&(nn=-A.height()/2,Y=!0),Y&&F.target.setPosition({x:en,y:nn}),k?(r.xmin=en,r.ymin=nn):(r.xmax=en,r.ymax=nn);var mn=(0,m.Z)((0,m.Z)({},e),{},{points:r});c(mn)}};return(0,t.jsx)(o.Cd,{onMouseDown:function(){v=="editor"&&b(e)},draggable:v=="editor",onDragMove:w,onDragEnd:w,onMouseOver:function(){v=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},x:k?r.xmin:r.xmax,y:k?r.ymin:r.ymax,radius:5/g,fill:y})}return[(0,t.jsxs)(o.ZA,{children:[sn,cn(!0),cn(!1)]},e.annotationId)]}function z(e){var c=1;if(!e||e.length==0)return c;var U=(0,d.Z)(e),g;try{for(U.s();!(g=U.n()).done;){var v=g.value;v.frontendId&&c<=v.frontendId&&(c=v.frontendId+1)}}catch(b){U.e(b)}finally{U.f()}return c}function H(e){var c=function(h,j,r,y){var O=(h.evt.offsetX+j)/y,Z=(h.evt.offsetY+r)/y,N=tn([O,Z]);!N||e.onAnnotationAdd({frontendId:z(e.annotations),type:"rectangle",label:e.currentLabel,points:N})},U=function(h,j,r,y){if(!(!e.currentAnnotation||!e.currentAnnotation.points)){var O=(h.evt.offsetX+j)/y,Z=(h.evt.offsetY+r)/y,N=e.currentAnnotation.points;if(!!N){N.xmax=O,N.ymax=Z;var sn={type:"rectangle",frontendId:e.currentAnnotation.frontendId,label:e.currentAnnotation.label,points:N};e.onAnnotationModify(sn)}}},g=function(h,j,r,y){e.currentTool=="rectangle"&&(e.currentAnnotation?U(h,j,r,y):c(h,j,r,y))},v=function(){e.currentTool=="rectangle"&&e.onMouseUp()};return{onMouseDown:g,onMouseMove:function(){},onMouseUp:v,createElementsFunc:C}}var an=n(64322),S=n(91861),P=n(48971),rn=n(85871),W=n(62850),$=function(){var c,U=(0,an.$L)(s.useState,s.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:S.Ad}}),g=(0,K.Z)(U,10),v=g[0],b=g[1],h=g[2],j=g[3],r=g[4],y=g[5],O=g[6],Z=g[7],N=g[8],sn=g[9],cn=(0,s.useState)(),k=(0,K.Z)(cn,2),w=k[0],x=k[1],F=(0,s.useState)([]),vn=(0,K.Z)(F,2),A=vn[0],Y=vn[1],en=(0,s.useState)(!1),nn=(0,K.Z)(en,2),mn=nn[0],_n=nn[1],hn=(0,s.useState)(!1),xn=(0,K.Z)(hn,2),An=xn[0],gn=xn[1],yn=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));A.push(a),Y(A),x(a)},En=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));var ln=[],on=(0,d.Z)(A),un;try{for(on.s();!(un=on.n()).done;){var fn=un.value;fn.frontendId==a.frontendId?ln.push(a):ln.push(fn)}}catch(Pn){on.e(Pn)}finally{on.f()}console.log("modifyAnnotation, newAnnos:",ln,"anno:",a),Y(ln),x(a)},Cn=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));var ln=[],on=(0,d.Z)(A),un;try{for(on.s();!(un=on.n()).done;){var fn=un.value;fn.frontendId!=a.frontendId&&ln.push(fn)}}catch(Pn){on.e(Pn)}finally{on.f()}Y(ln),x(void 0)},Kn=function(a){!a||(console.log("modifyAnnotation",a,"anno.label:",a==null?void 0:a.label),a.taskId=r.curr.taskId,a.dataId=y.curr.dataId,j.modify(a))},Dn=H({currentLabel:Z.curr,currentTool:v.curr,annotations:A,currentAnnotation:w,onAnnotationAdd:yn,onAnnotationModify:En,onMouseUp:function(){(0,S.k3)({annos:A,currAnno:w})}}),Mn=Dn,On=(0,P.YB)().formatMessage({id:"pages.toolBar.rectangle"}),pn=(0,P.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),In=(0,P.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),Bn=(0,P.YB)().formatMessage({id:"pages.toolBar.move"}),Sn=(0,P.YB)().formatMessage({id:"pages.toolBar.unDo"}),jn=(0,P.YB)().formatMessage({id:"pages.toolBar.reDo"}),Zn=(0,P.YB)().formatMessage({id:"pages.toolBar.save"}),Ln=(0,P.YB)().formatMessage({id:"pages.toolBar.edit"}),Tn=(0,P.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Rn=(0,P.YB)().formatMessage({id:"pages.toolBar.undef"}),Un=(0,P.YB)().formatMessage({id:"pages.toolBar.divideData"}),bn=(0,P.YB)().formatMessage({id:"pages.toolBar.export"});return(0,t.jsxs)(p.Z,{className:R().det,children:[(0,t.jsxs)(u.Z,{children:[(0,t.jsx)(J,{active:v.curr=="rectangle",onClick:function(){if(!Z.curr){i.default.error("Please choose a label category first!");return}v.setCurr("rectangle"),x(void 0)},children:On}),(0,t.jsx)(f.Z,{active:v.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){v.setCurr("editor")},children:Ln}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){h.change(.1)},children:pn}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){h.change(-.1)},children:In}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){i.default.info("Annotations are saved automatically. You don't need to click save.")},children:Zn}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/move.png",active:v.curr=="mover",onClick:function(){v.setCurr("mover")},children:Bn}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var a=(0,S.td)();!a||(x(a.currAnno),Y(a.annos))},children:Sn}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var a=(0,S.Vd)();!a||(x(a.currAnno),Y(a.annos))},children:jn}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:Tn})]}),(0,t.jsx)("div",{id:"dr",className:"mainStage",children:(0,t.jsxs)(X.Z,{tip:"loading",spinning:!!b.curr,children:[(0,t.jsx)("div",{className:"draw",children:(0,t.jsx)(Q.Z,{scale:h.curr,annotations:A,currentTool:v.curr,currentAnnotation:w,setCurrentAnnotation:x,onAnnotationModify:En,onAnnotationModifyComplete:function(){(0,S.k3)({annos:A,currAnno:w})},onMouseDown:Mn.onMouseDown,onMouseMove:Mn.onMouseMove,onMouseUp:Mn.onMouseUp,createRectangleFunc:Dn.createElementsFunc,imgSrc:y.imgSrc})}),(0,t.jsx)("div",{className:"pblock",children:(0,t.jsxs)("div",{className:"progress",children:[(0,t.jsx)(T.Z,{className:"progressBar",percent:O.progress,status:"active",showInfo:!1})," ",(0,t.jsxs)("span",{className:"progressDesc",children:["Current labeling ",r.currIdx==null?1:r.currIdx+1," of"," ",(c=r.all)===null||c===void 0?void 0:c.length,". Already labeled ",r.finished(O.progress)||0,"."]})]})}),(0,t.jsx)("div",{className:"prevTask",onClick:function(){!r.prevTask()||(x(void 0),Y([]))}}),(0,t.jsx)("div",{className:"nextTask",onClick:function(){!r.nextTask()||(x(void 0),Y([]))}})]})}),(0,t.jsxs)(u.Z,{disLoc:"right",children:[(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){_n(!0)},children:Un}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){gn(!0)},children:bn}),(0,t.jsx)(f.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){x(void 0)},children:Rn})]}),(0,t.jsxs)("div",{className:"rightSideBar",children:[(0,t.jsx)(I.Z,{labels:Z.all,activeIds:Z.activeIds,onLabelSelect:function(a){Z.onSelect(a),x(void 0)},onLabelModify:function(){},onLabelDelete:Z.remove,onLabelAdd:function(a){return Z.create((0,m.Z)((0,m.Z)({},a),{},{projectId:O.curr.projectId}))}}),(0,t.jsx)(D.Z,{annotations:A,currAnnotation:w,onAnnotationSelect:x,onAnnotationAdd:function(){x(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(a){Cn(a)}})]}),(0,t.jsx)(rn.Z,{visible:mn,splitDataset:N,project:O,onCancel:function(){_n(!1)},onFinish:function(){_n(!1)}}),(0,t.jsx)(W.Z,{visible:An,exportDataset:sn,project:O,onCancel:function(){gn(!1)},onFinish:function(){gn(!1)}})]})},G=$},15746:function(M,E,n){"use strict";var m=n(21584);E.Z=m.Z},89032:function(M,E,n){"use strict";var m=n(38663),L=n.n(m),X=n(6999)},71230:function(M,E,n){"use strict";var m=n(92820);E.Z=m.Z},13062:function(M,E,n){"use strict";var m=n(38663),L=n.n(m),X=n(6999)}}]);
