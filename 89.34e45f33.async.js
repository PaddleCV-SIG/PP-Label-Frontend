(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[89],{57560:function(T){T.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(T){T.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},54777:function(T){T.exports={segment:"segment___1YMcl",mainStage:"mainStage___2otee",draw:"draw___equn4",pblock:"pblock___2bT7z",progress:"progress___1porz",rightSideBar:"rightSideBar___2X7jK",determinOutline:"determinOutline___2ls57"}},43801:function(T,S,n){"use strict";n.d(S,{Z:function(){return M}});var Z=n(11849),y=n(2824),I=n(91220),b=n(67294),L=n(65031),E=n(85893);function R(e,d,s,g){if(!(!e||!d||!s||!g))return{width:e,color:d,points:s,tool:g}}function A(e,d,s,g,l,h,c){if(!e||!e.lines)return(0,E.jsx)(E.Fragment,{});var i=(c==null?void 0:c.annotationId)==e.annotationId,o=i&&l=="mover",f=[],m=(0,I.Z)(e.lines),C;try{for(m.s();!(C=m.n()).done;){var u=C.value;!u.width||!u.color||!u.points||!u.tool||f.push((0,E.jsx)(L.x1,{stroke:u.color,strokeWidth:u.width,globalCompositeOperation:u.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:u.points,tension:.01,onDragMove:function(){},onDragEnd:function(){s()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:o?1:0}))}}catch(D){m.e(D)}finally{m.f()}return(0,E.jsx)(L.ZA,{draggable:o,children:f})}function W(e,d){return e=="rubber"||d==2?"rubber":"brush"}function t(e){var d=0,s=(0,I.Z)(e),g;try{for(s.s();!(g=s.n()).done;){var l=g.value;!l||l.annotationId>d&&(d=l.annotationId)}}catch(h){s.e(h)}finally{s.f()}return d}function M(e){var d=(0,b.useState)(),s=(0,y.Z)(d,2),g=s[0],l=s[1],h=function(f,m){var C;if(!(e.currentTool!="brush"&&e.currentTool!="rubber")){var u=f.evt.offsetX/m,D=f.evt.offsetY/m,_=W(e.currentTool,f.evt.button),r=R(e.brushSize||10,(C=e.currentLabel)===null||C===void 0?void 0:C.color,[u,D,u,D],_);if(!!r)if(l(_),e.currentAnnotation){var B,p={tool:"brush",annotationId:e.currentAnnotation.annotationId,label:e.currentAnnotation.label,lines:(B=e.currentAnnotation.lines)===null||B===void 0?void 0:B.concat([r])};e.onAnnotationModify(p)}else{if(_=="rubber")return;e.onAnnotationAdd({tool:"brush",annotationId:t(e.annotations)+1,label:e.currentLabel,lines:[r]})}}},c=function(f,m){var C;if(!(!g||!e.currentAnnotation)){var u=f.evt.offsetX/m,D=f.evt.offsetY/m,_=[u,D],r=[];(C=e.currentAnnotation)!==null&&C!==void 0&&C.lines&&(_=e.currentAnnotation.lines[e.currentAnnotation.lines.length-1].points.concat(_),r=e.currentAnnotation.lines);var B=R(e.brushSize||10,e.currentLabel.color,_,g);!B||(r.pop(),r.push(B),e.onAnnotationModify((0,Z.Z)((0,Z.Z)({},e.currentAnnotation),{},{lines:r})))}},i=function(){e.currentTool!="brush"&&e.currentTool!="rubber"||(l(void 0),e.onMouseUp())};return{onMouseDown:h,onMouseMove:c,onMouseUp:i,createElementsFunc:A}}},58967:function(T,S,n){"use strict";var Z=n(20136),y=n(55241),I=n(77883),b=n(70507),L=n(57663),E=n(71577),R=n(2824),A=n(67294),W=n(61541),t=n(57560),M=n.n(t),e=n(85893),d=1,s=50,g=10;function l(c){return c?c<=d?d:c>=s?s:c:g}var h=function(i){var o=(0,A.useState)(l(i.size)),f=(0,R.Z)(o,2),m=f[0],C=f[1],u=function(_){C(l(_))};return(0,A.useEffect)(function(){u(i.size)},[i.size]),(0,e.jsxs)(y.Z,{overlayClassName:M().popover,placement:"right",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(E.Z,{type:"text",onClick:function(){var _,r=l(m-1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"-"}),(0,e.jsx)(b.Z,{min:d,max:s,value:m,onChange:function(_){var r;(r=i.onChange)===null||r===void 0||r.call(0,_)},controls:!1,style:{textAlign:"center"}}),(0,e.jsx)(E.Z,{type:"text",onClick:function(){var _,r=l(m+1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"+"})]}),trigger:i.active?"hover":"click",children:[" ",(0,e.jsx)(W.Z,{active:i.active,imgSrc:i.imgSrc||"./pics/buttons/brush.png",onClick:i.onClick,children:i.children||"Brush"})]})};S.Z=h},27992:function(T,S,n){"use strict";var Z=n(20136),y=n(55241),I=n(77883),b=n(70507),L=n(57663),E=n(71577),R=n(2824),A=n(67294),W=n(61541),t=n(26647),M=n.n(t),e=n(85893),d=1,s=100,g=10;function l(c){return c?c<=d?d:c>=s?s:c:g}var h=function(i){var o=(0,A.useState)(l(i.size)),f=(0,R.Z)(o,2),m=f[0],C=f[1],u=function(_){C(l(_))};return(0,A.useEffect)(function(){u(i.size)},[i.size]),(0,e.jsxs)(y.Z,{overlayClassName:"".concat(M().popover," ").concat(i.disLoc=="left"?M().popoverLeft:""),placement:i.disLoc||"right",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(E.Z,{type:"text",onClick:function(){var _,r=l(m-1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"-"}),(0,e.jsx)(b.Z,{min:d,max:s,value:m,onChange:function(_){var r;(r=i.onChange)===null||r===void 0||r.call(0,_)},controls:!1,style:{textAlign:"center"}}),(0,e.jsx)(E.Z,{type:"text",onClick:function(){var _,r=l(m+1);u(r),(_=i.onChange)===null||_===void 0||_.call(0,r)},children:"+"})]}),trigger:"hover",children:[" ",(0,e.jsx)(W.Z,{imgSrc:i.imgSrc,onClick:i.onClick,children:i.children})]})};S.Z=h},13931:function(T,S,n){"use strict";n.d(S,{Z:function(){return W}});var Z=n(91220),y=n(11849),I=n(65031),b=n(85893);function L(t){var M=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return M?{r:parseInt(M[1],16),g:parseInt(M[2],16),b:parseInt(M[3],16)}:null}function E(t,M){if(!(!t||!M))return{color:t,points:M}}function R(t,M,e,d,s,g,l){if(!t||!t.lines||!t.lines[0])return[(0,b.jsx)(b.Fragment,{})];var h=t.lines[0].points,c=t.lines[0].color,i=L(c);if(!i)return[(0,b.jsx)(b.Fragment,{})];var o=(l==null?void 0:l.annotationId)==t.annotationId,f=o?.5:.1,m=void 0,C=[];return h.forEach(function(u,D){if(!m){m=u;return}C.push((0,b.jsx)(I.Cd,{onMouseDown:function(){s=="mover"&&g(t)},draggable:s=="mover",onDragMove:function(r){console.log("Circle onDrageMove");var B=r.evt.offsetX/d,p=r.evt.offsetY/d;h[D-1]=B,h[D]=p;var z=(0,y.Z)((0,y.Z)({},t),{},{lines:[{color:c,points:h}]});M(z)},onMouseOver:function(){console.log("Circle onMouseOver"),s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:m,y:u,radius:5,fill:c})),m=void 0}),[(0,b.jsxs)(I.ZA,{children:[(0,b.jsx)(I.x1,{onMouseOver:function(){s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){s=="mover"&&g(t)},stroke:c,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:h,tension:0,closed:!0,fill:"rgba(".concat(i.r,", ").concat(i.g,", ").concat(i.b,", ").concat(f,")")}),C]},t.annotationId)]}function A(t){var M=0,e=(0,Z.Z)(t),d;try{for(e.s();!(d=e.n()).done;){var s=d.value;!s||s.annotationId>M&&(M=s.annotationId)}}catch(g){e.e(g)}finally{e.f()}return M}function W(t){var M=function(l,h){var c,i=l.evt.offsetX/h,o=l.evt.offsetY/h,f=E((c=t.currentLabel)===null||c===void 0?void 0:c.color,[i,o]);!f||t.onAnnotationAdd({tool:"polygon",annotationId:A(t.annotations)+1,label:t.currentLabel,lines:[f]})},e=function(l,h){var c,i;if(!!t.currentAnnotation){var o=l.evt.offsetX/h,f=l.evt.offsetY/h,m=t.currentAnnotation.lines||[],C=E((c=t.currentLabel)===null||c===void 0?void 0:c.color,(i=m[0])===null||i===void 0?void 0:i.points.concat([o,f]));if(!!C){var u={tool:"polygon",annotationId:t.currentAnnotation.annotationId,label:t.currentAnnotation.label,lines:[C]};t.onAnnotationModify(u)}}},d=function(l,h){t.currentTool=="polygon"&&(t.currentAnnotation?e(l,h):M(l,h))},s=function(){t.currentTool=="polygon"&&t.onMouseUp()};return{onMouseDown:d,onMouseMove:function(){},onMouseUp:s,createElementsFunc:R}}},29919:function(T,S,n){"use strict";var Z=n(67294),y=n(61541),I=n(85893),b=function(E){return(0,I.jsx)(y.Z,{active:E.active,imgSrc:E.imgSrc||"./pics/buttons/polygon.png",onClick:E.onClick,children:E.children})};S.Z=b},86089:function(T,S,n){"use strict";n.r(S),n.d(S,{MOST_HISTORY_STEPS:function(){return f}});var Z=n(57663),y=n(71577),I=n(34669),b=n(54458),L=n(2824),E=n(67294),R=n(54777),A=n.n(R),W=n(8088),t=n(61541),M=n(44434),e=n(58967),d=n(27992),s=n(5041),g=n(57436),l=n(14836),h=n(29919),c=n(43801),i=n(13931),o=n(85893),f=40,m=function(){var u,D=(0,E.useState)(void 0),_=(0,L.Z)(D,2),r=_[0],B=_[1],p=(0,E.useState)({color:"",name:""}),z=(0,L.Z)(p,2),X=z[0],w=z[1],an=(0,E.useState)(),V=(0,L.Z)(an,2),j=V[0],Y=V[1],_n=(0,E.useState)([]),G=(0,L.Z)(_n,2),x=G[0],K=G[1],sn=(0,E.useState)(10),Q=(0,L.Z)(sn,2),F=Q[0],q=Q[1],ln=(0,E.useState)(1),nn=(0,L.Z)(ln,2),$=nn[0],k=nn[1],en=function(a){a||k(1),a<.1||a>3?k(1):k(a)},U=function(a){Y(a),a!=null&&a.label&&w(a.label)};(0,E.useEffect)(function(){localStorage.removeItem("history"),N([])},[]);function N(v,a){var P=localStorage.getItem("history"),O=P?JSON.parse(P):{index:-1,items:[]},rn={currentAnnotation:a,annotations:v};if(JSON.stringify(O.items[O.index])!=JSON.stringify(rn)){var dn=O.index>f?O.index-f:0,vn=O.items.splice(dn,O.index==0?1:O.index+1);O.items=vn.concat([rn]),O.index<=f?O.index++:O.index=f+1,localStorage.setItem("history",JSON.stringify(O))}}var un=function(){var a=localStorage.getItem("history");if(!!a){var P=JSON.parse(a);if(!!P&&!(P.index>=P.items.length-1)){P.index++,localStorage.setItem("history",JSON.stringify(P));var O=P.items[P.index];Y(O.currentAnnotation),K(O.annotations)}}},cn=function(){var a=localStorage.getItem("history");if(!!a){var P=JSON.parse(a);if(!(!P||!P.index)&&!(P.index<=0)){P.index--,localStorage.setItem("history",JSON.stringify(P));var O=P.items[P.index];Y(O.currentAnnotation),K(O.annotations)}}},H=function(a){for(var P=[],O=0;O<x.length;O++)x[O].annotationId==a.annotationId?P.push(a):P.push(x[O]);U(a),K(P)},tn=(0,c.Z)({currentLabel:X,brushSize:F,currentTool:r,annotations:x,currentAnnotation:j,onAnnotationAdd:function(a){var P=x.concat([a]);K(P),j||U(a)},onAnnotationModify:H,onMouseUp:function(){N(x,j)}}),on=(0,i.Z)({currentLabel:X,brushSize:F,currentTool:r,annotations:x,currentAnnotation:j,onAnnotationAdd:function(a){var P=x.concat([a]);K(P),j||U(a)},onAnnotationModify:H,onMouseUp:function(){N(x,j)}}),J=r=="polygon"?on:tn;return(0,o.jsxs)(W.Z,{className:A().segment,children:[(0,o.jsxs)(M.Z,{children:[(0,o.jsx)(h.Z,{active:r=="polygon",onClick:function(){B("polygon"),U(void 0)},children:"Polygon"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,o.jsx)(e.Z,{size:F,active:r=="brush",onClick:function(){r!="rubber"&&r!="brush"&&U(void 0),B("brush")},onChange:function(a){q(a)},children:"Brush"}),(0,o.jsx)(e.Z,{size:F,active:r=="rubber",onClick:function(){r!="rubber"&&r!="brush"&&U(void 0),B("rubber")},onChange:function(a){q(a)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){en($+.1)},children:"Zoom in"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){en($-.1)},children:"Zoom out"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){B("mover")},children:"Move"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){cn()},children:"Undo"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){un()},children:"Redo"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{id:"dr",className:A().mainStage,children:[(0,o.jsx)("div",{className:A().draw,children:(0,o.jsx)(g.Z,{width:(u=document.getElementById("dr"))===null||u===void 0?void 0:u.clientWidth,scale:$,annotations:x,currentTool:r,currentAnnotation:j,setCurrentAnnotation:U,onAnnotationModify:H,onAnnotationModifyComplete:function(){N(x,j)},onMouseDown:J.onMouseDown,onMouseMove:J.onMouseMove,onMouseUp:J.onMouseUp,createPolygonFunc:on.createElementsFunc,createBrushFunc:tn.createElementsFunc})}),(0,o.jsx)("div",{className:A().pblock,children:(0,o.jsx)("div",{className:A().progress,children:(0,o.jsx)(b.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(M.Z,{disLoc:"right",children:[(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Interactor"}),(0,o.jsx)(d.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,o.jsx)(d.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,o.jsx)(d.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(t.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"})]}),(0,o.jsxs)("div",{className:A().rightSideBar,children:[(0,o.jsx)("div",{className:A().determinOutline,children:(0,o.jsx)(y.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){U(void 0)},children:"Determine Outline"})}),(0,o.jsx)(s.Z,{selectedLabel:X,onLabelSelect:function(a){w(a),U(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(l.Z,{selectedAnnotation:j,annotations:x,onAnnotationSelect:function(a){a!=null&&a.delete||U(a)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(a){K(x.filter(function(P){return P.annotationId!=a.annotationId})),U(void 0)}})]})]})};S.default=m}}]);
