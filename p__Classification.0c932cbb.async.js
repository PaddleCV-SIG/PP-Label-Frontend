(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(i,M,e){"use strict";e.d(M,{Z:function(){return s}});var F=e(94663),P=e(80112);function g(m){return Function.toString.call(m).indexOf("[native code]")!==-1}var f=e(18597);function r(m,v,L){return(0,f.Z)()?r=Reflect.construct:r=function(E,Z,n){var _=[null];_.push.apply(_,Z);var t=Function.bind.apply(E,_),u=new t;return n&&(0,P.Z)(u,n.prototype),u},r.apply(null,arguments)}function s(m){var v=typeof Map=="function"?new Map:void 0;return s=function(C){if(C===null||!g(C))return C;if(typeof C!="function")throw new TypeError("Super expression must either be null or a function");if(typeof v!="undefined"){if(v.has(C))return v.get(C);v.set(C,E)}function E(){return r(C,arguments,(0,F.Z)(this).constructor)}return E.prototype=Object.create(C.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),(0,P.Z)(E,C)},s(m)}},52822:function(i){i.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(i){i.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(i){i.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(i){i.exports={container:"container___G0FNe"}},83930:function(i){i.exports={stage:"stage___3H5QL"}},80961:function(i){i.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(i){i.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(i){i.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(i,M,e){"use strict";var F=e(20136),P=e(55241),g=e(2824),f=e(67294),r=e(52822),s=e.n(r),m=e(63144),v=e(85893),L=function(E){var Z=(0,f.useState)(E.color||"#FFF"),n=(0,g.Z)(Z,2),_=n[0],t=n[1];return(0,f.useEffect)(function(){t(E.color||"#FFF")},[E]),E.changeable?(0,v.jsx)(P.Z,{getPopupContainer:function(y){return y.parentElement||document.body},overlayClassName:s().popover,openClassName:s().popoverOpenClassName,placement:"bottom",content:(0,v.jsx)(m.xS,{disableAlpha:!0,color:_,onChange:function(y){t(y.hex)},onChangeComplete:E.onChange}),trigger:"click",children:(0,v.jsx)("div",{className:s().roundBall,style:{backgroundColor:_}})}):(0,v.jsx)("div",{className:s().roundBall,style:{backgroundColor:_}})};M.Z=L},5041:function(i,M,e){"use strict";e.d(M,{Z:function(){return U}});var F=e(54421),P=e(38272),g=e(57663),f=e(71577),r=e(2824),s=e(67294),m=e(56131),v=e.n(m),L=e(49111),C=e(19650),E=e(11849),Z=e(5882),n=e.n(Z),_=e(63097),t=e(85893),u=function(o){var d=(0,E.Z)({},o.label),I=(0,s.useState)(d.invisible),D=(0,r.Z)(I,2),B=D[0],O=D[1],A=(0,t.jsx)(P.ZP.Item,{className:"".concat(n().listItem," ").concat(d.active?n().listItemActive:""),unselectable:"on",onClick:function(){o.onClick(d)},children:(0,t.jsxs)(C.Z,{align:"center",size:5,children:[(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:B?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){O(!B),o.onLabelModify(d)}})," ",d.name,(0,t.jsx)(_.Z,{color:d.color,changeable:!0,onChange:function(b){d.color=b.hex,o.onLabelModify(d)}}),(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){o.onLabelDelete(d)}})]})});return A},y=u,S=e(71194),N=e(50146),$=e(47673),z=e(24044),V=e(9715),h=e(93766),l=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],X=function(o){var d,I,D=(0,s.useState)(((d=o.defaultLabel)===null||d===void 0?void 0:d.color)||l[o.order||0]),B=(0,r.Z)(D,2),O=B[0],A=B[1];(0,s.useEffect)(function(){var c;A(((c=o.defaultLabel)===null||c===void 0?void 0:c.color)||l[o.order||0])},[o]);var a=h.Z.useForm(),b=(0,r.Z)(a,1),W=b[0];return(0,t.jsx)(N.Z,{title:"Add Label",visible:o.visible,onCancel:o.onCancel,footer:null,children:(0,t.jsxs)(h.Z,{form:W,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(I=o.defaultLabel)===null||I===void 0?void 0:I.name},onFinish:function(T){var k={name:T.labelname,color:O};o.onLabelAdd(k),W.resetFields()},autoComplete:"off",children:[(0,t.jsx)(h.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,t.jsx)(z.Z,{})}),(0,t.jsx)(h.Z.Item,{label:"Select Color",name:"color",children:(0,t.jsx)(_.Z,{color:O,onChange:function(T){A(T.hex)}})}),(0,t.jsx)(h.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,t.jsxs)(C.Z,{children:[(0,t.jsx)(f.Z,{onClick:function(){var T;(T=o.onCancel)===null||T===void 0||T.call(0),W.resetFields()},children:"\u53D6\u6D88"}),(0,t.jsx)(f.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},H=X,J=function(o){var d;console.log("render pplabellist");var I=(0,s.useState)(!1),D=(0,r.Z)(I,2),B=D[0],O=D[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.ZP,{className:v().labelList,size:"large",header:(0,t.jsx)("div",{className:v().listHeader,children:"Label List"}),footer:(0,t.jsx)("div",{children:(0,t.jsx)(f.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){O(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:o.labels,renderItem:function(a){return(0,t.jsx)(y,{onClick:o.onLabelSelect,label:a,onLabelDelete:o.onLabelDelete,onLabelModify:o.onLabelModify})}}),(0,t.jsx)(H,{order:(d=o.labels)===null||d===void 0?void 0:d.length,visible:B,onLabelAdd:function(a){o.onLabelAdd(a),O(!1)},onCancel:function(){O(!1)}})]})},U=J},8088:function(i,M,e){"use strict";var F=e(67294),P=e(78677),g=e.n(P),f=e(85893),r=function(m){return(0,f.jsx)("div",{className:"".concat(g().container," ").concat(m.className),children:m.children})};M.Z=r},57436:function(i,M,e){"use strict";var F=e(91220),P=e(2824),g=e(67294),f=e(65031),r=e(84420),s=e.n(r),m=e(83930),v=e.n(m),L=e(85893),C="./pics/basketball.jpg",E=function(n){var _=s()(n.imgSrc||""),t=(0,P.Z)(_,1),u=t[0],y=(u==null?void 0:u.width)||0,S=(u==null?void 0:u.height)||0,N=(0,g.useState)(),$=(0,P.Z)(N,2),z=$[0],V=$[1],h=(0,g.useState)(),l=(0,P.Z)(h,2),X=l[0],H=l[1],J=(0,g.useState)({x:0,y:0}),U=(0,P.Z)(J,2),p=U[0],o=U[1];function d(){var a=document.getElementById("dr");a&&(V(a.clientWidth),H(a.clientHeight))}(0,g.useEffect)(function(){window.removeEventListener("resize",d),window.addEventListener("resize",d);var a=document.getElementById("dr");a&&(V(a.clientWidth),H(a.clientHeight),o({x:a.clientWidth/2,y:a.clientHeight/2}))},[]);var I=[];if(n.annotations){var D=(0,F.Z)(n.annotations),B;try{for(D.s();!(B=D.n()).done;){var O=B.value;if(!!O){var A=O.tool=="polygon"?n.createPolygonFunc:n.createBrushFunc;A&&I.push(A(O,n.onAnnotationModify,n.onAnnotationModifyComplete,n.scale,n.currentTool,n.setCurrentAnnotation,n.currentAnnotation))}}}catch(a){D.e(a)}finally{D.f()}}return(0,L.jsx)(f.Hf,{width:z,height:X,className:v().stage,children:(0,L.jsx)(f.mh,{onMouseDown:function(b){n.onMouseDown&&n.onMouseDown(b,n.scale)},onMouseMove:function(b){n.onMouseMove&&n.onMouseMove(b,n.scale)},onMouseUp:function(b){n.onMouseUp&&n.onMouseUp(b,n.scale)},onContextMenu:function(b){b.evt.preventDefault()},draggable:!1,children:(0,L.jsxs)(f.ZA,{draggable:n.currentTool=="mover",onDragEnd:function(b){},children:[(0,L.jsx)(f.Ee,{draggable:!1,image:u,x:p.x,y:p.y,offsetX:y/2,offsetY:S/2,scaleX:n.scale,scaleY:n.scale}),I]})})})};M.Z=E},44434:function(i,M,e){"use strict";var F=e(67294),P=e(80961),g=e.n(P),f=e(85893),r=function(m){var v=g().leftToolbar;return m.disLoc=="right"&&(v=g().rightToolbar),(0,f.jsx)("div",{className:v,children:m.children})};M.Z=r},61541:function(i,M,e){"use strict";var F=e(49111),P=e(19650),g=e(67294),f=e(82499),r=e.n(f),s=e(85893),m=function(L){return(0,s.jsx)("div",{unselectable:"on",className:"".concat(r().toolBarButtonContainerWrapper," ").concat(L.active&&r().toolBarButtonContainerWrapperActive),onClick:L.onClick,children:(0,s.jsx)(P.Z,{align:"center",className:r().toolBarButtonContainer,size:0,children:(0,s.jsxs)(P.Z,{align:"center",direction:"vertical",className:r().toolBarButton,size:0,children:[(0,s.jsx)("img",{src:L.imgSrc}),(0,s.jsx)("div",{className:r().buttonText,children:L.children})]})})})};M.Z=m},29214:function(i,M,e){"use strict";e.r(M);var F=e(11849),P=e(20228),g=e(11382),f=e(34669),r=e(54458),s=e(34792),m=e(48086),v=e(86582),L=e(91220),C=e(3182),E=e(2824),Z=e(94043),n=e.n(Z),_=e(67294),t=e(73199),u=e.n(t),y=e(8088),S=e(61541),N=e(44434),$=e(5041),z=e(57436),V=e(37071),h=e(64322),l=e(85893),X=localStorage.getItem("basePath"),H=function(){var U,p=(0,_.useState)("mover"),o=(0,E.Z)(p,2),d=o[0],I=o[1],D=(0,_.useState)(!1),B=(0,E.Z)(D,2),O=B[0],A=B[1],a=V.Z.getQueryVariable("projectId"),b=(0,h._D)(_.useState),W=(0,h.CV)(_.useState),c=(0,h.iA)(_.useState),T=(0,h.A5)(_.useState),k=(0,h.Gd)(_.useState),_e=function(R){if(console.log("selectLabel",c.curr,T.curr,W.all),R.active)W.create({taskId:c.curr.taskId,labelId:R.labelId,dataId:T.curr.dataId});else{var Y=W.all.filter(function(w){return w.labelId==R.labelId})[0];console.log("filter ann ",Y),W.remove(Y.annotationId)}console.log("selectlabel",R)},j=(0,h.jL)(_.useState,{oneHot:!1,pageOnSelect:_e});return(0,_.useEffect)(function(){k.getCurr(a),j.getAll(a),c.getAll(a)},[]),(0,_.useEffect)(function(){c.all&&c.all.length!=0&&c.turnTo(0)},[c.all]),(0,_.useEffect)(function(){if(c.currIdx!=null){var x=function(){var R=(0,C.Z)(n().mark(function Y(){var w,ee,ie,ne,te,G,ae,oe,Q,le,re;return n().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return console.log("onTaskChange",c.curr,j.all),K.next=3,T.getAll(c.curr.taskId,0);case 3:return w=K.sent,ee=(0,E.Z)(w,2),ie=ee[0],ne=ee[1],K.next=9,W.getAll(ne.dataId);case 9:te=K.sent,G=(0,L.Z)(j.all);try{for(G.s();!(ae=G.n()).done;)oe=ae.value,oe.active=!1}catch(q){G.e(q)}finally{G.f()}Q=(0,L.Z)(j.all);try{for(re=function(){var se=le.value,ue=te.filter(function(de){return de.label.labelId==se.labelId});ue.length!=0&&(se.active=!0)},Q.s();!(le=Q.n()).done;)re()}catch(q){Q.e(q)}finally{Q.f()}console.log("label.all toggled",j.all),j.setAll((0,v.Z)(j.all)),A(!1);case 17:case"end":return K.stop()}},Y)}));return function(){return R.apply(this,arguments)}}();x()}},[c.currIdx]),(0,l.jsxs)(y.Z,{className:u().classes,children:[(0,l.jsxs)(N.Z,{children:[(0,l.jsx)(S.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){b.change(.1)},children:"Zoom in"}),(0,l.jsx)(S.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){b.change(-.1)},children:"Zoom out"}),(0,l.jsx)(S.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){m.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,l.jsx)(S.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){I("mover"),m.default.info("You can move the image now.")},children:"Move"})]}),(0,l.jsx)("div",{id:"dr",className:u().mainStage,children:(0,l.jsxs)(g.Z,{tip:"loading",spinning:O,children:[(0,l.jsx)("div",{className:u().draw,children:(0,l.jsx)(z.Z,{scale:b.curr,currentTool:d,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat(X,"/datas/").concat((U=T.curr)===null||U===void 0?void 0:U.dataId,"/image")})}),(0,l.jsx)("div",{className:u().pblock,children:(0,l.jsx)("div",{className:u().progress,children:(0,l.jsx)(r.Z,{percent:50,status:"active"})})}),(0,l.jsx)("div",{className:u().prevTask,onClick:function(){return c.turnTo(c.currIdx-1)}}),(0,l.jsx)("div",{className:u().nextTask,onClick:function(){return c.turnTo(c.currIdx+1)}})]})}),(0,l.jsxs)(N.Z,{disLoc:"right",children:[(0,l.jsx)(S.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,l.jsx)(S.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,l.jsx)("div",{className:u().rightSideBar,children:(0,l.jsx)($.Z,{labels:j.all,selectedLabel:j.curr,onLabelSelect:j.onSelect,onLabelAdd:function(R){return j.create((0,F.Z)((0,F.Z)({},R),{},{projectId:k.curr.projectId}))},onLabelDelete:j.remove,onLabelModify:function(){}})})]})};M.default=H}}]);
