(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[885],{85024:function(b){b.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(b){b.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},57560:function(b){b.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(b){b.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},14836:function(b,D,t){"use strict";t.d(D,{Z:function(){return E}});var R=t(54421),g=t(38272),B=t(57663),A=t(71577),L=t(67294),C=t(56159),T=t.n(C),I=t(49111),y=t(19650),e=t(2824),f=t(11849),v=t(85024),n=t.n(v),i=t(63097),o=t(85893),u=function(s){var d=(0,f.Z)({},s.annotation),P=(0,L.useState)(d.invisible),m=(0,e.Z)(P,2),r=m[0],l=m[1],O=(0,L.useState)(0),h=(0,e.Z)(O,2),x=h[0],S=h[1];(0,L.useEffect)(function(){l(s.annotation.invisible)},[s.annotation.invisible]);var W=(0,o.jsxs)(g.ZP.Item,{className:"".concat(n().listItem," ").concat(s.active?n().listItemActive:""),unselectable:"on",onClick:function(){s.onClick(d)},children:[(0,o.jsxs)(y.Z,{align:"center",size:5,children:[(0,o.jsx)("a",{className:n().eye,style:{backgroundImage:r?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(U){U.stopPropagation(),l(!r),s.onAnnotationModify(d)}})," ",(0,o.jsx)("span",{className:n().annotationId,children:d.frontendId}),(0,o.jsx)("span",{className:n().labelName,children:d.label.name}),(0,o.jsx)(i.Z,{color:d.label.color})]}),(0,o.jsx)("a",{className:n().delete,onClick:function(U){U.stopPropagation();var K=new Date().getTime();K-x<300||(S(K),s.onAnnotationDelete(d))}})]});return W},_=u,a=t(48971),c=function(s){var d=(0,a.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),P=(0,a.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(g.ZP,{className:T().labelList,size:"large",header:(0,o.jsx)("div",{className:T().listHeader,children:d}),bordered:!0,dataSource:s.annotations,renderItem:function(r){var l;return(0,o.jsx)(_,{onClick:s.onAnnotationSelect,annotation:r,active:r.frontendId==((l=s.currAnnotation)===null||l===void 0?void 0:l.frontendId),onAnnotationDelete:s.onAnnotationDelete,onAnnotationModify:s.onAnnotationModify})},footer:(0,o.jsx)("div",{children:(0,o.jsx)(A.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){s.onAnnotationAdd()},block:!0,children:P})})})})},E=c},43801:function(b,D,t){"use strict";t.d(D,{Z:function(){return v}});var R=t(11849),g=t(2824),B=t(91220),A=t(67294),L=t(65031),C=t(85893);function T(n){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}function I(n,i,o,u){if(!(!n||!i||!o||!u))return{width:n,color:i,points:o,tool:u}}function y(n){if(!n.annotation||!n.annotation.points)return(0,C.jsx)(C.Fragment,{});var i=[],o=(0,B.Z)(n.annotation.points),u;try{for(o.s();!(u=o.n()).done;){var _=u.value;if(!(!_.width||!_.color||!_.tool)){var a=T(_.color);!a||i.push((0,C.jsx)(L.x1,{stroke:"rgba(".concat(a.r,", ").concat(a.g,", ").concat(a.b,", ").concat(n.transparency*.01,")"),strokeWidth:_.width,globalCompositeOperation:_.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:_.points,tension:1}))}}}catch(c){o.e(c)}finally{o.f()}return(0,C.jsx)(L.ZA,{draggable:!1,children:i})}function e(n,i){return n=="rubber"||i==2?"rubber":"brush"}function f(n){var i=0,o=(0,B.Z)(n),u;try{for(o.s();!(u=o.n()).done;){var _=u.value;!_||!_.frontendId||_.frontendId>i&&(i=_.frontendId)}}catch(a){o.e(a)}finally{o.f()}return i}function v(n){var i=(0,A.useState)(),o=(0,g.Z)(i,2),u=o[0],_=o[1],a=function(s,d,P,m){var r,l;if(!(n.currentTool!="brush"&&n.currentTool!="rubber"||!((r=n.currentLabel)!==null&&r!==void 0&&r.color))){var O=(s.evt.offsetX+d)/m,h=(s.evt.offsetY+P)/m,x=e(n.currentTool,s.evt.button),S=I(n.brushSize||10,(l=n.currentLabel)===null||l===void 0?void 0:l.color,[O,h,O,h],x);if(!!S)if(_(x),n.currentAnnotation){var W,j={type:"brush",frontendId:n.currentAnnotation.frontendId,label:n.currentAnnotation.label,points:(W=n.currentAnnotation.points)===null||W===void 0?void 0:W.concat([S])};n.onAnnotationModify(j)}else{if(x=="rubber")return;n.onAnnotationAdd({type:x,frontendId:f(n.annotations)+1,label:n.currentLabel,points:[S]})}}},c=function(s,d,P,m){var r;if(!(!u||!n.currentAnnotation||!n.currentLabel.color)){var l=(s.evt.offsetX+d)/m,O=(s.evt.offsetY+P)/m,h=[l,O],x=[];(r=n.currentAnnotation)!==null&&r!==void 0&&r.points&&(h=n.currentAnnotation.points[n.currentAnnotation.points.length-1].points.concat(h),x=n.currentAnnotation.points);var S=I(n.brushSize||10,n.currentLabel.color,h,u);!S||(x.pop(),x.push(S),n.onAnnotationModify((0,R.Z)((0,R.Z)({},n.currentAnnotation),{},{points:x,type:u})))}},E=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||(_(void 0),n.onMouseUp())};return{onMouseDown:a,onMouseMove:c,onMouseUp:E,createElementsFunc:y}}},58967:function(b,D,t){"use strict";var R=t(20136),g=t(55241),B=t(77883),A=t(70507),L=t(57663),C=t(71577),T=t(2824),I=t(67294),y=t(61541),e=t(57560),f=t.n(e),v=t(85893),n=1,i=50,o=10;function u(a){return a?a<=n?n:a>=i?i:a:o}var _=function(c){var E=(0,I.useState)(u(c.size)),M=(0,T.Z)(E,2),s=M[0],d=M[1],P=function(r){d(u(r))};return(0,I.useEffect)(function(){P(c.size)},[c.size]),(0,v.jsxs)(g.Z,{overlayClassName:f().popover,placement:"right",content:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(C.Z,{type:"text",onClick:function(){var r,l=u(s-1);P(l),(r=c.onChange)===null||r===void 0||r.call(0,l)},children:"-"}),(0,v.jsx)(A.Z,{min:n,max:i,value:s,onChange:function(r){var l;(l=c.onChange)===null||l===void 0||l.call(0,r)},controls:!1,style:{textAlign:"center"}}),(0,v.jsx)(C.Z,{type:"text",onClick:function(){var r,l=u(s+1);P(l),(r=c.onChange)===null||r===void 0||r.call(0,l)},children:"+"})]}),trigger:c.active?"hover":"click",children:[" ",(0,v.jsx)(y.Z,{active:c.active,imgSrc:c.imgSrc||"./pics/buttons/brush.png",onClick:c.onClick,children:c.children||"Brush"})]})};D.Z=_},27992:function(b,D,t){"use strict";var R=t(20136),g=t(55241),B=t(77883),A=t(70507),L=t(57663),C=t(71577),T=t(2824),I=t(67294),y=t(61541),e=t(26647),f=t.n(e),v=t(85893),n=0,i=100,o=10,u=function(a){var c=(0,I.useState)(r(a.size)),E=(0,T.Z)(c,2),M=E[0],s=E[1];function d(l){s(r(l))}var P=a.minSize==null?n:a.minSize,m=a.maxSize==null?i:a.maxSize;function r(l){return l==null?o:l<=P?P:l>=m?m:l}return(0,I.useEffect)(function(){d(a.size),console.log("props.size changed to:".concat(a.size))},[a.size]),(0,v.jsxs)(g.Z,{overlayClassName:"".concat(f().popover," ").concat(a.disLoc=="left"?f().popoverLeft:""),placement:a.disLoc||"right",content:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(C.Z,{type:"text",onClick:function(){var O,h=r(M-1);d(h),(O=a.onChange)===null||O===void 0||O.call(0,h)},children:"-"}),(0,v.jsx)(A.Z,{min:P,max:m,value:M,onChange:function(O){var h;(h=a.onChange)===null||h===void 0||h.call(0,O)},controls:!1,style:{textAlign:"center"}}),(0,v.jsx)(C.Z,{type:"text",onClick:function(){var O,h=r(M+1);d(h),(O=a.onChange)===null||O===void 0||O.call(0,h)},children:"+"})]}),trigger:"hover",children:[" ",(0,v.jsx)(y.Z,{imgSrc:a.imgSrc||"",onClick:a.onClick,children:a.children})]})};D.Z=u},13931:function(b,D,t){"use strict";t.d(D,{Z:function(){return y}});var R=t(91220),g=t(11849),B=t(65031),A=t(85893);function L(e){var f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return f?{r:parseInt(f[1],16),g:parseInt(f[2],16),b:parseInt(f[3],16)}:null}function C(e,f){if(!(!e||!f))return{color:e,points:f}}function T(e){if(!e.annotation||!e.annotation.points||!e.annotation.points[0])return[(0,A.jsx)(A.Fragment,{})];var f=e.annotation.points[0].points,v=e.annotation.points[0].color,n=L(v);if(!n)return[(0,A.jsx)(A.Fragment,{})];var i=.3,o=void 0,u=[];return f.forEach(function(_,a){if(!o){o=_;return}u.push((0,A.jsx)(B.Cd,{onMouseDown:function(){e.currentTool=="editor"&&e.onSelect(e.annotation)},draggable:e.currentTool=="editor",onDragMove:function(E){var M;E.cancelBubble=!0;var s=(M=e.stageRef)===null||M===void 0?void 0:M.current,d=s.findOne(".baseImage"),P=!1,m=E.target.x();m>d.width()/2&&(m=d.width()/2,P=!0),m<-d.width()/2&&(m=-d.width()/2,P=!0);var r=E.target.y();r>d.height()/2&&(r=d.height()/2,P=!0),r<-d.height()/2&&(r=-d.height()/2,P=!0),P&&E.target.setPosition({x:m,y:r}),f[a-1]=m,f[a]=r;var l=(0,g.Z)((0,g.Z)({},e.annotation),{},{points:[{color:v,points:f}]});e.onDrag(l)},onMouseOver:function(){e.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},x:o,y:_,radius:5/e.scale,fill:v})),o=void 0}),[(0,A.jsxs)(B.ZA,{children:[(0,A.jsx)(B.x1,{onMouseOver:function(){e.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){e.currentTool=="editor"&&e.onSelect(e.annotation)},stroke:v,strokeWidth:2/e.scale,globalCompositeOperation:"source-over",lineCap:"round",points:f,tension:0,closed:!0,fill:"rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(i,")")}),u]},e.annotation.frontendId)]}function I(e){var f=0,v=(0,R.Z)(e),n;try{for(v.s();!(n=v.n()).done;){var i=n.value;!i||!i.frontendId||i.frontendId>f&&(f=i.frontendId)}}catch(o){v.e(o)}finally{v.f()}return f}function y(e){var f=function(u,_,a,c){var E,M=(u.evt.offsetX+_)/c,s=(u.evt.offsetY+a)/c,d=C((E=e.currentLabel)===null||E===void 0?void 0:E.color,[M,s]);!d||e.onAnnotationAdd({type:"polygon",frontendId:I(e.annotations)+1,label:e.currentLabel,points:[d]})},v=function(u,_,a,c){var E,M;if(!!e.currentAnnotation){var s=(u.evt.offsetX+_)/c,d=(u.evt.offsetY+a)/c,P=e.currentAnnotation.points||[],m=C((E=e.currentLabel)===null||E===void 0?void 0:E.color,(M=P[0])===null||M===void 0?void 0:M.points.concat([s,d]));if(!!m){var r={type:"polygon",frontendId:e.currentAnnotation.frontendId,label:e.currentAnnotation.label,points:[m]};e.onAnnotationModify(r)}}},n=function(u,_,a,c){e.currentTool=="polygon"&&(e.currentAnnotation?v(u,_,a,c):f(u,_,a,c))},i=function(){e.currentTool=="polygon"&&e.onMouseUp()};return{onMouseDown:n,onMouseMove:function(){},onMouseUp:i,createElementsFunc:T}}},29919:function(b,D,t){"use strict";var R=t(67294),g=t(61541),B=t(85893),A=function(C){return(0,B.jsx)(g.Z,{active:C.active,imgSrc:C.imgSrc||"./pics/buttons/polygon.png",onClick:C.onClick,children:C.children})};D.Z=A}}]);
