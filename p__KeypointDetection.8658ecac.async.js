(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{71212:function(B){B.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},13931:function(B,S,t){"use strict";t.d(S,{Z:function(){return W}});var R=t(91220),b=t(11849),x=t(65031),f=t(85893);function O(n){var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16)}:null}function u(n,s){if(!(!n||!s))return{color:n,points:s}}function K(n,s,E,y,c,v,_){if(!n||!n.lines||!n.lines[0])return[(0,f.jsx)(f.Fragment,{})];var o=n.lines[0].points,l=n.lines[0].color,d=O(l);if(!d)return[(0,f.jsx)(f.Fragment,{})];var C=(_==null?void 0:_.annotationId)==n.annotationId,m=C?.5:.1,D=void 0,A=[];return o.forEach(function(P,p){if(!D){D=P;return}A.push((0,f.jsx)(x.Cd,{onMouseDown:function(){c=="mover"&&v(n)},draggable:c=="mover",onDragMove:function(T){console.log("Circle onDrageMove");var U=T.evt.offsetX/y,Z=T.evt.offsetY/y;o[p-1]=U,o[p]=Z;var k=(0,b.Z)((0,b.Z)({},n),{},{lines:[{color:l,points:o}]});s(k)},onMouseOver:function(){console.log("Circle onMouseOver"),c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:D,y:P,radius:5,fill:l})),D=void 0}),[(0,f.jsxs)(x.ZA,{children:[(0,f.jsx)(x.x1,{onMouseOver:function(){c=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){c=="mover"&&v(n)},stroke:l,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:o,tension:0,closed:!0,fill:"rgba(".concat(d.r,", ").concat(d.g,", ").concat(d.b,", ").concat(m,")")}),A]},n.annotationId)]}function M(n){var s=0,E=(0,R.Z)(n),y;try{for(E.s();!(y=E.n()).done;){var c=y.value;!c||c.annotationId>s&&(s=c.annotationId)}}catch(v){E.e(v)}finally{E.f()}return s}function W(n){var s=function(_,o){var l,d=_.evt.offsetX/o,C=_.evt.offsetY/o,m=u((l=n.currentLabel)===null||l===void 0?void 0:l.color,[d,C]);!m||n.onAnnotationAdd({tool:"polygon",annotationId:M(n.annotations)+1,label:n.currentLabel,lines:[m]})},E=function(_,o){var l,d;if(!!n.currentAnnotation){var C=_.evt.offsetX/o,m=_.evt.offsetY/o,D=n.currentAnnotation.lines||[],A=u((l=n.currentLabel)===null||l===void 0?void 0:l.color,(d=D[0])===null||d===void 0?void 0:d.points.concat([C,m]));if(!!A){var P={tool:"polygon",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:[A]};n.onAnnotationModify(P)}}},y=function(_,o){n.currentTool=="polygon"&&(n.currentAnnotation?E(_,o):s(_,o))},c=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:y,onMouseMove:function(){},onMouseUp:c,createElementsFunc:K}}},29919:function(B,S,t){"use strict";var R=t(67294),b=t(61541),x=t(85893),f=function(u){return(0,x.jsx)(b.Z,{active:u.active,imgSrc:u.imgSrc||"./pics/buttons/polygon.png",onClick:u.onClick,children:u.children})};S.Z=f},82881:function(B,S,t){"use strict";t.r(S);var R=t(57663),b=t(71577),x=t(34669),f=t(54458),O=t(2824),u=t(67294),K=t(71212),M=t.n(K),W=t(8088),n=t(61541),s=t(44434),E=t(5041),y=t(57436),c=t(14836),v=t(29919),_=t(13931),o=t(85893),l=40,d=function(){var m,D=(0,u.useState)(void 0),A=(0,O.Z)(D,2),P=A[0],p=A[1],I=(0,u.useState)({color:"",name:""}),T=(0,O.Z)(I,2),U=T[0],Z=T[1],k=(0,u.useState)(),Y=(0,O.Z)(k,2),L=Y[0],N=Y[1],q=(0,u.useState)([]),X=(0,O.Z)(q,2),g=X[0],j=X[1],nn=(0,u.useState)(1),$=(0,O.Z)(nn,2),F=$[0],w=$[1],z=function(e){e||w(1),e<.1||e>3?w(1):w(e)},h=function(e){N(e),e!=null&&e.label&&Z(e.label)};(0,u.useEffect)(function(){localStorage.removeItem("history"),H([])},[]);function H(i,e){var r=localStorage.getItem("history"),a=r?JSON.parse(r):{index:-1,items:[]},V={currentAnnotation:e,annotations:i};if(JSON.stringify(a.items[a.index])!=JSON.stringify(V)){var tn=a.index>l?a.index-l:0,rn=a.items.splice(tn,a.index==0?1:a.index+1);a.items=rn.concat([V]),a.index<=l?a.index++:a.index=l+1,localStorage.setItem("history",JSON.stringify(a))}}var on=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!!r&&!(r.index>=r.items.length-1)){r.index++,localStorage.setItem("history",JSON.stringify(r));var a=r.items[r.index];N(a.currentAnnotation),j(a.annotations)}}},en=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!(!r||!r.index)&&!(r.index<=0)){r.index--,localStorage.setItem("history",JSON.stringify(r));var a=r.items[r.index];N(a.currentAnnotation),j(a.annotations)}}},Q=function(e){for(var r=[],a=0;a<g.length;a++)g[a].annotationId==e.annotationId?r.push(e):r.push(g[a]);h(e),j(r)},G=(0,_.Z)({currentLabel:U,currentTool:P,annotations:g,currentAnnotation:L,onAnnotationAdd:function(e){var r=g.concat([e]);j(r),L||h(e)},onAnnotationModify:Q,onMouseUp:function(){H(g,L)}}),J=G;return(0,o.jsxs)(W.Z,{className:M().key,children:[(0,o.jsxs)(s.Z,{children:[(0,o.jsx)(v.Z,{active:P=="polygon",onClick:function(){p("polygon"),h(void 0)},children:"Polygon"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){z(F+.1)},children:"Zoom in"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){z(F-.1)},children:"Zoom out"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){p("mover")},children:"Move"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){en()},children:"Undo"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){on()},children:"Redo"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,o.jsxs)("div",{id:"dr",className:M().mainStage,children:[(0,o.jsx)("div",{className:M().draw,children:(0,o.jsx)(y.Z,{width:(m=document.getElementById("dr"))===null||m===void 0?void 0:m.clientWidth,scale:F,annotations:g,currentTool:P,currentAnnotation:L,setCurrentAnnotation:h,onAnnotationModify:Q,onAnnotationModifyComplete:function(){H(g,L)},onMouseDown:J.onMouseDown,onMouseMove:J.onMouseMove,onMouseUp:J.onMouseUp,createPolygonFunc:G.createElementsFunc})}),(0,o.jsx)("div",{className:M().pblock,children:(0,o.jsx)("div",{className:M().progress,children:(0,o.jsx)(f.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(s.Z,{disLoc:"right",children:[(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"})]}),(0,o.jsxs)("div",{className:M().rightSideBar,children:[(0,o.jsx)("div",{className:M().finished,children:(0,o.jsx)(b.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){h(void 0)},children:"Determine Outline"})}),(0,o.jsx)(E.Z,{selectedLabel:U,onLabelSelect:function(e){Z(e),h(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(c.Z,{selectedAnnotation:L,annotations:g,onAnnotationSelect:function(e){e!=null&&e.delete||h(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){j(g.filter(function(r){return r.annotationId!=e.annotationId})),h(void 0)}})]})]})};S.default=d}}]);
