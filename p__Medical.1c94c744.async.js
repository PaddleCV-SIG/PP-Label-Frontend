(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[454],{85024:function(y){y.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(y){y.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},26647:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",slider:"slider___ALra-",popoverLeft:"popoverLeft___15lGe"}},8982:function(y){y.exports={RSPop1:"RSPop1___ei_bv",RSPop2:"RSPop2___9d5gM"}},75721:function(y){y.exports={segment:"segment___1EX9A",mainStage:"mainStage___nDwOp",draw:"draw___1Aue1",pblock:"pblock___19sdD",progress:"progress___1595f",rightSideBar:"rightSideBar___1JzJc",determinOutline:"determinOutline___2vG7S"}},8978:function(y,z,t){"use strict";t.d(z,{Z:function(){return B}});var Y=t(8870),N=t(2824),$=t(91220),U=t(67294),E=t(85893);function W(n){if(!n||!n.width||!n.color||!n.points||n.points.length<2||n.frontendId==null)return"";var o=n.type=="brush"?0:n.frontendId;return"".concat(n.width,",").concat(o,",").concat(n.points.join(","))}function O(n){var o,i=n.canvasRef,u=n.annotation,s=u.result;if(!s)return(0,E.jsx)(E.Fragment,{});var m=(o=i.current)===null||o===void 0?void 0:o.getContext("2d");if(!m)return(0,E.jsx)(E.Fragment,{});for(var g=[],I=0,a=0;a<s.length;a++)s.at(a)==","?(g.push(parseFloat(s.slice(I,a))),I=a+1):s.at(a)=="|"?(g.push(parseFloat(s.slice(I,a))),A(g,m,u),g=[],I=a+1):a==s.length-1&&(g.push(parseFloat(s.slice(I,s.length))),A(g,m,u));return(0,E.jsx)(E.Fragment,{})}function A(n,o,i){var u;if(n.length<4){console.log("found incorrect points:",n);return}var s=n[0],m=n[1];if(s==0){var g;x(o,n.slice(2),i==null||(g=i.label)===null||g===void 0?void 0:g.color);return}if(m==0){K(o,s,n.slice(2),void 0);return}K(o,s,n.slice(2),i==null||(u=i.label)===null||u===void 0?void 0:u.color)}function K(n,o,i,u){n.beginPath(),n.moveTo(i[0],i[1]);for(var s=0;s<=i.length/2-1;s++){var m=i[2*s],g=i[2*s+1];n.lineTo(m,g)}n.lineCap="round",n.lineJoin="round",n.lineWidth=o,u&&(n.strokeStyle=u),n.globalCompositeOperation=u?"source-over":"destination-out",n.stroke()}function x(n,o,i){n.globalCompositeOperation=i?"source-over":"destination-out",i&&(n.fillStyle=i);for(var u=0;u<=o.length/2-1;u++){var s=o[2*u],m=o[2*u+1];n.fillRect(s,m,1,1)}}function F(n){if(!n||n.length==0)return 0;var o=0,i=(0,$.Z)(n),u;try{for(i.s();!(u=i.n()).done;){var s=u.value;s.frontendId>o&&(o=s.frontendId)}}catch(m){i.e(m)}finally{i.f()}return o}function f(n,o){return n=="rubber"||o==2?"rubber":"brush"}function B(n){var o=(0,U.useState)(),i=(0,N.Z)(o,2),u=i[0],s=i[1],m=function(c){var M,P;if(!(n.currentTool!="brush"&&n.currentTool!="rubber"||!((M=n.currentLabel)!==null&&M!==void 0&&M.color)||!n.brushSize)){var C=c.mouseX,e=c.mouseY,_=f(n.currentTool,c.e.evt.button),b=n.frontendIdOps.frontendId>0?n.frontendIdOps.frontendId:F(n.annotations);b!=n.frontendIdOps.frontendId&&n.frontendIdOps.setFrontendId(b);var T=W({width:n.brushSize||10,color:(P=n.currentLabel)===null||P===void 0?void 0:P.color,points:[C,e,C,e],type:_,frontendId:b});if(!!T){s(_);var S={dataId:n.dataId,label:n.currentLabel,frontendId:b,lines:T};n.onAnnotationAdd(S)}}},g=function(c){var M;if(!(!u||!n.currentAnnotation||!n.currentAnnotation.result||n.currentAnnotation.result.length<2||!((M=n.currentLabel)!==null&&M!==void 0&&M.color))){var P=c.mouseX,C=c.mouseY,e=n.currentAnnotation.result+",".concat(P,",").concat(C);n.onAnnotationModify((0,Y.Z)((0,Y.Z)({},n.currentAnnotation),{},{result:e}))}},I=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||(s(void 0),n.onMouseUp())};return{onMouseDown:m,onMouseMove:g,onMouseUp:I,drawAnnotation:O}}},14836:function(y,z,t){"use strict";t.d(z,{Z:function(){return g}});var Y=t(54421),N=t(38272),$=t(57663),U=t(71577),E=t(67294),W=t(56159),O=t.n(W),A=t(49111),K=t(19650),x=t(2824),F=t(8870),f=t(85024),B=t.n(f),n=t(63097),o=t(85893),i=function(a){var c=(0,F.Z)({},a.annotation),M=(0,E.useState)(c.invisible),P=(0,x.Z)(M,2),C=P[0],e=P[1],_=(0,E.useState)(0),b=(0,x.Z)(_,2),T=b[0],S=b[1];(0,E.useEffect)(function(){e(a.annotation.invisible)},[a.annotation.invisible]);var H=(0,o.jsxs)(N.ZP.Item,{className:"".concat(B().listItem," ").concat(a.active?B().listItemActive:""),unselectable:"on",onClick:function(){a.onClick(c)},children:[(0,o.jsxs)(K.Z,{align:"center",size:5,children:[(0,o.jsx)("a",{className:B().eye,style:{backgroundImage:C?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(X){X.stopPropagation(),e(!C),a.onAnnotationModify(c)}})," ",(0,o.jsx)("span",{className:B().annotationId,children:c.frontendId}),(0,o.jsx)("span",{className:B().labelName,children:c.label.name}),(0,o.jsx)(n.Z,{color:c.label.color})]}),(0,o.jsx)("a",{className:B().delete,onClick:function(X){X.stopPropagation();var p=new Date().getTime();p-T<300||(S(p),a.onAnnotationDelete(c))}})]});return H},u=i,s=t(48971),m=function(a){var c=(0,s.YB)(),M=c.formatMessage({id:"component.PPAnnotationList.annotationList"}),P=c.formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(N.ZP,{className:O().labelList,size:"large",header:(0,o.jsx)("div",{className:O().listHeader,children:M}),bordered:!0,dataSource:a.annotations,renderItem:function(e){var _;return(0,o.jsx)(u,{onClick:a.onAnnotationSelect,annotation:e,active:e.frontendId==((_=a.currAnnotation)===null||_===void 0?void 0:_.frontendId),onAnnotationDelete:a.onAnnotationDelete,onAnnotationModify:a.onAnnotationModify})},footer:(0,o.jsx)("div",{children:(0,o.jsx)(U.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){a.onAnnotationAdd()},block:!0,children:P})})})})},g=m},27992:function(y,z,t){"use strict";var Y=t(20136),N=t(55241),$=t(13062),U=t(71230),E=t(77883),W=t(70507),O=t(89032),A=t(15746),K=t(66126),x=t(75454),F=t(2824),f=t(67294),B=t(61541),n=t(26647),o=t.n(n),i=t(85893),u=0,s=100,m=10,g=function(a){var c=(0,f.useState)(T(a.size)),M=(0,F.Z)(c,2),P=M[0],C=M[1];function e(S){C(T(S))}var _=a.minSize==null?u:a.minSize,b=a.maxSize==null?s:a.maxSize;function T(S){return S==null?m:S<=_?_:S>=b?b:S}return(0,f.useEffect)(function(){e(a.size)},[a.size]),(0,i.jsxs)(N.Z,{overlayClassName:"".concat(o().popover," ").concat(a.disLoc=="left"?o().popoverLeft:""),placement:a.disLoc||"right",content:(0,i.jsxs)(U.Z,{children:[(0,i.jsx)(A.Z,{span:16,children:(0,i.jsx)(x.Z,{className:o().slider,value:P,max:b,min:_,onChange:function(H){var D;(D=a.onChange)===null||D===void 0||D.call(0,H)},tooltipVisible:!1})}),(0,i.jsx)(A.Z,{span:8,children:(0,i.jsx)(W.Z,{min:_,max:b,value:P,onChange:function(H){var D;(D=a.onChange)===null||D===void 0||D.call(0,H)},step:10})})]}),trigger:"hover",children:[" ",(0,i.jsx)(B.Z,{imgSrc:a.imgSrc||"",onClick:a.onClick,active:a.active,children:a.children})]})};z.Z=g},21028:function(y,z,t){"use strict";t.r(z),t.d(z,{MOST_HISTORY_STEPS:function(){return S},default:function(){return D}});var Y=t(57663),N=t(71577),$=t(20136),U=t(55241),E=t(34669),W=t(54458),O=t(2824),A=t(67294),K=t(75721),x=t.n(K),F=t(8088),f=t(61541),B=t(44434),n=t(27992),o=t(5041),i=t(57436),u=t(14836),s=t(13062),m=t(71230),g=t(66126),I=t(75454),a=t(89032),c=t(15746),M=t(8982),P=t.n(M),C=t(48971),e=t(85893),_=function(p){var V=(0,C.YB)(),G=V.formatMessage({id:"component.PPMedical.windowWidth"}),L=V.formatMessage({id:"component.PPMedical.windowLevel"});return(0,e.jsxs)("div",{children:[(0,e.jsxs)(m.Z,{children:[(0,e.jsx)(c.Z,{span:6,className:P().Pop1,children:(0,e.jsx)("span",{children:G})}),(0,e.jsx)(c.Z,{span:18,className:P().Pop2,children:(0,e.jsx)(I.Z,{min:1,max:p.wwValue||100,defaultValue:37})})]}),(0,e.jsxs)(m.Z,{children:[(0,e.jsx)(c.Z,{span:6,className:P().Pop1,children:(0,e.jsx)("span",{children:L})}),(0,e.jsx)(c.Z,{span:18,className:P().Pop2,children:(0,e.jsx)(I.Z,{min:1,max:p.wlValue||100,defaultValue:37})})]})]})},b=_,T=t(8978),S=40,H=function(){var p,V=(0,A.useState)(void 0),G=(0,O.Z)(V,2),L=G[0],Q=G[1],Pn=(0,A.useState)({color:"",name:""}),rn=(0,O.Z)(Pn,2),q=rn[0],sn=rn[1],Sn=(0,A.useState)(),ln=(0,O.Z)(Sn,2),R=ln[0],nn=ln[1],Mn=(0,A.useState)([]),dn=(0,O.Z)(Mn,2),j=dn[0],_n=dn[1],An=(0,A.useState)(10),un=(0,O.Z)(An,2),w=un[0],cn=un[1],xn=(0,A.useState)(1),vn=(0,O.Z)(xn,2),tn=vn[0],en=vn[1],fn=function(r){r||en(1),r<.1||r>3?en(1):en(r)},Z=function(r){nn(r),r!=null&&r.label&&sn(r.label)},J=function(r){_n(r)};(0,A.useEffect)(function(){localStorage.removeItem("history"),k([])},[]);function k(l,r){var d=localStorage.getItem("history"),v=d?JSON.parse(d):{index:-1,items:[]},hn={currentAnnotation:r,annotations:l};if(JSON.stringify(v.items[v.index])!=JSON.stringify(hn)){var Jn=v.index>S?v.index-S:0,Yn=v.items.splice(Jn,v.index==0?1:v.index+1);v.items=Yn.concat([hn]),v.index<=S?v.index++:v.index=S+1,localStorage.setItem("history",JSON.stringify(v))}}var Cn=function(){var r=localStorage.getItem("history");if(!!r){var d=JSON.parse(r);if(!!d&&!(d.index>=d.items.length-1)){d.index++,localStorage.setItem("history",JSON.stringify(d));var v=d.items[d.index];nn(v.currentAnnotation),J(v.annotations)}}},bn=function(){var r=localStorage.getItem("history");if(!!r){var d=JSON.parse(r);if(!(!d||!d.index)&&!(d.index<=0)){d.index--,localStorage.setItem("history",JSON.stringify(d));var v=d.items[d.index];nn(v.currentAnnotation),J(v.annotations)}}},on=function(r){for(var d=[],v=0;v<j.length;v++)j[v].annotationId==r.annotationId?d.push(r):d.push(j[v]);Z(r),J(d)},mn=drawBrush({currentLabel:q,brushSize:w,currentTool:L,annotations:j,currentAnnotation:R,onAnnotationAdd:function(r){var d=j.concat([r]);J(d),R||Z(r)},onAnnotationModify:on,onMouseUp:function(){k(j,R)}}),gn=drawPolygon({currentLabel:q,brushSize:w,currentTool:L,annotations:j,currentAnnotation:R,onAnnotationAdd:function(r){var d=j.concat([r]);J(d),R||Z(r)},onAnnotationModify:on,onMouseUp:function(){k(j,R)}}),an=L=="polygon"?gn:mn,h=(0,C.YB)(),yn=h.formatMessage({id:"pages.toolBar.polygon"}),Bn=h.formatMessage({id:"pages.toolBar.brush"}),In=h.formatMessage({id:"pages.toolBar.rubber"}),Ln=h.formatMessage({id:"pages.toolBar.zoomIn"}),jn=h.formatMessage({id:"pages.toolBar.zoomOut"}),En=h.formatMessage({id:"pages.toolBar.move"}),On=h.formatMessage({id:"pages.toolBar.unDo"}),Dn=h.formatMessage({id:"pages.toolBar.reDo"}),Zn=h.formatMessage({id:"pages.toolBar.save"}),Tn=h.formatMessage({id:"pages.toolBar.edit"}),pn=h.formatMessage({id:"pages.toolBar.clearMark"}),Rn=h.formatMessage({id:"pages.toolBar.interactor"}),zn=h.formatMessage({id:"pages.toolBar.segmentThreshold"}),Nn=h.formatMessage({id:"pages.toolBar.transparency"}),Un=h.formatMessage({id:"pages.toolBar.visualRadius"}),Wn=h.formatMessage({id:"pages.toolBar.determineOutline"}),Kn=h.formatMessage({id:"pages.toolBar.medicalSetting"}),Fn=h.formatMessage({id:"pages.toolBar.divideData"}),Hn=h.formatMessage({id:"pages.toolBar.export"});return(0,e.jsxs)(F.Z,{className:x().segment,children:[(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/polygon.png",active:L=="polygon",onClick:function(){Q("polygon"),Z(void 0)},children:yn}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/edit.png",children:Tn}),(0,e.jsx)(T.Z,{size:w,active:L=="brush",onClick:function(){L!="rubber"&&L!="brush"&&Z(void 0),Q("brush")},onChange:function(r){cn(r)},children:Bn}),(0,e.jsx)(T.Z,{size:w,active:L=="rubber",onClick:function(){L!="rubber"&&L!="brush"&&Z(void 0),Q("rubber")},onChange:function(r){cn(r)},imgSrc:"./pics/buttons/rubber.png",children:In}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){fn(tn+.1)},children:Ln}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){fn(tn-.1)},children:jn}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/save.png",children:Zn}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){Q("mover")},children:En}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){bn()},children:On}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){Cn()},children:Dn}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:pn})]}),(0,e.jsxs)("div",{id:"dr",className:x().mainStage,children:[(0,e.jsx)("div",{className:x().draw,children:(0,e.jsx)(i.Z,{width:(p=document.getElementById("dr"))===null||p===void 0?void 0:p.clientWidth,scale:tn,annotations:j,currentTool:L,currentAnnotation:R,setCurrentAnnotation:Z,onAnnotationModify:on,onAnnotationModifyComplete:function(){k(j,R)},onMouseDown:an.onMouseDown,onMouseMove:an.onMouseMove,onMouseUp:an.onMouseUp,createPolygonFunc:gn.createElementsFunc,createBrushFunc:mn.createElementsFunc})}),(0,e.jsx)("div",{className:x().pblock,children:(0,e.jsx)("div",{className:x().progress,children:(0,e.jsx)(W.Z,{percent:50,status:"active"})})})]}),(0,e.jsxs)(B.Z,{disLoc:"right",children:[(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:Rn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:zn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:Nn}),(0,e.jsx)(n.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:Un}),(0,e.jsxs)(U.Z,{overlayInnerStyle:{borderRadius:"0.5rem"},placement:"leftTop",title:"Setting of medical",content:(0,e.jsx)(b,{}),trigger:"hover",children:[" ",(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/medical_setting.png",children:Kn})]}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/data_division.png",children:Fn}),(0,e.jsx)(f.Z,{imgSrc:"./pics/buttons/export.png",children:Hn})]}),(0,e.jsxs)("div",{className:x().rightSideBar,children:[(0,e.jsx)("div",{className:x().determinOutline,children:(0,e.jsx)(N.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){Z(void 0)},children:Wn})}),(0,e.jsx)(o.Z,{selectedLabel:q,onLabelSelect:function(r){sn(r),Z(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,e.jsx)(u.Z,{selectedAnnotation:R,annotations:j,onAnnotationSelect:function(r){r!=null&&r.delete||Z(r)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(r){J(j.filter(function(d){return d.annotationId!=r.annotationId})),Z(void 0)}})]})]})},D=H}}]);
