(self.webpackChunkpp_labeling_frontend=self.webpackChunkpp_labeling_frontend||[]).push([[89],{57560:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___147XP",toolBarButtonContainer:"toolBarButtonContainer___ZEvhK",toolBarButton:"toolBarButton___1s2Rh",buttonText:"buttonText___3NTCv",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___2Utx8",popover:"popover___3PRoi"}},26647:function(y){y.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1FTWb",toolBarButtonContainer:"toolBarButtonContainer___1Vahn",toolBarButton:"toolBarButton___3mR2H",buttonText:"buttonText___Y0WDm",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3lRZ8",popover:"popover___3zzu2",popoverLeft:"popoverLeft___15lGe"}},54777:function(y){y.exports={segment:"segment___1YMcl",mainStage:"mainStage___2otee",draw:"draw___equn4",pblock:"pblock___2bT7z",progress:"progress___1porz",rightSideBar:"rightSideBar___2X7jK",determinOutline:"determinOutline___2ls57"}},43801:function(y,x,e){"use strict";e.d(x,{Z:function(){return E}});var Z=e(11849),T=e(2824),R=e(91220),A=e(67294),L=e(65031),C=e(85893);function I(n,c,s,M){if(!(!n||!c||!s||!M))return{width:n,color:c,points:s,tool:M}}function D(n,c,s,M,l,g,u){if(!n||!n.lines)return(0,C.jsx)(C.Fragment,{});var i=(u==null?void 0:u.annotationId)==n.annotationId,t=i&&l=="mover",f=[],m=(0,R.Z)(n.lines),b;try{for(m.s();!(b=m.n()).done;){var d=b.value;!d.width||!d.color||!d.points||!d.tool||f.push((0,C.jsx)(L.x1,{stroke:d.color,strokeWidth:d.width,globalCompositeOperation:d.tool==="brush"?"source-over":"destination-out",lineCap:"round",points:d.points,tension:.01,onDragMove:function(){},onDragEnd:function(){s()},shadowColor:"red",shadowBlur:10,shadowOffset:{x:5,y:5},shadowOpacity:t?1:0}))}}catch(O){m.e(O)}finally{m.f()}return(0,C.jsx)(L.ZA,{draggable:t,children:f})}function W(n,c){return n=="rubber"||c==2?"rubber":"brush"}function o(n){var c=0,s=(0,R.Z)(n),M;try{for(s.s();!(M=s.n()).done;){var l=M.value;!l||l.annotationId>c&&(c=l.annotationId)}}catch(g){s.e(g)}finally{s.f()}return c}function E(n){var c=(0,A.useState)(),s=(0,T.Z)(c,2),M=s[0],l=s[1],g=function(f,m){var b;if(!(n.currentTool!="brush"&&n.currentTool!="rubber")){var d=f.evt.offsetX/m,O=f.evt.offsetY/m,r=W(n.currentTool,f.evt.button),_=I(n.brushSize||10,(b=n.currentLabel)===null||b===void 0?void 0:b.color,[d,O,d,O],r);if(!!_)if(l(r),n.currentAnnotation){var U,p={tool:"brush",annotationId:n.currentAnnotation.annotationId,label:n.currentAnnotation.label,lines:(U=n.currentAnnotation.lines)===null||U===void 0?void 0:U.concat([_])};n.onAnnotationModify(p)}else{if(r=="rubber")return;n.onAnnotationAdd({tool:"brush",annotationId:o(n.annotations)+1,label:n.currentLabel,lines:[_]})}}},u=function(f,m){var b;if(!(!M||!n.currentAnnotation)){var d=f.evt.offsetX/m,O=f.evt.offsetY/m,r=[d,O],_=[];(b=n.currentAnnotation)!==null&&b!==void 0&&b.lines&&(r=n.currentAnnotation.lines[n.currentAnnotation.lines.length-1].points.concat(r),_=n.currentAnnotation.lines);var U=I(n.brushSize||10,n.currentLabel.color,r,M);!U||(_.pop(),_.push(U),n.onAnnotationModify((0,Z.Z)((0,Z.Z)({},n.currentAnnotation),{},{lines:_})))}},i=function(){n.currentTool!="brush"&&n.currentTool!="rubber"||(l(void 0),n.onMouseUp())};return{onMouseDown:g,onMouseMove:u,onMouseUp:i,createElementsFunc:D}}},58967:function(y,x,e){"use strict";var Z=e(20136),T=e(55241),R=e(77883),A=e(70507),L=e(57663),C=e(71577),I=e(2824),D=e(67294),W=e(61541),o=e(57560),E=e.n(o),n=e(85893),c=1,s=50,M=10;function l(u){return u?u<=c?c:u>=s?s:u:M}var g=function(i){var t=(0,D.useState)(l(i.size)),f=(0,I.Z)(t,2),m=f[0],b=f[1],d=function(r){b(l(r))};return(0,D.useEffect)(function(){d(i.size)},[i.size]),(0,n.jsxs)(T.Z,{overlayClassName:E().popover,placement:"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Z,{type:"text",onClick:function(){var r,_=l(m-1);d(_),(r=i.onChange)===null||r===void 0||r.call(0,_)},children:"-"}),(0,n.jsx)(A.Z,{min:c,max:s,value:m,onChange:function(r){var _;(_=i.onChange)===null||_===void 0||_.call(0,r)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(C.Z,{type:"text",onClick:function(){var r,_=l(m+1);d(_),(r=i.onChange)===null||r===void 0||r.call(0,_)},children:"+"})]}),trigger:i.active?"hover":"click",children:[" ",(0,n.jsx)(W.Z,{active:i.active,imgSrc:i.imgSrc||"./pics/buttons/brush.png",onClick:i.onClick,children:i.children||"Brush"})]})};x.Z=g},27992:function(y,x,e){"use strict";var Z=e(20136),T=e(55241),R=e(77883),A=e(70507),L=e(57663),C=e(71577),I=e(2824),D=e(67294),W=e(61541),o=e(26647),E=e.n(o),n=e(85893),c=1,s=100,M=10;function l(u){return u?u<=c?c:u>=s?s:u:M}var g=function(i){var t=(0,D.useState)(l(i.size)),f=(0,I.Z)(t,2),m=f[0],b=f[1],d=function(r){b(l(r))};return(0,D.useEffect)(function(){d(i.size)},[i.size]),(0,n.jsxs)(T.Z,{overlayClassName:"".concat(E().popover," ").concat(i.disLoc=="left"?E().popoverLeft:""),placement:i.disLoc||"right",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Z,{type:"text",onClick:function(){var r,_=l(m-1);d(_),(r=i.onChange)===null||r===void 0||r.call(0,_)},children:"-"}),(0,n.jsx)(A.Z,{min:c,max:s,value:m,onChange:function(r){var _;(_=i.onChange)===null||_===void 0||_.call(0,r)},controls:!1,style:{textAlign:"center"}}),(0,n.jsx)(C.Z,{type:"text",onClick:function(){var r,_=l(m+1);d(_),(r=i.onChange)===null||r===void 0||r.call(0,_)},children:"+"})]}),trigger:"hover",children:[" ",(0,n.jsx)(W.Z,{imgSrc:i.imgSrc,onClick:i.onClick,children:i.children})]})};x.Z=g},13931:function(y,x,e){"use strict";e.d(x,{Z:function(){return W}});var Z=e(91220),T=e(11849),R=e(65031),A=e(85893);function L(o){var E=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return E?{r:parseInt(E[1],16),g:parseInt(E[2],16),b:parseInt(E[3],16)}:null}function C(o,E){if(!(!o||!E))return{color:o,points:E}}function I(o,E,n,c,s,M,l){if(!o||!o.lines||!o.lines[0])return[(0,A.jsx)(A.Fragment,{})];var g=o.lines[0].points,u=o.lines[0].color,i=L(u);if(!i)return[(0,A.jsx)(A.Fragment,{})];var t=(l==null?void 0:l.annotationId)==o.annotationId,f=t?.5:.1,m=void 0,b=[];return g.forEach(function(d,O){if(!m){m=d;return}b.push((0,A.jsx)(R.Cd,{onMouseDown:function(){s=="mover"&&M(o)},draggable:s=="mover",onDragMove:function(_){console.log("Circle onDrageMove");var U=_.evt.offsetX/c,p=_.evt.offsetY/c;g[O-1]=U,g[O]=p;var z=(0,T.Z)((0,T.Z)({},o),{},{lines:[{color:u,points:g}]});E(z)},onMouseOver:function(){console.log("Circle onMouseOver"),s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:m,y:d,radius:5,fill:u})),m=void 0}),[(0,A.jsxs)(R.ZA,{children:[(0,A.jsx)(R.x1,{onMouseOver:function(){s=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){s=="mover"&&M(o)},stroke:u,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:g,tension:0,closed:!0,fill:"rgba(".concat(i.r,", ").concat(i.g,", ").concat(i.b,", ").concat(f,")")}),b]},o.annotationId)]}function D(o){var E=0,n=(0,Z.Z)(o),c;try{for(n.s();!(c=n.n()).done;){var s=c.value;!s||s.annotationId>E&&(E=s.annotationId)}}catch(M){n.e(M)}finally{n.f()}return E}function W(o){var E=function(l,g){var u,i=l.evt.offsetX/g,t=l.evt.offsetY/g,f=C((u=o.currentLabel)===null||u===void 0?void 0:u.color,[i,t]);!f||o.onAnnotationAdd({tool:"polygon",annotationId:D(o.annotations)+1,label:o.currentLabel,lines:[f]})},n=function(l,g){var u,i;if(!!o.currentAnnotation){var t=l.evt.offsetX/g,f=l.evt.offsetY/g,m=o.currentAnnotation.lines||[],b=C((u=o.currentLabel)===null||u===void 0?void 0:u.color,(i=m[0])===null||i===void 0?void 0:i.points.concat([t,f]));if(!!b){var d={tool:"polygon",annotationId:o.currentAnnotation.annotationId,label:o.currentAnnotation.label,lines:[b]};o.onAnnotationModify(d)}}},c=function(l,g){o.currentTool=="polygon"&&(o.currentAnnotation?n(l,g):E(l,g))},s=function(){o.currentTool=="polygon"&&o.onMouseUp()};return{onMouseDown:c,onMouseMove:function(){},onMouseUp:s,createElementsFunc:I}}},86089:function(y,x,e){"use strict";e.r(x),e.d(x,{MOST_HISTORY_STEPS:function(){return f}});var Z=e(57663),T=e(71577),R=e(34669),A=e(54458),L=e(2824),C=e(67294),I=e(54777),D=e.n(I),W=e(8088),o=e(61541),E=e(44434),n=e(58967),c=e(27992),s=e(5041),M=e(57436),l=e(14836),g=e(29919),u=e(43801),i=e(13931),t=e(85893),f=40,m=function(){var d=(0,C.useState)(void 0),O=(0,L.Z)(d,2),r=O[0],_=O[1],U=(0,C.useState)({color:"",name:""}),p=(0,L.Z)(U,2),z=p[0],J=p[1],rn=(0,C.useState)(),w=(0,L.Z)(rn,2),j=w[0],X=w[1],an=(0,C.useState)([]),V=(0,L.Z)(an,2),S=V[0],K=V[1],_n=(0,C.useState)(10),G=(0,L.Z)(_n,2),F=G[0],Q=G[1],sn=(0,C.useState)(1),q=(0,L.Z)(sn,2),Y=q[0],H=q[1],nn=function(a){a||H(1),a<.1||a>3?H(1):H(a)},B=function(a){X(a),a!=null&&a.label&&J(a.label)};(0,C.useEffect)(function(){localStorage.removeItem("history"),N([])},[]);function N(v,a){var P=localStorage.getItem("history"),h=P?JSON.parse(P):{index:-1,items:[]},tn={currentAnnotation:a,annotations:v};if(JSON.stringify(h.items[h.index])!=JSON.stringify(tn)){var cn=h.index>f?h.index-f:0,dn=h.items.splice(cn,h.index==0?1:h.index+1);h.items=dn.concat([tn]),h.index<=f?h.index++:h.index=f+1,localStorage.setItem("history",JSON.stringify(h))}}var ln=function(){var a=localStorage.getItem("history");if(!!a){var P=JSON.parse(a);if(!!P&&!(P.index>=P.items.length-1)){P.index++,localStorage.setItem("history",JSON.stringify(P));var h=P.items[P.index];X(h.currentAnnotation),K(h.annotations)}}},un=function(){var a=localStorage.getItem("history");if(!!a){var P=JSON.parse(a);if(!(!P||!P.index)&&!(P.index<=0)){P.index--,localStorage.setItem("history",JSON.stringify(P));var h=P.items[P.index];X(h.currentAnnotation),K(h.annotations)}}},$=function(a){for(var P=[],h=0;h<S.length;h++)S[h].annotationId==a.annotationId?P.push(a):P.push(S[h]);B(a),K(P)},en=(0,u.Z)({currentLabel:z,brushSize:F,currentTool:r,annotations:S,currentAnnotation:j,onAnnotationAdd:function(a){var P=S.concat([a]);K(P),j||B(a)},onAnnotationModify:$,onMouseUp:function(){N(S,j)}}),on=(0,i.Z)({currentLabel:z,brushSize:F,currentTool:r,annotations:S,currentAnnotation:j,onAnnotationAdd:function(a){var P=S.concat([a]);K(P),j||B(a)},onAnnotationModify:$,onMouseUp:function(){N(S,j)}}),k=r=="polygon"?on:en;return(0,t.jsxs)(W.Z,{className:D().segment,children:[(0,t.jsxs)(E.Z,{children:[(0,t.jsx)(g.Z,{active:r=="polygon",onClick:function(){_("polygon"),B(void 0)},children:"Polygon"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/edit.png",children:"Edit"}),(0,t.jsx)(n.Z,{size:F,active:r=="brush",onClick:function(){r!="rubber"&&r!="brush"&&B(void 0),_("brush")},onChange:function(a){Q(a)},children:"Brush"}),(0,t.jsx)(n.Z,{size:F,active:r=="rubber",onClick:function(){r!="rubber"&&r!="brush"&&B(void 0),_("rubber")},onChange:function(a){Q(a)},imgSrc:"./pics/buttons/rubber.png",children:"Rubber"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){nn(Y+.1)},children:"Zoom in"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){nn(Y-.1)},children:"Zoom out"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/save.png",children:"Save"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){_("mover")},children:"Move"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){un()},children:"Undo"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){ln()},children:"Redo"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:"Clear Mark"})]}),(0,t.jsxs)("div",{className:D().mainStage,children:[(0,t.jsx)("div",{className:D().draw,children:(0,t.jsx)(M.Z,{scale:Y,annotations:S,currentTool:r,currentAnnotation:j,setCurrentAnnotation:B,onAnnotationModify:$,onAnnotationModifyComplete:function(){N(S,j)},onMouseDown:k.onMouseDown,onMouseMove:k.onMouseMove,onMouseUp:k.onMouseUp,createPolygonFunc:on.createElementsFunc,createBrushFunc:en.createElementsFunc})}),(0,t.jsx)("div",{className:D().pblock,children:(0,t.jsx)("div",{className:D().progress,children:(0,t.jsx)(A.Z,{percent:50,status:"active"})})})]}),(0,t.jsxs)(E.Z,{disLoc:"right",children:[(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/intelligent_interaction.png",children:"Interactor"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Divide Data"}),(0,t.jsx)(c.Z,{imgSrc:"./pics/buttons/threshold.png",disLoc:"left",children:"Segment Threshold"}),(0,t.jsx)(c.Z,{imgSrc:"./pics/buttons/alpha.png",disLoc:"left",children:"Diaphaneity"}),(0,t.jsx)(c.Z,{imgSrc:"./pics/buttons/radius.png",disLoc:"left",children:"Visual Radius"})]}),(0,t.jsxs)("div",{className:D().rightSideBar,children:[(0,t.jsx)("div",{className:D().determinOutline,children:(0,t.jsx)(T.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){B(void 0)},children:"Determine Outline"})}),(0,t.jsx)(s.Z,{selectedLabel:z,onLabelSelect:function(a){J(a),B(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,t.jsx)(l.Z,{selectedAnnotation:j,annotations:S,onAnnotationSelect:function(a){a!=null&&a.delete||B(a)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(a){K(S.filter(function(P){return P.annotationId!=a.annotationId})),B(void 0)}})]})]})};x.default=m}}]);
