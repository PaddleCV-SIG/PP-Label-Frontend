(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(y,D,n){"use strict";n.d(D,{Z:function(){return L}});var E=n(94663),K=n(80112);function X(W){return Function.toString.call(W).indexOf("[native code]")!==-1}var Q=n(18597);function $(W,h,b){return(0,Q.Z)()?$=Reflect.construct:$=function(R,B,H){var u=[null];u.push.apply(u,B);var F=Function.bind.apply(R,u),C=new F;return H&&(0,K.Z)(C,H.prototype),C},$.apply(null,arguments)}function L(W){var h=typeof Map=="function"?new Map:void 0;return L=function(l){if(l===null||!X(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof h!="undefined"){if(h.has(l))return h.get(l);h.set(l,R)}function R(){return $(l,arguments,(0,E.Z)(this).constructor)}return R.prototype=Object.create(l.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),(0,K.Z)(R,l)},L(W)}},6277:function(y){y.exports={modal:"modal___26yNn"}},45092:function(y){y.exports={modal:"modal___1H_FQ"}},72285:function(y){y.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},85871:function(y,D,n){"use strict";var E=n(71194),K=n(50146),X=n(49111),Q=n(19650),$=n(57663),L=n(71577),W=n(13062),h=n(71230),b=n(89032),l=n(15746),R=n(77883),B=n(70507),H=n(34792),u=n(48086),F=n(9715),C=n(93766),N=n(2824),P=n(67294),t=n(48971),un=n(6277),U=n.n(un),d=n(85893),en=function(S){var w=(0,t.YB)(),an=(0,P.useState)(60),q=(0,N.Z)(an,2),j=q[0],nn=q[1],k=(0,P.useState)(20),Z=(0,N.Z)(k,2),Y=Z[0],v=Z[1],vn=(0,P.useState)(20),fn=(0,N.Z)(vn,2),tn=fn[0],mn=fn[1],e=(0,P.useState)(!1),o=(0,N.Z)(e,2),c=o[0],f=o[1],i=(0,t.YB)().formatMessage({id:"pages.toolBar.divideData"}),A=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.train"}),m=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.validation"}),r=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.test"}),_=(0,t.YB)().formatMessage({id:"component.PPCreater.cancel"}),g=(0,t.YB)().formatMessage({id:"component.PPSegMode.ok"}),I=C.Z.useForm(),x=(0,N.Z)(I,1),p=x[0];return(0,d.jsx)(K.Z,{className:U().modal,title:i,visible:S.visible,onCancel:S.onCancel,footer:null,children:(0,d.jsxs)(C.Z,{form:p,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(){if(j+Y+tn!=100){u.default.error("Train, Validation and Test total percent should equal 100!");return}console.log("x trainData: ".concat(j,", validationData: ").concat(Y,", testData: ").concat(tn,", props.project.curr.projectId: ").concat(S.project.curr.projectId)),f(!0),S.splitDataset(S.project.curr.projectId,{train:j*.01,validation:Y*.01,test:tn*.01}).then(function(){var M;console.log("success"),u.default.success(w.formatMessage({id:"component.PPDivideDataModal.success"})),(M=S.onFinish)===null||M===void 0||M.call(0)}).finally(function(){f(!1)})},autoComplete:"off",layout:"vertical",children:[(0,d.jsxs)(h.Z,{children:[(0,d.jsx)(l.Z,{span:8,children:(0,d.jsx)(C.Z.Item,{label:A,name:"train",children:(0,d.jsx)(B.Z,{addonAfter:"%",defaultValue:60,precision:0,min:0,max:100,value:j,onChange:nn})})}),(0,d.jsx)(l.Z,{span:8,children:(0,d.jsx)(C.Z.Item,{label:m,name:"validation",children:(0,d.jsx)(B.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:Y,onChange:v})})}),(0,d.jsx)(l.Z,{span:8,children:(0,d.jsx)(C.Z.Item,{label:r,name:"test",children:(0,d.jsx)(B.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:tn,onChange:mn})})})]}),(0,d.jsx)(C.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,d.jsxs)(Q.Z,{children:[(0,d.jsx)(L.Z,{onClick:function(){var M;(M=S.onCancel)===null||M===void 0||M.call(0),p.resetFields()},children:_}),(0,d.jsx)(L.Z,{type:"primary",htmlType:"submit",loading:c,children:g})]})})]})})};D.Z=en},62850:function(y,D,n){"use strict";var E=n(71194),K=n(50146),X=n(49111),Q=n(19650),$=n(57663),L=n(71577),W=n(47673),h=n(24044),b=n(34792),l=n(48086),R=n(9715),B=n(93766),H=n(2824),u=n(67294),F=n(48971),C=n(45092),N=n.n(C),P=n(85893),t=function(U){var d=(0,F.YB)(),en=(0,u.useState)(!1),on=(0,H.Z)(en,2),S=on[0],w=on[1],an=(0,F.YB)().formatMessage({id:"component.PPCreater.cancel"}),q=B.Z.useForm(),j=(0,H.Z)(q,1),nn=j[0];return(0,P.jsx)(K.Z,{className:N().modal,title:(0,F.YB)().formatMessage({id:"component.PPExportModal.title"}),visible:U.visible,onCancel:U.onCancel,footer:null,children:(0,P.jsxs)(B.Z,{form:nn,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(Z){console.log(Z);var Y=Z.path;if(!Y){l.default.error(d.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}w(!0),U.exportDataset(U.project.curr.projectId,Y).then(function(){var v;l.default.success(d.formatMessage({id:"component.PPExportModal.exportSuccess"})),(v=U.onFinish)===null||v===void 0||v.call(0)}).finally(function(){w(!1)})},autoComplete:"off",children:[(0,P.jsx)(B.Z.Item,{label:d.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,P.jsx)(h.Z,{})}),(0,P.jsx)(B.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,P.jsxs)(Q.Z,{children:[(0,P.jsx)(L.Z,{onClick:function(){var Z;(Z=U.onCancel)===null||Z===void 0||Z.call(0),nn.resetFields()},children:an}),(0,P.jsx)(L.Z,{type:"primary",htmlType:"submit",loading:S,children:d.formatMessage({id:"component.PPExportModal.export"})})]})})]})})};D.Z=t},33549:function(y,D,n){"use strict";n.r(D),n.d(D,{default:function(){return mn}});var E=n(11849),K=n(20228),X=n(11382),Q=n(34669),$=n(54458),L=n(34792),W=n(48086),h=n(91220),b=n(2824),l=n(67294),R=n(72285),B=n.n(R),H=n(8088),u=n(61541),F=n(44434),C=n(5041),N=n(57436),P=n(14836),t=n(85893),un=function(o){return(0,t.jsx)(u.Z,{active:o.active,imgSrc:o.imgSrc||"./pics/buttons/rectangle.png",onClick:o.onClick,children:o.children})},U=un,d=n(65031);function en(e){var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null}function on(e){if(!(!e||e.length<2))return{xmin:e[0],ymin:e[1],xmax:e[2]||void 0,ymax:e[3]||void 0}}function S(e,o,c,f,i,A,m){if(!e||!e.points||!e.label||!e.label.color)return[(0,t.jsx)(t.Fragment,{})];var r=e.points,_=e.label.color,g=en(_);if(!g)return[(0,t.jsx)(t.Fragment,{})];var I=(m==null?void 0:m.annotationId)==e.annotationId,x=I?.5:.1,p=r.xmax!=null&&r.ymax!=null?(0,t.jsx)(d.UL,{onMouseOver:function(){i=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){i=="mover"&&A(e)},stroke:_,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",x:r.xmin,y:r.ymin,width:r.xmax-r.xmin,height:r.ymax-r.ymin,closed:!0,fill:"rgba(".concat(g.r,", ").concat(g.g,", ").concat(g.b,", ").concat(x,")")}):(0,t.jsx)(t.Fragment,{});function z(M){if(!M&&(r.xmax==null||r.ymax==null))return(0,t.jsx)(t.Fragment,{});var rn=function(O){if(i=="editor"){var _n=O.target.x(),sn=O.target.y();M?(r.xmin=_n,r.ymin=sn):(r.xmax=_n,r.ymax=sn);var T=(0,E.Z)((0,E.Z)({},e),{},{points:r});o(T)}};return(0,t.jsx)(d.Cd,{onMouseDown:function(){(i=="editor"||i=="mover")&&A(e)},draggable:i=="editor",onDragMove:rn,onDragEnd:rn,onMouseOver:function(){i=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},x:M?r.xmin:r.xmax,y:M?r.ymin:r.ymax,radius:5,fill:_})}return[(0,t.jsxs)(d.ZA,{children:[p,z(!0),z(!1)]},e.annotationId)]}function w(e){var o=1;if(!e||e.length==0)return o;var c=(0,h.Z)(e),f;try{for(c.s();!(f=c.n()).done;){var i=f.value;i.frontendId&&o<=i.frontendId&&(o=i.frontendId+1)}}catch(A){c.e(A)}finally{c.f()}return o}function an(e){var o=function(m,r,_,g){var I=(m.evt.offsetX+r)/g,x=(m.evt.offsetY+_)/g,p=on([I,x]);!p||e.onAnnotationAdd({frontendId:w(e.annotations),type:"rectangle",label:e.currentLabel,points:p})},c=function(m,r,_,g){if(!(!e.currentAnnotation||!e.currentAnnotation.points)){var I=(m.evt.offsetX+r)/g,x=(m.evt.offsetY+_)/g,p=e.currentAnnotation.points;if(!!p){p.xmax=I,p.ymax=x;var z={type:"rectangle",frontendId:e.currentAnnotation.frontendId,label:e.currentAnnotation.label,points:p};e.onAnnotationModify(z)}}},f=function(m,r,_,g){e.currentTool=="rectangle"&&(e.currentAnnotation?c(m,r,_,g):o(m,r,_,g))},i=function(){e.currentTool=="rectangle"&&e.onMouseUp()};return{onMouseDown:f,onMouseMove:function(){},onMouseUp:i,createElementsFunc:S}}var q=n(64322),j=40;function nn(){localStorage.removeItem("history"),k([])}function k(e){var o=localStorage.getItem("history"),c=o?JSON.parse(o):{index:-1,items:[]};if(JSON.stringify(c.items[c.index])!=JSON.stringify(e)){var f=c.index>j?c.index-j:0,i=c.items.splice(f,c.index==0?1:c.index+1);c.items=i.concat([e]),c.index<=j?c.index++:c.index=j+1,localStorage.setItem("history",JSON.stringify(c))}}function Z(){var e=localStorage.getItem("history");if(!!e){var o=JSON.parse(e);if(!!o&&!(o.index>=o.items.length-1))return o.index++,localStorage.setItem("history",JSON.stringify(o)),o.items[o.index]}}function Y(){var e=localStorage.getItem("history");if(!!e){var o=JSON.parse(e);if(!(!o||!o.index)&&!(o.index<=0))return o.index--,localStorage.setItem("history",JSON.stringify(o)),o.items[o.index]}}var v=n(48971),vn=n(85871),fn=n(62850),tn=function(){var o,c=(0,q.$L)(l.useState,l.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:nn}}),f=(0,b.Z)(c,10),i=f[0],A=f[1],m=f[2],r=f[3],_=f[4],g=f[5],I=f[6],x=f[7],p=f[8],z=f[9],M=(0,l.useState)(),rn=(0,b.Z)(M,2),J=rn[0],O=rn[1],_n=(0,l.useState)([]),sn=(0,b.Z)(_n,2),T=sn[0],ln=sn[1],yn=(0,l.useState)(!1),xn=(0,b.Z)(yn,2),hn=xn[0],gn=xn[1],Cn=(0,l.useState)(!1),Dn=(0,b.Z)(Cn,2),An=Dn[0],Mn=Dn[1],In=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));T.push(a),ln(T),O(a)},Bn=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));var G=[],V=(0,h.Z)(T),dn;try{for(V.s();!(dn=V.n()).done;){var cn=dn.value;cn.frontendId==a.frontendId?G.push(a):G.push(cn)}}catch(Pn){V.e(Pn)}finally{V.f()}console.log("modifyAnnotation, newAnnos:",G,"anno:",a),ln(G),O(a)},Sn=function(a){if(!a.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(a));var G=[],V=(0,h.Z)(T),dn;try{for(V.s();!(dn=V.n()).done;){var cn=dn.value;cn.frontendId!=a.frontendId&&G.push(cn)}}catch(Pn){V.e(Pn)}finally{V.f()}ln(G),O(void 0)},Jn=function(a){!a||(console.log("modifyAnnotation",a,"anno.label:",a==null?void 0:a.label),a.taskId=_.curr.taskId,a.dataId=g.curr.dataId,r.modify(a))},pn=function(a){console.log("onAnnotationModify"),Bn(a)},On=an({currentLabel:x.curr,currentTool:i.curr,annotations:T,currentAnnotation:J,onAnnotationAdd:In,onAnnotationModify:pn,onMouseUp:function(){k({annos:T,currAnno:J})}}),En=On,jn=(0,v.YB)().formatMessage({id:"pages.toolBar.rectangle"}),Zn=(0,v.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),Tn=(0,v.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),Ln=(0,v.YB)().formatMessage({id:"pages.toolBar.move"}),Rn=(0,v.YB)().formatMessage({id:"pages.toolBar.unDo"}),Un=(0,v.YB)().formatMessage({id:"pages.toolBar.reDo"}),Kn=(0,v.YB)().formatMessage({id:"pages.toolBar.save"}),Wn=(0,v.YB)().formatMessage({id:"pages.toolBar.edit"}),bn=(0,v.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Fn=(0,v.YB)().formatMessage({id:"pages.toolBar.undef"}),Nn=(0,v.YB)().formatMessage({id:"pages.toolBar.divideData"}),Yn=(0,v.YB)().formatMessage({id:"pages.toolBar.export"});return(0,t.jsxs)(H.Z,{className:B().det,children:[(0,t.jsxs)(F.Z,{children:[(0,t.jsx)(U,{active:i.curr=="rectangle",onClick:function(){if(!x.curr){W.default.error("Please choose a label category first!");return}i.setCurr("rectangle"),O(void 0)},children:jn}),(0,t.jsx)(u.Z,{active:i.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){i.setCurr("editor")},children:Wn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){m.change(.1)},children:Zn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){m.change(-.1)},children:Tn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){W.default.info("Annotations are saved automatically. You don't need to click save.")},children:Kn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/move.png",active:i.curr=="mover",onClick:function(){i.setCurr("mover")},children:Ln}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var a=Y();!a||(O(a.currAnno),ln(a.annos))},children:Rn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var a=Z();!a||(O(a.currAnno),ln(a.annos))},children:Un}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:bn})]}),(0,t.jsx)("div",{id:"dr",className:"mainStage",children:(0,t.jsxs)(X.Z,{tip:"loading",spinning:!!A.curr,children:[(0,t.jsx)("div",{className:"draw",children:(0,t.jsx)(N.Z,{scale:m.curr,annotations:T,currentTool:i.curr,currentAnnotation:J,setCurrentAnnotation:O,onAnnotationModify:pn,onAnnotationModifyComplete:function(){k({annos:T,currAnno:J})},onMouseDown:En.onMouseDown,onMouseMove:En.onMouseMove,onMouseUp:En.onMouseUp,createRectangleFunc:On.createElementsFunc,imgSrc:g.imgSrc})}),(0,t.jsx)("div",{className:"pblock",children:(0,t.jsxs)("div",{className:"progress",children:[(0,t.jsx)($.Z,{className:"progressBar",percent:I.progress,status:"active",showInfo:!1})," ",(0,t.jsxs)("span",{className:"progressDesc",children:["Current labeling ",_.currIdx==null?1:_.currIdx+1," of"," ",(o=_.all)===null||o===void 0?void 0:o.length,". Already labeled ",_.finished(I.progress)||0,"."]})]})}),(0,t.jsx)("div",{className:"prevTask",onClick:_.prevTask}),(0,t.jsx)("div",{className:"nextTask",onClick:_.nextTask})]})}),(0,t.jsxs)(F.Z,{disLoc:"right",children:[(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){gn(!0)},children:Nn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){Mn(!0)},children:Yn}),(0,t.jsx)(u.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){O(void 0)},children:Fn})]}),(0,t.jsxs)("div",{className:"rightSideBar",children:[(0,t.jsx)(C.Z,{labels:x.all,activeIds:x.activeIds,onLabelSelect:function(a){x.onSelect(a),O(void 0)},onLabelModify:function(){},onLabelDelete:x.remove,onLabelAdd:function(a){return x.create((0,E.Z)((0,E.Z)({},a),{},{projectId:I.curr.projectId}))}}),(0,t.jsx)(P.Z,{annotations:T,currAnnotation:J,onAnnotationSelect:O,onAnnotationAdd:function(){O(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(a){Sn(a)}})]}),(0,t.jsx)(vn.Z,{visible:hn,splitDataset:p,project:I,onCancel:function(){gn(!1)},onFinish:function(){gn(!1)}}),(0,t.jsx)(fn.Z,{visible:An,exportDataset:z,project:I,onCancel:function(){Mn(!1)},onFinish:function(){Mn(!1)}})]})},mn=tn},15746:function(y,D,n){"use strict";var E=n(21584);D.Z=E.Z},89032:function(y,D,n){"use strict";var E=n(38663),K=n.n(E),X=n(6999)},71230:function(y,D,n){"use strict";var E=n(92820);D.Z=E.Z},13062:function(y,D,n){"use strict";var E=n(38663),K=n.n(E),X=n(6999)}}]);
