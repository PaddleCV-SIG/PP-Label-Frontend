(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{85024:function(S){S.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(S){S.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},71212:function(S){S.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},14836:function(S,b,t){"use strict";t.d(b,{Z:function(){return P}});var N=t(54421),I=t(38272),j=t(57663),h=t(71577),E=t(67294),g=t(56159),p=t.n(g),L=t(49111),R=t(19650),n=t(2824),l=t(11849),M=t(85024),f=t.n(M),x=t(63097),a=t(85893),A=function(d){var s=(0,l.Z)({},d.annotation),y=(0,E.useState)(s.invisible),v=(0,n.Z)(y,2),m=v[0],C=v[1],W=(0,E.useState)(0),U=(0,n.Z)(W,2),Y=U[0],H=U[1];(0,E.useEffect)(function(){C(d.annotation.invisible)},[d.annotation.invisible]);var k=(0,a.jsxs)(I.ZP.Item,{className:"".concat(f().listItem," ").concat(d.active?f().listItemActive:""),unselectable:"on",onClick:function(){d.onClick(s)},children:[(0,a.jsxs)(R.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:f().eye,style:{backgroundImage:m?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(Z){Z.stopPropagation(),C(!m),d.onAnnotationModify(s)}})," ",(0,a.jsx)("span",{className:f().annotationId,children:s.frontendId}),(0,a.jsx)("span",{className:f().labelName,children:s.label.name}),(0,a.jsx)(x.Z,{color:s.label.color})]}),(0,a.jsx)("a",{className:f().delete,onClick:function(Z){Z.stopPropagation();var F=new Date().getTime();F-Y<300||(H(F),d.onAnnotationDelete(s))}})]});return k},i=A,o=t(48971),_=function(d){var s=(0,o.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),y=(0,o.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(I.ZP,{className:p().labelList,size:"large",header:(0,a.jsx)("div",{className:p().listHeader,children:s}),bordered:!0,dataSource:d.annotations,renderItem:function(m){var C;return(0,a.jsx)(i,{onClick:d.onAnnotationSelect,annotation:m,active:m.frontendId==((C=d.currAnnotation)===null||C===void 0?void 0:C.frontendId),onAnnotationDelete:d.onAnnotationDelete,onAnnotationModify:d.onAnnotationModify})},footer:(0,a.jsx)("div",{children:(0,a.jsx)(h.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){d.onAnnotationAdd()},block:!0,children:y})})})})},P=_},13931:function(S,b,t){"use strict";t.d(b,{Z:function(){return R}});var N=t(91220),I=t(11849),j=t(65031),h=t(85893);function E(n){var l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return l?{r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)}:null}function g(n,l){if(!(!n||!l))return{color:n,points:l}}function p(n){if(!n.annotation||!n.annotation.points||!n.annotation.points[0])return[(0,h.jsx)(h.Fragment,{})];var l=n.annotation.points[0].points,M=n.annotation.points[0].color,f=E(M);if(!f)return[(0,h.jsx)(h.Fragment,{})];var x=.3,a=void 0,A=[];return l.forEach(function(i,o){if(!a){a=i;return}A.push((0,h.jsx)(j.Cd,{onMouseDown:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},draggable:n.currentTool=="editor",onDragMove:function(P){var O;P.cancelBubble=!0;var d=(O=n.stageRef)===null||O===void 0?void 0:O.current,s=d.findOne(".baseImage"),y=!1,v=P.target.x();v>s.width()/2&&(v=s.width()/2,y=!0),v<-s.width()/2&&(v=-s.width()/2,y=!0);var m=P.target.y();m>s.height()/2&&(m=s.height()/2,y=!0),m<-s.height()/2&&(m=-s.height()/2,y=!0),y&&P.target.setPosition({x:v,y:m}),l[o-1]=v,l[o]=m;var C=(0,I.Z)((0,I.Z)({},n.annotation),{},{points:[{color:M,points:l}]});n.onDrag(C)},onMouseOver:function(){n.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},x:a,y:i,radius:5/n.scale,fill:M})),a=void 0}),[(0,h.jsxs)(j.ZA,{children:[(0,h.jsx)(j.x1,{onMouseOver:function(){n.currentTool=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){n.currentTool=="editor"&&n.onSelect(n.annotation)},stroke:M,strokeWidth:2/n.scale,globalCompositeOperation:"source-over",lineCap:"round",points:l,tension:0,closed:!0,fill:"rgba(".concat(f.r,", ").concat(f.g,", ").concat(f.b,", ").concat(x,")")}),A]},n.annotation.frontendId)]}function L(n){var l=0,M=(0,N.Z)(n),f;try{for(M.s();!(f=M.n()).done;){var x=f.value;!x||!x.frontendId||x.frontendId>l&&(l=x.frontendId)}}catch(a){M.e(a)}finally{M.f()}return l}function R(n){var l=function(A,i,o,_){var P,O=(A.evt.offsetX+i)/_,d=(A.evt.offsetY+o)/_,s=g((P=n.currentLabel)===null||P===void 0?void 0:P.color,[O,d]);!s||n.onAnnotationAdd({type:"polygon",frontendId:L(n.annotations)+1,label:n.currentLabel,points:[s]})},M=function(A,i,o,_){var P,O;if(!!n.currentAnnotation){var d=(A.evt.offsetX+i)/_,s=(A.evt.offsetY+o)/_,y=n.currentAnnotation.points||[],v=g((P=n.currentLabel)===null||P===void 0?void 0:P.color,(O=y[0])===null||O===void 0?void 0:O.points.concat([d,s]));if(!!v){var m={type:"polygon",frontendId:n.currentAnnotation.frontendId,label:n.currentAnnotation.label,points:[v]};n.onAnnotationModify(m)}}},f=function(A,i,o,_){n.currentTool=="polygon"&&(n.currentAnnotation?M(A,i,o,_):l(A,i,o,_))},x=function(){n.currentTool=="polygon"&&n.onMouseUp()};return{onMouseDown:f,onMouseMove:function(){},onMouseUp:x,createElementsFunc:p}}},29919:function(S,b,t){"use strict";var N=t(67294),I=t(61541),j=t(85893),h=function(g){return(0,j.jsx)(I.Z,{active:g.active,imgSrc:g.imgSrc||"./pics/buttons/polygon.png",onClick:g.onClick,children:g.children})};b.Z=h},82881:function(S,b,t){"use strict";t.r(b);var N=t(57663),I=t(71577),j=t(34669),h=t(54458),E=t(2824),g=t(67294),p=t(71212),L=t.n(p),R=t(8088),n=t(61541),l=t(44434),M=t(5041),f=t(57436),x=t(14836),a=t(29919),A=t(13931),i=t(48971),o=t(85893),_=40,P=function(){var d,s=(0,g.useState)(void 0),y=(0,E.Z)(s,2),v=y[0],m=y[1],C=(0,g.useState)({color:"",name:""}),W=(0,E.Z)(C,2),U=W[0],Y=W[1],H=(0,g.useState)(),k=(0,E.Z)(H,2),B=k[0],Z=k[1],F=(0,g.useState)([]),Q=(0,E.Z)(F,2),D=Q[0],K=Q[1],tn=(0,g.useState)(1),w=(0,E.Z)(tn,2),z=w[0],J=w[1],G=function(e){e||J(1),e<.1||e>3?J(1):J(e)},T=function(e){Z(e),e!=null&&e.label&&Y(e.label)};(0,g.useEffect)(function(){localStorage.removeItem("history"),X([])},[]);function X(c,e){var r=localStorage.getItem("history"),u=r?JSON.parse(r):{index:-1,items:[]},nn={currentAnnotation:e,annotations:c};if(JSON.stringify(u.items[u.index])!=JSON.stringify(nn)){var Pn=u.index>_?u.index-_:0,Mn=u.items.splice(Pn,u.index==0?1:u.index+1);u.items=Mn.concat([nn]),u.index<=_?u.index++:u.index=_+1,localStorage.setItem("history",JSON.stringify(u))}}var on=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!!r&&!(r.index>=r.items.length-1)){r.index++,localStorage.setItem("history",JSON.stringify(r));var u=r.items[r.index];Z(u.currentAnnotation),K(u.annotations)}}},en=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!(!r||!r.index)&&!(r.index<=0)){r.index--,localStorage.setItem("history",JSON.stringify(r));var u=r.items[r.index];Z(u.currentAnnotation),K(u.annotations)}}},V=function(e){for(var r=[],u=0;u<D.length;u++)D[u].annotationId==e.annotationId?r.push(e):r.push(D[u]);T(e),K(r)},q=(0,A.Z)({currentLabel:U,currentTool:v,annotations:D,currentAnnotation:B,onAnnotationAdd:function(e){var r=D.concat([e]);K(r),B||T(e)},onAnnotationModify:V,onMouseUp:function(){X(D,B)}}),$=q,an=(0,i.YB)().formatMessage({id:"pages.toolBar.polygon"}),rn=(0,i.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),sn=(0,i.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),ln=(0,i.YB)().formatMessage({id:"pages.toolBar.move"}),dn=(0,i.YB)().formatMessage({id:"pages.toolBar.unDo"}),cn=(0,i.YB)().formatMessage({id:"pages.toolBar.reDo"}),un=(0,i.YB)().formatMessage({id:"pages.toolBar.save"}),_n=(0,i.YB)().formatMessage({id:"pages.toolBar.edit"}),fn=(0,i.YB)().formatMessage({id:"pages.toolBar.clearMark"}),vn=(0,i.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),mn=(0,i.YB)().formatMessage({id:"pages.toolBar.divideData"}),gn=(0,i.YB)().formatMessage({id:"pages.toolBar.export"});return(0,o.jsxs)(R.Z,{className:L().key,children:[(0,o.jsxs)(l.Z,{children:[(0,o.jsx)(a.Z,{active:v=="polygon",onClick:function(){m("polygon"),T(void 0)},children:an}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/edit.png",children:_n}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){G(z+.1)},children:rn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){G(z-.1)},children:sn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/save.png",children:un}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){m("mover")},children:ln}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){en()},children:dn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){on()},children:cn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:fn})]}),(0,o.jsxs)("div",{id:"dr",className:L().mainStage,children:[(0,o.jsx)("div",{className:L().draw,children:(0,o.jsx)(f.Z,{width:(d=document.getElementById("dr"))===null||d===void 0?void 0:d.clientWidth,scale:z,annotations:D,currentTool:v,currentAnnotation:B,setCurrentAnnotation:T,onAnnotationModify:V,onAnnotationModifyComplete:function(){X(D,B)},onMouseDown:$.onMouseDown,onMouseMove:$.onMouseMove,onMouseUp:$.onMouseUp,createPolygonFunc:q.createElementsFunc})}),(0,o.jsx)("div",{className:L().pblock,children:(0,o.jsx)("div",{className:L().progress,children:(0,o.jsx)(h.Z,{percent:50,status:"active"})})})]}),(0,o.jsxs)(l.Z,{disLoc:"right",children:[(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/data_division.png",children:mn}),(0,o.jsx)(n.Z,{imgSrc:"./pics/buttons/export.png",children:gn})]}),(0,o.jsxs)("div",{className:L().rightSideBar,children:[(0,o.jsx)("div",{className:L().finished,children:(0,o.jsx)(I.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){T(void 0)},children:vn})}),(0,o.jsx)(M.Z,{selectedLabel:U,onLabelSelect:function(e){Y(e),T(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,o.jsx)(x.Z,{selectedAnnotation:B,annotations:D,onAnnotationSelect:function(e){e!=null&&e.delete||T(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){K(D.filter(function(r){return r.annotationId!=e.annotationId})),T(void 0)}})]})]})};b.default=P}}]);
