(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{52822:function(r){r.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(r){r.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(r){r.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(r){r.exports={container:"container___G0FNe"}},83930:function(r){r.exports={stage:"stage___3H5QL"}},80961:function(r){r.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(r){r.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(r){r.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(r,O,e){"use strict";var R=e(20136),P=e(55241),B=e(2824),m=e(67294),c=e(52822),u=e.n(c),A=e(63144),v=e(85893),s=function(S){var d=(0,m.useState)(S.color||"#FFF"),n=(0,B.Z)(d,2),L=n[0],a=n[1];return(0,m.useEffect)(function(){a(S.color||"#FFF")},[S]),S.changeable?(0,v.jsx)(P.Z,{getPopupContainer:function(j){return j.parentElement||document.body},overlayClassName:u().popover,openClassName:u().popoverOpenClassName,placement:"bottom",content:(0,v.jsx)(A.xS,{disableAlpha:!0,color:L,onChange:function(j){a(j.hex)},onChangeComplete:S.onChange}),trigger:"click",children:(0,v.jsx)("div",{className:u().roundBall,style:{backgroundColor:L}})}):(0,v.jsx)("div",{className:u().roundBall,style:{backgroundColor:L}})};O.Z=s},5041:function(r,O,e){"use strict";e.d(O,{Z:function(){return N}});var R=e(54421),P=e(38272),B=e(57663),m=e(71577),c=e(2824),u=e(67294),A=e(56131),v=e.n(A),s=e(49111),K=e(19650),S=e(11849),d=e(5882),n=e.n(d),L=e(63097),a=e(85893),E=function(t){var _=(0,S.Z)({},t.label),x=(0,u.useState)(_.invisible),b=(0,c.Z)(x,2),h=b[0],f=b[1],I=(0,a.jsx)(P.ZP.Item,{className:"".concat(n().listItem," ").concat(_.active?n().listItemActive:""),unselectable:"on",onClick:function(){t.onClick(_)},children:(0,a.jsxs)(K.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:n().eye,style:{backgroundImage:h?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){f(!h),t.onLabelModify(_)}})," ",_.name,(0,a.jsx)(L.Z,{color:_.color,changeable:!0,onChange:function(C){_.color=C.hex,t.onLabelModify(_)}}),(0,a.jsx)("a",{className:n().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){t.onLabelDelete(_)}})]})});return I},j=E,Y=e(71194),H=e(50146),z=e(47673),g=e(24044),$=e(9715),Z=e(93766),l=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],Q=function(t){var _,x,b=(0,u.useState)(((_=t.defaultLabel)===null||_===void 0?void 0:_.color)||l[t.order||0]),h=(0,c.Z)(b,2),f=h[0],I=h[1];(0,u.useEffect)(function(){var U;I(((U=t.defaultLabel)===null||U===void 0?void 0:U.color)||l[t.order||0])},[t]);var o=Z.Z.useForm(),C=(0,c.Z)(o,1),X=C[0];return(0,a.jsx)(H.Z,{title:"Add Label",visible:t.visible,onCancel:t.onCancel,footer:null,children:(0,a.jsxs)(Z.Z,{form:X,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(x=t.defaultLabel)===null||x===void 0?void 0:x.name},onFinish:function(F){var T={name:F.labelname,color:f};t.onLabelAdd(T),X.resetFields()},autoComplete:"off",children:[(0,a.jsx)(Z.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,a.jsx)(g.Z,{})}),(0,a.jsx)(Z.Z.Item,{label:"Select Color",name:"color",children:(0,a.jsx)(L.Z,{color:f,onChange:function(F){I(F.hex)}})}),(0,a.jsx)(Z.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsxs)(K.Z,{children:[(0,a.jsx)(m.Z,{onClick:function(){var F;(F=t.onCancel)===null||F===void 0||F.call(0),X.resetFields()},children:"\u53D6\u6D88"}),(0,a.jsx)(m.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},p=Q,J=function(t){var _,x=(0,u.useState)(!1),b=(0,c.Z)(x,2),h=b[0],f=b[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.ZP,{className:v().labelList,size:"large",header:(0,a.jsx)("div",{className:v().listHeader,children:"Label List"}),footer:(0,a.jsx)("div",{children:(0,a.jsx)(m.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){f(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:t.labels,renderItem:function(o){return(0,a.jsx)(j,{onClick:t.onLabelSelect,label:o,onLabelDelete:t.onLabelDelete,onLabelModify:t.onLabelModify})}}),(0,a.jsx)(p,{order:(_=t.labels)===null||_===void 0?void 0:_.length,visible:h,onLabelAdd:function(o){t.onLabelAdd(o),f(!1)},onCancel:function(){f(!1)}})]})},N=J},8088:function(r,O,e){"use strict";var R=e(67294),P=e(78677),B=e.n(P),m=e(85893),c=function(A){return(0,m.jsx)("div",{className:"".concat(B().container," ").concat(A.className),children:A.children})};O.Z=c},57436:function(r,O,e){"use strict";var R=e(91220),P=e(2824),B=e(67294),m=e(65031),c=e(84420),u=e.n(c),A=e(83930),v=e.n(A),s=e(85893),K="./pics/basketball.jpg",S=function(n){var L=u()(n.imgSrc||""),a=(0,P.Z)(L,1),E=a[0],j=(E==null?void 0:E.width)||0,Y=(E==null?void 0:E.height)||0,H=(0,B.useState)(),z=(0,P.Z)(H,2),g=z[0],$=z[1],Z=(0,B.useState)(),l=(0,P.Z)(Z,2),Q=l[0],p=l[1],J=(0,B.useState)({x:0,y:0}),N=(0,P.Z)(J,2),W=N[0],t=N[1];function _(){var o=document.getElementById("dr");o&&($(o.clientWidth),p(o.clientHeight))}(0,B.useEffect)(function(){window.removeEventListener("resize",_),window.addEventListener("resize",_);var o=document.getElementById("dr");o&&($(o.clientWidth),p(o.clientHeight),t({x:o.clientWidth/2,y:o.clientHeight/2}))},[]);var x=[];if(n.annotations){var b=(0,R.Z)(n.annotations),h;try{for(b.s();!(h=b.n()).done;){var f=h.value;if(!!f){var I=f.tool=="polygon"?n.createPolygonFunc:n.createBrushFunc;I&&x.push(I(f,n.onAnnotationModify,n.onAnnotationModifyComplete,n.scale,n.currentTool,n.setCurrentAnnotation,n.currentAnnotation))}}}catch(o){b.e(o)}finally{b.f()}}return(0,s.jsx)(m.Hf,{width:g,height:Q,className:v().stage,children:(0,s.jsx)(m.mh,{onMouseDown:function(C){n.onMouseDown&&n.onMouseDown(C,n.scale)},onMouseMove:function(C){n.onMouseMove&&n.onMouseMove(C,n.scale)},onMouseUp:function(C){n.onMouseUp&&n.onMouseUp(C,n.scale)},onContextMenu:function(C){C.evt.preventDefault()},draggable:!1,children:(0,s.jsxs)(m.ZA,{draggable:n.currentTool=="mover",onDragEnd:function(C){},children:[(0,s.jsx)(m.Ee,{draggable:!1,image:E,x:W.x,y:W.y,offsetX:j/2,offsetY:Y/2,scaleX:n.scale,scaleY:n.scale}),x]})})})};O.Z=S},44434:function(r,O,e){"use strict";var R=e(67294),P=e(80961),B=e.n(P),m=e(85893),c=function(A){var v=B().leftToolbar;return A.disLoc=="right"&&(v=B().rightToolbar),(0,m.jsx)("div",{className:v,children:A.children})};O.Z=c},61541:function(r,O,e){"use strict";var R=e(49111),P=e(19650),B=e(67294),m=e(82499),c=e.n(m),u=e(85893),A=function(s){return(0,u.jsx)("div",{unselectable:"on",className:"".concat(c().toolBarButtonContainerWrapper," ").concat(s.active&&c().toolBarButtonContainerWrapperActive),onClick:s.onClick,children:(0,u.jsx)(P.Z,{align:"center",className:c().toolBarButtonContainer,size:0,children:(0,u.jsxs)(P.Z,{align:"center",direction:"vertical",className:c().toolBarButton,size:0,children:[(0,u.jsx)("img",{src:s.imgSrc}),(0,u.jsx)("div",{className:c().buttonText,children:s.children})]})})})};O.Z=A},29214:function(r,O,e){"use strict";e.r(O);var R=e(20228),P=e(11382),B=e(34669),m=e(54458),c=e(3182),u=e(86582),A=e(34792),v=e(48086),s=e(2824),K=e(94043),S=e.n(K),d=e(67294),n=e(73199),L=e.n(n),a=e(8088),E=e(61541),j=e(44434),Y=e(5041),H=e(57436),z=e(3275),g=e(91156),$=e(37071),Z=e(64322),l=e(85893),Q=localStorage.getItem("basePath"),p=function(){var N=(0,d.useState)(),W=(0,s.Z)(N,2),t=W[0],_=W[1],x=(0,d.useState)(),b=(0,s.Z)(x,2),h=b[0],f=b[1],I=(0,d.useState)(),o=(0,s.Z)(I,2),C=o[0],X=o[1],U=(0,d.useState)(0),F=(0,s.Z)(U,2),T=F[0],oe=F[1],fe=(0,d.useState)(),se=(0,s.Z)(fe,2),le=se[0],Ce=se[1],Le=(0,d.useState)(),re=(0,s.Z)(Le,2),Qe=re[0],ge=re[1],Me=(0,d.useState)(),_e=(0,s.Z)(Me,2),Xe=_e[0],De=_e[1],he=(0,d.useState)(),ie=(0,s.Z)(he,2),be=ie[0],Oe=ie[1],Be=(0,d.useState)(),ue=(0,s.Z)(Be,2),Ae=ue[0],Ie=ue[1],Se=(0,d.useState)({color:"",name:""}),de=(0,s.Z)(Se,2),xe=de[0],Te=de[1],je=(0,d.useState)("mover"),ce=(0,s.Z)(je,2),Fe=ce[0],Ze=ce[1],We=(0,d.useState)(0),me=(0,s.Z)(We,2),Ue=me[0],Re=me[1],ye=(0,d.useState)(""),ve=(0,s.Z)(ye,2),Ke=ve[0],pe=ve[1],Ne=(0,d.useState)(!1),Pe=(0,s.Z)(Ne,2),ke=Pe[0],w=Pe[1],q=(0,Z._D)(d.useState),He=function(){if(console.log("turning next ",T,C.length),T+1>=C.length){v.default.error("This is the last task.");return}oe(T+1)},ze=function(){if(console.log("turning prev ",T,C.length),T-1<0){v.default.error("This is the first task.");return}oe(T-1)},$e=function(D){var V=(0,u.Z)(h);if(V[(0,g.cq)(D,h,"name")].active=!D.active,D.active){var y=Ae.filter(function(k){return k.labelId==D.labelId})[0];console.log("filter ann ",y),g.A9.remove(y.annotationId)}else console.log("add ann",{taskId:le.taskId,labelId:D.labelId}),g.A9.create({taskId:le.taskId,labelId:D.labelId,dataId:be.dataId}).catch(function(k){console.log("err",k)});f(V),Te(D)};return(0,d.useEffect)(function(){function M(){return D.apply(this,arguments)}function D(){return D=(0,c.Z)(S().mark(function V(){var y,k,Ee,ee,ne,G,te;return S().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,w(!0),t){i.next=17;break}return i.next=5,(0,z.refreshProject)();case 5:return y=i.sent,i.next=8,g.F$.getTasks(y.projectId);case 8:return k=i.sent,i.next=11,g.F$.getLabels(y.projectId);case 11:return Ee=i.sent,f((0,g.gu)(Ee)),X(k),_(y),w(!1),i.abrupt("return");case 17:return(0,g.xC)(t.projectId).then(function(ae){Re(ae)}),Ce(C[T]),ee=C[T].taskId,g.Qp.getAnnotations(ee).then(function(ae){De(ae)}),i.next=23,g.Qp.getDatas(ee);case 23:return ne=i.sent,ge(ne),G=ne[0],Oe(G),i.next=29,g.Bl.getAnnotations(G.dataId);case 29:te=i.sent,Ie(te),f((0,g.JZ)(h,te)),pe("".concat(Q,"/datas/").concat(G.dataId,"/image")),console.log("hereraasdf",h),w(!1),i.next=41;break;case 37:i.prev=37,i.t0=i.catch(0),console.log(i.t0),$.Z.parseError(i.t0,v.default);case 41:case"end":return i.stop()}},V,null,[[0,37]])})),D.apply(this,arguments)}M()},[T,t]),(0,l.jsxs)(a.Z,{className:L().classes,children:[(0,l.jsxs)(j.Z,{children:[(0,l.jsx)(E.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){q.change(.1)},children:"Zoom in"}),(0,l.jsx)(E.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){q.change(-.1)},children:"Zoom out"}),(0,l.jsx)(E.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){v.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,l.jsx)(E.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){Ze("mover"),v.default.info("You can move the image now.")},children:"Move"})]}),(0,l.jsx)("div",{id:"dr",className:L().mainStage,children:(0,l.jsxs)(P.Z,{tip:"loading",spinning:ke,children:[(0,l.jsx)("div",{className:L().draw,children:(0,l.jsx)(H.Z,{scale:q.curr,currentTool:Fe,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:Ke})}),(0,l.jsx)("div",{className:L().pblock,children:(0,l.jsx)("div",{className:L().progress,children:(0,l.jsx)(m.Z,{percent:Ue,status:"active"})})}),(0,l.jsx)("div",{className:L().prevTask,onClick:function(){ze()}}),(0,l.jsx)("div",{className:L().nextTask,onClick:function(){He()}})]})}),(0,l.jsxs)(j.Z,{disLoc:"right",children:[(0,l.jsx)(E.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,l.jsx)(E.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,l.jsx)("div",{className:L().rightSideBar,children:(0,l.jsx)(Y.Z,{labels:h,selectedLabel:xe,onLabelSelect:function(D){$e(D)},onLabelAdd:function(D){t!=null&&t.projectId&&(0,g.jc)(t.projectId,D,f)},onLabelDelete:function(D){(0,g.SP)(D,f)},onLabelModify:function(){}})})]})};O.default=p}}]);
