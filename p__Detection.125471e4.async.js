(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[18],{41435:function(C,D,n){"use strict";n.d(D,{Z:function(){return m}});var f=n(94663),U=n(80112);function N(i){return Function.toString.call(i).indexOf("[native code]")!==-1}var Q=n(18597);function Y(i,l,K){return(0,Q.Z)()?Y=Reflect.construct:Y=function(V,T,w){var v=[null];v.push.apply(v,T);var k=Function.bind.apply(V,v),B=new k;return w&&(0,U.Z)(B,w.prototype),B},Y.apply(null,arguments)}function m(i){var l=typeof Map=="function"?new Map:void 0;return m=function(s){if(s===null||!N(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l!="undefined"){if(l.has(s))return l.get(s);l.set(s,V)}function V(){return Y(s,arguments,(0,f.Z)(this).constructor)}return V.prototype=Object.create(s.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),(0,U.Z)(V,s)},m(i)}},6277:function(C){C.exports={modal:"modal___26yNn"}},45092:function(C){C.exports={modal:"modal___1H_FQ"}},72285:function(C){C.exports={det:"det___3GOn8",mainStage:"mainStage___36l4G",draw:"draw___1EIyT",pblock:"pblock___107zJ",progress:"progress___vIcpV",rightSideBar:"rightSideBar___3n2bi",determinOutline:"determinOutline___1p2xS"}},85871:function(C,D,n){"use strict";var f=n(71194),U=n(50146),N=n(49111),Q=n(19650),Y=n(57663),m=n(71577),i=n(13062),l=n(71230),K=n(89032),s=n(15746),V=n(77883),T=n(70507),w=n(34792),v=n(48086),k=n(9715),B=n(93766),H=n(2824),p=n(67294),t=n(48971),fn=n(6277),J=n.n(fn),d=n(85893),rn=function(W){var en=(0,t.YB)(),ln=(0,p.useState)(60),on=(0,H.Z)(ln,2),L=on[0],P=on[1],dn=(0,p.useState)(20),b=(0,H.Z)(dn,2),z=b[0],q=b[1],e=(0,p.useState)(20),c=(0,H.Z)(e,2),A=c[0],_=c[1],u=(0,p.useState)(!1),I=(0,H.Z)(u,2),M=I[0],O=I[1],a=(0,t.YB)().formatMessage({id:"pages.toolBar.divideData"}),x=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.train"}),h=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.validation"}),y=(0,t.YB)().formatMessage({id:"component.PPDivideDataModal.test"}),S=(0,t.YB)().formatMessage({id:"component.PPCreater.cancel"}),nn=(0,t.YB)().formatMessage({id:"component.PPSegMode.ok"}),an=B.Z.useForm(),R=(0,H.Z)(an,1),F=R[0];return(0,d.jsx)(U.Z,{className:J().modal,title:a,visible:W.visible,onCancel:W.onCancel,footer:null,children:(0,d.jsxs)(B.Z,{form:F,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(){if(L+z+A!=100){v.default.error("Train, Validation and Test total percent should equal 100!");return}console.log("x trainData: ".concat(L,", validationData: ").concat(z,", testData: ").concat(A,", props.project.curr.projectId: ").concat(W.project.curr.projectId)),O(!0),W.splitDataset(W.project.curr.projectId,{train:L*.01,validation:z*.01,test:A*.01}).then(function(){var j;console.log("success"),v.default.success(en.formatMessage({id:"component.PPDivideDataModal.success"})),(j=W.onFinish)===null||j===void 0||j.call(0)}).finally(function(){O(!1)})},autoComplete:"off",layout:"vertical",children:[(0,d.jsxs)(l.Z,{children:[(0,d.jsx)(s.Z,{span:8,children:(0,d.jsx)(B.Z.Item,{label:x,name:"train",children:(0,d.jsx)(T.Z,{addonAfter:"%",defaultValue:60,precision:0,min:0,max:100,value:L,onChange:P})})}),(0,d.jsx)(s.Z,{span:8,children:(0,d.jsx)(B.Z.Item,{label:h,name:"validation",children:(0,d.jsx)(T.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:z,onChange:q})})}),(0,d.jsx)(s.Z,{span:8,children:(0,d.jsx)(B.Z.Item,{label:y,name:"test",children:(0,d.jsx)(T.Z,{addonAfter:"%",defaultValue:20,precision:0,min:0,max:100,value:A,onChange:_})})})]}),(0,d.jsx)(B.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,d.jsxs)(Q.Z,{children:[(0,d.jsx)(m.Z,{onClick:function(){var j;(j=W.onCancel)===null||j===void 0||j.call(0),F.resetFields()},children:S}),(0,d.jsx)(m.Z,{type:"primary",htmlType:"submit",loading:M,children:nn})]})})]})})};D.Z=rn},62850:function(C,D,n){"use strict";var f=n(71194),U=n(50146),N=n(49111),Q=n(19650),Y=n(57663),m=n(71577),i=n(47673),l=n(24044),K=n(34792),s=n(48086),V=n(9715),T=n(93766),w=n(2824),v=n(67294),k=n(48971),B=n(45092),H=n.n(B),p=n(85893),t=function(J){var d=(0,k.YB)(),rn=(0,v.useState)(!1),sn=(0,w.Z)(rn,2),W=sn[0],en=sn[1],ln=(0,k.YB)().formatMessage({id:"component.PPCreater.cancel"}),on=T.Z.useForm(),L=(0,w.Z)(on,1),P=L[0];return(0,p.jsx)(U.Z,{className:H().modal,title:(0,k.YB)().formatMessage({id:"component.PPExportModal.title"}),visible:J.visible,onCancel:J.onCancel,footer:null,children:(0,p.jsxs)(T.Z,{form:P,name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!1},onFinish:function(b){console.log(b);var z=b.path;if(!z){s.default.error(d.formatMessage({id:"component.PPExportModal.pathNotNull"}));return}en(!0),J.exportDataset(J.project.curr.projectId,z).then(function(){var q;s.default.success(d.formatMessage({id:"component.PPExportModal.exportSuccess"})),(q=J.onFinish)===null||q===void 0||q.call(0)}).finally(function(){en(!1)})},autoComplete:"off",children:[(0,p.jsx)(T.Z.Item,{label:d.formatMessage({id:"component.PPExportModal.path"}),name:"path",children:(0,p.jsx)(l.Z,{})}),(0,p.jsx)(T.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,p.jsxs)(Q.Z,{children:[(0,p.jsx)(m.Z,{onClick:function(){var b;(b=J.onCancel)===null||b===void 0||b.call(0),P.resetFields()},children:ln}),(0,p.jsx)(m.Z,{type:"primary",htmlType:"submit",loading:W,children:d.formatMessage({id:"component.PPExportModal.export"})})]})})]})})};D.Z=t},91861:function(C,D,n){"use strict";n.d(D,{Ad:function(){return U},k3:function(){return N},Vd:function(){return Q},td:function(){return Y}});var f=40;function U(){localStorage.removeItem("history"),N([])}function N(m){var i=localStorage.getItem("history"),l=i?JSON.parse(i):{index:-1,items:[]};if(JSON.stringify(l.items[l.index])!=JSON.stringify(m)){var K=l.index>f?l.index-f:0,s=l.items.splice(K,l.index==0?1:l.index+1);l.items=s.concat([m]),l.index<=f?l.index++:l.index=f+1,localStorage.setItem("history",JSON.stringify(l))}}function Q(){var m=localStorage.getItem("history");if(!!m){var i=JSON.parse(m);if(!!i&&!(i.index>=i.items.length-1))return i.index++,localStorage.setItem("history",JSON.stringify(i)),i.items[i.index]}}function Y(){var m=localStorage.getItem("history");if(!!m){var i=JSON.parse(m);if(!(!i||!i.index)&&!(i.index<=0))return i.index--,localStorage.setItem("history",JSON.stringify(i)),i.items[i.index]}}},80212:function(C,D,n){"use strict";n.r(D),n.d(D,{default:function(){return q}});var f=n(11849),U=n(20228),N=n(11382),Q=n(34669),Y=n(54458),m=n(34792),i=n(48086),l=n(91220),K=n(2824),s=n(67294),V=n(72285),T=n.n(V),w=n(8088),v=n(61541),k=n(44434),B=n(5041),H=n(57436),p=n(14836),t=n(85893),fn=function(c){return(0,t.jsx)(v.Z,{active:c.active,imgSrc:c.imgSrc||"./pics/buttons/rectangle.png",onClick:c.onClick,children:c.children})},J=fn,d=n(65031);function rn(e){var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}function sn(e){if(!(!e||e.length<2))return{xmin:e[0],ymin:e[1],xmax:e[2]||void 0,ymax:e[3]||void 0}}function W(e,c,A,_,u,I,M,O){if(!e||!e.points||!e.label||!e.label.color)return[(0,t.jsx)(t.Fragment,{})];var a=e.points,x=e.label.color,h=rn(x);if(!h)return[(0,t.jsx)(t.Fragment,{})];var y=(O==null?void 0:O.frontendId)==e.frontendId,S=y?.5:.1,nn=a.xmax!=null&&a.ymax!=null?(0,t.jsx)(d.UL,{onMouseOver:function(){u=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){u=="editor"&&I(e)},stroke:x,strokeWidth:2/_,globalCompositeOperation:"source-over",lineCap:"round",x:a.xmin,y:a.ymin,width:a.xmax-a.xmin,height:a.ymax-a.ymin,closed:!0,fill:"rgba(".concat(h.r,", ").concat(h.g,", ").concat(h.b,", ").concat(S,")")}):(0,t.jsx)(t.Fragment,{});function an(R){if(!R&&(a.xmax==null||a.ymax==null))return(0,t.jsx)(t.Fragment,{});var F=function(j){if(u=="editor"){var vn=M==null?void 0:M.current,E=vn.findOne(".baseImage"),Z=!1,X=j.target.x();X>E.width()/2&&(X=E.width()/2,Z=!0),X<-E.width()/2&&(X=-E.width()/2,Z=!0);var $=j.target.y();$>E.height()/2&&($=E.height()/2,Z=!0),$<-E.height()/2&&($=-E.height()/2,Z=!0),Z&&j.target.setPosition({x:X,y:$}),R?(a.xmin=X,a.ymin=$):(a.xmax=X,a.ymax=$);var _n=(0,f.Z)((0,f.Z)({},e),{},{points:a});c(_n)}};return(0,t.jsx)(d.Cd,{onMouseDown:function(){u=="editor"&&I(e)},draggable:u=="editor",onDragMove:F,onDragEnd:F,onMouseOver:function(){u=="editor"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},x:R?a.xmin:a.xmax,y:R?a.ymin:a.ymax,radius:5/_,fill:x})}return[(0,t.jsxs)(d.ZA,{children:[nn,an(!0),an(!1)]},e.annotationId)]}function en(e){var c=1;if(!e||e.length==0)return c;var A=(0,l.Z)(e),_;try{for(A.s();!(_=A.n()).done;){var u=_.value;u.frontendId&&c<=u.frontendId&&(c=u.frontendId+1)}}catch(I){A.e(I)}finally{A.f()}return c}function ln(e){var c=function(M,O,a,x){var h=(M.evt.offsetX+O)/x,y=(M.evt.offsetY+a)/x,S=sn([h,y]);!S||e.onAnnotationAdd({frontendId:en(e.annotations),type:"rectangle",label:e.currentLabel,points:S})},A=function(M,O,a,x){if(!(!e.currentAnnotation||!e.currentAnnotation.points)){var h=(M.evt.offsetX+O)/x,y=(M.evt.offsetY+a)/x,S=e.currentAnnotation.points;if(!!S){S.xmax=h,S.ymax=y;var nn={type:"rectangle",frontendId:e.currentAnnotation.frontendId,label:e.currentAnnotation.label,points:S};e.onAnnotationModify(nn)}}},_=function(M,O,a,x){e.currentTool=="rectangle"&&(e.currentAnnotation?A(M,O,a,x):c(M,O,a,x))},u=function(){e.currentTool=="rectangle"&&e.onMouseUp()};return{onMouseDown:_,onMouseMove:function(){},onMouseUp:u,createElementsFunc:W}}var on=n(64322),L=n(91861),P=n(48971),dn=n(85871),b=n(62850),z=function(){var c,A=(0,on.$L)(s.useState,s.useEffect,{label:{oneHot:!0},effectTrigger:{postTaskChange:L.Ad}}),_=(0,K.Z)(A,10),u=_[0],I=_[1],M=_[2],O=_[3],a=_[4],x=_[5],h=_[6],y=_[7],S=_[8],nn=_[9],an=(0,s.useState)(),R=(0,K.Z)(an,2),F=R[0],g=R[1],j=(0,s.useState)([]),vn=(0,K.Z)(j,2),E=vn[0],Z=vn[1],X=(0,s.useState)(!1),$=(0,K.Z)(X,2),_n=$[0],mn=$[1],hn=(0,s.useState)(!1),Pn=(0,K.Z)(hn,2),pn=Pn[0],gn=Pn[1],On=function(o){if(!o.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(o));E.push(o),Z(E),g(o)},xn=function(o){if(!o.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(o));var tn=[],G=(0,l.Z)(E),cn;try{for(G.s();!(cn=G.n()).done;){var un=cn.value;un.frontendId==o.frontendId?tn.push(o):tn.push(un)}}catch(En){G.e(En)}finally{G.f()}console.log("modifyAnnotation, newAnnos:",tn,"anno:",o),Z(tn),g(o)},yn=function(o){if(!o.frontendId)throw new Error("addAnnotation, Annotation frontendId not generated: "+JSON.stringify(o));var tn=[],G=(0,l.Z)(E),cn;try{for(G.s();!(cn=G.n()).done;){var un=cn.value;un.frontendId!=o.frontendId&&tn.push(un)}}catch(En){G.e(En)}finally{G.f()}Z(tn),g(void 0)},Wn=function(o){!o||(console.log("modifyAnnotation",o,"anno.label:",o==null?void 0:o.label),o.taskId=a.curr.taskId,o.dataId=x.curr.dataId,O.modify(o))},Dn=ln({currentLabel:y.curr,currentTool:u.curr,annotations:E,currentAnnotation:F,onAnnotationAdd:On,onAnnotationModify:xn,onMouseUp:function(){(0,L.k3)({annos:E,currAnno:F})}}),Mn=Dn,Cn=(0,P.YB)().formatMessage({id:"pages.toolBar.rectangle"}),An=(0,P.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),In=(0,P.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),Bn=(0,P.YB)().formatMessage({id:"pages.toolBar.move"}),Sn=(0,P.YB)().formatMessage({id:"pages.toolBar.unDo"}),jn=(0,P.YB)().formatMessage({id:"pages.toolBar.reDo"}),Zn=(0,P.YB)().formatMessage({id:"pages.toolBar.save"}),Tn=(0,P.YB)().formatMessage({id:"pages.toolBar.edit"}),Ln=(0,P.YB)().formatMessage({id:"pages.toolBar.clearMark"}),Rn=(0,P.YB)().formatMessage({id:"pages.toolBar.undef"}),Un=(0,P.YB)().formatMessage({id:"pages.toolBar.divideData"}),Kn=(0,P.YB)().formatMessage({id:"pages.toolBar.export"});return(0,t.jsxs)(w.Z,{className:T().det,children:[(0,t.jsxs)(k.Z,{children:[(0,t.jsx)(J,{active:u.curr=="rectangle",onClick:function(){if(!y.curr){i.default.error("Please choose a label category first!");return}u.setCurr("rectangle"),g(void 0)},children:Cn}),(0,t.jsx)(v.Z,{active:u.curr=="editor",imgSrc:"./pics/buttons/edit.png",onClick:function(){u.setCurr("editor")},children:Tn}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){M.change(.1)},children:An}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){M.change(-.1)},children:In}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){i.default.info("Annotations are saved automatically. You don't need to click save.")},children:Zn}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/move.png",active:u.curr=="mover",onClick:function(){u.setCurr("mover")},children:Bn}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){var o=(0,L.td)();!o||(g(o.currAnno),Z(o.annos))},children:Sn}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){var o=(0,L.Vd)();!o||(g(o.currAnno),Z(o.annos))},children:jn}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/clear_mark.png",onClick:function(){return console.log("clear")},children:Ln})]}),(0,t.jsx)("div",{id:"dr",className:"mainStage",children:(0,t.jsxs)(N.Z,{tip:"loading",spinning:!!I.curr,children:[(0,t.jsx)("div",{className:"draw",children:(0,t.jsx)(H.Z,{scale:M.curr,annotations:E,currentTool:u.curr,currentAnnotation:F,setCurrentAnnotation:g,onAnnotationModify:xn,onAnnotationModifyComplete:function(){(0,L.k3)({annos:E,currAnno:F})},onMouseDown:Mn.onMouseDown,onMouseMove:Mn.onMouseMove,onMouseUp:Mn.onMouseUp,createRectangleFunc:Dn.createElementsFunc,imgSrc:x.imgSrc})}),(0,t.jsx)("div",{className:"pblock",children:(0,t.jsxs)("div",{className:"progress",children:[(0,t.jsx)(Y.Z,{className:"progressBar",percent:h.progress,status:"active",showInfo:!1})," ",(0,t.jsxs)("span",{className:"progressDesc",children:["Current labeling ",a.currIdx==null?1:a.currIdx+1," of"," ",(c=a.all)===null||c===void 0?void 0:c.length,". Already labeled ",a.finished(h.progress)||0,"."]})]})}),(0,t.jsx)("div",{className:"prevTask",onClick:function(){!a.prevTask()||(g(void 0),Z([]))}}),(0,t.jsx)("div",{className:"nextTask",onClick:function(){!a.nextTask()||(g(void 0),Z([]))}})]})}),(0,t.jsxs)(k.Z,{disLoc:"right",children:[(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){mn(!0)},children:Un}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/export.png",onClick:function(){gn(!0)},children:Kn}),(0,t.jsx)(v.Z,{imgSrc:"./pics/buttons/data_division.png",onClick:function(){g(void 0)},children:Rn})]}),(0,t.jsxs)("div",{className:"rightSideBar",children:[(0,t.jsx)(B.Z,{labels:y.all,activeIds:y.activeIds,onLabelSelect:function(o){y.onSelect(o),g(void 0)},onLabelModify:function(){},onLabelDelete:y.remove,onLabelAdd:function(o){return y.create((0,f.Z)((0,f.Z)({},o),{},{projectId:h.curr.projectId}))}}),(0,t.jsx)(p.Z,{annotations:E,currAnnotation:F,onAnnotationSelect:g,onAnnotationAdd:function(){g(void 0)},onAnnotationModify:function(){},onAnnotationDelete:function(o){yn(o)}})]}),(0,t.jsx)(dn.Z,{visible:_n,splitDataset:S,project:h,onCancel:function(){mn(!1)},onFinish:function(){mn(!1)}}),(0,t.jsx)(b.Z,{visible:pn,exportDataset:nn,project:h,onCancel:function(){gn(!1)},onFinish:function(){gn(!1)}})]})},q=z},15746:function(C,D,n){"use strict";var f=n(21584);D.Z=f.Z},89032:function(C,D,n){"use strict";var f=n(38663),U=n.n(f),N=n(6999)},71230:function(C,D,n){"use strict";var f=n(92820);D.Z=f.Z},13062:function(C,D,n){"use strict";var f=n(38663),U=n.n(f),N=n(6999)}}]);
