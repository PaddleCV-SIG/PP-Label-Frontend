(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[267],{85024:function(D){D.exports={listItem:"listItem___u4Q82",eye:"eye___BwaRm",delete:"delete___31JB_",roundBall:"roundBall___23A7l",popover:"popover___1BNET",annotationId:"annotationId___zAzX4",labelName:"labelName___2ohxn",listItemActive:"listItemActive___2QnA3"}},56159:function(D){D.exports={labelList:"labelList___v7C6K",listHeader:"listHeader___1aY8R",eye:"eye___2MKbp",roundBall:"roundBall___187XH"}},71212:function(D){D.exports={key:"key___HbxlB",mainStage:"mainStage___2kPY7",draw:"draw___1d3zf",pblock:"pblock___13HlD",progress:"progress___1iogf",rightSideBar:"rightSideBar___2SKvQ",finished:"finished___nNiaq"}},14836:function(D,b,n){"use strict";n.d(b,{Z:function(){return I}});var Y=n(54421),L=n(38272),j=n(57663),M=n(71577),A=n(67294),v=n(56159),U=n.n(v),O=n(49111),N=n(19650),o=n(2824),c=n(11849),E=n(85024),f=n.n(E),P=n(63097),i=n(85893),m=function(s){var _=(0,c.Z)({},s.annotation),g=(0,A.useState)(_.invisible),x=(0,o.Z)(g,2),y=x[0],C=x[1],R=(0,A.useState)(0),T=(0,o.Z)(R,2),K=T[0],H=T[1];(0,A.useEffect)(function(){C(s.annotation.invisible)},[s.annotation.invisible]);var k=(0,i.jsxs)(L.ZP.Item,{className:"".concat(f().listItem," ").concat(s.active?f().listItemActive:""),unselectable:"on",onClick:function(){s.onClick(_)},children:[(0,i.jsxs)(N.Z,{align:"center",size:5,children:[(0,i.jsx)("a",{className:f().eye,style:{backgroundImage:y?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(Z){Z.stopPropagation(),C(!y),s.onAnnotationModify(_)}})," ",(0,i.jsx)("span",{className:f().annotationId,children:_.frontendId}),(0,i.jsx)("span",{className:f().labelName,children:_.label.name}),(0,i.jsx)(P.Z,{color:_.label.color})]}),(0,i.jsx)("a",{className:f().delete,onClick:function(Z){Z.stopPropagation();var F=new Date().getTime();F-K<300||(H(F),s.onAnnotationDelete(_))}})]});return k},a=m,t=n(48971),u=function(s){var _=(0,t.YB)().formatMessage({id:"component.PPAnnotationList.annotationList"}),g=(0,t.YB)().formatMessage({id:"component.PPAnnotationList.addAnnotation"});return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(L.ZP,{className:U().labelList,size:"large",header:(0,i.jsx)("div",{className:U().listHeader,children:_}),bordered:!0,dataSource:s.annotations,renderItem:function(y){var C;return(0,i.jsx)(a,{onClick:s.onAnnotationSelect,annotation:y,active:y.frontendId==((C=s.currAnnotation)===null||C===void 0?void 0:C.frontendId),onAnnotationDelete:s.onAnnotationDelete,onAnnotationModify:s.onAnnotationModify})},footer:(0,i.jsx)("div",{children:(0,i.jsx)(M.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){s.onAnnotationAdd()},block:!0,children:g})})})})},I=u},13931:function(D,b,n){"use strict";n.d(b,{Z:function(){return N}});var Y=n(91220),L=n(11849),j=n(65031),M=n(85893);function A(o){var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}function v(o,c){if(!(!o||!c))return{color:o,points:c}}function U(o,c,E,f,P,i,m){if(!o||!o.lines||!o.lines[0])return[(0,M.jsx)(M.Fragment,{})];var a=o.lines[0].points,t=o.lines[0].color,u=A(t);if(!u)return[(0,M.jsx)(M.Fragment,{})];var I=(m==null?void 0:m.annotationId)==o.annotationId,S=I?.5:.1,s=void 0,_=[];return a.forEach(function(g,x){if(!s){s=g;return}_.push((0,M.jsx)(j.Cd,{onMouseDown:function(){P=="mover"&&i(o)},draggable:P=="mover",onDragMove:function(C){console.log("Circle onDrageMove");var R=C.evt.offsetX/f,T=C.evt.offsetY/f;a[x-1]=R,a[x]=T;var K=(0,L.Z)((0,L.Z)({},o),{},{lines:[{color:t,points:a}]});c(K)},onMouseOver:function(){console.log("Circle onMouseOver"),P=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){console.log("Circle onMouseOut"),document.body.style.cursor="default"},x:s,y:g,radius:5,fill:t})),s=void 0}),[(0,M.jsxs)(j.ZA,{children:[(0,M.jsx)(j.x1,{onMouseOver:function(){P=="mover"&&(document.body.style.cursor="pointer")},onMouseOut:function(){document.body.style.cursor="default"},onClick:function(){P=="mover"&&i(o)},stroke:t,strokeWidth:2,globalCompositeOperation:"source-over",lineCap:"round",points:a,tension:0,closed:!0,fill:"rgba(".concat(u.r,", ").concat(u.g,", ").concat(u.b,", ").concat(S,")")}),_]},o.annotationId)]}function O(o){var c=0,E=(0,Y.Z)(o),f;try{for(E.s();!(f=E.n()).done;){var P=f.value;!P||P.annotationId>c&&(c=P.annotationId)}}catch(i){E.e(i)}finally{E.f()}return c}function N(o){var c=function(m,a){var t,u=m.evt.offsetX/a,I=m.evt.offsetY/a,S=v((t=o.currentLabel)===null||t===void 0?void 0:t.color,[u,I]);!S||o.onAnnotationAdd({tool:"polygon",annotationId:O(o.annotations)+1,label:o.currentLabel,lines:[S]})},E=function(m,a){var t,u;if(!!o.currentAnnotation){var I=m.evt.offsetX/a,S=m.evt.offsetY/a,s=o.currentAnnotation.lines||[],_=v((t=o.currentLabel)===null||t===void 0?void 0:t.color,(u=s[0])===null||u===void 0?void 0:u.points.concat([I,S]));if(!!_){var g={tool:"polygon",annotationId:o.currentAnnotation.annotationId,label:o.currentAnnotation.label,lines:[_]};o.onAnnotationModify(g)}}},f=function(m,a){o.currentTool=="polygon"&&(o.currentAnnotation?E(m,a):c(m,a))},P=function(){o.currentTool=="polygon"&&o.onMouseUp()};return{onMouseDown:f,onMouseMove:function(){},onMouseUp:P,createElementsFunc:U}}},29919:function(D,b,n){"use strict";var Y=n(67294),L=n(61541),j=n(85893),M=function(v){return(0,j.jsx)(L.Z,{active:v.active,imgSrc:v.imgSrc||"./pics/buttons/polygon.png",onClick:v.onClick,children:v.children})};b.Z=M},82881:function(D,b,n){"use strict";n.r(b);var Y=n(57663),L=n(71577),j=n(34669),M=n(54458),A=n(2824),v=n(67294),U=n(71212),O=n.n(U),N=n(8088),o=n(61541),c=n(44434),E=n(5041),f=n(57436),P=n(14836),i=n(29919),m=n(13931),a=n(48971),t=n(85893),u=40,I=function(){var s,_=(0,v.useState)(void 0),g=(0,A.Z)(_,2),x=g[0],y=g[1],C=(0,v.useState)({color:"",name:""}),R=(0,A.Z)(C,2),T=R[0],K=R[1],H=(0,v.useState)(),k=(0,A.Z)(H,2),B=k[0],Z=k[1],F=(0,v.useState)([]),Q=(0,A.Z)(F,2),h=Q[0],W=Q[1],on=(0,v.useState)(1),G=(0,A.Z)(on,2),z=G[0],J=G[1],V=function(e){e||J(1),e<.1||e>3?J(1):J(e)},p=function(e){Z(e),e!=null&&e.label&&K(e.label)};(0,v.useEffect)(function(){localStorage.removeItem("history"),X([])},[]);function X(l,e){var r=localStorage.getItem("history"),d=r?JSON.parse(r):{index:-1,items:[]},nn={currentAnnotation:e,annotations:l};if(JSON.stringify(d.items[d.index])!=JSON.stringify(nn)){var gn=d.index>u?d.index-u:0,Mn=d.items.splice(gn,d.index==0?1:d.index+1);d.items=Mn.concat([nn]),d.index<=u?d.index++:d.index=u+1,localStorage.setItem("history",JSON.stringify(d))}}var tn=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!!r&&!(r.index>=r.items.length-1)){r.index++,localStorage.setItem("history",JSON.stringify(r));var d=r.items[r.index];Z(d.currentAnnotation),W(d.annotations)}}},en=function(){var e=localStorage.getItem("history");if(!!e){var r=JSON.parse(e);if(!(!r||!r.index)&&!(r.index<=0)){r.index--,localStorage.setItem("history",JSON.stringify(r));var d=r.items[r.index];Z(d.currentAnnotation),W(d.annotations)}}},w=function(e){for(var r=[],d=0;d<h.length;d++)h[d].annotationId==e.annotationId?r.push(e):r.push(h[d]);p(e),W(r)},q=(0,m.Z)({currentLabel:T,currentTool:x,annotations:h,currentAnnotation:B,onAnnotationAdd:function(e){var r=h.concat([e]);W(r),B||p(e)},onAnnotationModify:w,onMouseUp:function(){X(h,B)}}),$=q,an=(0,a.YB)().formatMessage({id:"pages.toolBar.polygon"}),rn=(0,a.YB)().formatMessage({id:"pages.toolBar.zoomIn"}),sn=(0,a.YB)().formatMessage({id:"pages.toolBar.zoomOut"}),ln=(0,a.YB)().formatMessage({id:"pages.toolBar.move"}),dn=(0,a.YB)().formatMessage({id:"pages.toolBar.unDo"}),cn=(0,a.YB)().formatMessage({id:"pages.toolBar.reDo"}),un=(0,a.YB)().formatMessage({id:"pages.toolBar.save"}),_n=(0,a.YB)().formatMessage({id:"pages.toolBar.edit"}),vn=(0,a.YB)().formatMessage({id:"pages.toolBar.clearMark"}),fn=(0,a.YB)().formatMessage({id:"pages.toolBar.determineOutline"}),mn=(0,a.YB)().formatMessage({id:"pages.toolBar.divideData"}),Pn=(0,a.YB)().formatMessage({id:"pages.toolBar.export"});return(0,t.jsxs)(N.Z,{className:O().key,children:[(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(i.Z,{active:x=="polygon",onClick:function(){y("polygon"),p(void 0)},children:an}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/edit.png",children:_n}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){V(z+.1)},children:rn}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){V(z-.1)},children:sn}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/save.png",children:un}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){y("mover")},children:ln}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){en()},children:dn}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){tn()},children:cn}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/clear_mark.png",children:vn})]}),(0,t.jsxs)("div",{id:"dr",className:O().mainStage,children:[(0,t.jsx)("div",{className:O().draw,children:(0,t.jsx)(f.Z,{width:(s=document.getElementById("dr"))===null||s===void 0?void 0:s.clientWidth,scale:z,annotations:h,currentTool:x,currentAnnotation:B,setCurrentAnnotation:p,onAnnotationModify:w,onAnnotationModifyComplete:function(){X(h,B)},onMouseDown:$.onMouseDown,onMouseMove:$.onMouseMove,onMouseUp:$.onMouseUp,createPolygonFunc:q.createElementsFunc})}),(0,t.jsx)("div",{className:O().pblock,children:(0,t.jsx)("div",{className:O().progress,children:(0,t.jsx)(M.Z,{percent:50,status:"active"})})})]}),(0,t.jsxs)(c.Z,{disLoc:"right",children:[(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/data_division.png",children:mn}),(0,t.jsx)(o.Z,{imgSrc:"./pics/buttons/export.png",children:Pn})]}),(0,t.jsxs)("div",{className:O().rightSideBar,children:[(0,t.jsx)("div",{className:O().finished,children:(0,t.jsx)(L.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",block:!0,onClick:function(){p(void 0)},children:fn})}),(0,t.jsx)(E.Z,{selectedLabel:T,onLabelSelect:function(e){K(e),p(void 0)},onLabelModify:function(){},onLabelDelete:function(){},onLabelAdd:function(){}}),(0,t.jsx)(P.Z,{selectedAnnotation:B,annotations:h,onAnnotationSelect:function(e){e!=null&&e.delete||p(e)},onAnnotationAdd:function(){},onAnnotationModify:function(){},onAnnotationDelete:function(e){W(h.filter(function(r){return r.annotationId!=e.annotationId})),p(void 0)}})]})]})};b.default=I}}]);
