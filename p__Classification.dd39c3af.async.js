(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{52822:function(r){r.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(r){r.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(r){r.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(r){r.exports={container:"container___G0FNe"}},83930:function(r){r.exports={stage:"stage___3H5QL"}},80961:function(r){r.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(r){r.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(r){r.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(r,b,e){"use strict";var p=e(20136),C=e(55241),A=e(2824),d=e(67294),c=e(52822),o=e.n(c),a=e(63144),L=e(85893),g=function(I){var S=(0,d.useState)(I.color||"#FFF"),n=(0,A.Z)(S,2),P=n[0],t=n[1];return(0,d.useEffect)(function(){t(I.color||"#FFF")},[I]),I.changeable?(0,L.jsx)(C.Z,{getPopupContainer:function(R){return R.parentElement||document.body},overlayClassName:o().popover,openClassName:o().popoverOpenClassName,placement:"bottom",content:(0,L.jsx)(a.xS,{disableAlpha:!0,color:P,onChange:function(R){t(R.hex)},onChangeComplete:I.onChange}),trigger:"click",children:(0,L.jsx)("div",{className:o().roundBall,style:{backgroundColor:P}})}):(0,L.jsx)("div",{className:o().roundBall,style:{backgroundColor:P}})};b.Z=g},5041:function(r,b,e){"use strict";e.d(b,{Z:function(){return y}});var p=e(54421),C=e(38272),A=e(57663),d=e(71577),c=e(2824),o=e(67294),a=e(56131),L=e.n(a),g=e(49111),i=e(19650),I=e(11849),S=e(5882),n=e.n(S),P=e(63097),t=e(85893),h=function(s){var u=(0,I.Z)({},s.label),B=(0,o.useState)(u.invisible),O=(0,c.Z)(B,2),K=O[0],F=O[1],D=(0,t.jsx)(C.ZP.Item,{className:"".concat(n().listItem," ").concat(u.active?n().listItemActive:""),unselectable:"on",onClick:function(){s.onClick(u)},children:(0,t.jsxs)(i.Z,{align:"center",size:5,children:[(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:K?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){F(!K),s.onLabelModify(u)}})," ",u.name,(0,t.jsx)(P.Z,{color:u.color,changeable:!0,onChange:function(J){u.color=J.hex,s.onLabelModify(u)}}),(0,t.jsx)("a",{className:n().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){s.onLabelDelete(u)}})]})});return D},R=h,X=e(71194),E=e(50146),z=e(47673),l=e(24044),H=e(9715),x=e(93766),N=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],T=function(s){var u,B,O=(0,o.useState)(((u=s.defaultLabel)===null||u===void 0?void 0:u.color)||N[s.order||0]),K=(0,c.Z)(O,2),F=K[0],D=K[1];(0,o.useEffect)(function(){var f;D(((f=s.defaultLabel)===null||f===void 0?void 0:f.color)||N[s.order||0])},[s]);var Z=x.Z.useForm(),J=(0,c.Z)(Z,1),k=J[0];return(0,t.jsx)(E.Z,{title:"Add Label",visible:s.visible,onCancel:s.onCancel,footer:null,children:(0,t.jsxs)(x.Z,{form:k,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(B=s.defaultLabel)===null||B===void 0?void 0:B.name},onFinish:function(U){var Y={name:U.labelname,color:F};s.onLabelAdd(Y),k.resetFields()},autoComplete:"off",children:[(0,t.jsx)(x.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,t.jsx)(l.Z,{})}),(0,t.jsx)(x.Z.Item,{label:"Select Color",name:"color",children:(0,t.jsx)(P.Z,{color:F,onChange:function(U){D(U.hex)}})}),(0,t.jsx)(x.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,t.jsxs)(i.Z,{children:[(0,t.jsx)(d.Z,{onClick:function(){var U;(U=s.onCancel)===null||U===void 0||U.call(0),k.resetFields()},children:"\u53D6\u6D88"}),(0,t.jsx)(d.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},j=T,Q=function(s){var u,B=(0,o.useState)(!1),O=(0,c.Z)(B,2),K=O[0],F=O[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.ZP,{className:L().labelList,size:"large",header:(0,t.jsx)("div",{className:L().listHeader,children:"Label List"}),footer:(0,t.jsx)("div",{children:(0,t.jsx)(d.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){F(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:s.labels,renderItem:function(Z){return(0,t.jsx)(R,{onClick:s.onLabelSelect,label:Z,onLabelDelete:s.onLabelDelete,onLabelModify:s.onLabelModify})}}),(0,t.jsx)(j,{order:(u=s.labels)===null||u===void 0?void 0:u.length,visible:K,onLabelAdd:function(Z){s.onLabelAdd(Z),F(!1)},onCancel:function(){F(!1)}})]})},y=Q},8088:function(r,b,e){"use strict";var p=e(67294),C=e(78677),A=e.n(C),d=e(85893),c=function(a){return(0,d.jsx)("div",{className:"".concat(A().container," ").concat(a.className),children:a.children})};b.Z=c},57436:function(r,b,e){"use strict";var p=e(91220),C=e(2824),A=e(67294),d=e(65031),c=e(84420),o=e.n(c),a=e(83930),L=e.n(a),g=e(85893),i="./pics/basketball.jpg",I=function(n){var P=o()(n.imgSrc),t=(0,C.Z)(P,1),h=t[0],R=(h==null?void 0:h.width)||0,X=(h==null?void 0:h.height)||0,E=n.width||R,z=[];if(n.annotations){var l=(0,p.Z)(n.annotations),H;try{for(l.s();!(H=l.n()).done;){var x=H.value;if(!!x){var N=x.tool=="polygon"?n.createPolygonFunc:n.createBrushFunc;N&&z.push(N(x,n.onAnnotationModify,n.onAnnotationModifyComplete,n.scale,n.currentTool,n.setCurrentAnnotation,n.currentAnnotation))}}}catch(T){l.e(T)}finally{l.f()}}return(0,g.jsx)(d.Hf,{width:E,height:708,className:L().stage,children:(0,g.jsx)(d.mh,{scaleX:n.scale,scaleY:n.scale,onMouseDown:function(j){n.onMouseDown&&n.onMouseDown(j,n.scale)},onMouseMove:function(j){n.onMouseMove&&n.onMouseMove(j,n.scale)},onMouseUp:function(j){n.onMouseUp&&n.onMouseUp(j,n.scale)},onContextMenu:function(j){j.evt.preventDefault()},draggable:!1,children:(0,g.jsxs)(d.ZA,{draggable:n.currentTool=="mover",children:[(0,g.jsx)(d.Ee,{draggable:!1,image:h}),z]})})})};b.Z=I},44434:function(r,b,e){"use strict";var p=e(67294),C=e(80961),A=e.n(C),d=e(85893),c=function(a){var L=A().leftToolbar;return a.disLoc=="right"&&(L=A().rightToolbar),(0,d.jsx)("div",{className:L,children:a.children})};b.Z=c},61541:function(r,b,e){"use strict";var p=e(49111),C=e(19650),A=e(67294),d=e(82499),c=e.n(d),o=e(85893),a=function(g){return(0,o.jsx)("div",{unselectable:"on",className:"".concat(c().toolBarButtonContainerWrapper," ").concat(g.active&&c().toolBarButtonContainerWrapperActive),onClick:g.onClick,children:(0,o.jsx)(C.Z,{align:"center",className:c().toolBarButtonContainer,size:0,children:(0,o.jsxs)(C.Z,{align:"center",direction:"vertical",className:c().toolBarButton,size:0,children:[(0,o.jsx)("img",{src:g.imgSrc}),(0,o.jsx)("div",{className:c().buttonText,children:g.children})]})})})};b.Z=a},29214:function(r,b,e){"use strict";e.r(b);var p=e(34669),C=e(54458),A=e(3182),d=e(86582),c=e(34792),o=e(48086),a=e(2824),L=e(94043),g=e.n(L),i=e(67294),I=e(73199),S=e.n(I),n=e(8088),P=e(61541),t=e(44434),h=e(5041),R=e(57436),X=e(3275),E=e(93120),z=e(37071),l=e(85893),H=localStorage.getItem("basePath"),x=function(){var T,j=(0,i.useState)(),Q=(0,a.Z)(j,2),y=Q[0],V=Q[1],s=(0,i.useState)(),u=(0,a.Z)(s,2),B=u[0],O=u[1],K=(0,i.useState)(),F=(0,a.Z)(K,2),D=F[0],Z=F[1],J=(0,i.useState)(0),k=(0,a.Z)(J,2),f=k[0],U=k[1],Y=(0,i.useState)(),ae=(0,a.Z)(Y,2),oe=ae[0],Ee=ae[1],fe=(0,i.useState)(),le=(0,a.Z)(fe,2),ze=le[0],Ce=le[1],Le=(0,i.useState)(),se=(0,a.Z)(Le,2),He=se[0],ge=se[1],Me=(0,i.useState)(),re=(0,a.Z)(Me,2),be=re[0],De=re[1],he=(0,i.useState)(),_e=(0,a.Z)(he,2),Be=_e[0],Oe=_e[1],Ae=(0,i.useState)({color:"",name:""}),ie=(0,a.Z)(Ae,2),Ie=ie[0],Se=ie[1],xe=(0,i.useState)("mover"),ue=(0,a.Z)(xe,2),Te=ue[0],je=ue[1],Fe=(0,i.useState)(1),de=(0,a.Z)(Fe,2),w=de[0],Ze=de[1],We=(0,i.useState)(0),ce=(0,a.Z)(We,2),Ue=ce[0],Re=ce[1],ye=(0,i.useState)(""),me=(0,a.Z)(ye,2),Ke=me[0],pe=me[1],ve=function(m){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],M=m;M==null&&(M=1),M<W[0]&&(M=W[0],o.default.error("Smallest scale is "+W[0])),M>W[1]&&(M=W[1],o.default.error("Largest scale is "+W[1])),Ze(M)},Ne=function(){if(console.log("turning next ",f,D.length),f+1>=D.length){o.default.error("This is the last task.");return}U(f+1)},ke=function(){if(console.log("turning prev ",f,D.length),f-1<0){o.default.error("This is the first task.");return}U(f-1)},$e=function(m){var W=(0,d.Z)(B);if(W[(0,E.cq)(m,B,"name")].active=!m.active,m.active){var M=Be.filter(function($){return $.labelId==m.labelId})[0];console.log("filter ann ",M),E.A9.remove(M.annotationId)}else console.log("add ann",{taskId:oe.taskId,labelId:m.labelId}),E.A9.create({taskId:oe.taskId,labelId:m.labelId,dataId:be.dataId}).catch(function($){console.log("err",$)});O(W),Se(m)};return(0,i.useEffect)(function(){function v(){return m.apply(this,arguments)}function m(){return m=(0,A.Z)(g().mark(function W(){var M,$,Pe,q,ee,G,ne;return g().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(_.prev=0,y){_.next=15;break}return _.next=4,(0,X.refreshProject)();case 4:return M=_.sent,_.next=7,E.F$.getTasks(M.projectId);case 7:return $=_.sent,_.next=10,E.F$.getLabels(M.projectId);case 10:return Pe=_.sent,O((0,E.gu)(Pe)),Z($),V(M),_.abrupt("return");case 15:return(0,E.xC)(y.projectId).then(function(te){Re(te)}),Ee(D[f]),q=D[f].taskId,E.Qp.getAnnotations(q).then(function(te){ge(te)}),_.next=21,E.Qp.getDatas(q);case 21:return ee=_.sent,Ce(ee),G=ee[0],De(G),_.next=27,E.Bl.getAnnotations(G.dataId);case 27:ne=_.sent,Oe(ne),O((0,E.JZ)(B,ne)),pe("".concat(H,"/datas/").concat(G.dataId,"/image")),console.log("hereraasdf",B),_.next=38;break;case 34:_.prev=34,_.t0=_.catch(0),console.log(_.t0),z.Z.parseError(_.t0,o.default);case 38:case"end":return _.stop()}},W,null,[[0,34]])})),m.apply(this,arguments)}v()},[f,y]),(0,l.jsxs)(n.Z,{className:S().classes,children:[(0,l.jsxs)(t.Z,{children:[(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){ve(w+.1)},children:"Zoom in"}),(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){ve(w-.1)},children:"Zoom out"}),(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){o.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){je("mover")},children:"Move"})]}),(0,l.jsxs)("div",{id:"dr",className:S().mainStage,children:[(0,l.jsx)("div",{className:S().draw,children:(0,l.jsx)(R.Z,{width:(T=document.getElementById("dr"))===null||T===void 0?void 0:T.clientWidth,scale:w,currentTool:Te,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:Ke})}),(0,l.jsx)("div",{className:S().pblock,children:(0,l.jsx)("div",{className:S().progress,children:(0,l.jsx)(C.Z,{percent:Ue,status:"active"})})})]}),(0,l.jsxs)(t.Z,{disLoc:"right",children:[(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"}),(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/next.png",onClick:function(){Ne()},children:"Next Task"}),(0,l.jsx)(P.Z,{imgSrc:"./pics/buttons/prev.png",onClick:function(){ke()},children:"Prev Task"})]}),(0,l.jsx)("div",{className:S().rightSideBar,children:(0,l.jsx)(h.Z,{labels:B,selectedLabel:Ie,onLabelSelect:function(m){$e(m)},onLabelAdd:function(m){y!=null&&y.projectId&&(0,E.jc)(y.projectId,m,O)},onLabelDelete:function(m){(0,E.SP)(m,O)},onLabelModify:function(){}})})]})};b.default=x}}]);
