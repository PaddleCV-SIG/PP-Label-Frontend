(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{52822:function(r){r.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(r){r.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(r){r.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(r){r.exports={container:"container___G0FNe"}},83930:function(r){r.exports={stage:"stage___3H5QL"}},80961:function(r){r.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(r){r.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(r){r.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(r,O,e){"use strict";var R=e(20136),E=e(55241),B=e(2824),v=e(67294),m=e(52822),u=e.n(m),A=e(63144),d=e(85893),o=function(F){var c=(0,v.useState)(F.color||"#FFF"),t=(0,B.Z)(c,2),L=t[0],a=t[1];return(0,v.useEffect)(function(){a(F.color||"#FFF")},[F]),F.changeable?(0,d.jsx)(E.Z,{getPopupContainer:function(W){return W.parentElement||document.body},overlayClassName:u().popover,openClassName:u().popoverOpenClassName,placement:"bottom",content:(0,d.jsx)(A.xS,{disableAlpha:!0,color:L,onChange:function(W){a(W.hex)},onChangeComplete:F.onChange}),trigger:"click",children:(0,d.jsx)("div",{className:u().roundBall,style:{backgroundColor:L}})}):(0,d.jsx)("div",{className:u().roundBall,style:{backgroundColor:L}})};O.Z=o},5041:function(r,O,e){"use strict";e.d(O,{Z:function(){return K}});var R=e(54421),E=e(38272),B=e(57663),v=e(71577),m=e(2824),u=e(67294),A=e(56131),d=e.n(A),o=e(49111),p=e(19650),F=e(11849),c=e(5882),t=e.n(c),L=e(63097),a=e(85893),f=function(l){var _=(0,F.Z)({},l.label),j=(0,u.useState)(_.invisible),C=(0,m.Z)(j,2),h=C[0],I=C[1],S=(0,a.jsx)(E.ZP.Item,{className:"".concat(t().listItem," ").concat(_.active?t().listItemActive:""),unselectable:"on",onClick:function(){l.onClick(_)},children:(0,a.jsxs)(p.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:t().eye,style:{backgroundImage:h?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){I(!h),l.onLabelModify(_)}})," ",_.name,(0,a.jsx)(L.Z,{color:_.color,changeable:!0,onChange:function(x){_.color=x.hex,l.onLabelModify(_)}}),(0,a.jsx)("a",{className:t().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){l.onLabelDelete(_)}})]})});return S},W=f,J=e(71194),k=e(50146),H=e(47673),M=e(24044),z=e(9715),s=e(93766),y=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],$=function(l){var _,j,C=(0,u.useState)(((_=l.defaultLabel)===null||_===void 0?void 0:_.color)||y[l.order||0]),h=(0,m.Z)(C,2),I=h[0],S=h[1];(0,u.useEffect)(function(){var U;S(((U=l.defaultLabel)===null||U===void 0?void 0:U.color)||y[l.order||0])},[l]);var n=s.Z.useForm(),x=(0,m.Z)(n,1),Y=x[0];return(0,a.jsx)(k.Z,{title:"Add Label",visible:l.visible,onCancel:l.onCancel,footer:null,children:(0,a.jsxs)(s.Z,{form:Y,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(j=l.defaultLabel)===null||j===void 0?void 0:j.name},onFinish:function(D){var V={name:D.labelname,color:I};l.onLabelAdd(V),Y.resetFields()},autoComplete:"off",children:[(0,a.jsx)(s.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,a.jsx)(M.Z,{})}),(0,a.jsx)(s.Z.Item,{label:"Select Color",name:"color",children:(0,a.jsx)(L.Z,{color:I,onChange:function(D){S(D.hex)}})}),(0,a.jsx)(s.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsxs)(p.Z,{children:[(0,a.jsx)(v.Z,{onClick:function(){var D;(D=l.onCancel)===null||D===void 0||D.call(0),Y.resetFields()},children:"\u53D6\u6D88"}),(0,a.jsx)(v.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},Q=$,X=function(l){var _,j=(0,u.useState)(!1),C=(0,m.Z)(j,2),h=C[0],I=C[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.ZP,{className:d().labelList,size:"large",header:(0,a.jsx)("div",{className:d().listHeader,children:"Label List"}),footer:(0,a.jsx)("div",{children:(0,a.jsx)(v.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){I(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:l.labels,renderItem:function(n){return(0,a.jsx)(W,{onClick:l.onLabelSelect,label:n,onLabelDelete:l.onLabelDelete,onLabelModify:l.onLabelModify})}}),(0,a.jsx)(Q,{order:(_=l.labels)===null||_===void 0?void 0:_.length,visible:h,onLabelAdd:function(n){l.onLabelAdd(n),I(!1)},onCancel:function(){I(!1)}})]})},K=X},8088:function(r,O,e){"use strict";var R=e(67294),E=e(78677),B=e.n(E),v=e(85893),m=function(A){return(0,v.jsx)("div",{className:"".concat(B().container," ").concat(A.className),children:A.children})};O.Z=m},57436:function(r,O,e){"use strict";var R=e(91220),E=e(2824),B=e(67294),v=e(65031),m=e(84420),u=e.n(m),A=e(83930),d=e.n(A),o=e(85893),p="./pics/basketball.jpg",F=function(t){var L=u()(t.imgSrc||""),a=(0,E.Z)(L,1),f=a[0],W=(f==null?void 0:f.width)||0,J=(f==null?void 0:f.height)||0,k=(0,B.useState)(),H=(0,E.Z)(k,2),M=H[0],z=H[1],s=(0,B.useState)(),y=(0,E.Z)(s,2),$=y[0],Q=y[1],X=(0,B.useState)({x:0,y:0}),K=(0,E.Z)(X,2),T=K[0],l=K[1];function _(){var n=document.getElementById("dr");n&&(z(n.clientWidth),Q(n.clientHeight))}(0,B.useEffect)(function(){window.removeEventListener("resize",_),window.addEventListener("resize",_);var n=document.getElementById("dr");n&&(z(n.clientWidth),Q(n.clientHeight),l({x:n.clientWidth/2,y:n.clientHeight/2}))},[]);var j=[];if(t.annotations){var C=(0,R.Z)(t.annotations),h;try{for(C.s();!(h=C.n()).done;){var I=h.value;if(!!I){var S=I.tool=="polygon"?t.createPolygonFunc:t.createBrushFunc;S&&j.push(S(I,t.onAnnotationModify,t.onAnnotationModifyComplete,t.scale,t.currentTool,t.setCurrentAnnotation,t.currentAnnotation))}}}catch(n){C.e(n)}finally{C.f()}}return(0,o.jsx)(v.Hf,{width:M,height:$,className:d().stage,children:(0,o.jsx)(v.mh,{onMouseDown:function(x){t.onMouseDown&&t.onMouseDown(x,t.scale)},onMouseMove:function(x){t.onMouseMove&&t.onMouseMove(x,t.scale)},onMouseUp:function(x){t.onMouseUp&&t.onMouseUp(x,t.scale)},onContextMenu:function(x){x.evt.preventDefault()},draggable:!1,children:(0,o.jsxs)(v.ZA,{draggable:t.currentTool=="mover",onDragEnd:function(x){},children:[(0,o.jsx)(v.Ee,{draggable:!1,image:f,x:T.x,y:T.y,offsetX:W/2,offsetY:J/2,scaleX:t.scale,scaleY:t.scale}),j]})})})};O.Z=F},44434:function(r,O,e){"use strict";var R=e(67294),E=e(80961),B=e.n(E),v=e(85893),m=function(A){var d=B().leftToolbar;return A.disLoc=="right"&&(d=B().rightToolbar),(0,v.jsx)("div",{className:d,children:A.children})};O.Z=m},61541:function(r,O,e){"use strict";var R=e(49111),E=e(19650),B=e(67294),v=e(82499),m=e.n(v),u=e(85893),A=function(o){return(0,u.jsx)("div",{unselectable:"on",className:"".concat(m().toolBarButtonContainerWrapper," ").concat(o.active&&m().toolBarButtonContainerWrapperActive),onClick:o.onClick,children:(0,u.jsx)(E.Z,{align:"center",className:m().toolBarButtonContainer,size:0,children:(0,u.jsxs)(E.Z,{align:"center",direction:"vertical",className:m().toolBarButton,size:0,children:[(0,u.jsx)("img",{src:o.imgSrc}),(0,u.jsx)("div",{className:m().buttonText,children:o.children})]})})})};O.Z=A},29214:function(r,O,e){"use strict";e.r(O);var R=e(20228),E=e(11382),B=e(34669),v=e(54458),m=e(3182),u=e(86582),A=e(34792),d=e(48086),o=e(2824),p=e(94043),F=e.n(p),c=e(67294),t=e(73199),L=e.n(t),a=e(8088),f=e(61541),W=e(44434),J=e(5041),k=e(57436),H=e(3275),M=e(93120),z=e(37071),s=e(85893),y=localStorage.getItem("basePath"),$=function(){var X=(0,c.useState)(),K=(0,o.Z)(X,2),T=K[0],l=K[1],_=(0,c.useState)(),j=(0,o.Z)(_,2),C=j[0],h=j[1],I=(0,c.useState)(),S=(0,o.Z)(I,2),n=S[0],x=S[1],Y=(0,c.useState)(0),U=(0,o.Z)(Y,2),D=U[0],V=U[1],Ce=(0,c.useState)(),oe=(0,o.Z)(Ce,2),se=oe[0],ge=oe[1],Le=(0,c.useState)(),le=(0,o.Z)(Le,2),Je=le[0],Me=le[1],De=(0,c.useState)(),re=(0,o.Z)(De,2),Ve=re[0],he=re[1],be=(0,c.useState)(),_e=(0,o.Z)(be,2),Oe=_e[0],Be=_e[1],Ae=(0,c.useState)(),ie=(0,o.Z)(Ae,2),Ie=ie[0],Se=ie[1],xe=(0,c.useState)({color:"",name:""}),ue=(0,o.Z)(xe,2),Te=ue[0],je=ue[1],Fe=(0,c.useState)("mover"),de=(0,o.Z)(Fe,2),Ze=de[0],We=de[1],Ue=(0,c.useState)(1),ce=(0,o.Z)(Ue,2),w=ce[0],Re=ce[1],ye=(0,c.useState)(0),me=(0,o.Z)(ye,2),Ke=me[0],pe=me[1],Ne=(0,c.useState)(""),ve=(0,o.Z)(Ne,2),ke=ve[0],He=ve[1],ze=(0,c.useState)(!1),Pe=(0,o.Z)(ze,2),$e=Pe[0],q=Pe[1],Ee=function(P){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],b=P;b==null&&(b=1),b<Z[0]&&(b=Z[0],d.default.error("Smallest scale is "+Z[0])),b>Z[1]&&(b=Z[1],d.default.error("Largest scale is "+Z[1])),Re(b)},Qe=function(){if(console.log("turning next ",D,n.length),D+1>=n.length){d.default.error("This is the last task.");return}V(D+1)},Xe=function(){if(console.log("turning prev ",D,n.length),D-1<0){d.default.error("This is the first task.");return}V(D-1)},Ye=function(P){var Z=(0,u.Z)(C);if(Z[(0,M.cq)(P,C,"name")].active=!P.active,P.active){var b=Ie.filter(function(N){return N.labelId==P.labelId})[0];console.log("filter ann ",b),M.A9.remove(b.annotationId)}else console.log("add ann",{taskId:se.taskId,labelId:P.labelId}),M.A9.create({taskId:se.taskId,labelId:P.labelId,dataId:Oe.dataId}).catch(function(N){console.log("err",N)});h(Z),je(P)};return(0,c.useEffect)(function(){function g(){return P.apply(this,arguments)}function P(){return P=(0,m.Z)(F().mark(function Z(){var b,N,fe,ee,te,G,ne;return F().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,q(!0),T){i.next=17;break}return i.next=5,(0,H.refreshProject)();case 5:return b=i.sent,i.next=8,M.F$.getTasks(b.projectId);case 8:return N=i.sent,i.next=11,M.F$.getLabels(b.projectId);case 11:return fe=i.sent,h((0,M.gu)(fe)),x(N),l(b),q(!1),i.abrupt("return");case 17:return(0,M.xC)(T.projectId).then(function(ae){pe(ae)}),ge(n[D]),ee=n[D].taskId,M.Qp.getAnnotations(ee).then(function(ae){he(ae)}),i.next=23,M.Qp.getDatas(ee);case 23:return te=i.sent,Me(te),G=te[0],Be(G),i.next=29,M.Bl.getAnnotations(G.dataId);case 29:ne=i.sent,Se(ne),h((0,M.JZ)(C,ne)),He("".concat(y,"/datas/").concat(G.dataId,"/image")),console.log("hereraasdf",C),q(!1),i.next=41;break;case 37:i.prev=37,i.t0=i.catch(0),console.log(i.t0),z.Z.parseError(i.t0,d.default);case 41:case"end":return i.stop()}},Z,null,[[0,37]])})),P.apply(this,arguments)}g()},[D,T]),(0,s.jsxs)(a.Z,{className:L().classes,children:[(0,s.jsxs)(W.Z,{children:[(0,s.jsx)(f.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){Ee(w+.1)},children:"Zoom in"}),(0,s.jsx)(f.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){Ee(w-.1)},children:"Zoom out"}),(0,s.jsx)(f.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){d.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,s.jsx)(f.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){We("mover"),d.default.info("You can move the image now.")},children:"Move"})]}),(0,s.jsx)("div",{id:"dr",className:L().mainStage,children:(0,s.jsxs)(E.Z,{tip:"loading",spinning:$e,children:[(0,s.jsx)("div",{className:L().draw,children:(0,s.jsx)(k.Z,{scale:w,currentTool:Ze,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:ke})}),(0,s.jsx)("div",{className:L().pblock,children:(0,s.jsx)("div",{className:L().progress,children:(0,s.jsx)(v.Z,{percent:Ke,status:"active"})})}),(0,s.jsx)("div",{className:L().prevTask,onClick:function(){Xe()}}),(0,s.jsx)("div",{className:L().nextTask,onClick:function(){Qe()}})]})}),(0,s.jsxs)(W.Z,{disLoc:"right",children:[(0,s.jsx)(f.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,s.jsx)(f.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,s.jsx)("div",{className:L().rightSideBar,children:(0,s.jsx)(J.Z,{labels:C,selectedLabel:Te,onLabelSelect:function(P){Ye(P)},onLabelAdd:function(P){T!=null&&T.projectId&&(0,M.jc)(T.projectId,P,h)},onLabelDelete:function(P){(0,M.SP)(P,h)},onLabelModify:function(){}})})]})};O.default=$}}]);
