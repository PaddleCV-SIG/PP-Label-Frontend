(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[507],{52822:function(v){v.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(v){v.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",delete:"delete___WHPf2",listItemActive:"listItemActive___3FRb7"}},56131:function(v){v.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(v){v.exports={container:"container___G0FNe"}},80961:function(v){v.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(v){v.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},63097:function(v,P,n){"use strict";var Z=n(20136),_=n(55241),d=n(2824),u=n(67294),c=n(52822),s=n.n(c),l=n(63144),h=n(85893),B=function(M){var a=(0,u.useState)(M.color||"#FFF"),D=(0,d.Z)(a,2),j=D[0],e=D[1];return(0,u.useEffect)(function(){e(M.color||"#FFF")},[M]),M.changeable?(0,h.jsx)(_.Z,{getPopupContainer:function(I){return I.parentElement||document.body},overlayClassName:s().popover,openClassName:s().popoverOpenClassName,placement:"bottom",content:(0,h.jsx)(l.xS,{disableAlpha:!0,color:j,onChange:function(I){e(I.hex)},onChangeComplete:M.onChange}),trigger:"click",children:(0,h.jsx)("div",{className:s().roundBall,style:{backgroundColor:j}})}):(0,h.jsx)("div",{className:s().roundBall,style:{backgroundColor:j}})};P.Z=B},5041:function(v,P,n){"use strict";n.d(P,{Z:function(){return X}});var Z=n(54421),_=n(38272),d=n(57663),u=n(71577),c=n(2824),s=n(67294),l=n(56131),h=n.n(l),B=n(49111),Y=n(19650),M=n(11849),a=n(5882),D=n.n(a),j=n(63097),e=n(85893),K=function(t){var i=(0,M.Z)({},t.label),m=(0,s.useState)(i.invisible),y=(0,c.Z)(m,2),x=y[0],F=y[1],O=(0,s.useState)(0),g=(0,c.Z)(O,2),b=g[0],C=g[1],E=t.hideEye?" ":(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("a",{className:D().eye,style:{backgroundImage:x?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(T){T.stopPropagation(),F(!x),t.onLabelModify(i)}})," "]}),A=t.hideColorPicker?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(j.Z,{color:i.color,changeable:!0,onChange:function(T){i.color=T.hex,t.onLabelModify(i)}}),H=(0,e.jsxs)(_.ZP.Item,{className:"".concat(D().listItem," ").concat(t.active?D().listItemActive:""),unselectable:"on",onClick:function(){t.onClick(i)},children:[(0,e.jsxs)(Y.Z,{align:"center",size:5,children:[E,i.name,A]}),(0,e.jsx)("a",{className:D().delete,onClick:function(T){T.stopPropagation();var W=new Date().getTime();W-b<300||(C(W),t.onLabelDelete(i))}})]});return H},I=K,J=n(71194),p=n(50146),Q=n(47673),$=n(24044),k=n(9715),S=n(93766),L=n(48971),N=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],z=function(t){var i,m,y=(0,L.YB)().formatMessage({id:"component.PPAddLabelModal.selectColor"}),x=(0,L.YB)().formatMessage({id:"component.PPAddLabelModal.addLabel"}),F=(0,L.YB)().formatMessage({id:"component.PPAddLabelModal.labelName"}),O=(0,L.YB)().formatMessage({id:"component.PPCreater.cancel"}),g=(0,L.YB)().formatMessage({id:"component.PPSegMode.ok"}),b=(0,s.useState)(((i=t.defaultLabel)===null||i===void 0?void 0:i.color)||N[t.order||0]),C=(0,c.Z)(b,2),E=C[0],A=C[1];(0,s.useEffect)(function(){var U;A(((U=t.defaultLabel)===null||U===void 0?void 0:U.color)||N[t.order||0])},[t]);var H=t.hideColorPicker?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(S.Z.Item,{label:y,name:"color",children:(0,e.jsx)(j.Z,{color:E,onChange:function(o){A(o.hex)}})}),R=S.Z.useForm(),T=(0,c.Z)(R,1),W=T[0];return(0,e.jsx)(p.Z,{title:x,visible:t.visible,onCancel:t.onCancel,footer:null,children:(0,e.jsxs)(S.Z,{form:W,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(m=t.defaultLabel)===null||m===void 0?void 0:m.name},onFinish:function(o){var r={name:o.labelname,color:E};t.onLabelAdd(r),W.resetFields()},autoComplete:"off",children:[(0,e.jsx)(S.Z.Item,{label:F,name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,e.jsx)($.Z,{})}),H,(0,e.jsx)(S.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(u.Z,{onClick:function(){var o;(o=t.onCancel)===null||o===void 0||o.call(0),W.resetFields()},children:O}),(0,e.jsx)(u.Z,{type:"primary",htmlType:"submit",children:g})]})})]})})},q=z,w=function(t){var i,m=(0,L.YB)().formatMessage({id:"component.PPLabelList.addLabel"}),y=(0,L.YB)().formatMessage({id:"component.PPLabelList.labelList"}),x=(0,s.useState)(!1),F=(0,c.Z)(x,2),O=F[0],g=F[1];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_.ZP,{className:h().labelList,size:"large",header:(0,e.jsx)("div",{className:h().listHeader,children:y}),footer:(0,e.jsx)("div",{children:(0,e.jsx)(u.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){g(!0)},block:!0,children:m})}),bordered:!0,dataSource:t.labels,renderItem:function(C){var E;return(0,e.jsx)(I,{hideColorPicker:t.hideColorPicker,hideEye:t.hideEye,onClick:t.onLabelSelect,label:C,active:(E=t.activeIds)===null||E===void 0?void 0:E.has(C.labelId),onLabelDelete:t.onLabelDelete,onLabelModify:t.onLabelModify})}}),(0,e.jsx)(q,{hideColorPicker:t.hideColorPicker,order:(i=t.labels)===null||i===void 0?void 0:i.length,visible:O,onLabelAdd:function(C){t.onLabelAdd(C),g(!1)},onCancel:function(){g(!1)}})]})},X=w},8088:function(v,P,n){"use strict";var Z=n(67294),_=n(78677),d=n.n(_),u=n(85893),c=function(l){return(0,u.jsx)("div",{className:"".concat(d().container," ").concat(l.className),children:l.children})};P.Z=c},57436:function(v,P,n){"use strict";var Z=n(91220),_=n(2824),d=n(67294),u=n(65031),c=n(84420),s=n.n(c),l=n(85893),h="./pics/32_23.jpg";function B(M){switch(M){case"mover":return"move";case"rectangle":case"polygon":return"crosshair";default:return"default"}}var Y=function(a){var D=s()(a.imgSrc||h),j=(0,_.Z)(D,1),e=j[0],K=(e==null?void 0:e.width)||0,I=(e==null?void 0:e.height)||0,J=a.transparency==null?0:a.transparency*.01;console.log("imageWidth,imageHeight: ",K,I);var p=(0,d.useState)(0),Q=(0,_.Z)(p,2),$=Q[0],k=Q[1],S=(0,d.useState)(0),L=(0,_.Z)(S,2),N=L[0],z=L[1],q=(0,d.useState)({x:0,y:0}),w=(0,_.Z)(q,2),X=w[0],V=w[1],t=(0,d.useRef)(null),i=(0,d.useRef)(null),m=(0,d.useRef)(null);function y(){var o=document.getElementById("dr");o&&(k(o.clientWidth),z(o.clientHeight))}(0,d.useEffect)(function(){console.log("try to decode");var o=new XMLHttpRequest;o.open("GET","/test-10.bin",!0),o.responseType="arraybuffer",o.onload=function(r){console.log("onload");var f=o.response,ee=new Uint8Array(f);console.log(f,ee);var G=(0,Z.Z)(ee),ne;try{for(G.s();!(ne=G.n()).done;){var te=ne.value;console.log(te)}}catch(oe){G.e(oe)}finally{G.f()}},o.send()},[]),(0,d.useEffect)(function(){window.removeEventListener("resize",y),window.addEventListener("resize",y);var o=document.getElementById("dr");o&&(k(o.clientWidth),z(o.clientHeight))},[]),(0,d.useEffect)(function(){!t.current||(t.current.container().style.cursor=B(a.currentTool))},[a.currentTool]);var x=function(r){return{e:r,mouseX:(r.evt.offsetX-X.x-$/2)/a.scale+K/2,mouseY:(r.evt.offsetY-X.y-N/2)/a.scale+I/2,canvasRef:m,layerRef:i}},F=function(r){var f;(f=a.drawTool)===null||f===void 0||f.onMouseDown(x(r))},O=function(r){var f;(f=a.drawTool)===null||f===void 0||f.onMouseMove(x(r))},g=function(r){var f;(f=a.drawTool)===null||f===void 0||f.onMouseUp(x(r))},b=function(r){r.cancelBubble=!0,r.evt.preventDefault()},C=[];if(a.annotations){var E={onDrag:a.onAnnotationModify,onDragEnd:a.onAnnotationModifyComplete,scale:a.scale,currentTool:a.currentTool,onSelect:a.setCurrentAnnotation,stageRef:t,currentAnnotation:a.currentAnnotation,transparency:J,canvasRef:m},A=(0,Z.Z)(a.annotations),H;try{for(A.s();!(H=A.n()).done;){var R=H.value;if(!!R){E.annotation=R;var T=a.drawTool.createElementsFunc(E);C.push(T)}}}catch(o){A.e(o)}finally{A.f()}}function W(){var o,r=(o=m.current)===null||o===void 0?void 0:o.getContext("2d");!r||a.drawTool.colorAsFrontendId(m,i)}(0,d.useEffect)(function(){var o=window.setTimeout(function(){for(var r=o;r>=0;r--)window.clearInterval(r)},0);setTimeout(W,1e4),console.log("start dump")});var U=a.currentTool=="mover";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("canvas",{style:{display:"none"},id:"virtualCanvas",width:e==null?void 0:e.width,height:e==null?void 0:e.height}),(0,l.jsx)("canvas",{style:{display:"none"},id:"singleLineCanvas",width:e==null?void 0:e.width,height:e==null?void 0:e.height}),(0,l.jsx)("canvas",{style:{display:"none"},id:"canvasId",ref:m,width:e==null?void 0:e.width,height:e==null?void 0:e.height}),(0,l.jsx)("svg",{width:"0",height:"0",style:{position:"absolute",zIndex:"-1"},children:(0,l.jsx)("defs",{children:(0,l.jsx)("filter",{id:"remove-alpha",x:"0",y:"0",width:"100%",height:"100%",children:(0,l.jsx)("feComponentTransfer",{children:(0,l.jsx)("feFuncA",{type:"discrete",tableValues:"0 1"})})})})}),(0,l.jsxs)(u.Hf,{width:$,height:N,offsetX:-$/2,offsetY:-N/2,className:"stage",ref:t,draggable:U,onDragMove:function(r){a.currentTool=="mover"},onDragEnd:function(r){a.currentTool=="mover"&&(console.log("dragEndPosX,Y: (".concat(r.target.x(),",").concat(r.target.y(),")")),V({x:r.target.x(),y:r.target.y()}))},children:[(0,l.jsx)(u.mh,{onMouseDown:F,onMouseMove:O,onMouseUp:g,onContextMenu:b,scaleX:a.scale,scaleY:a.scale,draggable:!1,children:(0,l.jsx)(u.Ee,{name:"baseImage",draggable:!1,image:e,x:-((e==null?void 0:e.width)||0)/2,y:-((e==null?void 0:e.height)||0)/2})}),(0,l.jsxs)(u.mh,{ref:i,name:"annotation",scaleX:a.scale,scaleY:a.scale,onMouseDown:F,onMouseMove:O,onMouseUp:g,onContextMenu:b,opacity:J,children:[C,(0,l.jsx)(u.Ee,{x:-((e==null?void 0:e.width)||0)/2,y:-((e==null?void 0:e.height)||0)/2,image:m.current||void 0})]})]})]})};P.Z=Y},44434:function(v,P,n){"use strict";var Z=n(67294),_=n(80961),d=n.n(_),u=n(85893),c=function(l){var h=d().leftToolbar;return l.disLoc=="right"&&(h=d().rightToolbar),(0,u.jsx)("div",{className:h,children:l.children})};P.Z=c},61541:function(v,P,n){"use strict";var Z=n(49111),_=n(19650),d=n(67294),u=n(82499),c=n.n(u),s=n(85893),l=function(B){return(0,s.jsx)("div",{unselectable:"on",className:"".concat(c().toolBarButtonContainerWrapper," ").concat(B.active&&c().toolBarButtonContainerWrapperActive),onClick:B.onClick,children:(0,s.jsx)(_.Z,{align:"center",className:c().toolBarButtonContainer,size:0,children:(0,s.jsxs)(_.Z,{align:"center",direction:"vertical",className:c().toolBarButton,size:0,children:[(0,s.jsx)("img",{src:B.imgSrc}),(0,s.jsx)("div",{className:c().buttonText,children:B.children})]})})})};P.Z=l}}]);
