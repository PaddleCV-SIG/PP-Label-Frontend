(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{41435:function(M,y,e){"use strict";e.d(y,{Z:function(){return _}});var N=e(94663),L=e(80112);function E(b){return Function.toString.call(b).indexOf("[native code]")!==-1}var O=e(18597);function u(b,r,p){return(0,O.Z)()?u=Reflect.construct:u=function(I,W,l){var R=[null];R.push.apply(R,W);var c=Function.bind.apply(I,R),F=new c;return l&&(0,L.Z)(F,l.prototype),F},u.apply(null,arguments)}function _(b){var r=typeof Map=="function"?new Map:void 0;return _=function(P){if(P===null||!E(P))return P;if(typeof P!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r!="undefined"){if(r.has(P))return r.get(P);r.set(P,I)}function I(){return u(P,arguments,(0,N.Z)(this).constructor)}return I.prototype=Object.create(P.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),(0,L.Z)(I,P)},_(b)}},52822:function(M){M.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(M){M.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(M){M.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(M){M.exports={container:"container___G0FNe"}},83930:function(M){M.exports={stage:"stage___3H5QL"}},80961:function(M){M.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(M){M.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(M){M.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(M,y,e){"use strict";var N=e(20136),L=e(55241),E=e(2824),O=e(67294),u=e(52822),_=e.n(u),b=e(63144),r=e(85893),p=function(I){var W=(0,O.useState)(I.color||"#FFF"),l=(0,E.Z)(W,2),R=l[0],c=l[1];return(0,O.useEffect)(function(){c(I.color||"#FFF")},[I]),I.changeable?(0,r.jsx)(L.Z,{getPopupContainer:function(K){return K.parentElement||document.body},overlayClassName:_().popover,openClassName:_().popoverOpenClassName,placement:"bottom",content:(0,r.jsx)(b.xS,{disableAlpha:!0,color:R,onChange:function(K){c(K.hex)},onChangeComplete:I.onChange}),trigger:"click",children:(0,r.jsx)("div",{className:_().roundBall,style:{backgroundColor:R}})}):(0,r.jsx)("div",{className:_().roundBall,style:{backgroundColor:R}})};y.Z=p},5041:function(M,y,e){"use strict";e.d(y,{Z:function(){return Z}});var N=e(54421),L=e(38272),E=e(57663),O=e(71577),u=e(2824),_=e(67294),b=e(56131),r=e.n(b),p=e(49111),P=e(19650),I=e(11849),W=e(5882),l=e.n(W),R=e(63097),c=e(85893),F=function(o){var v=(0,I.Z)({},o.label),C=(0,_.useState)(v.invisible),d=(0,u.Z)(C,2),f=d[0],s=d[1],m=(0,c.jsx)(L.ZP.Item,{className:"".concat(l().listItem," ").concat(v.active?l().listItemActive:""),unselectable:"on",onClick:function(){o.onClick(v)},children:(0,c.jsxs)(P.Z,{align:"center",size:5,children:[(0,c.jsx)("a",{className:l().eye,style:{backgroundImage:f?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){s(!f),o.onLabelModify(v)}})," ",v.name,(0,c.jsx)(R.Z,{color:v.color,changeable:!0,onChange:function(t){v.color=t.hex,o.onLabelModify(v)}}),(0,c.jsx)("a",{className:l().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){o.onLabelDelete(v)}})]})});return m},K=F,h=e(71194),$=e(50146),H=e(47673),z=e(24044),U=e(9715),g=e(93766),B=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],S=function(o){var v,C,d=(0,_.useState)(((v=o.defaultLabel)===null||v===void 0?void 0:v.color)||B[o.order||0]),f=(0,u.Z)(d,2),s=f[0],m=f[1];(0,_.useEffect)(function(){var a;m(((a=o.defaultLabel)===null||a===void 0?void 0:a.color)||B[o.order||0])},[o]);var n=g.Z.useForm(),t=(0,u.Z)(n,1),A=t[0];return(0,c.jsx)($.Z,{title:"Add Label",visible:o.visible,onCancel:o.onCancel,footer:null,children:(0,c.jsxs)(g.Z,{form:A,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(C=o.defaultLabel)===null||C===void 0?void 0:C.name},onFinish:function(D){var i={name:D.labelname,color:s};o.onLabelAdd(i),A.resetFields()},autoComplete:"off",children:[(0,c.jsx)(g.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,c.jsx)(z.Z,{})}),(0,c.jsx)(g.Z.Item,{label:"Select Color",name:"color",children:(0,c.jsx)(R.Z,{color:s,onChange:function(D){m(D.hex)}})}),(0,c.jsx)(g.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,c.jsxs)(P.Z,{children:[(0,c.jsx)(O.Z,{onClick:function(){var D;(D=o.onCancel)===null||D===void 0||D.call(0),A.resetFields()},children:"\u53D6\u6D88"}),(0,c.jsx)(O.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},T=S,x=function(o){var v;console.log("render pplabellist");var C=(0,_.useState)(!1),d=(0,u.Z)(C,2),f=d[0],s=d[1];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(L.ZP,{className:r().labelList,size:"large",header:(0,c.jsx)("div",{className:r().listHeader,children:"Label List"}),footer:(0,c.jsx)("div",{children:(0,c.jsx)(O.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){s(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:o.labels,renderItem:function(n){return(0,c.jsx)(K,{onClick:o.onLabelSelect,label:n,onLabelDelete:o.onLabelDelete,onLabelModify:o.onLabelModify})}}),(0,c.jsx)(T,{order:(v=o.labels)===null||v===void 0?void 0:v.length,visible:f,onLabelAdd:function(n){o.onLabelAdd(n),s(!1)},onCancel:function(){s(!1)}})]})},Z=x},8088:function(M,y,e){"use strict";var N=e(67294),L=e(78677),E=e.n(L),O=e(85893),u=function(b){return(0,O.jsx)("div",{className:"".concat(E().container," ").concat(b.className),children:b.children})};y.Z=u},57436:function(M,y,e){"use strict";var N=e(91220),L=e(2824),E=e(67294),O=e(65031),u=e(84420),_=e.n(u),b=e(83930),r=e.n(b),p=e(85893),P="./pics/basketball.jpg",I=function(l){var R=_()(l.imgSrc||""),c=(0,L.Z)(R,1),F=c[0],K=(F==null?void 0:F.width)||0,h=(F==null?void 0:F.height)||0,$=(0,E.useState)(),H=(0,L.Z)($,2),z=H[0],U=H[1],g=(0,E.useState)(),B=(0,L.Z)(g,2),S=B[0],T=B[1],x=(0,E.useState)({x:0,y:0}),Z=(0,L.Z)(x,2),j=Z[0],o=Z[1];function v(){var n=document.getElementById("dr");n&&(U(n.clientWidth),T(n.clientHeight))}(0,E.useEffect)(function(){window.removeEventListener("resize",v),window.addEventListener("resize",v);var n=document.getElementById("dr");n&&(U(n.clientWidth),T(n.clientHeight),o({x:n.clientWidth/2,y:n.clientHeight/2}))},[]);var C=[];if(l.annotations){var d=(0,N.Z)(l.annotations),f;try{for(d.s();!(f=d.n()).done;){var s=f.value;if(!!s){var m=s.tool=="polygon"?l.createPolygonFunc:l.createBrushFunc;m&&C.push(m(s,l.onAnnotationModify,l.onAnnotationModifyComplete,l.scale,l.currentTool,l.setCurrentAnnotation,l.currentAnnotation))}}}catch(n){d.e(n)}finally{d.f()}}return(0,p.jsx)(O.Hf,{width:z,height:S,className:r().stage,children:(0,p.jsx)(O.mh,{onMouseDown:function(t){l.onMouseDown&&l.onMouseDown(t,l.scale)},onMouseMove:function(t){l.onMouseMove&&l.onMouseMove(t,l.scale)},onMouseUp:function(t){l.onMouseUp&&l.onMouseUp(t,l.scale)},onContextMenu:function(t){t.evt.preventDefault()},draggable:!1,children:(0,p.jsxs)(O.ZA,{draggable:l.currentTool=="mover",onDragEnd:function(t){},children:[(0,p.jsx)(O.Ee,{draggable:!1,image:F,x:j.x,y:j.y,offsetX:K/2,offsetY:h/2,scaleX:l.scale,scaleY:l.scale}),C]})})})};y.Z=I},44434:function(M,y,e){"use strict";var N=e(67294),L=e(80961),E=e.n(L),O=e(85893),u=function(b){var r=E().leftToolbar;return b.disLoc=="right"&&(r=E().rightToolbar),(0,O.jsx)("div",{className:r,children:b.children})};y.Z=u},61541:function(M,y,e){"use strict";var N=e(49111),L=e(19650),E=e(67294),O=e(82499),u=e.n(O),_=e(85893),b=function(p){return(0,_.jsx)("div",{unselectable:"on",className:"".concat(u().toolBarButtonContainerWrapper," ").concat(p.active&&u().toolBarButtonContainerWrapperActive),onClick:p.onClick,children:(0,_.jsx)(L.Z,{align:"center",className:u().toolBarButtonContainer,size:0,children:(0,_.jsxs)(L.Z,{align:"center",direction:"vertical",className:u().toolBarButton,size:0,children:[(0,_.jsx)("img",{src:p.imgSrc}),(0,_.jsx)("div",{className:u().buttonText,children:p.children})]})})})};y.Z=b},29214:function(M,y,e){"use strict";e.r(y);var N=e(20228),L=e(11382),E=e(34669),O=e(54458),u=e(34792),_=e(48086),b=e(2824),r=e(67294),p=e(73199),P=e.n(p),I=e(8088),W=e(61541),l=e(44434),R=e(5041),c=e(57436),F=e(37071),K=e(64322),h=e(85893),$=localStorage.getItem("basePath"),H=function U(g){console.log("selectlabel",U)},z=function(){var g,B=(0,r.useState)("mover"),S=(0,b.Z)(B,2),T=S[0],x=S[1],Z=(0,r.useState)(!1),j=(0,b.Z)(Z,2),o=j[0],v=j[1],C=(0,K.Gd)(r.useState),d=(0,K.jL)(r.useState,{pageOnSelect:H}),f=(0,K.iA)(r.useState),s=(0,K._D)(r.useState),m=(0,K.A5)(r.useState),n=F.Z.getQueryVariable("projectId");return console.log("projectId",n),(0,r.useEffect)(function(){v(!0),C.getCurr(n).then(function(t){d.getAll(t.projectId),f.getAll(t.projectId,0)}),v(!1)},[n]),(0,r.useEffect)(function(){!f.curr||m.getAll(f.curr.taskId,0)},[f.curr]),(0,h.jsxs)(I.Z,{className:P().classes,children:[(0,h.jsxs)(l.Z,{children:[(0,h.jsx)(W.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){s.change(.1)},children:"Zoom in"}),(0,h.jsx)(W.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){s.change(-.1)},children:"Zoom out"}),(0,h.jsx)(W.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){_.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,h.jsx)(W.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){x("mover"),_.default.info("You can move the image now.")},children:"Move"})]}),(0,h.jsx)("div",{id:"dr",className:P().mainStage,children:(0,h.jsxs)(L.Z,{tip:"loading",spinning:o,children:[(0,h.jsx)("div",{className:P().draw,children:(0,h.jsx)(c.Z,{scale:s.curr,currentTool:T,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:"".concat($,"/datas/").concat((g=m.curr)===null||g===void 0?void 0:g.dataId,"/image")})}),(0,h.jsx)("div",{className:P().pblock,children:(0,h.jsx)("div",{className:P().progress,children:(0,h.jsx)(O.Z,{percent:50,status:"active"})})}),(0,h.jsx)("div",{className:P().prevTask,onClick:function(){return f.turnTo(f.currIdx-1)}}),(0,h.jsx)("div",{className:P().nextTask,onClick:function(){return f.turnTo(f.currIdx+1)}})]})}),(0,h.jsxs)(l.Z,{disLoc:"right",children:[(0,h.jsx)(W.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,h.jsx)(W.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,h.jsx)("div",{className:P().rightSideBar,children:(0,h.jsx)(R.Z,{labels:d.all,selectedLabel:d.curr,onLabelSelect:d.onSelect,onLabelAdd:d.onAdd,onLabelDelete:d.onDelete,onLabelModify:function(){}})})]})};y.default=z},64322:function(M,y,e){"use strict";e.d(y,{gu:function(){return c},_D:function(){return K},Gd:function(){return h},jL:function(){return $},iA:function(){return H},A5:function(){return z}});var N=e(86582),L=e(91220),E=e(3182),O=e(34792),u=e(48086),_=e(2824),b=e(94043),r=e.n(b),p=e(37071),P=e(81139),I=localStorage.getItem("basePath"),W=new P.VK(I?{basePath:I}:void 0),l=new P.U(W),R=new P.sD(W),c=function(g){return JSON.parse(JSON.stringify(g))};function F(U){return U&&(U.toLowerCase().replace(/([-_][a-z])/g,function(g){return g.toUpperCase().replace("-","").replace("_","")}),U)}var K=function(g){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],S=g(1),T=(0,_.Z)(S,2),x=T[0],Z=T[1],j=x,o=function(C){var d=x;d+=C,d<B[0]&&(d=B[0],u.default.error("Smallest scale is "+B[0])),d>B[1]&&(d=B[1],u.default.error("Largest scale is "+B[1])),Z(d)};return{curr:j,change:o}},h=function(g){console.log("create project util");var B=g([]),S=(0,_.Z)(B,2),T=S[0],x=S[1],Z=g(),j=(0,_.Z)(Z,2),o=j[0],v=j[1],C=function(){var n=(0,E.Z)(r().mark(function t(){return r().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:l.getAll().then(function(D){x(D)}).catch(function(D){console.log("prject getall err",D),p.Z.parseError(D,u.default)});case 1:case"end":return a.stop()}},t)}));return function(){return n.apply(this,arguments)}}(),d=function(){var n=(0,E.Z)(r().mark(function t(A){var a;return r().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(console.log("get curr project"),A){i.next=3;break}return i.abrupt("return",void 0);case 3:return i.prev=3,i.next=6,l.get(A);case 6:return a=i.sent,v(a),i.abrupt("return",a);case 11:i.prev=11,i.t0=i.catch(3),console.log("prject getcurr err",i.t0),p.Z.parseError(i.t0,u.default);case 15:case"end":return i.stop()}},t,null,[[3,11]])}));return function(A){return n.apply(this,arguments)}}(),f=function(){var n=(0,E.Z)(r().mark(function t(A){return r().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:l.remove(A.projectId),C();case 2:case"end":return D.stop()}},t)}));return function(A){return n.apply(this,arguments)}}(),s=function(){var n=(0,E.Z)(r().mark(function t(A){var a;return r().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,l.create(A);case 3:return a=i.sent,console.log(a),i.abrupt("return",a);case 8:i.prev=8,i.t0=i.catch(0),console.log("project create err",i.t0),p.Z.parseError(i.t0,u.default);case 12:case"end":return i.stop()}},t,null,[[0,8]])}));return function(A){return n.apply(this,arguments)}}(),m=function(){var n=(0,E.Z)(r().mark(function t(A,a){return r().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:l.update(A,{name:a.name,description:a.description,dataDir:a.dataDir,labelDir:a.labelDir}).then(function(k){console.log("project update res",k)}).catch(function(k){console.log("project update err ",k),p.Z.parseError(k,u.default)});case 1:case"end":return i.stop()}},t)}));return function(A,a){return n.apply(this,arguments)}}();return{curr:o,all:T,getAll:C,getCurr:d,remove:f,create:s,update:m}},$=function(g,B){var S=B.pageOnSelect,T=g([]),x=(0,_.Z)(T,2),Z=x[0],j=x[1],o=function(){var s=(0,E.Z)(r().mark(function m(n){return r().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:l.getLabels(n).then(function(a){var D=(0,L.Z)(a),i;try{for(D.s();!(i=D.n()).done;){var k=i.value;k.active=!0}}catch(V){D.e(V)}finally{D.f()}j(a)});case 1:case"end":return A.stop()}},m)}));return function(n){return s.apply(this,arguments)}}(),v=function(m){var n=Z.filter(function(t){return t.labelId==m.labelId})[0];n.active=!n.active,S(n),j((0,N.Z)(Z))},C=function(){},d=function(){},f=function(){};return{all:Z,curr,getAll:o,onSelect:v,onAdd:C,onDelete:d,onModify:f}},H=function(g){var B=g([]),S=(0,_.Z)(B,2),T=S[0],x=S[1],Z=g(0),j=(0,_.Z)(Z,2),o=j[0],v=j[1],C=function(s){if(console.log("turnto",T,s),T.length!=0){if(s==-1){u.default.error("This is the first image. No previous image.");return}if(s==T.length){u.default.error("This is the final image. No next image.");return}v(s)}},d=function(){var f=(0,E.Z)(r().mark(function s(m,n){var t;return r().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.getTasks(m);case 3:return t=a.sent,x(t),n!=null&&C(n),a.abrupt("return",t);case 9:a.prev=9,a.t0=a.catch(0),console.log("task getall err ",a.t0),p.Z.parseError(a.t0,u.default);case 13:case"end":return a.stop()}},s,null,[[0,9]])}));return function(m,n){return f.apply(this,arguments)}}();return{currIdx:o,all:T,turnTo:C,getAll:d,get curr(){if(this.all.length)return this.all[this.currIdx]}}},z=function(g){var B=g(0),S=(0,_.Z)(B,2),T=S[0],x=S[1],Z=g([]),j=(0,_.Z)(Z,2),o=j[0],v=j[1],C=function(){var f=(0,E.Z)(r().mark(function s(m){return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:x(m);case 1:case"end":return t.stop()}},s)}));return function(m){return f.apply(this,arguments)}}(),d=function(){var f=(0,E.Z)(r().mark(function s(m,n){var t;return r().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,R.getDatas(m);case 3:return t=a.sent,n!=null&&C(n),v(t),a.abrupt("return",t);case 9:a.prev=9,a.t0=a.catch(0),console.log("data getall err ",a.t0),p.Z.parseError(a.t0,u.default);case 13:case"end":return a.stop()}},s,null,[[0,9]])}));return function(m,n){return f.apply(this,arguments)}}();return{all:o,getAll:d,turnTo:C,get curr(){if(o.length!=0)return o[T]}}}}}]);
