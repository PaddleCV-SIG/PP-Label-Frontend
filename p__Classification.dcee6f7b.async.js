(self.webpackChunkpp_label_frontend=self.webpackChunkpp_label_frontend||[]).push([[672],{52822:function(s){s.exports={roundBall:"roundBall___1pqu1",popover:"popover___1-PR6"}},5882:function(s){s.exports={listItem:"listItem___vtDXn",eye:"eye___AsLBS",roundBall:"roundBall___1J_R3",popover:"popover___1x-2R",listItemActive:"listItemActive___3FRb7"}},56131:function(s){s.exports={labelList:"labelList___jvD05",listHeader:"listHeader___UM5UF",eye:"eye___II3Po",roundBall:"roundBall___j752J"}},78677:function(s){s.exports={container:"container___G0FNe"}},83930:function(s){s.exports={stage:"stage___3H5QL"}},80961:function(s){s.exports={leftToolbar:"leftToolbar___1xi4t",rightToolbar:"rightToolbar___3dNSB"}},82499:function(s){s.exports={toolBarButtonContainerWrapper:"toolBarButtonContainerWrapper___1SHWL",toolBarButtonContainer:"toolBarButtonContainer___1jKUz",toolBarButton:"toolBarButton___3Ouq1",buttonText:"buttonText___10ls7",toolBarButtonContainerWrapperActive:"toolBarButtonContainerWrapperActive___3AA28"}},73199:function(s){s.exports={classes:"classes___3trCU",mainStage:"mainStage___3ajeT",prevTask:"prevTask___1O-ND",nextTask:"nextTask___2SQX8",draw:"draw___3nlFC",pblock:"pblock___2fZaD",progress:"progress___K3vmc",rightSideBar:"rightSideBar___aFTer"}},63097:function(s,g,e){"use strict";var K=e(20136),L=e(55241),S=e(2824),m=e(67294),d=e(52822),_=e.n(d),D=e(63144),i=e(85893),l=function(O){var u=(0,m.useState)(O.color||"#FFF"),n=(0,S.Z)(u,2),C=n[0],a=n[1];return(0,m.useEffect)(function(){a(O.color||"#FFF")},[O]),O.changeable?(0,i.jsx)(L.Z,{getPopupContainer:function(T){return T.parentElement||document.body},overlayClassName:_().popover,openClassName:_().popoverOpenClassName,placement:"bottom",content:(0,i.jsx)(D.xS,{disableAlpha:!0,color:C,onChange:function(T){a(T.hex)},onChangeComplete:O.onChange}),trigger:"click",children:(0,i.jsx)("div",{className:_().roundBall,style:{backgroundColor:C}})}):(0,i.jsx)("div",{className:_().roundBall,style:{backgroundColor:C}})};g.Z=l},5041:function(s,g,e){"use strict";e.d(g,{Z:function(){return G}});var K=e(54421),L=e(38272),S=e(57663),m=e(71577),d=e(2824),_=e(67294),D=e(56131),i=e.n(D),l=e(49111),N=e(19650),O=e(11849),u=e(5882),n=e.n(u),C=e(63097),a=e(85893),E=function(t){var v=(0,O.Z)({},t.label),U=(0,_.useState)(v.invisible),j=(0,d.Z)(U,2),h=j[0],b=j[1],F=(0,a.jsx)(L.ZP.Item,{className:"".concat(n().listItem," ").concat(v.active?n().listItemActive:""),unselectable:"on",onClick:function(){t.onClick(v)},children:(0,a.jsxs)(N.Z,{align:"center",size:5,children:[(0,a.jsx)("a",{className:n().eye,style:{backgroundImage:h?"url(./pics/hide.png)":"url(./pics/show.png)"},onClick:function(){b(!h),t.onLabelModify(v)}})," ",v.name,(0,a.jsx)(C.Z,{color:v.color,changeable:!0,onChange:function(R){v.color=R.hex,t.onLabelModify(v)}}),(0,a.jsx)("a",{className:n().eye,style:{backgroundImage:"url(./pics/delete.png)"},onClick:function(){t.onLabelDelete(v)}})]})});return F},T=E,Y=e(71194),$=e(50146),z=e(47673),c=e(24044),H=e(9715),o=e(93766),p=["#FF0000","#008000","#0000FF","#FFFF00","#FFA500","#00FFFF","#8B00FF","#FFC0CB","#7CFC00","#007FFF","#800080","#36BF36","#DAA520","#800000","#008B8B","#B22222","#E6D933","#000080","#FF00FF","#FFFF99","#87CEEB","#5C50E6","#CD5C5C","#20B2AA","#E680FF","#4D1F00","#006374","#B399FF","#8B4513","#BA55D3","#C0C0C0","#808080","#000000"],W=function(t){var v,U,j=(0,_.useState)(((v=t.defaultLabel)===null||v===void 0?void 0:v.color)||p[t.order||0]),h=(0,d.Z)(j,2),b=h[0],F=h[1];(0,_.useEffect)(function(){var y;F(((y=t.defaultLabel)===null||y===void 0?void 0:y.color)||p[t.order||0])},[t]);var B=o.Z.useForm(),R=(0,d.Z)(B,1),V=R[0];return(0,a.jsx)($.Z,{title:"Add Label",visible:t.visible,onCancel:t.onCancel,footer:null,children:(0,a.jsxs)(o.Z,{form:V,name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!1,labelname:(U=t.defaultLabel)===null||U===void 0?void 0:U.name},onFinish:function(Z){var A={name:Z.labelname,color:b};t.onLabelAdd(A),V.resetFields()},autoComplete:"off",children:[(0,a.jsx)(o.Z.Item,{label:"Label Name",name:"labelname",rules:[{required:!0,message:"Please input label name!"}],children:(0,a.jsx)(c.Z,{})}),(0,a.jsx)(o.Z.Item,{label:"Select Color",name:"color",children:(0,a.jsx)(C.Z,{color:b,onChange:function(Z){F(Z.hex)}})}),(0,a.jsx)(o.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsxs)(N.Z,{children:[(0,a.jsx)(m.Z,{onClick:function(){var Z;(Z=t.onCancel)===null||Z===void 0||Z.call(0),V.resetFields()},children:"\u53D6\u6D88"}),(0,a.jsx)(m.Z,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"})]})})]})})},x=W,Q=function(t){var v,U=(0,_.useState)(!1),j=(0,d.Z)(U,2),h=j[0],b=j[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L.ZP,{className:i().labelList,size:"large",header:(0,a.jsx)("div",{className:i().listHeader,children:"Label List"}),footer:(0,a.jsx)("div",{children:(0,a.jsx)(m.Z,{style:{height:40,fontSize:"0.75rem"},type:"primary",onClick:function(){b(!0)},block:!0,children:"Add Label"})}),bordered:!0,dataSource:t.labels,renderItem:function(B){return(0,a.jsx)(T,{onClick:t.onLabelSelect,label:B,onLabelDelete:t.onLabelDelete,onLabelModify:t.onLabelModify})}}),(0,a.jsx)(x,{order:(v=t.labels)===null||v===void 0?void 0:v.length,visible:h,onLabelAdd:function(B){t.onLabelAdd(B),b(!1)},onCancel:function(){b(!1)}})]})},G=Q},8088:function(s,g,e){"use strict";var K=e(67294),L=e(78677),S=e.n(L),m=e(85893),d=function(D){return(0,m.jsx)("div",{className:"".concat(S().container," ").concat(D.className),children:D.children})};g.Z=d},57436:function(s,g,e){"use strict";var K=e(91220),L=e(2824),S=e(67294),m=e(65031),d=e(84420),_=e.n(d),D=e(83930),i=e.n(D),l=e(85893),N="./pics/basketball.jpg",O=function(n){var C=_()(n.imgSrc),a=(0,L.Z)(C,1),E=a[0],T=(E==null?void 0:E.width)||0,Y=(E==null?void 0:E.height)||0,$=n.width||T,z=[];if(n.annotations){var c=(0,K.Z)(n.annotations),H;try{for(c.s();!(H=c.n()).done;){var o=H.value;if(!!o){var p=o.tool=="polygon"?n.createPolygonFunc:n.createBrushFunc;p&&z.push(p(o,n.onAnnotationModify,n.onAnnotationModifyComplete,n.scale,n.currentTool,n.setCurrentAnnotation,n.currentAnnotation))}}}catch(W){c.e(W)}finally{c.f()}}return(0,l.jsx)(m.Hf,{width:$,height:783,className:i().stage,children:(0,l.jsx)(m.mh,{scaleX:n.scale,scaleY:n.scale,onMouseDown:function(x){n.onMouseDown&&n.onMouseDown(x,n.scale)},onMouseMove:function(x){n.onMouseMove&&n.onMouseMove(x,n.scale)},onMouseUp:function(x){n.onMouseUp&&n.onMouseUp(x,n.scale)},onContextMenu:function(x){x.evt.preventDefault()},draggable:!1,children:(0,l.jsxs)(m.ZA,{draggable:n.currentTool=="mover",children:[(0,l.jsx)(m.Ee,{draggable:!1,image:E}),z]})})})};g.Z=O},44434:function(s,g,e){"use strict";var K=e(67294),L=e(80961),S=e.n(L),m=e(85893),d=function(D){var i=S().leftToolbar;return D.disLoc=="right"&&(i=S().rightToolbar),(0,m.jsx)("div",{className:i,children:D.children})};g.Z=d},61541:function(s,g,e){"use strict";var K=e(49111),L=e(19650),S=e(67294),m=e(82499),d=e.n(m),_=e(85893),D=function(l){return(0,_.jsx)("div",{unselectable:"on",className:"".concat(d().toolBarButtonContainerWrapper," ").concat(l.active&&d().toolBarButtonContainerWrapperActive),onClick:l.onClick,children:(0,_.jsx)(L.Z,{align:"center",className:d().toolBarButtonContainer,size:0,children:(0,_.jsxs)(L.Z,{align:"center",direction:"vertical",className:d().toolBarButton,size:0,children:[(0,_.jsx)("img",{src:l.imgSrc}),(0,_.jsx)("div",{className:d().buttonText,children:l.children})]})})})};g.Z=D},29214:function(s,g,e){"use strict";e.r(g);var K=e(20228),L=e(11382),S=e(34669),m=e(54458),d=e(3182),_=e(86582),D=e(34792),i=e(48086),l=e(2824),N=e(94043),O=e.n(N),u=e(67294),n=e(73199),C=e.n(n),a=e(8088),E=e(61541),T=e(44434),Y=e(5041),$=e(57436),z=e(3275),c=e(93120),H=e(37071),o=e(85893),p=localStorage.getItem("basePath"),W=function(){var Q,G=(0,u.useState)(),J=(0,l.Z)(G,2),t=J[0],v=J[1],U=(0,u.useState)(),j=(0,l.Z)(U,2),h=j[0],b=j[1],F=(0,u.useState)(),B=(0,l.Z)(F,2),R=B[0],V=B[1],y=(0,u.useState)(0),Z=(0,l.Z)(y,2),A=Z[0],ae=Z[1],Le=(0,u.useState)(),oe=(0,l.Z)(Le,2),le=oe[0],Me=oe[1],ge=(0,u.useState)(),se=(0,l.Z)(ge,2),Ye=se[0],De=se[1],be=(0,u.useState)(),re=(0,l.Z)(be,2),Ge=re[0],he=re[1],Oe=(0,u.useState)(),_e=(0,l.Z)(Oe,2),Be=_e[0],Ae=_e[1],Ie=(0,u.useState)(),ie=(0,l.Z)(Ie,2),Se=ie[0],Te=ie[1],xe=(0,u.useState)({color:"",name:""}),ue=(0,l.Z)(xe,2),je=ue[0],Fe=ue[1],Ze=(0,u.useState)("mover"),de=(0,l.Z)(Ze,2),We=de[0],Ue=de[1],Re=(0,u.useState)(1),ce=(0,l.Z)(Re,2),w=ce[0],ye=ce[1],Ke=(0,u.useState)(0),me=(0,l.Z)(Ke,2),pe=me[0],Ne=me[1],ke=(0,u.useState)(""),ve=(0,l.Z)(ke,2),$e=ve[0],ze=ve[1],He=(0,u.useState)(!1),Pe=(0,l.Z)(He,2),Qe=Pe[0],Ee=Pe[1],fe=function(P){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[.1,3],M=P;M==null&&(M=1),M<I[0]&&(M=I[0],i.default.error("Smallest scale is "+I[0])),M>I[1]&&(M=I[1],i.default.error("Largest scale is "+I[1])),ye(M)},Je=function(){if(console.log("turning next ",A,R.length),A+1>=R.length){i.default.error("This is the last task.");return}ae(A+1)},Ve=function(){if(console.log("turning prev ",A,R.length),A-1<0){i.default.error("This is the first task.");return}ae(A-1)},Xe=function(P){var I=(0,_.Z)(h);if(I[(0,c.cq)(P,h,"name")].active=!P.active,P.active){var M=Se.filter(function(k){return k.labelId==P.labelId})[0];console.log("filter ann ",M),c.A9.remove(M.annotationId)}else console.log("add ann",{taskId:le.taskId,labelId:P.labelId}),c.A9.create({taskId:le.taskId,labelId:P.labelId,dataId:Be.dataId}).catch(function(k){console.log("err",k)});b(I),Fe(P)};return(0,u.useEffect)(function(){function f(){return P.apply(this,arguments)}function P(){return P=(0,d.Z)(O().mark(function I(){var M,k,Ce,q,ee,X,ne;return O().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,Ee(!0),t){r.next=16;break}return r.next=5,(0,z.refreshProject)();case 5:return M=r.sent,r.next=8,c.F$.getTasks(M.projectId);case 8:return k=r.sent,r.next=11,c.F$.getLabels(M.projectId);case 11:return Ce=r.sent,b((0,c.gu)(Ce)),V(k),v(M),r.abrupt("return");case 16:return(0,c.xC)(t.projectId).then(function(te){Ne(te)}),Me(R[A]),q=R[A].taskId,c.Qp.getAnnotations(q).then(function(te){he(te)}),r.next=22,c.Qp.getDatas(q);case 22:return ee=r.sent,De(ee),X=ee[0],Ae(X),r.next=28,c.Bl.getAnnotations(X.dataId);case 28:ne=r.sent,Te(ne),b((0,c.JZ)(h,ne)),ze("".concat(p,"/datas/").concat(X.dataId,"/image")),console.log("hereraasdf",h),Ee(!1),r.next=40;break;case 36:r.prev=36,r.t0=r.catch(0),console.log(r.t0),H.Z.parseError(r.t0,i.default);case 40:case"end":return r.stop()}},I,null,[[0,36]])})),P.apply(this,arguments)}f()},[A,t]),(0,o.jsxs)(a.Z,{className:C().classes,children:[(0,o.jsxs)(T.Z,{children:[(0,o.jsx)(E.Z,{imgSrc:"./pics/buttons/zoom_in.png",onClick:function(){fe(w+.1)},children:"Zoom in"}),(0,o.jsx)(E.Z,{imgSrc:"./pics/buttons/zoom_out.png",onClick:function(){fe(w-.1)},children:"Zoom out"}),(0,o.jsx)(E.Z,{imgSrc:"./pics/buttons/save.png",onClick:function(){i.default.info("Annotations are saved automatically. You don't need to click save.")},children:"Save"}),(0,o.jsx)(E.Z,{imgSrc:"./pics/buttons/move.png",onClick:function(){Ue("mover"),i.default.info("You can move the image now.")},children:"Move"})]}),(0,o.jsx)("div",{id:"dr",className:C().mainStage,children:(0,o.jsxs)(L.Z,{tip:"loading",spinning:Qe,children:[(0,o.jsx)("div",{className:C().draw,children:(0,o.jsx)($.Z,{width:(Q=document.getElementById("dr"))===null||Q===void 0?void 0:Q.clientWidth,scale:w,currentTool:We,setCurrentAnnotation:function(){},onAnnotationModify:function(){},onAnnotationModifyComplete:function(){},imgSrc:$e})}),(0,o.jsx)("div",{className:C().pblock,children:(0,o.jsx)("div",{className:C().progress,children:(0,o.jsx)(m.Z,{percent:pe,status:"active"})})}),(0,o.jsx)("div",{className:C().prevTask,onClick:function(){Ve()}}),(0,o.jsx)("div",{className:C().nextTask,onClick:function(){Je()}})]})}),(0,o.jsxs)(T.Z,{disLoc:"right",children:[(0,o.jsx)(E.Z,{imgSrc:"./pics/buttons/export.png",children:"Export"}),(0,o.jsx)(E.Z,{imgSrc:"./pics/buttons/data_division.png",children:"Split Dataset"})]}),(0,o.jsx)("div",{className:C().rightSideBar,children:(0,o.jsx)(Y.Z,{labels:h,selectedLabel:je,onLabelSelect:function(P){Xe(P)},onLabelAdd:function(P){t!=null&&t.projectId&&(0,c.jc)(t.projectId,P,b)},onLabelDelete:function(P){(0,c.SP)(P,b)},onLabelModify:function(){}})})]})};g.default=W}}]);
